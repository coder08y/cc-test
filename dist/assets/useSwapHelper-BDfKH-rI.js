import{i as G,K as b,a as N,e as K,z as u,V}from"./index-Lo8eQgA0.js";import{r as y}from"./vendor-CBmAETR3.js";import{u as C}from"./useGetPoolList-Bo7JxsYj.js";var A=(t=>(t.CETUS="CETUS",t.KRIYA="KRIYA",t.KRIYAV3="KRIYAV3",t.FLOWX="FLOWX",t.FLOWXV3="FLOWXV3",t.AFTERMATH="AFTERMATH",t.METASTABLE="METASTABLE",t.HAEDAL="HAEDAL",t.VOLO="VOLO",t.AFSUI="AFSUI",t.DEEPBOOKV3="DEEPBOOKV3",t.SCALLOP="SCALLOP",t.BLUEMOVE="BLUEMOVE",t.TURBOS="TURBOS",t.SPRINGSUI="SPRINGSUI",t.BLUEFIN="BLUEFIN",t.HAEDALPMM="HAEDALPMM",t.ALPHAFI="ALPHAFI",t.STEAMM="STEAMM",t.STEAMM_OMM_V2="STEAMM_OMM_V2",t.OBRIC="OBRIC",t.HAWAL="HAWAL",t.MOMENTUM="MOMENTUM",t.MAGMA="MAGMA",t.SEVENK="SEVENK",t.HAEDALHMMV2="HAEDALHMMV2",t.FULLSAIL="FULLSAIL",t.CETUSDLMM="CETUSDLMM",t.FERRACLMM="FERRACLMM",t.FERRADLMM="FERRADLMM",t))(A||{}),P=(t=>(t[t.CalculateError=1e3]="CalculateError",t[t.NumberTooLarge=1001]="NumberTooLarge",t[t.NoRouter=1005]="NoRouter",t[t.InsufficientLiquidity=1002]="InsufficientLiquidity",t[t.HoneyPot=1003]="HoneyPot",t))(P||{}),q=(t=>(t.TradeInputPage="TradeInput",t.TradeStatus="TradeStatus",t.SelectTokenPage="SelectToken",t.TradeConfirmPage="TradeConfirm",t.RoutePage="Route",t.TradeSetting="TradeSetting",t.SlippageSetting="SlippageSetting",t))(q||{});const $=(t,s)=>({providersSwitchStates:{[A.CETUS]:!0},setProvidersSwitchStates:n=>{const c=s().providersSwitchStates;t(()=>({providersSwitchStates:{...c,...n}}))},supportOrderSplit:!0,setSupportOrderSplit:n=>{t(()=>({supportOrderSplit:n}))},isOpenRfqSwitch:!0,setIsOpenRfqSwitch:n=>{t(()=>({isOpenRfqSwitch:n}))},rfqConfigs:void 0,setRfqConfigs:n=>{t(()=>({rfqConfigs:n}))}}),X=G(b($,{name:"useSwapConfigStore"}));function x(t=!0){const{poolApiMap:s,setPoolApiMap:n}=N(),{getPoolList:c,getLocalJsonPoolList:S,getLocalJsonPoolAddress:T}=C();return{getPoolListByCoinType:async(l,f)=>{if(l&&f){const M=[l,f].sort(),e=`${M[0]}_${M[1]}`,m=s[e];if(m)return m;const a={coin_type:`${l},${f}`,display_all_pools:!0,offset:0,limit:100,order_by:"-tvl",no_incentives:!0,has_farming:!0,has_mining:!0};let o=t?await S(a):void 0;(o===void 0||o.list.length===0)&&(o=await c(a));const i=o.list;if(i.length>0)return s[e]=i,n(e,i),i}return[]},getPoolAddressByCoinType:async(l,f)=>{if(l&&f){const M=[l,f].sort(),e=`${M[0]}_${M[1]}`;if(t){const o=await T(l,f);if(!o||o.length===0){const i=s[e];if(i)return i.map(p=>p.poolAddress)}else return o}const m={coin_type:`${l},${f}`,display_all_pools:!0,offset:0,limit:100,order_by:"-tvl",no_incentives:!0,has_farming:!0,has_mining:!0},a=await c(m);if(a){const o=a.list;if(o.length>0)return s[e]=o,n(e,o),o.map(i=>i.poolAddress)}}return[]}}}function k(t,s){return{priceAcceptRouterData:y.useMemo(()=>{if(s&&t){if(t.byAmountIn){if(!u(t.toAmountUi).eq(s.toAmountUi||"0"))return s}else if(!u(t.fromAmountUi).eq(s.fromAmountUi||"0"))return s;return}},[s,t])}}function z(t,s){return{amountLimit:y.useMemo(()=>{if(s&&s.routerData){const{byAmountIn:c,fromAmountUi:S,toAmountUi:T}=s;return c?u(T).mul(u(1).sub(u(t))).toString():u(S).mul(u(1).add(u(t))).toString()}},[t,s])}}const Y={[A.HAEDALHMMV2]:A.HAEDALPMM};function Q(t){const{fetchTokenInfo:s}=K(),[n,c]=y.useState({}),S=async()=>{var T,O,I;if(t&&t.routerData){const l=[],f=t.byAmountIn?t.routerData.amountIn.toString():t.routerData.amountOut.toString(),M=[],e=[];let m=u(0);const a=((T=t==null?void 0:t.routerData)==null?void 0:T.routes)||[];for(let i=0;i<a.length;i++){const p=a[i],h={},H=t.byAmountIn?p.amountIn.toString():p.amountOut.toString();i===t.routerData.routes.length-1?h.percentage=u(1).sub(m).toFixed(2):h.percentage=u(H).div(f).toFixed(2),m=u(m).add(h.percentage);const U=[];for(let _=0;_<((O=p==null?void 0:p.path)==null?void 0:O.length);_++){const L=(I=p==null?void 0:p.path)==null?void 0:I[_],F=Y[L.provider]||L.provider;l.includes(F)||l.push(F);const E=V(L.from).full_address,R=V(L.target).full_address,d=await s([E,R]),B=d==null?void 0:d.get(E),r=d==null?void 0:d.get(R);B||e.includes(E)&&e.push(E),r||e.includes(R)&&e.push(R);const w=L.provider===A.SCALLOP||L.provider===A.FLOWX||L.provider===A.FLOWXV3;U.push({from_type:E,to_type:R,pool_address:w?"":L.id,fee_rate:L.feeRate,provider:L.provider})}h.paths=U,M.push(h)}if(e.length>0){const i=e==null?void 0:e.map(p=>p);await s(i)}c({router_summery:"",providers:l,routers:M});return}c(void 0)};return y.useEffect(()=>{S()},[t]),{formatSwapRouter:n}}function Z(){const{getPoolAddressByCoinType:t}=x(!0);return{getSwapPoolAddress:async(n,c)=>{if(n&&c){const S=await t(n.coin_type,c.coin_type);return console.log("ðŸš€ ~ getSwapPoolAddress ~ list:",S),S}return[]}}}function v(t,s){return y.useMemo(()=>t&&s&&+t&&+s?u(s).div(t).toString():"0",[t,s])}function D(t,s){const{isOpenRfqSwitch:n}=X();return y.useMemo(()=>{if(n&&t&&s&&t.uuid===s.uuid)return u(t.toAmountUi||0).gt(s.toAmountUi||0)?t:void 0},[t,s])}export{A,q as S,P as a,v as b,X as c,z as d,D as e,k as f,Q as g,Z as u};
