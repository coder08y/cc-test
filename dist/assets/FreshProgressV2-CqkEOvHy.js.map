{"version":3,"file":"FreshProgressV2-CqkEOvHy.js","sources":["../../src/components/swap/FreshProgressV2.tsx"],"sourcesContent":["import { cancelBubble } from '@cetus/utils'\nimport {\n  Center,\n  CircularProgress,\n  CircularProgressProps,\n  HTMLChakraProps,\n  Popover,\n  PopoverBody,\n  PopoverContent,\n  PopoverTrigger\n} from '@chakra-ui/react'\nimport { useInterval } from 'ahooks'\nimport { forwardRef, useEffect, useImperativeHandle, useState } from 'react'\n\ninterface FreshProgressProps extends HTMLChakraProps<'div'> {\n  callbackInterval?: number\n  min: number\n  max: number\n  onClick: () => void\n  size?: string\n  noBg?: boolean\n  thickness?: CircularProgressProps['thickness']\n}\n\nexport interface FreshProgressRef {\n  reset: () => void\n}\n\nconst FreshProgressV2 = forwardRef<FreshProgressRef, FreshProgressProps>(\n  ({ callbackInterval = 20, min, max, onClick, size = '18px', noBg, thickness = '10px', ...rest }, ref) => {\n    const [refreshCount, setRefreshCount] = useState<number>(0)\n\n    // Expose reset method to parent via ref\n    useImperativeHandle(ref, () => ({\n      reset: () => setRefreshCount(0)\n    }))\n\n    // Interval for auto-increment\n\n    const clear = useInterval(() => {\n      setRefreshCount(prev => {\n        const newCount = prev + 1\n        if (newCount >= callbackInterval) {\n          onClick()\n          return 0 // Reset after calling onClick\n        }\n        return newCount\n      })\n    }, 1000)\n\n    useEffect(() => {\n      return () => {\n        clear()\n      }\n    }, [])\n\n    return (\n      <>\n        {noBg ? (\n          <Center\n            p=\"2px\"\n            cursor=\"pointer\"\n            onClick={e => {\n              cancelBubble(e)\n              setRefreshCount(0) // Reset on manual click\n              onClick()\n            }}\n          >\n            <CircularProgress\n              min={min}\n              max={max}\n              value={refreshCount}\n              size={size}\n              color=\"text_highlight\"\n              trackColor=\"circle_progress_track_color\"\n              thickness={thickness}\n            />\n          </Center>\n        ) : (\n          <Popover isLazy trigger=\"hover\" autoFocus={false} returnFocusOnClose={false} gutter={4}>\n            <PopoverTrigger>\n              <Center\n                w=\"28px\"\n                h=\"28px\"\n                border=\"1px solid\"\n                borderColor=\"border\"\n                borderRadius=\"8px\"\n                bg=\"bg_secondary\"\n                cursor=\"pointer\"\n                {...rest}\n                onClick={() => {\n                  setRefreshCount(0) // Reset on manual click\n                  onClick()\n                }}\n              >\n                <CircularProgress\n                  min={min}\n                  max={max}\n                  value={callbackInterval == 5 ? 0 : refreshCount}\n                  size={size}\n                  color=\"text_highlight\"\n                  trackColor=\"circle_progress_track_color\"\n                />\n              </Center>\n            </PopoverTrigger>\n            <PopoverContent>\n              <PopoverBody p=\"12px\" lineHeight=\"20px\" fontSize=\"12px\">\n                Auto refresh in {callbackInterval} seconds, you can click to update manually.\n              </PopoverBody>\n            </PopoverContent>\n          </Popover>\n        )}\n      </>\n    )\n  }\n)\n\nexport default FreshProgressV2\n"],"names":["FreshProgressV2","forwardRef","callbackInterval","min","max","onClick","size","noBg","thickness","rest","ref","refreshCount","setRefreshCount","useState","useImperativeHandle","clear","useInterval","prev","newCount","useEffect","jsx","Center","e","cancelBubble","CircularProgress","jsxs","Popover","PopoverTrigger","PopoverContent","PopoverBody"],"mappings":"2KA4BA,MAAMA,EAAkBC,EAAAA,WACtB,CAAC,CAAE,iBAAAC,EAAmB,GAAI,IAAAC,EAAK,IAAAC,EAAK,QAAAC,EAAS,KAAAC,EAAO,OAAQ,KAAAC,EAAM,UAAAC,EAAY,OAAQ,GAAGC,CAAA,EAAQC,IAAQ,CACvG,KAAM,CAACC,EAAcC,CAAe,EAAIC,EAAAA,SAAiB,CAAC,EAG1DC,EAAAA,oBAAoBJ,EAAK,KAAO,CAC9B,MAAO,IAAME,EAAgB,CAAC,CAAA,EAC9B,EAIF,MAAMG,EAAQC,EAAY,IAAM,CAC9BJ,EAAgBK,GAAQ,CACtB,MAAMC,EAAWD,EAAO,EACxB,OAAIC,GAAYhB,GACdG,EAAA,EACO,GAEFa,CACT,CAAC,CACH,EAAG,GAAI,EAEPC,OAAAA,EAAAA,UAAU,IACD,IAAM,CACXJ,EAAA,CACF,EACC,CAAA,CAAE,oBAIA,SAAAR,EACCa,EAAAA,IAACC,EAAA,CACC,EAAE,MACF,OAAO,UACP,QAASC,GAAK,CACZC,EAAaD,CAAC,EACdV,EAAgB,CAAC,EACjBP,EAAA,CACF,EAEA,SAAAe,EAAAA,IAACI,EAAA,CACC,IAAArB,EACA,IAAAC,EACA,MAAOO,EACP,KAAAL,EACA,MAAM,iBACN,WAAW,8BACX,UAAAE,CAAA,CAAA,CACF,CAAA,EAGFiB,EAAAA,KAACC,EAAA,CAAQ,OAAM,GAAC,QAAQ,QAAQ,UAAW,GAAO,mBAAoB,GAAO,OAAQ,EACnF,SAAA,CAAAN,MAACO,EAAA,CACC,SAAAP,EAAAA,IAACC,EAAA,CACC,EAAE,OACF,EAAE,OACF,OAAO,YACP,YAAY,SACZ,aAAa,MACb,GAAG,eACH,OAAO,UACN,GAAGZ,EACJ,QAAS,IAAM,CACbG,EAAgB,CAAC,EACjBP,EAAA,CACF,EAEA,SAAAe,EAAAA,IAACI,EAAA,CACC,IAAArB,EACA,IAAAC,EACA,MAAOF,GAAoB,EAAI,EAAIS,EACnC,KAAAL,EACA,MAAM,iBACN,WAAW,6BAAA,CAAA,CACb,CAAA,EAEJ,EACAc,EAAAA,IAACQ,GACC,SAAAH,EAAAA,KAACI,EAAA,CAAY,EAAE,OAAO,WAAW,OAAO,SAAS,OAAO,SAAA,CAAA,mBACrC3B,EAAiB,6CAAA,CAAA,CACpC,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CAEJ,CAEJ,CACF"}