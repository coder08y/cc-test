import{u as E}from"./index-GwPPDvta.js";import{u as F}from"./index-9vefoQ6F.js";import{u as q,d as Y}from"./useWrapPoolData-CzWcfmSl.js";import{l as I,r as V,j as m}from"./vendor-CBmAETR3.js";import{bw as P,n as O,bx as z,by as G,bz as R,bA as J,z as X,bB as L}from"./index-ihcskjKt.js";import"./cross-CbhIs7DK.js";import{p as N,C as Z,E as K}from"./EmptyTooltip-t2-GI6nt.js";import{R as Q,X as _,Y as $}from"./YAxis-1VNgHXtM.js";import{B as tt}from"./BarChart-BYOCkToA.js";import{T as et,B as at}from"./generateCategoricalChart-DzovH4HE.js";function st(t){if(!t)return!1;try{const i=new Date,D=new Date(t),r=e=>{const s=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),p=String(e.getDate()).padStart(2,"0");return`${s}-${n}-${p}`},o=r(i),a=r(D);if(o===a){const e=new Date(i);return e.setHours(23,59,59,999),i<e}return!1}catch(i){return console.warn("Date parsing error:",i),!1}}function At(){const t=I(),{setApiPoolInfo:i}=E(),{setDlmmApiPoolInfo:D}=F(),{wrapPoolData:r,wrapDLmmPoolData:o}=q();return{goLiquidity:(s,n)=>{i(r(n)),t(s)},goDlmmLiquidity:(s,n)=>{D(o(n)),t(s)}}}var h=(t=>(t[t.Jan=1]="Jan",t[t.Feb=2]="Feb",t[t.Mar=3]="Mar",t[t.Apr=4]="Apr",t[t.May=5]="May",t[t.Jun=6]="Jun",t[t.Jul=7]="Jul",t[t.Aug=8]="Aug",t[t.Sep=9]="Sep",t[t.Oct=10]="Oct",t[t.Nov=11]="Nov",t[t.Dec=12]="Dec",t))(h||{});function Tt(){const[t,i]=V.useState("");return{time:t,getCurrentTime:()=>{const o=P(Date.parse(new Date().toUTCString()),"YMD")||"",a=o.slice(5,7),e=h[Number(a)],s=o.slice(8,10),n=e,p=o.slice(0,4),c=n+" "+s+", "+p+" (UTC)";i(c)},getHoverTime:(o,a)=>{const e=Date.parse(o),s=new Date(e);s.setDate(s.getDate()+7);const n=new Date(e);n.setDate(n.getDate()+31);const p=s.toUTCString(),c=n.toUTCString(),u=P(Date.parse(c),"YMD")||"",y=P(Date.parse(new Date().toUTCString()),"YMD")||"",A=Date.parse(p)>Date.parse(new Date().toUTCString())?P(Date.parse(new Date().toUTCString()),"YMD")||"":P(Date.parse(p),"YMD")||"",v=y.slice(5,7),S=h[Number(v)],g=y.slice(8,10),d=S,H=y.slice(0,4),w=o.slice(5,7),l=h[Number(w)],T=o.slice(8,10),x=l,f=o.slice(0,4),C=A.slice(5,7),k=h[Number(C)],b=A.slice(8,10),j=k,W=A.slice(0,4),B=Number(w)==12?h[1]:h[Number(w)+1],U=u.slice(0,4);let M;a=="D"?M=x+" "+T+", "+f+" (UTC)":a=="W"?M=T+" "+x+"-"+b+" "+j+" , "+W+" (UTC)":M=Date.parse(c)>=Date.parse(new Date().toUTCString())?x+" 01-"+d+" "+g+", "+H+" (UTC)":x+" 01-"+B+" 01, "+U+" (UTC)",i(M)}}}function ht(){const{fetchByApi:t}=O();return{getHistogramData:async o=>{const{type:a,date_type:e="day",limit:s,address:n="all"}=o;console.log("ðŸš€ ~ getHistogramData ~ limit:",a,e,s);const p=n=="all"&&a=="vol",u={day:"day",wek:"week",mon:"month"}[e],y=Date.now(),g=s?e=="day"?s*86400:e=="wek"?s*604800:s*2592e3:void 0,d=g?String(Math.floor(y/1e3-g)):0,w=N(p?{dataType:a,dateType:u,beginTimestamp:d}:{dataType:a,dateType:u,address:n,beginTimestamp:d},L),T=await t(p?z:G,"GET",w);console.log("ðŸš€ ~ getHistogramData response:",T);const f=[...((T==null?void 0:T.list)||[]).map(C=>{const k=new Date(C.timestamp*1e3).toISOString().split(".")[0]+"Z",b=Number(k.slice(5,7)),j=h[b];return{num:Number(C.value),date:k,xAxis:e==="mon"?j:Y(k)}})].reverse();return console.log("ðŸš€ ~ getHistogramData ~ isPureTvl:",f),f},getDlmmHistogramData:async o=>{const{type:a,date_type:e="day",limit:s,address:n="all"}=o;console.log("ðŸš€ ~ getHistogramData ~ limit:",a,e,s);const p=n=="all"&&a=="vol",u={day:"day",wek:"week",mon:"month"}[e],y=Date.now(),g=s?e=="day"?s*86400:e=="wek"?s*604800:s*2592e3:void 0,d=g?String(Math.floor(y/1e3-g)):0,w=N(p?{dataType:a,dateType:u,beginTimestamp:d}:{dataType:a,dateType:u,address:n,beginTimestamp:d},L),l=await t(R,"GET",w);console.log("ðŸš€ ~ getHistogramData response:",l);const x=[...((l==null?void 0:l.list)||[]).map(f=>{const C=new Date(f.timestamp*1e3).toISOString().split(".")[0]+"Z",k=Number(C.slice(5,7)),b=h[k];return{num:Number(f.value),date:C,xAxis:e==="mon"?b:Y(C)}})].reverse();return console.log("ðŸš€ ~ getHistogramData ~ isPureTvl:",x),x},getAllTvData:async o=>{const{date_type:a="day",limit:e}=o,n={day:"day",wek:"week",mon:"month"}[a],p=Date.now(),A=e?a=="day"?e*86400:a=="wek"?e*604800:e*2592e3:void 0,v=A?String(Math.floor(p/1e3-A)):0,g=N({dateType:n,beginTimestamp:v,endTimestamp:p},L),d=await t(J,"GET",g);console.log("ðŸš€ ~ getHistogramData response:",d);const w=[...((d==null?void 0:d.list)||[]).map(l=>{const T=new Date(l.timestamp*1e3).toISOString().split(".")[0]+"Z",x=Number(T.slice(5,7)),f=h[x];return{clmm:Number(l.clmm),dlmm:Number(l==null?void 0:l.dlmm),total:X((l==null?void 0:l.clmm)??0).plus((l==null?void 0:l.dlmm)??0).toNumber(),date:T,xAxis:a==="mon"?f:Y(T)}})].reverse();return console.log("ðŸš€ ~ getHistogramData ~ isPureTvl:",w),w}}}const ot=({payload:t,fill:i="#75C8FF",x:D=0,y:r=0,width:o=0,height:a=0,isCurrentDay:e=!1,isIncomplete:s=!1})=>!e||!s?m.jsx("rect",{x:D,y:r,width:o,height:a,fill:i,rx:"2",ry:"2"}):m.jsxs("g",{children:[m.jsx("defs",{children:m.jsxs("pattern",{id:"diagonalHatch",patternUnits:"userSpaceOnUse",width:"20",height:"20",children:[m.jsx("rect",{width:"20",height:"20",fill:i}),m.jsx("image",{width:"20",height:"20",opacity:"0.8",href:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAB4AgMAAABECt5BAAAADFBMVEUAAAAAAAAAAAAAAAA16TeWAAAAA3RSTlMAgH8BTzA4AAAAYElEQVR4Xu3SsQ3AIBTEUIuWYViBzVkhw6RFF/0B/vWRrnHr5qHNVBsuLLXhhaM2PAypDXYt7Ppi1hWzrtj1/u8aux7Y9cSuF3Z9sGvFWiXWYi3WYi3WYi3WYi3WYi3WPhVhAWJ8v+OTAAAAAElFTkSuQmCC"})]})}),m.jsx("rect",{x:D,y:r,width:o,height:a,fill:"url(#diagonalHatch)",rx:"2",ry:"2"})]}),wt=({data:t,onChangeValue:i,noXAxis:D,pageFrom:r="stats"})=>{const[o,a]=V.useState(""),e=c=>{if(c&&c.activePayload&&c.activePayload.length){const u=c.activePayload[0].payload.date;i(c.activePayload[0].payload);const y=u.slice(5,7),A=h[Number(y)],v=u.slice(8,10),S=A,g=u.slice(0,4);a(v+" "+S+" "+g)}},s=()=>{i(null)};(t==null?void 0:t.length)>0&&Math.floor(Math.min(...t.map(c=>c.num)));const n=Math.ceil(Math.max(...t.map(c=>c.num))),p=c=>{const{payload:u,fill:y,x:A,y:v,width:S,height:g}=c,d=st(u==null?void 0:u.date);return m.jsx(ot,{payload:u,fill:y,x:A,y:v,width:S,height:g,isCurrentDay:d,isIncomplete:d})};return m.jsx(Q,{width:"100%",height:"100%",children:m.jsxs(tt,{barCategoryGap:"24%",data:t,onMouseMove:e,onMouseLeave:s,maxBarSize:24,children:[!D&&m.jsx(_,{type:"category",dataKey:"xAxis",minTickGap:18,tickLine:!1,axisLine:!1,tick:m.jsx(Z,{})}),n&&m.jsx($,{domain:[0,n*1.05],hide:!0,axisLine:!1,tickLine:!1}),m.jsx(et,{content:m.jsx(K,{value:r!=="stats"?o:""}),cursor:m.jsx(nt,{})}),m.jsx(at,{dataKey:"num",fill:"#75C8FF",isAnimationActive:!1,shape:p})]})})};function nt(t){var s,n;const{x:i,y:D,width:r,height:o,payload:a}=t;if(!a||!(a!=null&&a[0])||!((n=(s=a==null?void 0:a[0])==null?void 0:s.payload)!=null&&n.num))return;const e=r>192?r/2:r>96?r/2.5:r>48?r/3:r>24?r/4:r/8;return m.jsx("g",{children:m.jsx("rect",{width:r-e,height:o,x:i+e/2,fill:"rgba(118,200,255,0.5)",y:D+1})})}export{wt as V,Tt as a,At as b,ht as u};
//# sourceMappingURL=VolumeChart-BMeNPMyu.js.map
