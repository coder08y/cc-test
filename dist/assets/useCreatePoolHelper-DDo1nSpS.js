import{u as O}from"./usePosAdd-DG3IUn6t.js";import{M as $}from"./msafe-BzcjPV-e.js";import{g as G,a as z}from"./dlmm-DdxfaipV.js";import{g as L}from"./utils-CMHkC_9A.js";import{c as S,d as w}from"./config-DTm0VBgZ.js";import{f as H,g as C,d as f,P as N,h as E,m as R}from"./index-BpSfzecM.js";import{T as U}from"./cross-DJ28FxNa.js";import{r as b}from"./vendor-CBmAETR3.js";import{u as X}from"./useGetDlmmPoolList-DgjXNLvP.js";import{u as Z}from"./useGetPoolList-4kFQ2tyG.js";import{u as j}from"./useWrapPoolData-CMGMCXwG.js";function le(){const l=H("clmm"),r=H("dlmm"),{preAdd:s}=O(),{getPoolList:d}=Z(),{getDlmmPoolList:y}=X(),{wrapDLmmPoolData:h}=j();return{preAddPool:c=>{const{tickSpacing:n,price:p,minPrice:a,maxPrice:u,amount:m,amountCoinType:i,realTokenA:t,realTokenB:e,needReverse:o}=c,P=C.priceToSqrtPriceX64(f(p),t.decimals,e.decimals).toString(),v=C.priceToTickIndex(f(p),t.decimals,e.decimals).toString(),_=t.decimals,g=e.decimals;let T,A;if(a==="0"&&u==="âˆž")T=R.getMinIndex(n),A=R.getMaxIndex(n);else{const F=o?L(u):a,k=o?L(a):u,q=C.priceToTickIndex(f(F),t.decimals,e.decimals).toString();console.log("ðŸš€ ~ file: useCreatePoolHelper.ts:103 ~ useCreatePoolHelper ~ realMintTick:",q),T=N(C.priceToTickIndex(f(F),_,g),n),A=N(C.priceToTickIndex(f(k),_,g),n)}console.log("ðŸš€ ~ file: useCreatePoolHelper.ts:87 ~ useCreatePoolHelper ~ params:",{...c,currentSqrtPrice:P,lowerTick:T,upperTick:A,currTick:v});const M=i===(t==null?void 0:t.coin_type),W=E(m,M?_:g).toString(),D=s({amount:W,tokenA:t,tokenB:e,isTokenA:M,lowerTick:T,upperTick:A,curSqrtPrice:P,isReverse:o,roundUp:!0});return console.log("ðŸš€ -----------------------------------------------------------------------ðŸš€"),console.log("ðŸš€ ~ file: useCreatePoolHelper.ts:128 ~ useCreatePoolHelper ~ res:",D),console.log("ðŸš€ -----------------------------------------------------------------------ðŸš€"),{...D,currentSqrtPrice:P,fixAmountA:M,lowerTick:T,upperTick:A,tickSpacing:n,coinTypeA:t.coin_type,coinTypeB:e.coin_type}},fetchFeeTierList:async(c,n)=>{var p;try{if(c&&n){const a=await d({coin_type:`${c},${n}`,is_vaults:!1,display_all_pools:!0,has_mining:!0,has_farming:!0,no_incentives:!0,order_by:"-vol",offset:0});if(a&&a.list&&a.list.length>0){const u=G(a.list),m=(p=S)==null?void 0:p.map(t=>{const e=u.find(o=>o.feeRate===t.feeRate);return{...t,title:(e==null?void 0:e.title)||t.title,poolAddress:e==null?void 0:e.poolAddress,liquidity:e==null?void 0:e.liquidity,tvl:e==null?void 0:e.tvl}}),i=m.findIndex(t=>t.feeDisplay==="0.001%"&&!t.poolAddress);return m.filter((t,e)=>Number(e)!==i)}else return S.filter(u=>u.feeDisplay!=="0.001%")}}catch(a){console.log("ðŸš€ ~ fetchFeeTierList ~ fetchFeeTierList:",a)}return[...S]},getCreatePoolTxPayload:async c=>{console.log("ðŸš€ ~ file: useCreatePoolHelper.ts:140 ~ getCreatePoolTxPayload ~ params:",c);const{tickSpacing:n,currentSqrtPrice:p,fixAmountA:a,coinAmountAOrigin:u,coinAmountBOrigin:m,lowerTick:i,upperTick:t,coinTypeA:e,coinTypeB:o}=c;await l.FullClient.fetchCoinMetadataId(e),await l.FullClient.fetchCoinMetadataId(o);const P={tick_spacing:n,initialize_sqrt_price:p,uri:"",fix_amount_a:a,amount_a:u,amount_b:m,tick_lower:i,tick_upper:t,coin_type_a:e,coin_type_b:o};return{tx:await l.Pool.createPoolPayload(P),msafeParams:{action:$.CreatePool,txbParams:P}}},getBinStepConfigs:async(c,n)=>{var p,a,u,m;try{if(c&&n){const i=await y({coin_type:`${c},${n}`,is_vaults:!1,display_all_pools:!0,has_mining:!0,has_farming:!0,no_incentives:!0,order_by:"-vol",offset:0});if(i&&i.list&&i.list.length>0){const t=(u=(a=(p=i==null?void 0:i.list)==null?void 0:p[0])==null?void 0:a.pools)==null?void 0:u.map(o=>h(o)),e=z(t);return(m=w)==null?void 0:m.map(o=>{var v,_;const P=((v=e==null?void 0:e.find(g=>g.fee+""===o.fee))==null?void 0:v.title)||o.title;return{...o,title:P,poolAddress:(_=e==null?void 0:e.find(g=>g.fee+""===o.fee))==null?void 0:_.poolAddress}})}else return w}}catch{return w}return w},getCreateDLMMPoolTxPayload:async c=>{console.log("ðŸš€ ~ file: useCreatePoolHelper.ts:140 ~ getCreatePoolTxPayload ~ params:",c);const{active_id:n,lower_bin_id:p,upper_bin_id:a,bin_step:u,bin_infos:m,tokenA:i,tokenB:t,base_factor:e}=c,o=new U;return{pool_id:await(r==null?void 0:r.Pool.createPoolPayload({active_id:n,bin_step:u,coin_type_a:i==null?void 0:i.coin_type,coin_type_b:t==null?void 0:t.coin_type,base_factor:e},o)),tx:o}}}}function ce(l,r,s,d){const y=b.useMemo(()=>{if(l)return!1;try{if(r!==void 0&&s!==void 0&&d!==void 0)return f(r).lt(s)||f(r).gt(d)}catch{}return!1},[d,r,s,l]),h=b.useMemo(()=>{if(l)return!1;try{if(s!==void 0&&d!==void 0)return f(s).gt(d)}catch{}return!1},[d,s,l]);return{showInputPriceWarn:y,showPriceRangeWarn:h}}function ue(l,r,s){const d=b.useMemo(()=>{try{if(l!==void 0&&r!==void 0&&s!==void 0&&Number.isFinite(r)&&Number.isFinite(s)&&Number.isFinite(l))return f(l).lt(r)||f(l).gt(s)}catch{}return!1},[l,r,s]),y=b.useMemo(()=>{try{if(r!==void 0&&s!==void 0&&Number.isFinite(r)&&Number.isFinite(s))return f(r).gt(s)}catch{}return!1},[r,s]);return{showInputPriceWarn:d,showPriceRangeWarn:y}}export{ue as a,ce as b,le as u};
