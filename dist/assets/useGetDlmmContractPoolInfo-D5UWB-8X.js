import{n as P,aD as C,j as T,ag as A,f as h,e as I,d as w,aE as v,aF as S}from"./index-BpSfzecM.js";import{f as $,w as b,b as k}from"./utils-CMHkC_9A.js";import"./vendor-CBmAETR3.js";import"./cross-DJ28FxNa.js";import{u as F}from"./useGetDlmmPoolList-DgjXNLvP.js";import{u as G}from"./useWrapPoolData-CMGMCXwG.js";import{u as R}from"./index-C7OfScvw.js";import{u as j}from"./addDlmmLiquidity-BTnvpcHs.js";function W(){const{fetchByApi:f}=P(),{wrapDLmmPoolData:u}=G(),{getLocalJsonPoolList:m}=F(),d=async a=>{var c,r,t,e;const i={...a},n=$(a==null?void 0:a.coin_type);n&&(i.coin_type=n);const l=b(i);try{console.log("ðŸš€ðŸš€ðŸš€ ~ getDlmmPools.ts:89 ~ getDlmmPools ~ warapApiParams:",l);const o=await f(C,"POST",l);if(console.log("ðŸš€ðŸš€ðŸš€ ~ getDlmmPools.ts:41 ~ getDlmmPools ~ res:",o),(c=o==null?void 0:o.data)!=null&&c.list){const s=(t=(r=o==null?void 0:o.data)==null?void 0:r.list)==null?void 0:t.map(g=>u(g));return console.log("ðŸš€ ~ file: getDlmmPools.ts:42 ~ poolList ~ poolList:",s),{list:s,total:(e=o==null?void 0:o.data)==null?void 0:e.total}}}catch(o){console.log("ðŸš€ ~ useGetPoolList ~ error:",o);const s=await m(l,!1);return console.log("ðŸš€ ~ useGetDlmmPools ~ res:",s),s}return{list:[],total:0}},p=a=>A(a)==="0x2::sui::SUI"?"0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI":A(a);return{getDlmmPools:d,getLocalJsonPoolList:m,getLocalJsonPoolAddress:async(a,i)=>{try{const n=p(a),l=p(i),c=T.env==="testnet"?"/data/all-pools-testnet.json":"/data/all-pools.json",r=await fetch(c).then(t=>t.json());if(r){const t=r[`${n.toLocaleLowerCase()}-${l.toLocaleLowerCase()}`]||r[`${l.toLocaleLowerCase()}-${n.toLocaleLowerCase()}`];return console.log("ðŸš€ --------------------------------------------------ðŸš€"),console.log("ðŸš€ ~ getLocalJsonPoolAddress ~ poolList:",t,`${n.toLocaleLowerCase()}-${l.toLocaleLowerCase()}`,`${l.toLocaleLowerCase()}-${n.toLocaleLowerCase()}`),console.log("ðŸš€ --------------------------------------------------ðŸš€"),t}}catch(n){console.error("getLocalJsonPoolAddress Error:",n)}return[]}}}function z(){const f=h("dlmm"),{fetchTokenInfo:u}=I(),{dlmmContractPoolInfo:m,setDlmmContractPoolInfo:d,setDlmmContractPoolInfoLoading:p,dlmmApiPoolInfo:L,setDlmmApiPoolInfo:a,setDlmmApiPoolInfoLoading:i}=R(),{setFromToken:n,setToToken:l}=j(),c=async t=>{p(!0);let e=null;if(f)try{const o=await f.Pool.getPool(t);if(e={...o,...S(o),poolAddress:o==null?void 0:o.id},(L==null?void 0:L.displayTokenA)===void 0){const s=await r(e);s&&(a(s),i(!1),n(s==null?void 0:s.displayTokenA),l(s==null?void 0:s.displayTokenB))}}catch(o){console.error("getDlmmContractPoolInfo error:",o)}finally{p(!1),i(!1)}return m?e?(d(e),e):m:(d(e||null),e)};async function r(t){const e=await u(t.coinTypeA),o=await u(t.coinTypeB);if(e&&o){const s=`${e==null?void 0:e.symbol} - ${o==null?void 0:o.symbol}`,g=w(t==null?void 0:t.baseFeeRate).div(v).toString(),D=w(g).mul(100).toString()+"%",y=!k(t.coinTypeA,t.coinTypeB);return{...t,poolAddress:t.poolAddress,name:s,isReverse:y,tokenA:e,tokenB:o,displayTokenA:y?o:e,displayTokenB:y?e:o,haveMining:!1,miningRewardList:null,miningAprList:null,haveFarming:!1,farmsRewarderList:null,farmsApr:"",farmingAprDisplay:"",feeApr:"",feeAprDisplay:"",miningAprTotal:"",feeAndMiningAprDisplay:"",totalAprDisplay:"",baseFee:g,baseFeeRate:t==null?void 0:t.baseFeeRate,feeDisplay:D,baseFeeDisplay:D,tvlDisplay:"0",volume24Display:"0",fees24Display:"0",isVaults:!1}}}return{getDlmmContractPoolInfo:c,formatDlmmApiPoolByContractPool:r}}export{z as a,W as u};
