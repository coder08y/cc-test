import{u as q}from"./index-GwPPDvta.js";import{i as C,d as m,aq as G,V as $,ar as j,j as z}from"./index-ihcskjKt.js";import"./cross-CbhIs7DK.js";import{r as A}from"./vendor-CBmAETR3.js";const Q=(n,i)=>({tokenAPrice:void 0,setTokenAPrice:s=>{n(()=>({tokenAPrice:s}))},tokenBPrice:void 0,setTokenBPrice:s=>{n(()=>({tokenBPrice:s}))},tokenAAmount:"",setTokenAAmount:s=>{n(()=>({tokenAAmount:m(s).lt(0)?"0":s}))},tokenBAmount:"",setTokenBAmount:s=>{n(()=>({tokenBAmount:m(s).lt(0)?"0":s}))},tokenAAmountUSD:"",setTokenAAmountUSD:s=>{n(()=>({tokenAAmountUSD:s}))},tokenBAmountUSD:"",setTokenBAmountUSD:s=>{n(()=>({tokenBAmountUSD:s}))},totalAmountUSD:"",setTotalAmountUSD:s=>{n(()=>({totalAmountUSD:s}))},tvlLoading:!0,setTvlLoading:s=>{n(()=>({tvlLoading:s}))},resetTvlInfo:()=>{n(()=>({tokenAPrice:void 0,tokenBPrice:void 0,tokenAAmount:"",tokenBAmount:"",tokenAAmountUSD:"",tokenBAmountUSD:"",totalAmountUSD:""}))}}),V=C(Q),E=(n,i,s)=>n&&i&&s?m(n).mul(i).div(m(10).pow(s)).toString():"--";function O(){var a,b;const{tokenAPrice:n,setTokenAPrice:i,tokenBPrice:s,setTokenBPrice:N,tokenAAmount:o,setTokenAAmount:h,tokenBAmount:_,setTokenBAmount:L,tokenAAmountUSD:k,setTokenAAmountUSD:f,tokenBAmountUSD:c,setTokenBAmountUSD:w,totalAmountUSD:x,setTotalAmountUSD:T,resetTvlInfo:g,tvlLoading:R,setTvlLoading:v}=V(),{apiPoolInfo:e,contractPoolInfo:t}=q(),y=async B=>{var d,S;try{const r=(d=$(B))==null?void 0:d.full_address,u=r=="0x2::sui::SUI"?"0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI":r,{prices:D}=await j(`${(S=z)==null?void 0:S.cetus_api}/v3/sui/market_price?base_symbol_address=${u}`);return D==null?void 0:D[0]}catch(r){return console.log("ðŸš€ðŸš€ðŸš€ ~ file: useRate.ts:31 ~ getAmountPrice ~ error:",r),"--"}},{poolAddress:U}=G(),l=async()=>{var B,d,S,r;v(!0);try{if((B=e==null?void 0:e.tokenA)!=null&&B.coin_type){const u=await y((d=e==null?void 0:e.tokenA)==null?void 0:d.coin_type);u&&i(u)}if((S=e==null?void 0:e.tokenB)!=null&&S.coin_type){const u=await y((r=e==null?void 0:e.tokenB)==null?void 0:r.coin_type);u&&N(u)}}catch(u){console.log("ðŸš€ ~ PoolInfo ~ handleRefresh:",u)}finally{v(!1)}};return A.useEffect(()=>{g()},[U]),A.useEffect(()=>()=>{g()},[]),A.useEffect(()=>{l()},[e==null?void 0:e.tvl,(a=e==null?void 0:e.tokenA)==null?void 0:a.coin_type,(b=e==null?void 0:e.tokenB)==null?void 0:b.coin_type]),A.useEffect(()=>{t!=null&&t.coinAmountA&&h(m(t==null?void 0:t.coinAmountA).sub((t==null?void 0:t.fee_protocol_coin_a)||"0").toString())},[t==null?void 0:t.coinAmountA,t==null?void 0:t.fee_protocol_coin_a,U]),A.useEffect(()=>{t!=null&&t.coinAmountB&&L(m(t==null?void 0:t.coinAmountB).sub((t==null?void 0:t.fee_protocol_coin_b)||"0").toString())},[t==null?void 0:t.coinAmountB,t==null?void 0:t.fee_protocol_coin_b,U]),A.useEffect(()=>{o&&(n!=null&&n.price)&&(e!=null&&e.tokenA.decimals)&&!Number.isNaN(Number(e==null?void 0:e.tokenA.decimals))&&f(E(o,n==null?void 0:n.price,e==null?void 0:e.tokenA.decimals))},[o,n]),A.useEffect(()=>{_&&(s!=null&&s.price)&&(e!=null&&e.tokenB.decimals)&&!Number.isNaN(Number(e==null?void 0:e.tokenB.decimals))&&w(E(_,s==null?void 0:s.price,e==null?void 0:e.tokenB.decimals))},[_,s]),A.useEffect(()=>{T((k||c)&&k!=="--"&&c!=="--"?m(k||0).plus(c||0).toString():"--")},[k,c]),{tokenAPrice:n,tokenBPrice:s,tokenAAmount:o,tokenBAmount:_,tokenAAmountUSD:k,tokenBAmountUSD:c,totalAmountUSD:x,setTotalAmountUSD:T,tvlLoading:R}}export{V as a,O as u};
//# sourceMappingURL=useGetTvlInfo-DD8PUvH9.js.map
