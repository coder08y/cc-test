var Te=Object.defineProperty;var Ie=(o,i,x)=>i in o?Te(o,i,{enumerable:!0,configurable:!0,writable:!0,value:x}):o[i]=x;var N=(o,i,x)=>Ie(o,typeof i!="symbol"?i+"":i,x);import{r as n,j as e,V as z,ac as Re,P as Ee,x as Pe,C as Q,y as We,A as Me,B as te,H as I,T as W,l as ve,ao as $e,n as se,Y as fe,m as Fe}from"./vendor-CBmAETR3.js";import{E as He,C as Se}from"./charting_library.esm-BuRCvzzK.js";import{u as V}from"./index-9yHNdYxH.js";import{Z as Y,d as re,bl as be,aj as Le,v as Be,ah as q,cN as me,Y as Z,aV as Ne,u as oe,x as _e,aT as Oe,A as le,I as k,w as ue,y as ze,C as G,t as ke,D as pe,B as de,a as Ge,bo as Ve}from"./index-Lo8eQgA0.js";import{a as P,u as Ae,t as ne}from"./CarouselBlock-BQy99RwQ.js";import{v as Ke}from"./v4-C6aID195.js";import"./cross-J9VCREIf.js";import{u as Ue}from"./useProData-C_Hyt5cN.js";import{R as Ze}from"./RefreshButton-BEUAg1WA.js";import{N as Je}from"./NoData-BFX9XpKb.js";import{S as Ye}from"./SearchInput-Ci9E2gMO.js";import{F as Qe}from"./FilterTable-DLAlxMD_.js";import{u as Xe}from"./useTokenRank-CM-9-tXe.js";let w=null,J=new Map,ee="disconnected",ae=!1,F=null,ie=new Map;const qe=o=>{const[i,x]=n.useState(ee),[l,t]=n.useState(0),g=n.useRef(new Map),d=n.useRef(o);d.current=o;const S=n.useRef(0),a=n.useCallback(c=>{ee=c,x(c)},[]),h=n.useCallback(c=>{try{const s=JSON.parse(c.data),m=J.get(s.type);m&&m.forEach(C=>C(s.data));const v=g.current.get(s.type);v&&v.forEach(C=>C(s.data))}catch(s){console.error("Error parsing WebSocket message:",s)}},[]),r=n.useCallback((c,s)=>w&&w.readyState===WebSocket.OPEN?(w.send(JSON.stringify({action:c,data:s})),!0):!1,[]),p=n.useCallback(()=>{var s;if(ae=!1,w){if(w.readyState===WebSocket.OPEN){a("connected");return}if(w.readyState===WebSocket.CONNECTING){a("connecting");return}}const c=((s=d.current)==null?void 0:s.url)||"wss://ws-api.suivision.xyz/ws";a("connecting"),w=new WebSocket(c),w.onopen=()=>{S.current=0,a("connected"),t(0),console.log("WebSocket connected"),ie.forEach((m,v)=>{r(v,m.data)})},w.onmessage=h,w.onclose=()=>{var m,v;if(a("disconnected"),console.log("WebSocket disconnected"),!ae&&document.visibilityState==="visible"){const C=(m=d.current)==null?void 0:m.maxReconnectAttempts;if(C===void 0||S.current<C){const M=((v=d.current)==null?void 0:v.reconnectInterval)||5e3;setTimeout(()=>{S.current+=1,t($=>$+1),p()},M)}}},w.onerror=m=>{a("error"),console.error("WebSocket error:",m)}},[h,r,a]),y=n.useCallback(()=>{ae=!0,w&&(a("disconnecting"),w.close(),w=null,a("disconnected"))},[a]),u=n.useCallback(()=>{var s;const c=((s=d.current)==null?void 0:s.visibilityDisconnectDelay)||5e3;document.visibilityState==="hidden"?(F&&clearTimeout(F),F=setTimeout(()=>{w&&w.readyState===WebSocket.OPEN&&y()},c)):(F&&(clearTimeout(F),F=null),(!w||w.readyState===WebSocket.CLOSED)&&p())},[p,y]),b=n.useCallback((c,s)=>{var m,v;return J.has(c)||J.set(c,new Set),(m=J.get(c))==null||m.add(s),g.current.has(c)||g.current.set(c,new Set),(v=g.current.get(c))==null||v.add(s),()=>{var C,R;(C=J.get(c))==null||C.delete(s),(R=g.current.get(c))==null||R.delete(s)}},[]),_=n.useCallback((c,s,{isSubscription:m=!1}={})=>{const v=r(c,s);return m&&v&&ie.set(c,{action:c,data:s}),v},[r]),D=n.useCallback(c=>{ie.delete(c),r(`unsubscribe.${c}`)},[r]);return n.useEffect(()=>{var c;return x(ee),(c=d.current)!=null&&c.autoConnect&&ee==="disconnected"&&p(),document.addEventListener("visibilitychange",u),()=>{g.current.clear(),document.removeEventListener("visibilitychange",u),F&&clearTimeout(F)}},[p,u]),{state:i,isConnected:i==="connected",reconnectCount:l,connect:p,disconnect:y,subscribe:b,send:_,unsubscribe:D,getSocket:()=>w}},et="https://api-sui-cf.cetus.zone/proxy";let ce=null;function tt(){const{setCoinBvPrice:o,proTransactionList:i}=V(),x=n.useRef(),l=n.useRef(),{subscribe:t,send:g}=qe(),d=async({poolId:h,resolution:r,from:p,to:y,firstDataRequest:u,callback:b,onErrorCallback:_})=>{console.log("useGetPriceKlineData ðŸš€ ~ getHistoricalData ~ params poolId:",h),console.log("useGetPriceKlineData ðŸš€ ~ getHistoricalData ~ params resolution:",r),console.log("useGetPriceKlineData ðŸš€ ~ getHistoricalData ~ params from:",p),console.log("useGetPriceKlineData ðŸš€ ~ getHistoricalData ~ params to:",y),x.current&&x.current!==h&&g("UNSUBSCRIBE_OHLCV"),x.current=h;const D=Ke();ce=D;const c=`0x${Y(h)}`;let s=p;if(u)r==="30s"||r==="1m"?s=Math.max(p,P(4)):r==="5m"?s=Math.max(p,P(24)):r==="15m"?s=Math.max(p,P(168)):(r==="1h"||r==="4h")&&(s=Math.max(p,P(720)));else if((r==="30s"||r==="1m")&&p<P(4)&&!u){b([],{noData:!0});return}else if(r==="5m"&&p<P(24)&&!u){b([],{noData:!0});return}else if(r==="15m"&&p<P(168)&&!u){b([],{noData:!0});return}else if((r==="1h"||r==="4h")&&p<P(720)&&!u){b([],{noData:!0});return}else if(r==="1d"&&p<P(7200)&&!u){b([],{noData:!0});return}else if(r==="1w"&&p<P(50400)&&!u){b([],{noData:!0});return}else if(r==="1M"&&p<P(216e3)&&!u){b([],{noData:!0});return}if(s<0){b([],{noData:!0});return}const m=`${et}/api/v1/coin/ohlcv?token=${c}&interval=${r}&start=${s}`,v=async()=>{var R,M,$,A;try{const j=await(await fetch(m,{method:"GET",headers:{accept:"application/json"}})).json();if(console.log("ðŸš€ ~ fetchData ~ data:",j),(j==null?void 0:j.code)===500)throw new Error("Server Error: 500");if((j==null?void 0:j.code)===0&&((M=(R=j==null?void 0:j.data)==null?void 0:R.list)==null?void 0:M.length)===0)return null;const L=(A=($=j==null?void 0:j.result)==null?void 0:$.ohlcs)==null?void 0:A.map(E=>({time:re(E.timestamp).mul(1e3).toNumber(),high:Number(E.high),low:Number(E.low),open:Number(E.open),close:Number(E.close),volume:E.volume}));return console.log("bv ðŸš€ ~ getHistoricalData ~ result:",L),L||[]}catch(H){return console.error("bv ðŸš€ ~ fetchData Error:",H),ce!==D?(console.log("bv ðŸš€ ~ Request aborted due to poolId change."),[]):(console.log("Retrying in 5 seconds..."),await be(5e3),ce!==D?(console.log("bv ðŸš€ ~ Request aborted due to poolId change."),[]):await v())}},C=await v();C?b(C,{noData:!1}):b([],{noData:!0})},S=async(h,r)=>{g(h,r,{isSubscription:!0})||(await be(1e3),S(h,r))};return{getHistoricalData:d,subscribeKlineData:({poolId:h,resolution:r,callback:p})=>{l.current&&l.current(),l.current=t("OHLCV_DATA",u=>{var D,c;const b=(c=u==null?void 0:u.list)==null?void 0:c[((D=u==null?void 0:u.list)==null?void 0:D.length)-1];if(!b)return[];if(Y(h)!==Y(u==null?void 0:u.tokenId))return[];const _={time:re(b.timestamp).mul(1e3).toNumber(),high:Number(b.high),low:Number(b.low),open:Number(b.open),close:Number(b.close),volume:b.volume};_&&(p(_),o({coinType:u==null?void 0:u.tokenId,price:String(_==null?void 0:_.close)||""}))}),S("SUBSCRIBE_OHLCV",{tokenId:h,interval:r})},proTransactionList:i}}const ye={1:"1m",5:"5m",15:"15m",60:"1h",240:"4h","1D":"1d","1W":"1w","1M":"1M"},rt={1:60,5:300,15:900,60:3600,240:14400,"1D":86400,"1W":604800,"1M":2592e3};class ot{constructor(i,x,l,t,g,d){N(this,"poolId");N(this,"resolution");N(this,"onChangePrice");N(this,"getHistoricalData");N(this,"subscribeKlineData");N(this,"setTvMarksOnDataCallback");this.poolId=i,this.resolution=x,this.onChangePrice=g,this.getHistoricalData=l,this.subscribeKlineData=t,this.setTvMarksOnDataCallback=d}onReady(i){setTimeout(()=>{i({supported_resolutions:["1","5","15","60","240","D","W","M"],supports_time:!0,supports_marks:!0})},0)}resolveSymbol(i,x,l){console.log("ðŸš€ ~ DataFeed ~ resolveSymbol ~ symbolName:",i),console.log("ðŸš€ ~ DataFeed ~ resolveSymbol ~ symbolInfo:");const t=i.split("::"),g=t[0],d=Number(t[1])||2;console.log("ðŸš€ ~ DataFeed ~ resolveSymbol ~ unit:",d),setTimeout(()=>{x({name:g,ticker:g,type:"crypto",session:"24x7",timezone:"Etc/UTC",minmov:1,format:"price",pricescale:Math.pow(10,d),has_intraday:!0,has_empty_bars:!0,has_daily:!0,has_weekly_and_monthly:!0,supported_resolutions:["1","5","15","60","240","D","W","M"],volume_precision:2,supports_marks:!0})},0)}getMarks(i,x,l,t,g){console.log("Tradingview getMarks 0922 "),this.setTvMarksOnDataCallback&&this.setTvMarksOnDataCallback(t)}getBars(i,x,l,t,g){const{from:d,to:S,firstDataRequest:a}=l;console.log("ðŸš€ ~ DataFeed getBars ~ resolution111:",x,i),console.log("ðŸš€ ~ DataFeed getBars ~ periodParams:",l);const h=this.poolId;this.getHistoricalData({poolId:h,resolution:ye[x],from:d-rt[x]*5,to:S,callback:t,onErrorCallback:g,firstDataRequest:a})}subscribeBars(i,x,l,t,g){console.log("bv subscribeBar ðŸš€ ~ DataFeed ~ symbolInfo:",i),console.log("bv subscribeBar ðŸš€ ~ DataFeed ~ this poolId:",this.poolId);const d=this.poolId;this.subscribeKlineData({poolId:d,resolution:ye[x],callback:l})}unsubscribeBars(i){clearInterval(this[i])}}const st=({token:o,onChartReady:i,tokenPriceUnit:x,onChangePrice:l})=>{const t=n.useRef(null),g=n.useRef(null),d=n.useRef(!1),[S,a]=n.useState([]),[,h]=n.useState(!1),[r,p]=n.useState(""),{getHistoricalData:y,subscribeKlineData:u,proTransactionList:b}=tt(),_=n.useRef(null);n.useEffect(()=>{console.log("tv chart component Mounted"),d.current=!0},[]);const D=c=>{_.current=c};return n.useEffect(()=>{if(!t.current||!(o!=null&&o.coin_type)||!x)return;console.log("bv chart tokenPriceUnit: ",x),console.log("tv chart init useEffect isMounted.current: ",d.current),p(o==null?void 0:o.coin_type);const c={symbol:`${o==null?void 0:o.symbol}::${x}`,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,interval:"15",container:"tv_chart_container",datafeed:new ot(o==null?void 0:o.coin_type,"1",y,u,l,D),library_path:"/charting_library_new/",locale:"en",autosize:!0,theme:"dark",settings_overrides:{},overrides:{"paneProperties.backgroundGradientStartColor":"#0F0F0F","paneProperties.backgroundGradientEndColor":"#0F0F0F","paneProperties.background":"#0F0F0F","paneProperties.backgroundType":"solid","Overlay.barStyle.upColor":"#68FFD8","Overlay.barStyle.downColor":"#FF5073","mainSeriesProperties.priceLineWidth":1,"priceScale.precision":2,"priceScale.minMove":.01,"mainSeriesProperties.style":1},custom_css_url:"/css/tv-chart-dart.css",disabled_features:["header_symbol_search","header_compare","timeframes_toolbar"],enabled_features:["header_widget","chart_style_hilo_last_price","hide_left_toolbar_by_default","hide_resolution_in_legend","two_character_bar_marks_labels"],custom_formatters:{priceFormatterFactory:(m,v)=>(console.log("ðŸš€ ~ priceFormatterFactory ~ symbolInfo:",m),m?{format:(C,R)=>Z(C)}:null)},favorites:{intervals:["5","15"],indicators:["Awesome Oscillator","Bollinger Bands"],chartTypes:["Candles","Line"]}};console.log("ðŸš€ ~ useEffect ~ document.getElementById(tv_chart_container):",document.getElementById("tv_chart_container"));const s=new He(c);return console.log("ðŸš€ ~ useEffect ~ tvWidgetRef.current:",g.current),s.onChartReady(()=>{console.log("ðŸš€ ~ useEffect ~ tvWidget.onChartReady:"),h(!0),i==null||i(),s.chart(),g.current=s}),()=>{if(g.current){try{g.current.remove()}catch(m){console.error("Error removing TradingView widget:",m)}g.current=null,h(!1)}}},[o==null?void 0:o.coin_type,d.current,x]),n.useCallback(()=>{if(g.current)try{g.current.startFullscreen()}catch(c){console.error("Error toggling fullscreen:",c)}},[]),Le(()=>{if(_.current&&b.length>0&&o!=null&&o.coin_type){const c=b.filter(s=>Y(s.currentCoin.coin_type)===Y(o.coin_type)).map((s,m)=>{const v=Be(s.amount,s.currentCoin.decimals,!0),C=s==null?void 0:s.price,R=re(C).mul(v).toString(),M=s.currentCoin.symbol;return{id:`pro_mark_${m}`,time:Number(Ne(re(s.time).div(1e3).toNumber(),0)),color:s.type==="Buy"?"green":"red",text:s.type==="Buy"?`Bought ${v} ${M}($${q(Z(R,!0))}) at $${q(Z(C))} on ${me(s.time)}`:`Sold ${v} ${M}($${q(Z(R,!0))}) at $${q(Z(C))} on ${me(s.time)}`,label:s.type==="Buy"?"B":"S",textColor:"#fff",labelFontColor:"#fff",minSize:20}});_.current(c)}},[b,_.current,o==null?void 0:o.coin_type]),e.jsx(z,{children:e.jsx("div",{id:"tv_chart_container",ref:t,style:{width:"100%",height:"460px"}})})},nt=[{label:"Watchlist",value:"watchlist"},{label:"Trending",value:"trending"},{label:"Imported",value:"Imported"}];function at({children:o,selectCoin:i,whiteTokenList:x,onCoinSelect:l}){var he;oe();const t=n.useRef(null),g=n.useRef(null),{isOpen:d,onOpen:S,onClose:a}=Re(),[h,r]=n.useState("Trending"),[p,y]=n.useState(!0),{recentSearchTokens:u,proTokenMap:b,setClearRecentSearchTokens:_,setRecentSearchTokens:D}=V(),{getProCoinList:c,getProCoinListWithCoins:s}=Ae(),[m,v]=n.useState(""),[C,R]=n.useState(),{userCollectObj:M,importTokenList:$}=_e(),[A,H]=n.useState([]),j=n.useMemo(()=>(h==="Watchlist"||h==="Imported")&&!m?A:C,[h,A,C,m]),L=async(f,T=!0)=>{y(T);try{const B=await c(f);R(B.list),y(!1)}catch(B){console.log("ðŸš€ ~ fetchProData ~ err:",B),y(!1)}},E=async(f,T=!0,B=h)=>{y(T);const K=B==="Watchlist"?(Object==null?void 0:Object.keys(M))||[]:($==null?void 0:$.map(U=>U==null?void 0:U.coin_type))||[];if(console.log("ðŸš€ ~ getWatchList ~ coins:",K),(K==null?void 0:K.length)==0)H([]);else{const U=await s(K,"hour24",f);H(U)}y(!1)},X=()=>{v(""),R([]),H([]),y(!0),a()};n.useEffect(()=>{console.log("TokenDropSelectBlock isOpen###",d),d&&(v(""),r("Trending"),L(ne))},[d]);const Ce=()=>{console.log("ðŸš€ ~ handleRefresh ~ currentTab:",h),m?xe(m,!1):h==="Trending"?L(ne,!1):E("",!1)};n.useEffect(()=>{const f=setInterval(Ce,6e4);return()=>clearInterval(f)},[h,m]),n.useEffect(()=>{h==="Watchlist"&&E()},[M]),n.useEffect(()=>{h==="Imported"&&E()},[$]),n.useEffect(()=>{const f=T=>{d&&g.current&&!g.current.contains(T.target)&&X()};return document.addEventListener("mousedown",f),()=>document.removeEventListener("mousedown",f)},[d,a]);const we=f=>{const T=f.replace(/[^[a-zA-Z0-9\s]+$/g,"");v(T),xe(T)},xe=Oe((f,T=!0)=>{console.log("ðŸš€ ~ debouncedFilter ~ result:",f),L({text:f},T)},500),je=f=>{y(!0),H([]),r(f),f=="Trending"?L(ne):E("",!0,f)},[De,ge]=n.useState(-1);return e.jsx("div",{ref:g,children:e.jsxs(Ee,{isLazy:!0,placement:"bottom-end",modifiers:[{name:"flip",enabled:!1},{name:"shift",enabled:!1}],initialFocusRef:t,isOpen:d,trigger:"click",onClose:X,onOpen:S,children:[e.jsx(Pe,{children:e.jsx(Q,{sx:{".singleTokenInfoBox":{svg:{transition:"transform 0.5s",transform:d?"rotate(180deg)":"rotate(0deg)"}}},ref:t,as:"button",onClick:()=>S(),children:o})}),d&&e.jsx(We,{ml:{base:"12px",lg:"20px"},w:{base:"calc(100vw - 24px)",lg:"340px"},children:e.jsx(Me,{p:"0px",children:e.jsxs(z,{align:"flex-start",w:"100%",p:"8px",borderRadius:"12px",children:[e.jsx(te,{w:"100%",sx:{input:{borderRadius:"8px",fontSize:"14px"}},children:e.jsx(Ye,{placeholder:"Search tokens",searchText:m,onChange:f=>we(f)})}),u&&(u==null?void 0:u.length)>0&&e.jsxs(z,{w:"100%",align:"flex-start",gap:"8px",children:[e.jsxs(I,{w:"100%",justify:"space-between",children:[e.jsx(W,{fontSize:"12px",color:"text_caption",m:"4px 0",children:"Recent Searches"}),e.jsx(W,{_hover:{color:"text_caption"},fontSize:"12px",cursor:"pointer",onClick:()=>_(),children:"Clear all"})]}),e.jsx(I,{gap:"8px",flexWrap:"wrap",children:(he=u==null?void 0:u.toReversed())==null?void 0:he.map((f,T)=>e.jsxs(I,{w:"auto",p:{base:"6px 8px",lg:"6px 12px"},align:"center",borderRadius:"8px",background:"bg_secondary",borderStyle:"solid",border:"1px",borderColor:"border",cursor:"pointer",position:"relative",userSelect:"none",_hover:{background:"primary_opacity.10"},onClick:()=>{l(f),X()},onMouseEnter:()=>ge(T),onMouseLeave:()=>ge(-1),children:[e.jsx(le,{token:f,imgBoxStyle:{w:"20px",h:"20px"},symbolFontSize:"14px",haveName:!1,warningIcon:{iconW:"10px",iconH:"10px"}}),De==T?e.jsx(k,{xlinkHref:"#icon-icon_close",variant:"round",position:"absolute",boxW:"20px",boxH:"20px",top:"-8px",right:"-8px",onClick:B=>{B.stopPropagation(),D(f,!0)}}):null]},f.coin_type))})]}),!m&&e.jsx(ue,{type:"outlineTab",wrapStyle:{w:{base:"100%"},gap:"0",borderRadius:"8px",p:"4px"},itemStyle:{w:"calc(100% / 3)",fontSize:"12px",h:"28px",p:"8px 0px"},tabList:nt,currentTab:h,handleChangeTab:f=>je(f.label)}),(j==null?void 0:j.length)==0&&!p?e.jsx(Q,{w:"100%",sx:{p:{color:"primary_gray",fontSize:"12px"}},children:e.jsx(Je,{type:"nodata",p:"12px",text:h=="Watchlist"?"No tokens in your watchlist.":h=="Imported"?"No Imported Tokens":"No Data",noBorder:!0})}):e.jsx(te,{w:"100%",maxH:"310px",overflow:"auto",children:e.jsx(Qe,{isShowDelete:h==="Imported",isLoading:p,data:j,onRowClick:f=>{const T=f!=null&&f.coin_type?f:b==null?void 0:b.get(f==null?void 0:f.coinType);l({...f,...T}),D({...f,...T}),X()}})})]})})})]})})}const it=({handleToggleDirect:o,h5ShowIcon:i=!0,whiteTokenList:x,onCoinSelect:l})=>{const{showTokenInfo:t,anotherTokenInfo:g,notChangeToken:d}=V(),{userCollectObj:S,userCollectList:a}=_e(),{delUserCollectToken:h,addUserCollectToken:r}=ze(),{isApp:p}=oe(),{getCoinRelatedData:y}=Ue();return ve(),e.jsxs(z,{w:"100%",align:"flex-start",gap:"0",children:[!i&&p&&e.jsx(W,{fontSize:"14px",fontWeight:"500",color:"text_caption",h:"20px",lineHeight:"20px",mb:"20px",children:"Coin Details"}),e.jsxs(I,{w:"100%",justify:"space-between",mb:i?"8px":"0px",children:[i||!p?e.jsx(at,{children:e.jsxs(I,{className:"singleTokenInfoBox",children:[e.jsx(le,{haveTooltip:!0,imgBoxStyle:{w:"32px",h:"32px"},symbolFontSize:"16px",nameEllipsesDecimals:20,coinType:t==null?void 0:t.coin_type,warningIcon:{iconW:"16px",iconH:"16px"}}),e.jsx(k,{svgW:"16px",xlinkHref:"#icon-icon_arrow",variant:"gray"})]}),onCoinSelect:l,whiteTokenList:x,selectCoin:null}):e.jsx(le,{haveTooltip:!0,imgBoxStyle:{w:"32px",h:"32px"},symbolFontSize:"16px",nameEllipsesDecimals:20,coinType:t==null?void 0:t.coin_type,warningIcon:{iconW:"16px",iconH:"16px"}}),(i||!p)&&e.jsxs(I,{gap:"12px",children:[e.jsx(G,{showTooltip:!p,placement:"top",tooltip:e.jsx(W,{fontSize:"12px",children:"Refresh"}),children:e.jsx(Q,{children:e.jsx(Ze,{handleRefresh:()=>{y((t==null?void 0:t.coin_type)||"",!0)},borderRadius:"8px",w:"28px",h:"28px",innerStyle:{bg:"bg_secondary"}})})}),!d&&e.jsx(G,{showTooltip:!p,placement:"top",tooltip:e.jsxs(W,{fontSize:"12px",children:["Switch to ",ke(g==null?void 0:g.symbol,10)||""," "]}),children:e.jsx(I,{w:"28px",h:"28px",borderRadius:"8px",bg:"bg_secondary",border:"1px solid",borderColor:"border",justify:"center",align:"center",children:e.jsx(k,{xlinkHref:"#icon-icon_swap1",svgW:"18px",svgH:"18px",onClick:o})})}),t!=null&&t.coin_type&&S[pe(t==null?void 0:t.coin_type)]?e.jsx(G,{showTooltip:!p,placement:"top",tooltip:e.jsx(W,{fontSize:"12px",children:"Remove from Watchlisit"}),children:e.jsx(I,{w:"28px",h:"28px",borderRadius:"8px",bg:"bg_secondary",border:"1px solid",borderColor:"border",justify:"center",align:"center",children:e.jsx(k,{xlinkHref:"#icon-icon_star_sel",svgFill:"primary",svgHover:"primary",onClick:u=>{u.stopPropagation(),t!=null&&t.coin_type&&h(t)}})})}):e.jsx(G,{showTooltip:!p,placement:"top",tooltip:e.jsx(W,{fontSize:"12px",children:"Add to Watchlisit"}),children:e.jsx(I,{w:"28px",h:"28px",borderRadius:"8px",bg:"bg_secondary",border:"1px solid",borderColor:"border",justify:"center",align:"center",children:e.jsx(k,{cursor:(a==null?void 0:a.length)>=100?"not-allowed":"pointer",xlinkHref:"#icon-icon_star",variant:"primary",onClick:u=>{u.stopPropagation(),t!=null&&t.coin_type&&(a==null?void 0:a.length)<100&&r(t)}})})})]})]})]})};function ct({whiteTokenList:o,onCoinSelect:i,token:x,tokenPriceUnit:l,handleToggleDirect:t}){const g=S=>{},{isApp:d}=oe();return e.jsxs(z,{w:"100%",children:[d&&e.jsx(it,{whiteTokenList:o,onCoinSelect:i,handleToggleDirect:t}),e.jsxs(de,{p:"0",overflow:"hidden",position:"relative",borderRadius:"16px",w:"100%",h:{base:"422px",lg:"475px"},children:[!x||l===void 0&&e.jsx(Se,{}),x&&l!==void 0&&e.jsx(st,{token:x,tokenPriceUnit:l,onChangePrice:g})]})]})}const Dt=Object.freeze(Object.defineProperty({__proto__:null,default:ct},Symbol.toStringTag,{value:"Module"}));var O=(o=>(o.Swap="Swap",o.Limit="Limit",o.DCA="DCA",o))(O||{});function lt(){const{currentProTab:o,setCurrentProTab:i}=V(),x=[{label:"Buy",value:"buy"},{label:"Sell",value:"Sell"}];return e.jsx(ue,{type:"outlineTab",tabList:x,currentTab:o,handleChangeTab:l=>i(l==null?void 0:l.label,"buySellTab"),wrapStyle:{w:"100%",h:"48px",p:"4px",border:"1px solid",borderColor:"border",borderRadius:"16px",gap:"4px",zIndex:"99",m:"8px 0 0px"},itemStyle:{w:"50%",h:"100%",p:"4px 8px",borderRadius:"12px",gap:"4px",justifyContent:"center",alignItems:"center",fontSize:"14px",fontWeight:"500",sx:{'&[data-active="true"]':{backgroundColor:o=="Buy"?"primary_green_opacity.10":"primary_red_opacity.10",color:o=="Buy"?"primary_green":"primary_red"}}},selectTabItemTextStyle:{color:"primary_gray",sx:{'&[data-active="true"]':{color:o=="Buy"?"primary_green":"primary_red"}}}})}const pt=[{label:O.Swap},{label:O.Limit},{label:O.DCA}];function Tt(o){const{currTradeTab:i}=o,{setIsShowTradeChart:x,setIsShowTradeOrders:l}=Ge(),{isProMode:t,setIsProMode:g}=V(),{from:d,to:S,pay:a,target:h}=$e(),{a:r,b:p}=n.useMemo(()=>({a:d||a||"",b:S||h||""}),[d,S,a,h]);n.useEffect(()=>{t&&l(!1)},[t]);const y=ve(),{isApp:u}=oe();return e.jsxs(z,{w:"100%",gap:"0",children:[t&&e.jsx(lt,{}),e.jsxs(I,{w:"100%",justify:"space-between",children:[e.jsx(ue,{type:"borderTab",currentTab:i,tabList:pt,handleChangeTab:b=>{b.label===O.Limit?y(`/limit${r?`/${r}`:""}${p?`/${p}`:""}`):b.label===O.DCA?y(`/dca${r?`/${r}`:""}${p?`/${p}`:""}`):y(`/swap${r?`/${r}`:""}${p?`/${p}`:""}`)},wrapStyle:{bg:"none",h:"52px",gap:"32px",border:"none"},itemStyle:{fontSize:"16px",fontWeight:500,position:"relative"}}),e.jsxs(I,{children:[i===O.Swap&&e.jsx(G,{placement:"top",tooltip:e.jsx(W,{fontWeight:"500",fontSize:"12px",children:"Merge Swap"}),children:e.jsxs(de,{p:"5px 8px",display:"flex",alignItems:"center",gap:"6px",borderRadius:"8px",w:"fit-content",onClick:()=>y("/merge-swap"),children:[e.jsx(se,{src:"/images/icon_merge_swap.svg",w:"16px",h:"16px"}),e.jsx(W,{color:"primary_gray",fontSize:"12px",fontWeight:"500",children:"Merge"})]})}),e.jsx(I,{gap:"2px",onClick:()=>g(!t),cursor:"pointer",children:e.jsx(G,{showTooltip:!u,placement:"top",tooltip:e.jsx(W,{fontWeight:"500",fontSize:"12px",children:t?"Switch to Lite Mode":"Switch to Pro Mode"}),children:e.jsx(Q,{children:t?e.jsx(te,{position:"relative",children:e.jsx(se,{w:"62px",h:"28px",src:"/images/icon_lpro.png"})}):e.jsx(se,{w:"62px",h:"28px",src:"/images/icon_lite.png"})})})})]})]})]})}function ut(o){const[i,x]=n.useState(!0),{baseToken:l,quoteToken:t,isChangeDirect:g}=o,[d,S]=n.useState(!1),[a,h]=n.useState(void 0),[r,p]=n.useState(void 0),{getTokenRank:y}=Xe(),{isProMode:u}=V(),b=n.useRef(!1);return n.useEffect(()=>{b.current?S(_=>!_):b.current=!0},[g]),n.useEffect(()=>{if(l!=null&&l.coin_type&&(t!=null&&t.coin_type)&&(l==null?void 0:l.coin_type)!==(t==null?void 0:t.coin_type)){const _=y(l,t);console.log("test price kline direct:",_),console.log("test price kline baseToken:",l),console.log("test price kline quoteToken:",t);const D=_?l:t,c=_?t:l,s=d?c:D,m=d?D:c;h(s),p(m)}},[l==null?void 0:l.coin_type,t==null?void 0:t.coin_type,d]),n.useMemo(()=>`${a==null?void 0:a.coin_type}##${r==null?void 0:r.coin_type}`,[a==null?void 0:a.coin_type,r==null?void 0:r.coin_type]),n.useCallback(()=>{x(!1)},[]),console.log("isLoading isLoading: ",i),e.jsxs(z,{w:"100%",position:"relative",alignItems:"start",gap:{base:"4px",lg:"16px"},children:[!u&&e.jsx(te,{children:i?e.jsxs(I,{h:"52px",lineHeight:"52px",gap:"8px",children:[e.jsx(fe,{}),e.jsx(fe,{}),e.jsx(Fe,{})]}):e.jsxs(I,{h:"52px",lineHeight:"52px",gap:"8px",children:[e.jsx(Ve,{coinACoinType:a==null?void 0:a.coin_type,coinBCoinType:r==null?void 0:r.coin_type,coinAIconUrl:a==null?void 0:a.logo_url,coinBIconUrl:r==null?void 0:r.logo_url,ml:"-4px"}),e.jsxs(W,{textColor:"text_caption",fontSize:"16px",children:[a==null?void 0:a.symbol," / ",r==null?void 0:r.symbol]}),e.jsx(k,{xlinkHref:"#icon-icon_swap1",onClick:()=>{S(!d)}})]})}),e.jsxs(de,{p:"0",overflow:"hidden",borderRadius:"16px",position:"relative",w:"100%",h:"422px",children:[i&&e.jsx(Q,{className:"test-is-loading",position:"absolute",left:"0px",top:"0px",w:"100%",h:"422px",bg:"bg_primary",zIndex:"10",children:e.jsx(Se,{})}),(a==null?void 0:a.coin_type)&&(r==null?void 0:r.coin_type)&&e.jsx("iframe",{id:"geckoterminal-embed",className:"frame",style:{display:i?"none":"block"},height:"422px",width:"100%",title:"GeckoTerminal Embed",frameBorder:"0",allow:"clipboard-write",allowFullScreen:!0,src:`https://noodles.fi/tv-widget?coinA=${pe(a==null?void 0:a.coin_type)}&coinB=${pe(r==null?void 0:r.coin_type)}&theme=dark`,onLoad:()=>{x(!1)}})]})]})}const It=Object.freeze(Object.defineProperty({__proto__:null,LimitPriceChart:ut},Symbol.toStringTag,{value:"Module"}));export{it as C,ut as L,ct as P,Tt as T,O as a,Dt as b,It as c,qe as u};
