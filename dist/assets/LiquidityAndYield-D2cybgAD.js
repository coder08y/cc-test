import{r as y,j as e,B as ne,P as ts,x as ns,C as as,T as d,W as is,y as os,A as ds,V as S,H as j,w as ae,Y as Fe,m as $,M as rs,o as cs,p as xs,$ as ps,a0 as us,q as gs,t as hs,S as Oe,a8 as vs,I as As}from"./vendor-CBmAETR3.js";import{H as Se}from"./HiddenDotted-D7bAXnIM.js";import{a as Ms,u as js}from"./usePosClaimFeeAndReward-DDP49i6N.js";import{a as se,j as zs,u as ke,c as Bs}from"./usePositionList-Bupy7RnX.js";import{u as Ps}from"./activeOrders-Blk-EQ9B.js";import{u as Ns,b as Ds}from"./useGetPythTokenPrice-ZvbDQKwq.js";import{c as Fs,p as W,A as ue,E as ge,B as ee,M as he,Q as Ue,k as Ve,d as T,l as Ys,a as Os,u as Te,w as Us,I as ys,Z as Ce,ca as Vs,C as Ws,a5 as Es}from"./index-Lo8eQgA0.js";import"./cross-J9VCREIf.js";import{u as Hs}from"./useTransaction-C3m_5TTr.js";import{s as qs}from"./dlmm-DZG9_A9Y.js";import{C as We}from"./CheckBox-BfyJMUfq.js";import{N as Ye}from"./NoData-BFX9XpKb.js";import{u as $s}from"./useAccountBalance-Bp-GiNHM.js";import{a as Gs}from"./CoinPairInfo-BkYX588i.js";import{L as Zs}from"./LiquidityValueBlock-BFN5N1z7.js";import{P as Ks,a as Qs}from"./PieChart-ixnjr2gC.js";import{o as Js,p as Xs}from"./generateCategoricalChart-C4prEJcQ.js";const Is=({posInfo:s})=>{var u,x,b,L,_,A,h,D;const[a,c]=y.useState(!1),{posApiPoolData:w}=se();return(u=w[s==null?void 0:s.clmmPool])==null||u.haveMining,(x=w[s==null?void 0:s.clmmPool])==null||x.haveFarming,e.jsx(ne,{p:"12px 0",onClick:n=>Fs(n),onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),children:e.jsxs(ts,{isLazy:!0,isOpen:a,children:[e.jsx(ns,{children:e.jsx(as,{as:"button",cursor:Number(s==null?void 0:s.totalRewardUsd)==0?"text":"help",children:e.jsx(d,{color:"primary",fontSize:"14px",textDecoration:Number(s==null?void 0:s.totalRewardUsd)==0?"none":"underline dotted",textUnderlineOffset:"3px",children:W(s==null?void 0:s.totalRewardUsd,2)})})}),a&&Number(s==null?void 0:s.totalRewardUsd)!==0&&e.jsx(is,{children:e.jsx(os,{zIndex:"2",w:"fit-content",children:e.jsx(ds,{children:e.jsxs(S,{align:"flex-start",minW:"300px",children:[((b=s==null?void 0:s.pendingFeesList)==null?void 0:b.length)>0&&e.jsxs(S,{align:"flex-start",minW:"100%",children:[e.jsxs(j,{w:"100%",justify:"space-between",bg:"bg_third",borderRadius:"12px",p:"16px",children:[e.jsx(d,{fontSize:"12px",children:"Fees"}),e.jsxs(d,{color:"primary",children:[" ",W(s==null?void 0:s.feeOwedUsd,2)]})]}),(L=s==null?void 0:s.pendingFeesList)==null?void 0:L.map(n=>(console.log("ðŸš€ ~ {posInfo?.pendingFeesList?.map ~ item:",n),e.jsxs(j,{w:"100%",justify:"space-between",p:"0 16px 8px",children:[e.jsx(ue,{token:n.token,imgBoxStyle:{w:"20px",h:"20px"},haveName:!1,symbolFontSize:"12px",warningIcon:{iconW:"10px",iconH:"10px"}}),e.jsxs(S,{align:"flex-end",gap:"4px",children:[e.jsx(d,{fontSize:"12px",color:"text_caption",children:ge(n==null?void 0:n.amount,6)}),e.jsx(d,{fontSize:"12px",children:W(n==null?void 0:n.amountUSD,2)})]})]},n==null?void 0:n.coin_address)))]}),((_=s==null?void 0:s.pendingRewarderList)==null?void 0:_.length)>0&&e.jsxs(S,{align:"flex-start",minW:"100%",children:[e.jsxs(j,{w:"100%",justify:"space-between",bg:"bg_third",borderRadius:"6px",p:"16px",children:[e.jsx(d,{fontSize:"12px",children:"Mining rewards"}),e.jsxs(d,{color:"primary",children:[" ",W(s==null?void 0:s.rewarderUsd,2)]})]}),(A=s==null?void 0:s.pendingRewarderList)==null?void 0:A.map(n=>e.jsxs(j,{w:"100%",justify:"space-between",p:"0 16px 8px",children:[e.jsx(ue,{token:n.token,imgBoxStyle:{w:"20px",h:"20px"},haveName:!1,symbolFontSize:"12px",warningIcon:{iconW:"10px",iconH:"10px"}}),e.jsxs(S,{align:"flex-end",gap:"4px",children:[e.jsx(d,{fontSize:"12px",color:"text_caption",children:ge(n==null?void 0:n.amount,6)}),e.jsx(d,{fontSize:"12px",children:W(n==null?void 0:n.amountUSD,2)})]})]},n==null?void 0:n.coin_address))]}),((h=s==null?void 0:s.pendingFarmsList)==null?void 0:h.length)>0&&e.jsxs(S,{align:"flex-start",minW:"100%",children:[e.jsxs(j,{w:"100%",justify:"space-between",bg:"bg_third",borderRadius:"6px",p:"16px",children:[e.jsx(d,{fontSize:"12px",children:"Farming rewards"}),e.jsxs(d,{color:"primary",children:[" ",W(s==null?void 0:s.farmsUsd,2)]})]}),(D=s==null?void 0:s.pendingFarmsList)==null?void 0:D.map(n=>{var m;return e.jsxs(j,{w:"100%",justify:"space-between",p:"0 16px 8px",children:[e.jsx(ue,{token:n.token,imgBoxStyle:{w:"20px",h:"20px"},haveName:!1,symbolFontSize:"12px",warningIcon:{iconW:"10px",iconH:"10px"}}),e.jsxs(S,{align:"flex-end",gap:"4px",children:[e.jsx(d,{fontSize:"12px",color:"text_caption",children:ge(n==null?void 0:n.amount,6)}),e.jsx(d,{fontSize:"12px",children:W(n==null?void 0:n.amountUSD,2)})]})]},(m=n==null?void 0:n.token)==null?void 0:m.coin_type)})]})]})})})})]})})};function bs({posInfo:s,onClickCheckBox:a,checked:c,pageFrom:w,cursor:u="pointer"}){const{getClmmPosName:x}=zs(),{posPoolsOriginalData:b}=se(),L=y.useMemo(()=>{var m;if(s!=null&&s.tokenName)return s!=null&&s.tokenName.includes("Cetus")?s==null?void 0:s.tokenName:`Cetus LP | ${s==null?void 0:s.tokenName}`;{const E=(m=b==null?void 0:b[s==null?void 0:s.clmmPool])==null?void 0:m.index;return x(s==null?void 0:s.index,E)}},[s==null?void 0:s.tokenName,s==null?void 0:s.index,s==null?void 0:s.clmmPool,b]),{posPoolsRelatedData:_}=se(),{dlmmPosPoolsRelatedData:A}=ke(),h=_[s==null?void 0:s.posId]||A[s==null?void 0:s.id],D=h==null?void 0:h.displayFee,n=h==null?void 0:h.binStep;return e.jsxs(ee,{w:"100%",borderRadius:"8px",p:"0",bg:"bg_primary",children:[e.jsxs(j,{w:"100%",bg:"bg_third",p:"12px 16px",borderRadius:"8px",children:[e.jsxs(S,{w:"100%",align:"flex-start",gap:"16px",children:[e.jsx(Gs,{poolInfo:{...s,feeDisplay:D!=null&&D.includes("%")?D:D+"%",binStep:n},poolType:(s==null?void 0:s.posType)==="dlmm"?"dlmm":"clmm",symbolEllipsesDecimals:10,showPoolTypeTag:!0,type:"column"}),e.jsx(d,{fontSize:"12px",color:"primary_gray",children:L})]}),a&&e.jsx(We,{cursor:u,checked:c||!1,onClick:()=>a(s)})]}),w=="pendingYieldModal"?e.jsxs(j,{p:"0px 16px",w:"100%",justify:"space-between",gap:"4px",align:"flex-start",children:[e.jsx(d,{color:"primary_gray",mb:"-12px",mt:"12px",children:"Claimable yield"}),e.jsx(Is,{posInfo:s})]}):e.jsxs(j,{justify:"space-between",p:"0 16px",children:[e.jsx(d,{color:"primary_gray",children:"Liquidity"}),e.jsx(Zs,{positionInfo:s,color:"primary",fontSize:"14px",haveTooltip:w!="lpBurnNext"})]})]})}function wl({onClose:s,onClickLock:a,currentLockItem:c,onClickCheckBox:w}){const{currentAccount:u,onWalletModal:x}=he(),{fullRangePosBaseList:b,fullRangePosBaseListLoading:L}=se();return e.jsxs(S,{w:"100%",gap:"20px",children:[e.jsxs(S,{w:"100%",align:"flex-start",gap:"20px",children:[e.jsx(d,{color:"primary_gray",textAlign:"left",lineHeight:"20px",children:"Token teams can permanently lock liquidity. The NFT representing your position is sent to a locked token account. Trading fees and mining rewards earned will still be claimable."}),e.jsx(d,{color:"primary_gray",textAlign:"left",lineHeight:"20px",children:"To start, select a liquidity position below to lock. Ensure that position value and NFT mint match the position you want to lock!"}),e.jsx(d,{color:"primary_gray",textAlign:"left",lineHeight:"20px",children:"Note: Technically, your NFT is not burned but permanently locked."})]}),e.jsx(S,{w:"100%",gap:"16px",maxH:"320px",overflow:"auto",children:u!=null&&u.address?L?[{},{}].map((_,A)=>e.jsx(ms,{},A)):(b==null?void 0:b.length)>0?b==null?void 0:b.map(_=>e.jsx(bs,{posInfo:_,checked:(_==null?void 0:_.posId)==(c==null?void 0:c.posId),onClickCheckBox:A=>w(A),pageFrom:"lpBurnPrev"},_==null?void 0:_.posId)):e.jsxs(ee,{pb:"30px",borderRadius:"12px",bg:"none",border:"none",pt:"0",children:[e.jsx(Ye,{h:"240px",type:"nodata",pb:"0px",text:"No Available Liquidity",bg:"none",noBorder:!0}),e.jsx(d,{color:"primary_gray",whiteSpace:"nowrap",children:"Burn/Lock Liquidity only available for CLMM Full-range position"})]}):e.jsx(Ye,{type:"nowallet",onboard:()=>x(!0),bg:"none",border:"none"})}),(u==null?void 0:u.address)&&e.jsxs(S,{gap:"8px",w:"100%",p:"20px 0",mt:"-20px",children:[e.jsx(ae,{isDisabled:Object.values(c).length<=0,w:"100%",h:"52px",fontWeight:"500",onClick:a,children:"Lock Liquidity"}),e.jsx(ae,{w:"100%",p:"20px",variant:"outline",onClick:s,cursor:"pointer",h:"52px",children:"Cancel"})]})]})}const ms=()=>e.jsxs(ee,{w:"100%",borderRadius:"8px",p:"0",bg:"bg_primary",children:[e.jsx(j,{w:"100%",bg:"bg_third",p:"12px 16px",borderRadius:"8px",children:e.jsxs(j,{gap:"0",children:[e.jsx(Fe,{size:"9"}),e.jsx(Fe,{size:"9"}),e.jsx(S,{gap:"4px",ml:"4px",align:"flex-start",children:e.jsx($,{height:"4",width:"100px"})})]})}),e.jsx(ne,{w:"100%",p:"16px",children:e.jsx($,{height:"5",width:"250px"})})]}),fs="/assets/tvl_bg-D80TUrdU.png",ws="/assets/yield_bg-CcCC1tTK.png";function el(s=!0){const{isAutoRefresh:a}=Ps(),{currentAccount:c}=he(),{posBaseList:w,posLiquidityData:u,posBaseListLoading:x,posLiquidityDataLoading:b}=se(),{dlmmPosBaseList:L,dlmmPosLiquidityData:_,dlmmPosBaseListLoading:A,dlmmPosRewardsDataLoading:h,dlmmPosRewardsData:D,dlmmPosFeeData:n}=ke(),{getTokenAmountValue:m}=Ue(),{coinPriceObj:E}=Ve(),{vaultsPositionObj:H}=Ns(),{getTokenAmountValueByPyth:G}=Ds(),M=y.useMemo(()=>{let C=0,B=0;if(a||!x&&!b)return(w==null?void 0:w.length)>0&&(c!=null&&c.address)?(w.forEach(r=>{var P,Y;const p=u[r==null?void 0:r.posId],v=m((P=r==null?void 0:r.displayTokenA)==null?void 0:P.coin_type,p==null?void 0:p.displayCoinAmountA),F=m((Y=r==null?void 0:r.displayTokenB)==null?void 0:Y.coin_type,p==null?void 0:p.displayCoinAmountB);C=T(C).plus(v).plus(F).toString(),B=T(B).plus((p==null?void 0:p.displayCoinAmountA)||0).plus((p==null?void 0:p.displayCoinAmountB)||0).toString()}),console.log("ðŸš€ ~ clmmTotalTvl ~ total:",B,C),T(C).lte(0)&&T(B).gt(0)?"--":C):"--"},[a,w,x,u,b,c==null?void 0:c.address,E]),R=y.useMemo(()=>{let C=T(0);return Ys(H)?(Object.values(H).forEach(B=>{const{category:r,displayCoinTypeA:p,displayAmountA:v,displayCoinTypeB:F,displayAmountB:P}=B,Y=r=="haedal"?G(p,v):m(p,v),U=r=="haedal"?G(F,P):m(F,P),q=T(Y).plus(U||0);C=C.add(q)}),C.toString()):"--"},[H,c==null?void 0:c.address]),O=y.useMemo(()=>{let C=0,B=0;if(a||!A&&!h)return(L==null?void 0:L.length)>0&&(c!=null&&c.address)?(L.forEach(r=>{var P,Y;const p=_[r.id];console.log("ðŸš€ ~ posBaseList.forEach ~ currentDlmmPosData:",p);const v=m((P=r==null?void 0:r.displayTokenA)==null?void 0:P.coin_type,p==null?void 0:p.displayCoinAmountA),F=m((Y=r==null?void 0:r.displayTokenB)==null?void 0:Y.coin_type,p==null?void 0:p.displayCoinAmountB);C=T(C).plus(v).plus(F).toString(),B=T(B).plus((p==null?void 0:p.displayCoinAmountA)||0).plus((p==null?void 0:p.displayCoinAmountB)||0).toString()}),T(C).lte(0)&&T(B).gt(0)?"--":C):"--"},[L,_,c,E,a,A,h]),Z=y.useMemo(()=>{if(!M||!O||!R)return;let C=T(0);return M&&M!=="--"&&(C=T(M)),O&&O!=="--"&&(C=C.plus(O)),s&&!R&&R!=="--"&&(C=C.plus(R)),C.toString()},[M,O,R]);return{clmmTotalTvl:M,vaultTotalTvl:R,liquidityTotalTvl:Z,dlmmTotalTvl:O}}const sl=[{label:"All",key:"all"},{label:"CLMM",key:"clmm"},{label:"DLMM",key:"dlmm"}];function ll({isOpen:s,claimLoading:a,onClose:c,changeClaimLoading:w,showLoading:u}){const[x,b]=y.useState(!1),{coinPriceObj:L}=Ve(),{getPositionBaseList:_}=Bs(),{batchSignAndExecuteTransaction:A}=Hs(),{currentAccount:h}=he(),{getBatchHarvestFeeAndRewardsTxPayload:D}=Ms(),{getTokenAmountValue:n}=Ue(),[m,E]=y.useState([]),[H,G]=y.useState(!0),[M,R]=y.useState(!0),[O,Z]=y.useState(.01),[C,B]=y.useState([]),[r,p]=y.useState([]),[v,F]=y.useState(""),[P,Y]=y.useState(""),[U,q]=y.useState([]),[V,xe]=y.useState("All"),{myPosYieldValue:ie,myClmmPosYieldValue:oe,myDlmmPosYieldValue:je,posBaseList:ye,posFeeData:K,posRewardsData:I,farmsPosRewardsData:le}=se(),{dlmmPosBaseList:Q,dlmmPosRewardsData:J,dlmmPosFeeData:te}=ke(),_e=l=>{const i=new RegExp("[^\\d-]*(\\d*(?:\\.\\d{0,4})?).*$");l.target.value=l.target.value.replace(i,"$1"),Z(l.target.value)},Le=()=>{(!O||O<.01)&&Z(.01)},Ee=(l,i,o,t,be=!1)=>{const N=[];let z="0";const Ae=[];return l.forEach(k=>{var Ze,Ke,Qe,Je,Xe,Ie,es;let me="0",Me="0",ze="0",pe="0",de="0",re="0";const Be=[],Pe=[],Ne=[];let fe=be?k.id:k.posId;if(((Ze=Object.values(i))==null?void 0:Ze.length)>0){const f=i[fe],g=n((Ke=k==null?void 0:k.displayTokenA)==null?void 0:Ke.coin_type,f==null?void 0:f.displayFeeOwedA,"--"),X=n((Qe=k==null?void 0:k.displayTokenB)==null?void 0:Qe.coin_type,f==null?void 0:f.displayFeeOwedB,"--");me=T(me).plus((f==null?void 0:f.displayFeeOwedA)||0).plus((f==null?void 0:f.displayFeeOwedB)||0).toString(),g!=="--"&&X!=="--"&&(pe=T(g).plus(X).toString()),Pe.push({coin_address:Ce((Je=k==null?void 0:k.displayTokenA)==null?void 0:Je.coin_type,!1),amount:f==null?void 0:f.displayFeeOwedA,amountUSD:g,token:k==null?void 0:k.displayTokenA},{coin_address:Ce((Xe=k==null?void 0:k.displayTokenB)==null?void 0:Xe.coin_type,!1),amount:f==null?void 0:f.displayFeeOwedB,amountUSD:X,token:k==null?void 0:k.displayTokenB})}if(((Ie=Object.values(o))==null?void 0:Ie.length)>0){const f=o[fe];(f==null?void 0:f.length)>0&&f.forEach(g=>{var X,ce;if(Me=T(Me).plus(g.display_amount_owed||0).toString(),Number(g==null?void 0:g.display_amount_owed)>0){const De=n((X=g==null?void 0:g.token)==null?void 0:X.coin_type,g.display_amount_owed);De!=="--"&&(de=T(de).plus(De).toString()),Be.push({coin_address:Ce((ce=g==null?void 0:g.token)==null?void 0:ce.coin_type,!1),amount:g.display_amount_owed,amountUSD:De,token:g==null?void 0:g.token})}})}if(t&&((es=Object.values(t))==null?void 0:es.length)>0){fe=k.id;const f=t[fe];(f==null?void 0:f.length)>0&&f.forEach(g=>{var X;if(ze=T(ze).plus(g.display_amount_owed||0).toString(),Number(g==null?void 0:g.display_amount_owed)>0){const ce=n(g==null?void 0:g.token.coin_type,g.display_amount_owed);ce!=="--"&&(re=T(re).plus(ce).toString()),Ne.push({coin_address:Ce(((X=g==null?void 0:g.token)==null?void 0:X.coin_type)||"",!1),amount:g.display_amount_owed,amountUSD:ce,token:g==null?void 0:g.token})}})}const Ge=T(de).plus(pe).plus(re).toString(),we=(T(me).gt(0)||T(Me).gt(0)||T(ze).gt(0))&&Number(Ge)==0?"--":Ge;z=T(z).plus(de).plus(pe).plus(re).toString(),Number(we)!==0&&Ae.push(k),M&&Number(we)>Number(O)&&N.push({...k,totalRewardUsd:we,pendingRewarderList:Be,pendingFeesList:Pe,pendingFarmsList:Ne,rewarderUsd:de,feeOwedUsd:pe,farmsUsd:re}),M||N.push({...k,totalRewardUsd:we,pendingRewarderList:Be,pendingFeesList:Pe,pendingFarmsList:Ne,rewarderUsd:de,feeOwedUsd:pe,farmsUsd:re})}),{result:N,totalAmount:z,amountGtZeroList:Ae}};y.useEffect(()=>{let l=[],i="0",o=[];if(!u){if(["DLMM","All"].includes(V)){const N=Ee(Q,te,J,void 0,!0);l=[...N.result],i=N.totalAmount,o=[...N.amountGtZeroList]}if(["CLMM","All"].includes(V)){const N=Ee(ye,K,I,le);console.log(N,"posResult"),l=[...l,...N.result],i=T(i).plus(N.totalAmount).toString(),o=[...o,...N.amountGtZeroList]}}B(o);const t=l.filter(N=>Number(N.totalRewardUsd)!==0);p(t),F(M?(t==null?void 0:t.length)===l.length?"all":"":(t==null?void 0:t.length)===o.length?"all":"");const be=l.sort((N,z)=>z.totalRewardUsd-N.totalRewardUsd);E(be),G(!1)},[O,M,u,L,Q,ye,te,K,J,I,le,V]);const{calculatePendingYield:Re}=js();y.useEffect(()=>{if(console.log("ðŸš€ ~ useEffect ~ selectList: ~ clickSelectAll ~ updatedList:",{selectList:r,dlmmPosBaseList:Q}),(r==null?void 0:r.length)>0){if(V==="All"){const{total:l,rewardAndFeeList:i}=Re(r,K,I,le,te,J);console.log("ðŸš€ ~ useEffect ~ total:",r,l,i),Y(l),q(i)}if(V==="CLMM"){const{total:l,rewardAndFeeList:i}=Re(r,K,I,le);console.log("ðŸš€ ~ useEffect ~ total:",r,l,i),Y(l),q(i)}if(V==="DLMM"){const{total:l,rewardAndFeeList:i}=Re(r,{},{},{},te,J);Y(l),q(i)}}else Y(""),q([])},[r,K,I,le,Q,te,J,V]);const Ss=l=>{if(console.log("ðŸš€ ~ selectItem ~ item:",r,l),Number(l==null?void 0:l.totalRewardUsd)<=0)return;const i=[...r],o=(i==null?void 0:i.filter(t=>(t==null?void 0:t.posType)=="clmm"?(t==null?void 0:t.posId)!==(l==null?void 0:l.posId):(t==null?void 0:t.id)!==(l==null?void 0:l.id)))||[];i!=null&&i.some(t=>(t==null?void 0:t.posType)=="clmm"?(t==null?void 0:t.posId)===(l==null?void 0:l.posId):(t==null?void 0:t.id)===(l==null?void 0:l.id))||o.push(l),console.log("ðŸš€ ~ selectItem ~ updatedList:",o),p(o),M?(o==null?void 0:o.length)!==(m==null?void 0:m.length)?F(""):F("all"):(o==null?void 0:o.length)!==(C==null?void 0:C.length)?F(""):F("all")};y.useEffect(()=>{Z(.01),b(!1),R(!0)},[s]);const Cs=()=>{if(console.log(v,"selectType"),v=="all")F(""),p([]);else{F("all");const l=[...r],i=Object.fromEntries(r.map(o=>[(o==null?void 0:o.posType)=="clmm"?o==null?void 0:o.posId:o==null?void 0:o.id,o]));m.forEach(o=>{!i[(o==null?void 0:o.posType)=="clmm"?o==null?void 0:o.posId:o==null?void 0:o.id]&&Number(o.totalRewardUsd)!==0&&l.push(o)}),console.log("ðŸš€ ~ clickSelectAll ~ updatedList:",i,l),p(l)}},{fetchAccountBalance:ks}=$s(),[Ts,He]=y.useState(!1),{remindDlmmClaimRewardTips:ve,setRemindDlmmClaimRewardTips:_s}=Os(),Ls=y.useMemo(()=>{if(ve){const l=r.filter(o=>o.posType==="dlmm").map(o=>o),i=qs(l,1800);return console.log("ðŸš€ ~ isNeedSpitDlmmClaim ~ batchDlmmPosList:",i),i.length>1}return!1},[ve,r]),qe=async()=>{w(!0);try{const l=Object.fromEntries(r.map(t=>[(t==null?void 0:t.posType)=="dlmm"?t==null?void 0:t.id:t==null?void 0:t.posId,(t==null?void 0:t.posType)=="dlmm"?t==null?void 0:t.pendingRewarderList:[...t==null?void 0:t.pendingFarmsList,...t==null?void 0:t.pendingRewarderList]])),{txs:i}=await D(r,l,h==null?void 0:h.address);console.log("ðŸš€ ~ toClaimYield ~ tx:",i);const o=await A(i,{getShowInfo:(t,be,N,z)=>t==="rejected"&&(z==null?void 0:z.failedResults)&&z.failedResults.length>0&&z.successResults.length>0&&z.failedResults.length>0?{modalTitleText:"Partial claim failed",modalDescriptionText:"Claim again to collect the remaining rewards.",toastTitleText:"Partial claim failed",toastDescriptionContent:`Failed transactions ${z.failedResults.length} /${z.successResults.length+z.failedResults.length} `}:t==="success"&&(z!=null&&z.successResults)&&z.successResults.length>1?{modalDescriptionText:"Claim Yield",toastTitleText:"Claim",toastDescriptionContent:`Completed transactions ${i.length} /${i.length} `}:{modalDescriptionText:"Claim Yield",toastTitleText:"Claim"}});console.log("ðŸš€ ~ toClaimYield ~ res:",o),o&&(ks(),await _(h==null?void 0:h.address)),w(!1)}catch(l){w(!1),console.log("ðŸš€ ~ toClaimYield ~ error:",l)}finally{c()}},{isApp:$e}=Te(),Rs=y.useMemo(()=>({All:ie,CLMM:oe,DLMM:je})[V],[V,ie,oe,je]);return e.jsxs(e.Fragment,{children:[e.jsxs(rs,{autoFocus:!1,returnFocusOnClose:!1,isOpen:s,onClose:c,isCentered:!0,children:[e.jsx(cs,{}),e.jsxs(xs,{minWidth:$e?"300px":"446px",children:[e.jsx(ps,{children:e.jsx(us,{fontWeight:"500",fontSize:"16px",children:x?"Claim Yield":"Details"})}),e.jsx(gs,{}),e.jsx(hs,{p:"16px 0px 0",textAlign:"center",children:e.jsxs(ne,{children:[e.jsxs(S,{w:"100%",children:[e.jsx(ne,{w:"100%",p:"0 16px",children:e.jsx(S,{justify:"center",w:"100%",h:"90px",borderRadius:"16px",bg:"pending_yield_bg",children:e.jsx($,{isLoaded:!u,children:e.jsxs(S,{gap:"4px",align:"center",children:[e.jsx(d,{color:"primary_gray",children:x?"Total Claim":"Claimable Yield"}),e.jsx(d,{color:"primary",fontSize:"20px",fontWeight:"500",children:W(x?P:Rs,2)})]})})})}),!x&&e.jsxs(Oe,{flexDir:{base:"column",lg:"row"},w:"100%",p:"0 16px",justify:"space-between",mt:"12px",children:[e.jsx(Us,{type:"outlineTab",tabList:sl,currentTab:V,handleChangeTab:l=>{xe(l==null?void 0:l.label)},isActive:(l,i)=>l===i.label,wrapStyle:{h:"30px",p:"2px",borderRadius:"8px",gap:"0px",w:"auto"},itemStyle:{flex:1,minW:$e?"auto":"54px",h:"24px",p:"2px 8px",fontSize:"12px",borderRadius:"4px"}}),e.jsxs(j,{justify:"flex-end",children:[e.jsx(vs,{isChecked:M,onChange:()=>R(!M)}),e.jsx(d,{color:"text_caption",fontSize:"12px",children:"Hide yield <"}),e.jsx(ee,{borderRadius:"8px",w:"72px",h:"24px",p:"0",lineHeight:"20px",children:e.jsx(As,{textAlign:"center",fontSize:"12px",p:"0px 12px",value:`$${O}`,onChange:_e,onBlur:Le})})]})]}),e.jsx(S,{w:"100%",p:"0 16px 16px",maxH:"370px",overflow:"auto",pr:(m==null?void 0:m.length)>2?"16px":"20px",mr:"-4px",children:x?U==null?void 0:U.map(l=>(console.log("ðŸš€ ~ :[yieldList]?.map ~ item:",l),e.jsx(ee,{w:"100%",p:"16px",borderRadius:"12px",sx:{_first:{mt:"12px"}},children:e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(ue,{token:l==null?void 0:l.token,imgBoxStyle:{w:"32px",h:"32px"},haveName:!1,symbolFontSize:"14px",warningIcon:{iconW:"16px",iconH:"16px"}}),e.jsxs(S,{align:"flex-end",gap:"4px",children:[e.jsx(d,{color:"text_caption",children:ge(l==null?void 0:l.amount,6)}),e.jsxs(d,{children:["(",W(l==null?void 0:l.amountUSD,2),")"]})]})]})},l==null?void 0:l.coin_address))):(m==null?void 0:m.length)>0?m==null?void 0:m.map(l=>e.jsx(bs,{posInfo:l,onClickCheckBox:i=>Ss(i),pageFrom:"pendingYieldModal",cursor:Number(l==null?void 0:l.totalRewardUsd)<=0?"not-allowed":"pointer",checked:r.some(i=>(i==null?void 0:i.posType)=="clmm"?(i==null?void 0:i.posId)===(l==null?void 0:l.posId):(i==null?void 0:i.id)===(l==null?void 0:l.id))},l==null?void 0:l.posId)):H?[{},{}].map((l,i)=>e.jsx(ms,{},i)):e.jsx(Ye,{type:"nodata"})}),x?e.jsx(j,{w:"100%",p:"12px 16px 20px",bg:"bg_secondary",justify:"center",mt:"-8px",children:e.jsx(ee,{cursor:"pointer",w:"168px",h:"36px",lineHeight:"34px",mt:"12px",p:"0",borderRadius:"8px",onClick:()=>b(!1),sx:{_hover:{p:{color:"text_caption"},svg:{fill:"text_caption"}}},children:e.jsxs(j,{justify:"center",gap:"4px",children:[e.jsx(ys,{xlinkHref:"#icon-icon_ascending_nor",transform:"rotate(-90deg)"}),e.jsx(d,{children:"Back"})]})})}):e.jsx(ne,{w:"100%",p:"12px 16px 20px",bg:"bg_secondary",mt:"-8px",children:e.jsxs(j,{justify:"space-between",w:"100%",h:"90px",borderRadius:"16px",bg:"pending_yield_bg",p:"20px 16px",children:[e.jsxs(S,{gap:"4px",align:"flex-start",children:[e.jsx(d,{color:"primary_gray",children:"Amount selected"}),e.jsx(d,{color:"primary",fontSize:"18px",fontWeight:"500",children:W(P,2)})]}),e.jsxs(j,{children:[e.jsx(d,{color:"text_caption",children:"Select All"}),e.jsx(We,{checked:v=="all",onClick:Cs})]})]})})]}),x?e.jsx(ae,{mb:"-1px",isLoading:a,isDisabled:(U==null?void 0:U.length)==0||a,w:"100%",h:"52px",fontWeight:"500",onClick:()=>{Ls?He(!0):qe()},children:"Confirm"}):e.jsx(ae,{mb:"-1px",isDisabled:Number(P)<=0,w:"100%",h:"52px",fontWeight:"500",onClick:()=>b(!0),children:"Claim Yield"})]})})]})]}),ve&&e.jsx(tl,{isOpen:Ts,onClose:()=>He(!1),handleContinue:l=>{qe(),_s(!l)}})]})}function tl({isOpen:s,onClose:a,handleContinue:c}){const{isApp:w}=Te(),[u,x]=y.useState(!1);return e.jsxs(rs,{autoFocus:!1,returnFocusOnClose:!1,isOpen:s,onClose:a,isCentered:!0,children:[e.jsx(cs,{}),e.jsxs(xs,{minWidth:w?"300px":"446px",children:[e.jsx(ps,{children:e.jsx(us,{fontWeight:"500",fontSize:"16px",children:"Tips"})}),e.jsx(gs,{}),e.jsx(hs,{p:"16px",textAlign:"center",children:e.jsxs(S,{w:"100%",gap:"16px",children:[e.jsx(d,{color:"text_caption",fontSize:"14px",lineHeight:"20px",textAlign:"start",children:"Because your DLMM positions span a large number of bins, some actions may require multiple transaction approvals in your wallet."}),e.jsx(ee,{borderRadius:"12px",p:"12px",children:e.jsxs(j,{sx:{div:{svg:{fill:"#000 !important",w:"16px",h:"16px"}}},children:[e.jsx(We,{height:"16px",width:"16px",wrapStyle:{border:"1px solid",borderColor:u?"transparent":"primary",bg:u?"primary":"transparent"},checked:u,onClick:()=>{x(!u)}}),e.jsx(d,{fontSize:"12px",children:"Don't remind me again."})]})}),e.jsxs(j,{w:"100%",gap:"16px",children:[e.jsx(ae,{w:"100%",fontSize:"14px",variant:"outline",onClick:()=>{a()},children:"Cancel"}),e.jsx(ae,{w:"100%",fontSize:"14px",onClick:()=>{c(u),a()},children:"Continue"})]})]})})]})]})}const ss=({yieldList:s,isProfile:a=!1})=>{const[c,w]=y.useState(!1),{myPosYieldValue:u}=se();return Te(),e.jsx(S,{gap:"4px",align:"flex-start",onClick:x=>{x.stopPropagation(),w(!c)},onMouseEnter:()=>w(!0),onMouseLeave:()=>w(!1),children:e.jsxs(ts,{isLazy:!0,isOpen:c,placement:"bottom-end",gutter:2,closeDelay:500,children:[e.jsx(ns,{children:e.jsx(as,{as:"button",children:e.jsx(d,{cursor:Number(u)<=0?"text":"help",fontSize:{base:a?"16px":"20px",lg:"20px"},color:"primary_green",fontWeight:"500",textDecoration:Number(u)<=0?"none":"underline dotted",textUnderlineOffset:"2px",children:W(u,2)})})}),c&&(Number(u)>0||u=="--")&&(s==null?void 0:s.length)>0&&e.jsx(is,{children:e.jsx(os,{zIndex:"2",w:"fit-content",maxH:"200px",overflow:"auto",p:"4px 0",children:e.jsx(ds,{p:"0px",children:e.jsx(S,{w:"100%",align:"flex-start",bg:"bg_secondary",gap:"0px",children:s==null?void 0:s.map(x=>{var b;return console.log("ðŸš€ ~ {yieldList?.map ~ item:",x),e.jsxs(j,{w:"100%",p:"10px 12px",minW:"300px",justify:"space-between",children:[e.jsx(ue,{token:x==null?void 0:x.token,imgBoxStyle:{w:"20px",h:"20px"},haveName:!1,symbolFontSize:"12px",warningIcon:{iconW:"10px",iconH:"10px"}}),e.jsxs(j,{gap:"4px",children:[e.jsx(d,{fontSize:"12px",color:"text_caption",children:ge(x==null?void 0:x.amount,6)}),e.jsxs(d,{fontSize:"12px",children:["(",W(x==null?void 0:x.amountUSD,2),")"]})]})]},(b=x==null?void 0:x.token)==null?void 0:b.coin_type)})})})})})]})})};function Sl({isProfile:s=!1}){const{currentAccount:a}=he(),[c,w]=y.useState(!1),[u,x]=y.useState(!1),[b,L]=y.useState([]);Ue();const{coinPriceObj:_}=Ve(),{myPosYieldValue:A,setMyPosYieldValue:h,myClmmPosYieldValue:D,setMyClmmPosYieldValue:n,myDlmmPosYieldValue:m,setMyDlmmPosYieldValue:E,posFeeDataLoading:H,posRewardsDataLoading:G,farmsPosRewardsDataLoading:M,posBaseList:R,posLiquidityData:O,posBaseListLoading:Z,posLiquidityDataLoading:C,posFeeData:B,posRewardsData:r,farmsPosRewardsData:p}=se(),{dlmmPosBaseList:v,dlmmPosLiquidityData:F,dlmmPosBaseListLoading:P,dlmmPosRewardsDataLoading:Y,dlmmPosRewardsData:U,dlmmPosFeeData:q,dlmmPosFeeAndRewardsLoading:V}=ke(),{clmmTotalTvl:xe,dlmmTotalTvl:ie,liquidityTotalTvl:oe}=el(!1),je=a!=null&&a.address?Z:!1,ye=a!=null&&a.address?P:!1,{calculatePendingYield:K}=js();y.useEffect(()=>{if(!(a!=null&&a.address))h(""),L([]);else if(!Z&&(R==null?void 0:R.length)<=0&&!P&&(v==null?void 0:v.length)<=0&&(h("0"),L([])),((R==null?void 0:R.length)>0||(v==null?void 0:v.length)>0)&&(a!=null&&a.address)&&!Z&&!H&&!G&&!M&&!P&&!Y&&!V){console.log("ðŸš€ ~ useEffect ~ posBaseList:",{posBaseList:R,dlmmPosBaseList:v,posFeeData:B,posRewardsData:r,farmsPosRewardsData:p,dlmmPosFeeData:q,dlmmPosRewardsData:U});const{total:J,rewardAndFeeList:te}=K([...R,...v],B,r,p,q,U);h(J),L(te);const{total:_e}=K(R,B,r,p);n(_e);const{total:Le}=K(v,{},{},{},q,U);E(Le)}},[R,Z,H,G,M,P,Y,a,_,v,B,p,q,U,V]);const I=a!=null&&a.address?!A:!1,{isApp:le}=Te(),Q=y.useMemo(()=>Number(A)<=0||c,[A,c]);return e.jsxs(e.Fragment,{children:[s&&le?e.jsx(ee,{borderRadius:"12px",children:e.jsxs(j,{w:"100%",gap:"12px",justify:"space-between",children:[e.jsxs(S,{w:"50%",align:"flex-start",children:[e.jsx(d,{children:"Total Liquidity"}),e.jsx($,{isLoaded:!!oe||!(a!=null&&a.address),children:e.jsx(Se,{size:"l",children:e.jsx(ls,{totalTvl:oe,isProfile:!0,clmmTvl:xe,dlmmTvl:ie})})})]}),e.jsx(ne,{h:"44px",w:"1px",bg:"border"}),e.jsxs(S,{w:"50%",align:"flex-start",children:[e.jsxs(j,{w:"100%",justify:"space-between",children:[e.jsx(d,{children:"Claimable Yield"}),e.jsx(d,{fontSize:"12px",color:Q?"":"primary",onClick:Q?()=>{}:()=>x(!0),children:"Claim"})]}),e.jsx($,{isLoaded:!I,children:e.jsx(Se,{size:"l",children:e.jsx(ss,{yieldList:b,isProfile:!0})})})]})]})}):e.jsxs(Oe,{flexDir:{base:"column",lg:"row"},w:"100%",gap:"16px",children:[e.jsxs(j,{justifyContent:"space-between",w:{base:"100%",lg:"50%"},p:"0 20px",h:"80px",borderRadius:"14px",bgColor:"card_bg",bgImage:fs,backgroundSize:"100% 100%",children:[e.jsx(d,{fontSize:"16px",color:"primary_gray",children:"Total Liquidity"}),e.jsx($,{isLoaded:!!xe&&!!ie||!(a!=null&&a.address),children:e.jsx(Se,{size:"l",children:e.jsx(ls,{totalTvl:oe,clmmTvl:xe,dlmmTvl:ie})})})]}),e.jsxs(j,{justifyContent:"space-between",p:"0 20px",w:{base:"100%",lg:"50%"},h:"80px",borderRadius:"14px",bgColor:"card_bg",bgImage:ws,backgroundSize:"100% 100%",children:[e.jsx(d,{fontSize:"16px",color:"primary_gray",children:"Claimable Yield"}),e.jsx($,{isLoaded:!I,children:e.jsxs(j,{onClick:Q?()=>{}:()=>x(!0),children:[e.jsx(Se,{size:"l",children:e.jsx(ss,{yieldList:b})}),Number(A)>0&&e.jsx(ys,{xlinkHref:"#icon-icon_spread"}),e.jsx(ae,{isLoading:c,isDisabled:Q,w:{base:"unset",lg:"112px"},p:{base:"8px",lg:"unset"},h:{base:"28px",lg:"32px"},borderRadius:"8px",fontSize:{base:"12px",lg:"14px"},fontWeight:"500",children:"Claim All"})]})})]})]}),e.jsx(ll,{showLoading:je||ye,isOpen:u,claimLoading:c,onClose:()=>x(!1),changeClaimLoading:J=>w(J)})]})}const ls=({totalTvl:s,isProfile:a=!1,clmmTvl:c,dlmmTvl:w})=>{const{currentAccount:u}=he(),x=s=="--",b=s=="0",L=s!==void 0?Vs(T(!c||c==="--"?"0":c).div(s).mul(100).toString()):"--",_=[{value:c,title:"CLMM",color:"#4A9AEF",percent:L+"%"},{value:w,title:"DLMM",color:"#00D8B6",percent:L==="< 0.01"?"99.99%":L!=="--"?T(100).sub(L).toString()+"%":"--"}],A=h=>{const{payload:D}=h;return e.jsx(S,{w:"calc(100% - 60px)",align:"flex-start",justify:"center",gap:"4px",children:D.map((n,m)=>{var E,H,G,M,R;return e.jsxs(j,{w:"100%",gap:"4px",justify:"space-between",h:"20px",children:[e.jsxs(j,{gap:"6px",justify:"space-between",children:[e.jsx(ne,{style:{width:"8px",height:"8px",minWidth:"8px",minHeight:"8px",backgroundColor:(E=n.payload)==null?void 0:E.color,borderRadius:"2px"}}),e.jsxs(j,{gap:"2px",children:[e.jsx(d,{fontSize:"12px",children:(H=n.payload)==null?void 0:H.title}),e.jsx(d,{fontSize:"12px",color:(G=n.payload)==null?void 0:G.color,children:(M=n.payload)==null?void 0:M.percent})]})]}),e.jsxs(d,{textAlign:"right",fontSize:"12px",color:"text_caption",children:["$",Es((R=n.payload)==null?void 0:R.value,2)]})]},`item-${m}`)})})};return u!=null&&u.address?x||b?e.jsx(d,{fontSize:{base:a?"16px":"20px",lg:"20px"},color:"text_highlight",fontStyle:"500",children:x?"--":"$0"}):e.jsx(Ws,{tooltip:e.jsx(y.Suspense,{fallback:e.jsxs(j,{justify:"space-between",gap:"12px",w:"100%",children:[e.jsx(Fe,{w:"32px",h:"32px"}),e.jsxs(S,{w:"80px",gap:"4px",children:[e.jsx($,{w:"100%",h:"20px"}),e.jsx($,{w:"100%",h:"20px"})]}),e.jsxs(S,{w:"100px",gap:"4px",children:[e.jsx($,{w:"100%",h:"20px"}),e.jsx($,{w:"100%",h:"20px"})]})]}),children:e.jsxs(Ks,{width:240,height:44,children:[e.jsx(Qs,{data:_==null?void 0:_.map(h=>({...h,value:Number(h==null?void 0:h.value)})),cx:"10%",cy:"50%",innerRadius:9,outerRadius:16,fill:"#8884d8",dataKey:"value",strokeWidth:0,isAnimationActive:!1,children:_.map((h,D)=>e.jsx(Js,{fill:h==null?void 0:h.color},`cell-${D}`))}),e.jsx(Xs,{content:A,layout:"horizontal",align:"center",verticalAlign:"middle",wrapperStyle:{left:"56px"}})]})}),children:e.jsx(d,{fontSize:{base:a?"16px":"20px",lg:"20px"},color:"text_highlight",fontStyle:"500",textDecoration:"underline dotted",textUnderlineOffset:"2px",cursor:"help",children:W(s,2)})}):e.jsx(d,{fontSize:{base:a?"16px":"20px",lg:"20px"},color:"text_highlight",fontStyle:"500",children:"$0"})},Cl=({leftChildren:s,rightChildren:a})=>e.jsxs(Oe,{flexDir:{base:"column",lg:"row"},w:"100%",gap:{base:"12px",lg:"20px"},children:[e.jsx(j,{w:{base:"100%",lg:"50%"},p:{base:"0 12px ",lg:"0 20px"},h:{base:"60px",lg:"80px"},borderRadius:"14px",bgColor:"card_bg",bgImage:fs,backgroundSize:"100% 100%",children:s}),e.jsx(j,{p:{base:"0 12px ",lg:"0 20px"},w:{base:"100%",lg:"50%"},h:{base:"60px",lg:"80px"},borderRadius:"14px",bgColor:"card_bg",bgImage:ws,backgroundSize:"100% 100%",children:a})]});export{Cl as L,bs as M,Sl as a,wl as b,el as u};
