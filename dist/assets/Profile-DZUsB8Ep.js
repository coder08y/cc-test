import{r as d,j as e,H as S,T as b,V,w as $,B as Y,C as ee,Z as tt,M as st,o as nt,p as ot,$ as it,q as at,t as lt,ac as be,n as rt,m as je,L as Tt,N as kt,I as Pt,af as Lt,l as Ee,a8 as Ot,F as Dt}from"./vendor-CBmAETR3.js";import{P as Rt,a as At,b as Ft}from"./PositionTypeAndCollapse-KcFDLp6P.js";import{a as ge,c as ct,j as zt,p as Vt,i as Ht,k as Mt,h as Et,g as Ut,f as Bt}from"./usePositionList-5SlPZsY2.js";import{u as Wt}from"./useFavoritePool-D10BRIh4.js";import{u as xe,a as Ue,b as $t,d as Nt,c as Xt}from"./useGetPythTokenPrice-DxHNOitR.js";import{u as I,w as Le,M as G,k as Oe,Q as he,l as pt,d as H,as as It,C as ae,S as we,E as te,p as ce,B as oe,av as Be,s as Ke,cW as Pe,I as N,c as Gt,a as qt,an as Kt,b3 as Qt,i as We,e as dt,G as ue,ad as Yt,A as xt,t as Jt,a5 as ut,a8 as Zt,j as ne,N as ie,$ as ye,f as pe,cY as es,cX as Qe,V as ke,dy as ts,z as ss,U as ns,cV as Ye,al as Je,aq as os}from"./index-ihcskjKt.js";import{T as is,n as as,B as ls}from"./cross-CbhIs7DK.js";import{a as rs,u as cs}from"./LiquidityAndYield-DOGWqOwH.js";import{u as se}from"./activeOrders-CRpxOhzY.js";import{N as le}from"./NoData-BFX9XpKb.js";import{C as ps}from"./CoinPairInfo-CDiS7h0Q.js";import{a as gt,F as ds}from"./VaultsAction-DL-ibFN1.js";import{a as xs,V as us}from"./VaultsPcTab-DSC6pjys.js";import{V as gs}from"./PositionItem-Bu3y-Fls.js";import{f as ht,c as ft,g as hs,h as fs,i as ms}from"./VaultsAprBlock-CTWozlz-.js";import{H as De}from"./H5MapTable-CpOBMbH2.js";import{T as Re,P as Ae}from"./Table-CmEnXJpd.js";import{S as mt}from"./SortDropBlock-CVcQDwBs.js";import{T as me}from"./TableSortTh-CJhvMpou.js";import{H as J}from"./HiddenDotted-9cZ5UVdD.js";import{u as bt,D as jt,g as bs,c as js,d as ws,W as ys,b as Cs,R as vs,a as _s}from"./OverviewOrders-CiahcvS2.js";import{I as Ze}from"./IconText-CE1HaJRf.js";import{u as Ss}from"./useTokenRank-CM-9-tXe.js";import{D as Fe}from"./Drawer-DX1wga2y.js";import{H as re}from"./HTextLabelBox-Cv1F2u1A.js";import{b as Ts,u as Ce,c as ks,C as Ps,P as Ls,F as Os,E as Ds,S as Rs,O as As,a as Fs}from"./useGetLimitOrderHistory-rZ7WzPDR.js";import{u as zs}from"./useRpcListener-Dj_lqr51.js";import{R as Vs}from"./RefreshButton-DtwRJDvy.js";import{u as Hs,A as Ms,R as Es}from"./RecentTransactions-B9h5zGYt.js";import{A as Us}from"./AccountSwitchDrawer-CDxlTk5s.js";import{u as Bs}from"./useAccountBalance-D7pkS3C9.js";import{f as $e,a as Ws,b as $s,u as Ns,X as Xs,c as Is,C as Gs,e as qs,d as Ks,g as Qs}from"./useXCetus-CCi5WG5A.js";import{u as Ys}from"./useTokenBalance-EOIPKTy-.js";import{b as Js}from"./useGetDcaOrderHistory-D2emN1Os.js";import{X as Zs,e as en,f as tn,g as sn}from"./useXCetusHelper-CrXtSO0d.js";import"./PositionItemContent-Cx-1mfww.js";import"./useTransaction-BEUdFaaa.js";import"./useTrack-Cu3it5QI.js";import"./v4-C6aID195.js";import"./useSigner-C1gsxlX5.js";import"./useTransactionModal-DhEdYJgg.js";import"./detail-BQ6q8Dje.js";import"./dlmm-B3MPeVqN.js";import"./utils-GUDa3Y46.js";import"./useWrapPoolData-CzWcfmSl.js";import"./en_US-KAK2ZBDO-7b1QhAeP.js";import"./usePosClaimFeeAndReward-R-HkZji1.js";import"./msafe-BzcjPV-e.js";import"./LiquidityValueBlock-DS5y0rnC.js";import"./usePosRemove-CKs7-Z6Q.js";import"./index-BgZD3vRA.js";import"./debounce-MPJy35Ge.js";import"./index-D8UqOC8m.js";import"./useInterval-FApnpfRj.js";import"./TooltipIcon-CBgjM1b2.js";import"./StatusPosition-CmUwds3p.js";import"./icon_active_new@2x-Bekkt6Xc.js";import"./useGetClmmPositionDailyEarning-BB_IEQSI.js";import"./detail-BpvHUFYz.js";import"./PositionPriceRangeBar-B3Gr2ilx.js";import"./PositionCurrentPrice-DCdJgKoa.js";import"./DLMMPositionItem-CmHH6WC2.js";import"./useFavoriteDlmmPool-Kbo6eRe5.js";import"./useGetDlmmPoolList-x-FGvX6E.js";import"./CheckBox-CkL01dAe.js";import"./SearchInputBlock-DFqrJwWo.js";import"./VaultsTab-r6AZjrkT.js";import"./index-DCf0hNUB.js";import"./Loading-DOvYGudd.js";import"./useGetPoolList-BxNmDN4c.js";import"./PieChart-Dq5PRqbH.js";import"./generateCategoricalChart-DzovH4HE.js";import"./config-DTm0VBgZ.js";import"./PoolTag-DVhitHGR.js";import"./BackButton-B9dAauAl.js";import"./Slippage-C7lPdRZI.js";import"./index-78J_CBpj.js";import"./RemoveBlock-BSsuAUPi.js";import"./addLiquidity-ByI4XtN_.js";import"./FreshProgressV2-CqkEOvHy.js";import"./index-CgYRIMgB.js";import"./index-Dq_SzPY7.js";import"./useSwapHelper-CDwInMwe.js";import"./index-GwPPDvta.js";import"./TradeInputGroup-Cg8Otj2e.js";import"./_baseClone-CJALfsQC.js";import"./_getAllKeysIn-BPcro3FP.js";import"./_defineProperty-BPanLZZj.js";import"./last-CTTiHFcU.js";import"./TradeConfirmAmountInfo-D6pugXWx.js";import"./TotalAmount-DPW4Igd_.js";import"./ErrorTips-D8Nv331n.js";import"./RemoveBlock-6_DpKj6X.js";import"./DepositRatio-BcoJdhLk.js";import"./WithTooltipInfo-DeNHsACa.js";import"./usePriceImpact-C25MtScm.js";import"./MarketSource-o58kgnsh.js";import"./useCurrentPos-qZJLM1cy.js";import"./usePosAdd-B-P_wwAw.js";import"./AutoClaimCheckBox-DmJqgBp6.js";import"./ExpendItem-ClLvPdQF.js";import"./RangeValue-B4jAazPi.js";import"./useFindBestRouting-BrNyL9M1.js";import"./VTextLabelBox-YDTOuudM.js";import"./usePreviousValue-Da-o2xpb.js";import"./HighlightText-Dw_TnRsZ.js";function nn(t=100){const n=d.useRef([]),s=d.useRef(!1),c=d.useRef(void 0),l=d.useCallback(async()=>{if(!s.current){for(s.current=!0;n.current.length>0;){const a=n.current.shift();if(!a)continue;const{id:o,run:r,onStart:x,onSuccess:h,onError:u}=a;if(a._cancelled){console.log(`[task:${a.id}] skipped (cancelled)`);continue}try{console.log(`[task:${o}] start`),x==null||x(o);const g=await r(c.current,o);c.current=g,console.log(`[task:${o}] success`,g),h==null||h(g,o)}catch(g){console.error(`[task:${o}] failed`,g),u==null||u(g,o)}await new Promise(g=>setTimeout(g,t))}s.current=!1}},[t]),i=a=>{n.current.push(a),l()},p=a=>{const o=n.current.find(r=>r.id===a);o&&(o._cancelled=!0),n.current=n.current.filter(r=>r.id!==a)};return d.useEffect(()=>()=>{n.current=[],s.current=!1,c.current=void 0},[]),{addTask:i,removeTask:p}}function Ne(t){const{type:n,children:s,wrapStyle:c,menuHeight:l="60px",haveActiveLine:i=!0,textStyle:p={fontSize:"16px"}}=t,a=(o,r)=>"title"in t?!1:t!=null&&t.isActive?t==null?void 0:t.isActive(o,r):o===r.value;return I(),e.jsxs(S,{justify:"space-between",w:"100%",h:l,...c,sx:{">div":{p:{"&:before":{bg:i?"primary":"none"}}}},children:["title"in t?e.jsx(b,{color:"text_caption",...p,children:t==null?void 0:t.title}):e.jsx(Le,{type:"borderTab",tabList:t.tabs,currentTab:t.currentTab,handleChangeTab:t.onTabChange,isActive:(o,r)=>a(o,r),wrapStyle:{h:l,border:"none",gap:"38px",...c},itemStyle:p}),s]})}function on({showPosListGroupByPool:t=[]}){const{currentAccount:n,onWalletModal:s}=G(),{posBaseListLoading:c}=ge(),{isAutoRefresh:l}=se(),{isApp:i}=I();return e.jsxs(V,{w:"100%",children:[e.jsx(rs,{isProfile:!0}),n!=null&&n.address?!l&&c?e.jsx(V,{width:"100%",mt:i?"0px":"8px",children:[{},{},{},{}].map((p,a)=>e.jsx(Rt,{},a))}):(t==null?void 0:t.length)>0?e.jsx(V,{width:"100%",mt:i?"0px":"8px",children:t==null?void 0:t.map((p,a)=>e.jsx(At,{poolInfo:p},(p==null?void 0:p.clmmPoolAddress)||(p==null?void 0:p.dlmmPoolAddress)))}):e.jsx(le,{type:"nodata",text:"No Liquidity Positions",noBorder:!0}):e.jsx(le,{type:"nowallet",onboard:()=>s(!0),noBorder:!0})]})}function an({poolInfo:t}){const{setProfileActionTab:n,isProfileOpenVaultModal:s,setIsProfileOpenVaultModal:c,clearVaultsActionData:l,setProfilePoolInfo:i,setCurrTab:p}=gt();return d.useEffect(()=>{l()},[s]),e.jsx(e.Fragment,{children:e.jsxs(S,{justify:"flex-end",flexDirection:{base:"row-reverse",lg:"row"},w:{base:"100%",lg:"unset"},children:[e.jsx($,{onClick:a=>{a.stopPropagation(),p("Deposit"),i(t),c(!0)},h:"32px",fontSize:"12px",borderRadius:"8px",fontWeight:"500",p:"0 8px",w:{base:"calc(50vw - 26px)",lg:"unset"},children:"Deposit"}),e.jsx($,{onClick:a=>{a.stopPropagation(),p("Withdraw"),i(t),c(!0)},variant:"outline",h:"32px",fontSize:"12px",borderRadius:"8px",fontWeight:"500",p:"0 8px",w:{base:"calc(50vw - 26px)",lg:"unset"},children:"Withdraw"})]})})}function ln({selectCoinList:t=[],currentTab:n,setCurrentTab:s}){const{vaultsPositionObj:c}=xe(),{vaultPageList:l,vaultListLoading:i,setVaultListLoading:p,setVaultPageList:a}=Ue(),{filterVaultList:o}=ht(),{profileActionTab:r,isProfileOpenVaultModal:x,setIsProfileOpenVaultModal:h,setProfilePoolInfo:u,profilePoolInfo:g,setCurrTab:m}=gt(),{coinPriceObj:R}=Oe(),{getTokenAmountValue:T}=he(),{getTokenAmountValueByPyth:L}=$t(),{pythPriceMap:M}=Nt(),{isAutoRefresh:C}=se(),{isApp:k}=I(),[j,_]=d.useState([]),[O,D]=d.useState("desc"),[v,f]=d.useState({label:"",value:""}),y=!0,P={sortRule:"desc",sortType:"tvl"},A=[{label:"Your Holdings",value:"holdings"},{label:"Share of Pool",value:"shareOfPool"}],E=Object.fromEntries(A.map(W=>[W.value,W])),F=(W,X,q)=>W.category==="haedal"?L(X,q):T(X,q,"--"),[U,B]=d.useState(!1);d.useEffect(()=>{console.log("ðŸš€ðŸš€ðŸš€ ~ ProfileVaults.tsx:67 ~ useEffect ~ vaultPageList:",l,!v.value),v.value||_(l)},[l]),d.useEffect(()=>{pt(c)&&o({sortOptions:P,currentTab:n.value,isYourHoldings:y,selectCoinList:t},void 0)},[c,t.length,n.value]),d.useEffect(()=>{if(v.value){const W=l.map(X=>{const q=c[X==null?void 0:X.vaultId]||{},Ie=F(X,q.displayCoinTypeA,q.displayAmountA),Ge=F(X,q.displayCoinTypeB,q.displayAmountB),qe=Ie==="--"||Ge==="--"?"0":H(Ie).plus(Ge||0).toString();return{...X,sharePoolRate:q==null?void 0:q.sharePoolRate,holdingAmount:parseFloat(qe||"0"),holdingAmountDisplay:It(qe,"$")}}).sort((X,q)=>O==="asc"?v.value==="holdings"?X.holdingAmount-q.holdingAmount:X.sharePoolRate-q.sharePoolRate:v.value==="holdings"?q.holdingAmount-X.holdingAmount:q.sharePoolRate-X.sharePoolRate);console.log("ðŸš€ðŸš€ðŸš€ ~ ProfileVaults.tsx:86 ~ useEffect ~ sorted:",W),_(W)}},[l.length,v.value,O,R,M]);const Q=W=>{(W==null?void 0:W.value)!==(v==null?void 0:v.value)?(f(W),D("desc")):k||D(X=>X==="desc"?"asc":"desc")},{vaultsFarmObj:Z}=ft(),w=rn({isShowPowered:n!=="haedal",vaultsPositionObj:c,getAmountValue:F,sortRule:O,sortBy:v,sortByObject:E,clickSort:Q,vaultsFarmObj:Z}),{currentAccount:z}=G();d.useEffect(()=>{_([]),p(!0),z!=null&&z.address||a([])},[z==null?void 0:z.address]);const K=W=>{console.log("ðŸš€ðŸš€ðŸš€ ~ ProfileVaults.tsx:135 ~ handleVaultsTab ~ data:",W),s(W),o({sortOptions:P,currentTab:W.value,isYourHoldings:y,selectCoinList:t})},[fe,de]=d.useState(!1),[ve,_e]=d.useState("Stake");return e.jsxs(V,{w:"100%",align:"flex-start",children:[k&&e.jsx(Y,{zIndex:"3",children:e.jsx(mt,{sortText:"Sort by",minW:"calc(100vw - 76px)",currentSort:v,sortByList:A,onSortByChange:Q,xlinkHref:O==="desc"?"#icon-icon_sort2":"#icon-icon_sort_asc1",iconOnClick:()=>D(W=>W==="desc"?"asc":"desc")})}),!k&&e.jsx(xs,{currentTab:n,onClickVaultsTab:W=>K(W)}),e.jsx(V,{w:"100%",gap:"20px",children:(C||!i)&&j.length===0?e.jsx(le,{type:"nodata",text:"No vaults found",noBorder:!0}):k?e.jsx(De,{rowKey:"clmmPoolAddress",columns:w,dataSource:j,loading:!C&&(i||U),itemSkeletonLength:5,itemHeight:"30px",haveDividingLine:!1,rowStyle:()=>({borderRadius:"12px",border:"1px solid",borderColor:"border",bg:"bg_secondary",p:"12px 8px"})}):e.jsx(Re,{rowKey:"clmmPoolAddress",columns:w,dataSource:j,loading:!C&&(i||U),rowStyle:{h:"80px",cursor:"pointer"},onRowClick:W=>{m("Deposit"),h(!0),u(W)}})}),x&&e.jsx(gs,{isOpen:x,setIsOpenFarmingModal:de,setFarmingModalAction:_e,setIsOpen:h,...g,vaultId:g.vaultId,onClose:()=>{h(!1)}},g.vaultId),fe&&e.jsx(ds,{isOpen:fe,setIsOpen:de,setIsOpenPre:h,onClose:()=>de(!1),farmingModalAction:ve,vaultsId:g==null?void 0:g.vaultId,isDetail:!1})]})}const rn=({isShowPowered:t,vaultsPositionObj:n,getAmountValue:s,sortRule:c,sortBy:l,sortByObject:i,clickSort:p,vaultsFarmObj:a})=>[{title:e.jsx(b,{children:"Pools"}),key:"pools",showLabel:!1,thConfig:{pl:"0px !important"},render:o=>{var x;const r=(x=a[o==null?void 0:o.vaultId])==null?void 0:x.isVaultsFarming;return e.jsx(ps,{poolInfo:{...o,poolAddress:o==null?void 0:o.vaultId,poolType:"clmm"},isShowPowered:t&&(o==null?void 0:o.category)!=="cetus",isShowVaultsFarmIcon:r,symbolFontSize:"15px",showPoolTypeTag:!0,type:"column"})}},{title:e.jsx(me,{labelInfo:i.holdings,defaultShowSortIcon:!0,sortBy:l,sortRule:c,clickSort:o=>p(o)}),key:"holdings",render:o=>{var u,g,m,R,T,L;const r=n[o==null?void 0:o.vaultId]||{},x=s(o,(u=o==null?void 0:o.displayTokenA)==null?void 0:u.coin_type,r==null?void 0:r.displayAmountA),h=s(o,(g=o==null?void 0:o.displayTokenB)==null?void 0:g.coin_type,r==null?void 0:r.displayAmountB);return e.jsx(ae,{placement:"top",tooltip:e.jsxs(V,{gap:"8px",align:"flex-start",minW:"200px",children:[e.jsxs(S,{w:"100%",gap:"12px",justify:"space-between",children:[e.jsxs(S,{children:[e.jsx(we,{imageUrl:(m=o==null?void 0:o.displayTokenA)==null?void 0:m.logo_url,imgBoxStyle:{w:"20px",h:"20px"}}),e.jsx(b,{color:"text_caption",fontSize:"12px",children:(R=o==null?void 0:o.displayTokenA)==null?void 0:R.symbol})]}),e.jsx(J,{children:e.jsxs(V,{align:"flex-end",children:[e.jsx(b,{color:"text_caption",fontSize:"12px",children:te(r==null?void 0:r.displayAmountA)}),e.jsx(b,{fontSize:"12px",children:!x||x=="--"?"$--":ce(x,2)})]})})]}),e.jsx(Y,{w:"100%",height:"1px",bg:"border"}),e.jsxs(S,{w:"100%",gap:"12px",justify:"space-between",children:[e.jsxs(S,{children:[e.jsx(we,{imageUrl:(T=o==null?void 0:o.displayTokenB)==null?void 0:T.logo_url,imgBoxStyle:{w:"20px",h:"20px"}}),e.jsx(b,{color:"text_caption",fontSize:"12px",children:(L=o==null?void 0:o.displayTokenB)==null?void 0:L.symbol})]}),e.jsx(J,{children:e.jsxs(V,{align:"flex-end",children:[e.jsx(b,{color:"text_caption",fontSize:"12px",children:te(r==null?void 0:r.displayAmountB)}),e.jsx(b,{fontSize:"12px",children:!h||h=="--"?"$--":ce(h,2)})]})})]})]}),children:e.jsx(ee,{as:"button",ml:"4px",children:e.jsx(J,{children:e.jsxs(S,{justifyContent:"flex-end",gap:"0",children:[e.jsx(b,{color:"text_caption",mr:"2px",textDecoration:"underline dotted",textDecorationColor:"text_paragraph",textUnderlineOffset:"3px",children:`${(r==null?void 0:r.balanceDisplay)||"0"} LP`}),e.jsx(b,{children:"("}),e.jsx(us,{color:"text_paragraph",vaultId:o.vaultId,category:o.category}),e.jsx(b,{children:")"})]})})})})}},{title:e.jsx(me,{labelInfo:i.shareOfPool,defaultShowSortIcon:!0,sortBy:l,sortRule:c,clickSort:o=>p(o)}),key:"shareOfPool",render:o=>{const r=n[o==null?void 0:o.vaultId]||{};return e.jsx(S,{justify:"flex-end",children:e.jsx(J,{children:e.jsxs(b,{color:"text_caption",children:[" ",r==null?void 0:r.shartOfPoolDisplay]})})})}},{title:e.jsx(b,{textAlign:"right",children:"Actions"}),key:"actions",showLabel:!1,render:o=>e.jsx(an,{poolInfo:o})}];function cn(){const{currentAccount:t}=G(),{vaultsPositionLoading:n}=xe(),{showPosListLength:s,posBaseListLoading:c,setShowPosListLength:l}=ge(),{showVaultsListLength:i}=xe(),{isExpendPositionMap:p,clearIsExpendPositionMap:a}=Wt(),[o,r]=d.useState([]),{getPositionBaseList:x}=ct(),h=async f=>{await x(f)},u=f=>{r(y=>[...y,f])},g=f=>{r(y=>y.filter(P=>(P==null?void 0:P.coin_type)!==(f==null?void 0:f.coin_type)))};d.useEffect(()=>{t!=null&&t.address?h(t==null?void 0:t.address):l({})},[t==null?void 0:t.address]),d.useEffect(()=>()=>{l({})},[]);const[m,R]=d.useState("positions"),T=d.useMemo(()=>c?"":H((s==null?void 0:s.clmm_position_count)??0).plus((s==null?void 0:s.dlmm_position_count)??0).toString()||"",[c,s,o]),L=d.useMemo(()=>n?"":Number(i)>0?i:"",[n,i,o]),M=d.useMemo(()=>[{label:"Positions",value:"positions",num:T},{label:"Vaults",value:"vaults",num:L}],[o,T,L]),[C,k]=d.useState([]),j=f=>{k(f)},{isApp:_}=I(),[O,D]=d.useState({label:"All",value:"all"}),{vaultsTokenList:v}=Ue();return d.useEffect(()=>()=>{a()},[]),e.jsx(oe,{borderRadius:"16px",p:{base:"0",lg:"0px 0px 16px"},bg:{base:"none",lg:"none"},backdropFilter:{base:"none",lg:"blur(20px)"},border:"none",mt:{base:"-12px",lg:"-6px"},children:e.jsxs(V,{gap:{base:"8px",lg:"16px"},w:"100%",children:[e.jsxs(S,{w:"100%",gap:"12px",justify:"space-between",flexDirection:{base:"column",lg:"row"},children:[e.jsx(Ne,{type:"tab",currentTab:m,tabs:M,menuHeight:_?"48px":"60px",onTabChange:f=>{r([]),R(f.value)},textStyle:{fontSize:"16px"},wrapStyle:{bg:"none"}}),e.jsx(S,{w:{base:"100%",lg:"unset"},children:e.jsx(Ft,{isProfile:!0,isVaults:m=="vaults",currentTab:O,setCurrentTab:D,whiteTokenList:m=="vaults"?v:void 0,isShowChildren:m!=="vaults"&&H(T).gt(0),handleRefresh:()=>{},selectCoinList:o,onClickSelectCoinList:u,onDeleteSelectCoinList:g,showPosListGroupByPool:C,changeShowPosListGroupByPool:j})})]}),m==="positions"&&e.jsx(on,{showPosListGroupByPool:C}),m==="vaults"&&e.jsx(ln,{selectCoinList:o,currentTab:O,setCurrentTab:D})]})})}function pn({orderInfo:t,isActiveOrder:n,pageDirect:s}){const{inCoin:c,outCoin:l}=t,{orderHistoryList:i,handleGetDcaOrderHistory:p,orderHistoryListLoading:a}=bt();d.useEffect(()=>{t!=null&&t.orderID&&p(t==null?void 0:t.orderID,9999,0,!0)},[t==null?void 0:t.orderID]);const{getExplorerUrl:o}=Be(),[r,x]=d.useState(s),h=142,u=(i==null?void 0:i.length)||0,g=(i==null?void 0:i.length)==0?"0px":(i==null?void 0:i.length)<=1?`${h*u+8}px`:`${h*u+(u-1)*32+8}px`;return e.jsxs(V,{pb:"16px",align:"flex-start",w:"100%",gap:"32px",position:"relative",h:(i==null?void 0:i.length)>=3?"460px":"unset",overflowY:"auto",children:[!a&&e.jsx(Y,{w:"0px",h:g,borderRight:"1px dashed",borderColor:"border",position:"absolute",left:"6px",top:"8px"}),a?e.jsx(S,{h:"100px",w:"100%",justify:"center",children:e.jsx(tt,{})}):(i==null?void 0:i.length)===0?e.jsx(le,{type:"nodata",text:"No orders",p:"12px",bg:"none"}):i.map(m=>{const R=Ke(m.inAmount,c==null?void 0:c.decimals),T=Ke(m.outAmount,l==null?void 0:l.decimals),L=H(R).div(T).toString(),M=H(1).div(L).toString();return e.jsxs(V,{pl:"20px",align:"flex-start",w:"100%",children:[e.jsxs(S,{w:"100%",gap:"16px",justifyContent:"space-between",position:"relative",children:[e.jsxs(b,{h:"20px",lineHeight:"20px",children:[Pe((m==null?void 0:m.time)*1e3)," (UTC)"]}),e.jsx(N,{fontSize:"16px",xlinkHref:"#icon-icon_link1",onClick:()=>{window.open(o(m==null?void 0:m.tx,"tx"))}}),e.jsx(S,{justify:"center",h:"12px",w:"12px",bg:"primary_opacity.20",position:"absolute",left:"-20px",top:"4px",zIndex:"99999",borderRadius:"50%",children:e.jsx(Y,{h:"6px",w:"6px",bg:"primary",borderRadius:"50%"})})]}),e.jsx(oe,{p:"16px",borderRadius:"12px",children:e.jsxs(V,{align:"flex-start",gap:"16px",children:[e.jsxs(V,{gap:"4px",align:"flex-start",children:[e.jsx(b,{whiteSpace:"nowrap",color:"text_caption",fontSize:"16px",h:"20px",lineHeight:"20px",children:r?`${te(L)} `:`${te(M)} `}),e.jsxs(S,{children:[e.jsx(b,{whiteSpace:"nowrap",h:"20px",fontSize:"12px",lineHeight:"20px",children:r?` ${c.symbol} per ${l.symbol}`:` ${l.symbol} per ${c.symbol}`}),e.jsx(N,{xlinkHref:"#icon-icon_swap1",svgW:"14px",svgH:"14px",ml:"-6px",onClick:()=>x(!r)})]})]}),e.jsxs(S,{w:"100%",gap:"4px",children:[e.jsx(we,{imageUrl:c==null?void 0:c.logo_url,w:"20px",h:"20px"}),e.jsx(b,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:`${te(R)}`}),e.jsx(b,{whiteSpace:"nowrap",h:"20px",lineHeight:"20px",children:` ${c.symbol}`}),e.jsx(b,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:" â†’ "}),e.jsx(we,{imageUrl:l==null?void 0:l.logo_url,w:"20px",h:"20px"}),e.jsx(b,{whiteSpace:"nowrap",color:"text_caption",h:"20px",lineHeight:"20px",children:`${te(T)}`}),e.jsx(b,{whiteSpace:"nowrap",h:"20px",lineHeight:"20px",children:`${l.symbol}`})]})]})})]},m==null?void 0:m.tx)})]})}function dn({orderInfo:t,isActiveOrder:n,pageDirect:s,isClaimLoading:c=!1,toClaim:l}){const{inCoin:i,outCoin:p}=t;return e.jsxs(V,{pb:"24px",children:[(t==null?void 0:t.isShowTradeTips)&&(t==null?void 0:t.orderStatus)=="Active"&&n&&e.jsx(xn,{}),e.jsxs(S,{w:"100%",justify:"space-between",children:[e.jsx(jt,{orderInfo:t}),n&&l&&e.jsx($,{isLoading:c,onClick:()=>l(t),isDisabled:(t==null?void 0:t.outBalance)<=0||c,h:"32px",fontSize:"12px",borderRadius:"8px",lineHeight:"32px",p:"0 8px",fontWeight:"500",children:"Claim"})]}),e.jsx(b,{fontSize:"16px",color:"text_caption",children:bs(t,n,!0)}),e.jsx(b,{fontSize:"12px",children:"Amount Withdrawn"}),e.jsxs(S,{w:"100%",justify:"space-around",children:[e.jsxs(V,{children:[e.jsx(b,{fontSize:"16px",color:"text_caption",children:js(t)}),e.jsxs(b,{fontSize:"12px",children:["DCA ",i==null?void 0:i.symbol," Balance"]})]}),e.jsx(Y,{as:"span",display:"inline-block",w:"1px",h:"20px",bg:"border"}),e.jsxs(V,{children:[e.jsx(b,{color:"text_caption",fontSize:"16px",children:ws(t)}),e.jsxs(b,{fontSize:"12px",children:["DCA ",p==null?void 0:p.symbol," Balance "]})]})]}),e.jsxs(V,{mt:"28px",w:"100%",gap:"20px",children:[e.jsx(re,{label:"Invest Every",value:t==null?void 0:t.investEvery}),H(t==null?void 0:t.ofOrderLeft).gt("0")&&e.jsx(re,{label:"Orders Left",value:t==null?void 0:t.ofOrderLeft}),e.jsx(re,{label:"Each Order Size",value:`${t==null?void 0:t.eachOrderSize} ${i==null?void 0:i.symbol}`}),n&&((t==null?void 0:t.currentAvgPrice)&&(t==null?void 0:t.currentAvgPrice)!=="--"||(t==null?void 0:t.currentAvgPriceResever)&&(t==null?void 0:t.currentAvgPriceResever)!=="--")&&e.jsx(re,{label:"Current Avg. Price",value:s?`${t==null?void 0:t.currentAvgPrice} ${i==null?void 0:i.symbol} per ${p==null?void 0:p.symbol}`:`${t==null?void 0:t.currentAvgPriceResever} ${p==null?void 0:p.symbol} per ${i==null?void 0:i.symbol}`}),!n&&(t==null?void 0:t.currentAvgPrice)!=="--"&&e.jsx(re,{label:"Avg. Price",value:s?`${t==null?void 0:t.currentAvgPrice} ${i==null?void 0:i.symbol} per ${p==null?void 0:p.symbol}`:`${t==null?void 0:t.currentAvgPriceResever} ${p==null?void 0:p.symbol} per ${i==null?void 0:i.symbol}`}),n&&e.jsx(re,{label:"Next Order (UTC)",value:Pe(t==null?void 0:t.nextCycleAtTimeStamp)||""}),e.jsx(re,{label:"Created (UTC)",value:Pe((t==null?void 0:t.created_at)*1e3)||""})]})]})}const xn=()=>{const[t,n]=d.useState(!1);return e.jsxs(V,{p:"12px",align:"flex-start",bg:"primary_yellow_opacity.10",borderRadius:"8px",children:[e.jsxs(S,{align:"center",w:"100%",cursor:"pointer",onClick:()=>n(!t),children:[e.jsx(b,{fontSize:"12px",color:"primary_yellow",lineHeight:"20px",textAlign:"left",children:"The system tried to execute your order multiple times but did not get it through. This is possibly because:"}),e.jsx(N,{transform:t?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.5s",svgW:"12px",svgH:"12px",variant:"warning",xlinkHref:"#icon-icon_arrow"})]}),t&&e.jsxs(V,{align:"flex-start",w:"100%",children:[e.jsx(Y,{w:"100%",h:"1px",bg:"primary_yellow_opacity.10",m:"4px 0"}),e.jsx(ys,{})]})]})};function un({isOpen:t,onClose:n,orderInfo:s,isActiveOrder:c,isClaimLoading:l=!1,toClaim:i}){const{isApp:p}=I(),[a,o]=d.useState("overview"),{inCoin:r,outCoin:x}=s||{},h=[{label:"Overview",value:"overview"},{label:"Orders",value:"orders"}],[u,g]=d.useState(!1),{getTokenRank:m}=Ss();d.useEffect(()=>{if(r!=null&&r.coin_type&&(x!=null&&x.coin_type)){const L=m(r,x);console.log("ðŸš€ ~ TokenRank:",x,r,L),g(!L)}},[r==null?void 0:r.coin_type,x==null?void 0:x.coin_type]);const R=e.jsx(Y,{w:"100%",borderBottom:"1px solid",borderColor:"border",children:e.jsx(Ne,{type:"tab",currentTab:a,tabs:h,onTabChange:L=>o(L.value),textStyle:{fontSize:"16px"},wrapStyle:{bg:"none",mt:"-12px",mb:"-4px"}})}),T=e.jsxs(e.Fragment,{children:[a==="overview"&&e.jsx(dn,{orderInfo:s,isActiveOrder:c,pageDirect:u,isClaimLoading:l,toClaim:i}),a==="orders"&&e.jsx(pn,{orderInfo:s,isActiveOrder:c,pageDirect:u})]});return p?e.jsx(gn,{isOpen:t,onClose:n,renderTabs:R,renderContent:T}):e.jsxs(st,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:n,isCentered:!0,children:[e.jsx(nt,{}),e.jsxs(ot,{minWidth:"482px",children:[e.jsx(it,{children:R}),e.jsx(at,{}),e.jsx(lt,{p:"0 16px 0px",textAlign:"center",children:T})]})]})}function gn({isOpen:t,onClose:n,renderTabs:s,renderContent:c}){return console.log("DetailDrawer rendered",t),e.jsxs(Fe,{isOpen:t,onClose:n,placement:"bottom",haveCloseButton:!0,children:[s,e.jsx(Y,{h:"20px"}),c]})}function hn({orderInfo:t,isActiveOrder:n=!0}){const{isApp:s}=I(),[c,l]=d.useState(!1),{getExplorerUrl:i}=Be(),{isClaimLoading:p,toClaim:a,closeOrderAction:o,isCloseLoading:r}=bt(),{isOpen:x,onOpen:h,onClose:u}=be(),g=()=>l(!0),m=()=>{r||o(t)},R=(t==null?void 0:t.outBalance)<=0||p;return e.jsxs(e.Fragment,{children:[e.jsx(S,{justify:"flex-end",children:n?e.jsxs(e.Fragment,{children:[e.jsx($,{isLoading:p,onClick:()=>a(t),isDisabled:R,h:"32px",fontSize:"12px",borderRadius:"8px",fontWeight:"500",p:"0 8px",w:{base:"calc(50vw - 45px)",lg:"unset"},children:"Claim"}),e.jsx($,{isLoading:r,onClick:m,isDisabled:r,h:"32px",fontSize:"12px",borderRadius:"8px",fontWeight:"500",p:"0 8px",w:{base:"calc(50vw - 45px)",lg:"unset"},children:(t==null?void 0:t.outBalance)<=0?"Close":"Close and Withdraw"}),e.jsx(ae,{placement:"bottom-end",showTooltip:!s,tooltip:e.jsx(wt,{getExplorerUrl:i,orderInfo:t,handleOpenDetail:g}),children:e.jsx(ee,{children:e.jsx($,{variant:"outline",w:"32px",h:"32px",p:"0",borderRadius:"8px",onClick:s?h:void 0,sx:{_hover:{svg:{fill:"primary"}}},children:e.jsx(N,{svgFill:s?"primary":"text_paragraph",xlinkHref:"#icon-icon_more",svgW:"16px",svgH:"16px"})})})})]}):e.jsxs(e.Fragment,{children:[e.jsx($,{w:{base:"calc(100vw - 84px)",lg:"unset"},onClick:g,h:"32px",fontSize:"12px",variant:"outline",borderRadius:"8px",fontWeight:"500",p:"0 8px",children:"Details"}),e.jsx(ae,{placement:"bottom-end",showTooltip:!s,tooltip:e.jsx(b,{fontSize:"12px",children:"View on Explorer"}),children:e.jsx(ee,{children:e.jsx($,{onClick:T=>{Gt(T),window.open(i(t.orderID,"poolAddress"))},w:"32px",p:"0",h:"32px",fontSize:"12px",borderRadius:"8px",variant:"outline",_hover:{svg:{fill:"primary"}},children:e.jsx(N,{fontSize:"16px",xlinkHref:"#icon-icon_link1"})})})})]})}),c&&e.jsx(un,{isOpen:c,onClose:()=>l(!1),orderInfo:t,isActiveOrder:n}),e.jsx(fn,{isOpen:x,onClose:u,getExplorerUrl:i,orderInfo:t,handleOpenDetail:g})]})}function wt({getExplorerUrl:t,orderInfo:n,handleOpenDetail:s}){return e.jsxs(V,{align:"flex-start",children:[e.jsx(Ze,{text:"View Details",onClick:s}),e.jsx(Ze,{text:"View on Explorer",onClick:()=>{window.open(t(n.orderID,"poolAddress"))}})]})}function fn({isOpen:t,onClose:n,getExplorerUrl:s,orderInfo:c,handleOpenDetail:l}){return e.jsx(Fe,{isOpen:t,onClose:n,placement:"bottom",children:e.jsx(V,{align:"flex-start",sx:{">div":{w:"100%",">div":{justifyContent:"center",background:"none",p:{color:"text_caption",fontSize:"16px"}}}},children:e.jsx(wt,{getExplorerUrl:s,orderInfo:c,handleOpenDetail:l})})})}function mn(){const{isAutoRefresh:t,dcaOrderListLoading:n,dcaActiveOrderList:s,dcaPastOrderList:c}=se(),[l,i]=d.useState("activeDCAs"),p=l==="activeDCAs",a=10,o=d.useMemo(()=>[{label:"Active DCAs",value:"activeDCAs",num:!t&&n?"":s==null?void 0:s.length},{label:"Past DCAs",value:"pastDCAs",num:!t&&n?"":c==null?void 0:c.length}],[t,n,s,c]),r=d.useMemo(()=>p?s:c,[p,s,c]),{isApp:x}=I(),{closeAll:h,claimAll:u,isClaimAllLoading:g,isCloseAllLoading:m}=Cs(),{isOpen:R,onOpen:T,onClose:L}=be(),[M,C]=d.useState([]),[k,j]=d.useState(0),[_,O]=d.useState(1),D=d.useMemo(()=>!p||!(r!=null&&r.length)?"0":r.reduce((P,A)=>H(P).plus((A==null?void 0:A.outBalance)||0),H(0)).toString(),[p,r]),v=H(D).isZero()||g,f=!(r!=null&&r.length)||m,y=d.useMemo(()=>bn(p),[p]);return d.useEffect(()=>{const P=(r==null?void 0:r.length)||0,A=(_-1)*a,E=A+a;P>0?P<=A?O(1):(j(P),C(r.slice(A,E))):(C([]),j(0))},[r,_]),e.jsxs(V,{w:"100%",children:[e.jsxs(S,{w:"100%",justify:"space-between",children:[e.jsx(Le,{type:"outlineTab",tabList:o,currentTab:l,handleChangeTab:P=>i(P==null?void 0:P.value),isActive:(P,A)=>P===A.value,wrapStyle:{h:"32px",p:"3px",border:"1px solid",borderColor:"border",borderRadius:"8px",gap:"4px",zIndex:"99"},itemStyle:{h:"24px",p:"4px 8px",borderRadius:"4px",gap:"4px"}}),p&&(r==null?void 0:r.length)>1&&(x?e.jsx($,{bg:"card_bg",variant:"outline",w:"32px",h:"32px",p:"0",borderRadius:"8px",onClick:T,sx:{_hover:{svg:{fill:"primary"}}},children:e.jsx(N,{svgFill:"primary",xlinkHref:"#icon-icon_more",svgW:"16px",svgH:"16px"})}):e.jsx(yt,{isClaimAllLoading:g,claimDisabled:v,claimAll:()=>u(r),isCloseAllLoading:m,closeDisabled:f,closeAll:()=>h(r)}))]}),e.jsxs(V,{w:"100%",position:"relative",gap:"20px",children:[(t||!n)&&(r==null?void 0:r.length)===0?e.jsx(le,{type:"nodata",text:p?"No active DCAs":"No past DCAs",noBorder:!0}):x?e.jsx(De,{rowKey:"orderID",columns:y,dataSource:M,loading:!t&&n,itemSkeletonLength:3,itemHeight:"30px",haveDividingLine:!1,rowStyle:()=>({borderRadius:"12px",border:"1px solid",borderColor:"border",bg:"bg_secondary",p:"12px 8px"})}):e.jsx(Re,{rowKey:"orderID",columns:y,dataSource:M,loading:!t&&n,rowStyle:{h:"80px",cursor:"pointer"}}),(r==null?void 0:r.length)>a&&e.jsx(ee,{children:e.jsx(Ae,{total:k,size:a,currentPage:_,onChange:O})})]}),e.jsx(jn,{isOpen:R,onClose:L,isClaimAllLoading:g,claimDisabled:v,claimAll:()=>u(r),isCloseAllLoading:m,closeDisabled:f,closeAll:()=>h(r)})]})}const bn=t=>[{title:e.jsx(b,{children:"Orders"}),key:"order",showLabel:!1,thConfig:{w:"18%"},render:s=>e.jsx(jt,{orderInfo:s})},{title:e.jsx(b,{textAlign:"right",children:"Price Range"}),key:"price",thConfig:{w:"20%"},render:s=>e.jsx(S,{justify:"flex-end",children:e.jsx(J,{children:e.jsx(vs,{orderInfo:s,isProfile:!0,isRank:!0})})})},{title:e.jsx(b,{textAlign:"right",children:"Filled Size"}),key:"completed",thConfig:{w:"15%"},render:s=>e.jsx(S,{justify:"flex-end",children:e.jsxs(J,{children:[e.jsx(_s,{orderInfo:s,isProfile:!0})," "]})})},t&&{title:e.jsx(b,{textAlign:"right",children:"Next Order (UTC)"}),key:"nextOrder",thConfig:{w:"20%"},render:({nextCycleAtTimeStamp:s})=>e.jsx(b,{color:"text_caption",children:Pe(s)})},{title:e.jsx(b,{textAlign:"right",children:"Actions"}),key:"actions",showLabel:!1,thConfig:{w:"15%"},render:s=>e.jsx(hn,{orderInfo:s,isActiveOrder:t})}].filter(Boolean);function yt({isClaimAllLoading:t,claimDisabled:n,claimAll:s,isCloseAllLoading:c,closeDisabled:l,closeAll:i}){return e.jsxs(S,{children:[e.jsx($,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"500",borderRadius:"8px",isLoading:t,isDisabled:n,onClick:s,children:"Claim All"}),e.jsx($,{h:"32px",p:"8px",fontSize:"12px",fontWeight:"400",variant:"ghost",isLoading:c,isDisabled:l,onClick:i,children:"Close All"})]})}function jn({isOpen:t,onClose:n,isClaimAllLoading:s,claimDisabled:c,claimAll:l,isCloseAllLoading:i,closeDisabled:p,closeAll:a}){return e.jsx(Fe,{isOpen:t,onClose:n,placement:"bottom",children:e.jsx(V,{align:"flex-start",sx:{">div":{w:"100%",flexDirection:"column",button:{w:"100%",bg:"none !important",border:"none !important",color:"text_caption",fontSize:"16px","&:disabled":{bg:"none !important","&:hover":{bg:"none !important"}},"&:hover":{bg:"none !important"}}}},children:e.jsx(yt,{isClaimAllLoading:s,claimDisabled:c,claimAll:l,isCloseAllLoading:i,closeDisabled:p,closeAll:a})})})}function wn(t,n,s){const c=t.length,l=(s-1)*n,i=l+n,p=c>l?t.slice(l,i):[];return{total:c,paginated:p}}function yn(){const{currentAccount:t}=G(),{getLimitOrderHistory:n,historyOrderList:s,historyOrderLoading:c}=Ts(),{myOrderList:l,orderListLoading:i}=Ce(),{isAutoRefresh:p,autoRefreshCount:a}=se(),{isApp:o}=I(),{handleCancelOrder:r,cancelOrderLoading:x}=ks(),{isOpen:h,onOpen:u,onClose:g}=be(),[m,R]=d.useState("openOrders"),[T,L]=d.useState(1),M=10,C=d.useMemo(()=>m==="openOrders"?l:s,[m,l,s]),k=d.useMemo(()=>m==="openOrders"?i:c,[m,i,c]),{total:j,paginated:_}=wn(C||[],M,T);d.useEffect(()=>{const y=(T-1)*M;C.length<=y&&L(1)},[C,T]);const O=y=>{t!=null&&t.address&&n(t.address,y)};d.useEffect(()=>{a>0&&O(!0)},[a]),d.useEffect(()=>{O(!1)},[m,t]),zs({onRpcChange:()=>O(!0)});const D=(y,P)=>(p||!y)&&P.length===0?0:!p&&y?"":P.length,v=d.useMemo(()=>[{label:"Open Orders",value:"openOrders",num:D(i,l)},{label:"Orders History",value:"ordersHistory",num:D(c,s)}],[p,i,c,l,s]),f=d.useMemo(()=>Cn(m==="openOrders"),[m]);return e.jsxs(V,{w:"100%",children:[e.jsxs(S,{w:"100%",justify:"space-between",children:[e.jsx(Le,{type:"outlineTab",tabList:v,currentTab:m,handleChangeTab:y=>R(y==null?void 0:y.value),isActive:(y,P)=>y===P.value,wrapStyle:{h:"32px",p:"3px",border:"1px solid",borderColor:"border",borderRadius:"8px",gap:"4px",zIndex:"99"},itemStyle:{h:"24px",p:"4px 8px",borderRadius:"4px",gap:"4px"}}),m==="openOrders"&&C.length>1&&(o?e.jsx($,{variant:"outline",w:"32px",h:"32px",p:"0",bg:"card_bg",borderRadius:"8px",onClick:u,sx:{_hover:{svg:{fill:"primary"}}},children:e.jsx(N,{svgFill:"primary",xlinkHref:"#icon-icon_more",svgW:"16px",svgH:"16px"})}):e.jsx(Ct,{cancelOrderLoading:x,handleCancelOrder:()=>r(l)}))]}),e.jsxs(V,{w:"100%",position:"relative",gap:"20px",children:[(p||!k)&&C.length===0?e.jsx(le,{type:"nodata",text:m==="openOrders"?"No open orders":"No history orders",noBorder:!0}):o?e.jsx(De,{rowKey:"order_id",columns:f,dataSource:_,loading:!p&&k,itemSkeletonLength:4,itemHeight:"30px",haveDividingLine:!1,rowStyle:(y,P)=>({borderRadius:"12px",border:"1px solid",borderColor:"border",bg:"bg_secondary",p:"12px 8px"})}):e.jsx(Re,{rowKey:"order_id",columns:f,dataSource:_,loading:!p&&k,rowStyle:{h:"80px",cursor:"pointer"}}),j>M&&e.jsx(ee,{children:e.jsx(Ae,{total:j,size:M,currentPage:T,onChange:L})})]}),e.jsx(vn,{isOpen:h,onClose:g,cancelOrderLoading:x,handleCancelOrder:()=>r(l)})]})}function Cn(t){return[{title:e.jsx(b,{children:"Order"}),key:"order",showLabel:!1,thConfig:{w:"20%"},render:s=>e.jsx(Ps,{imgSize:"28px",info:s,isProfile:!0})},{title:e.jsx(b,{textAlign:"right",children:"Limit Price"}),key:"price",thConfig:{w:"20%"},render:s=>e.jsx(S,{justify:"flex-end",children:e.jsxs(J,{children:[e.jsx(Ls,{info:s,isProfile:!0})," "]})})},{title:e.jsx(b,{textAlign:"right",children:"Filled Size"}),key:"completed",thConfig:{w:"12%"},render:s=>e.jsx(S,{justify:"flex-end",children:e.jsx(J,{children:e.jsx(Os,{info:s,isProfile:!0})})})},{title:e.jsx(b,{textAlign:"right",children:"Expiry"}),key:"expiry",thConfig:{w:"16%"},render:s=>e.jsx(Ds,{info:s,isProfile:!0})},!t&&{title:e.jsx(b,{textAlign:"right",children:"Status"}),key:"status",thConfig:{w:"8%"},render:s=>e.jsx(Rs,{historyInfo:s,openExpendItemObj:void 0,isProfile:!0})},{title:e.jsx(b,{textAlign:"right",children:"Actions"}),key:"actions",showLabel:!1,thConfig:{w:"8%"},render:s=>e.jsx(As,{orderInfo:s,isProfile:!0,isOpenOrder:t})}].filter(Boolean)}function Ct({cancelOrderLoading:t,handleCancelOrder:n}){return e.jsx($,{h:"32px",p:{base:"4px",lg:"8px"},fontSize:"12px",fontWeight:"400",variant:"ghost",isLoading:t,onClick:n,children:"Cancel All"})}function vn({isOpen:t,onClose:n,cancelOrderLoading:s,handleCancelOrder:c}){return e.jsx(Fe,{isOpen:t,onClose:n,placement:"bottom",children:e.jsx(V,{align:"flex-start",sx:{button:{w:"100%",bg:"none !important",border:"none !important",color:"text_caption",fontSize:"16px","&:disabled":{bg:"none !important","&:hover":{bg:"none !important"}},"&:hover":{bg:"none !important"}}},children:e.jsx(Ct,{cancelOrderLoading:s,handleCancelOrder:c})})})}function _n(){const t=[{label:"Limit Orders",value:"limitOrders"},{label:"DCA",value:"dca"}],[n,s]=d.useState("limitOrders"),{isApp:c}=I();return e.jsx(oe,{borderRadius:"16px",p:{base:"0",lg:"0px 0px 16px"},bg:{base:"none",lg:"none"},backdropFilter:{base:"none",lg:"blur(20px)"},border:"none",mt:{base:"-12px",lg:"-6px"},children:e.jsxs(V,{align:"flex-start",gap:{base:"12px",lg:"20px"},children:[e.jsx(Y,{w:"100%",children:e.jsx(Ne,{type:"tab",currentTab:n,tabs:t,onTabChange:l=>s(l.value),menuHeight:c?"48px":"60px",textStyle:{fontSize:"16px"},wrapStyle:{bg:"none"}})}),n==="limitOrders"&&e.jsx(yn,{}),n==="dca"&&e.jsx(mn,{})]})})}const Sn=t=>(t==null?void 0:t.length)>16?(t==null?void 0:t.substring(0,6))+"..."+(t==null?void 0:t.substring((t==null?void 0:t.length)-10)):t;function Tn({handleRefresh:t,totalValue:n,isLoading:s}){const{isApp:c}=I(),{currentAccount:l,accounts:i,accountServiceNameObj:p}=G(),{isShowProfileAssets:a,setIsShowProfileAssets:o}=qt(),[r,x]=d.useState(!1),{onClose:h}=be(),{isOpen:u,onOpen:g,onClose:m,onToggle:R}=be(),{getServiceNames:T}=Hs(),L=d.useCallback(()=>{u||T(i),R()},[u,i]),M=["/images/one.png","/images/two.png","/images/three.png","/images/four.png","/images/five.png","/images/six.png","/images/seven.png","/images/eight.png","/images/nine.png","/images/ten.png"],[C,k]=d.useState("");d.useEffect(()=>{if(!(l!=null&&l.address))return;const _=l==null?void 0:l.address.toLowerCase(),O=localStorage.getItem("accountImageMap"),D=O?JSON.parse(O):{};if(D[_])k(D[_]);else{const v=Math.floor(Math.random()*M.length),f=M[v];D[_]=f,localStorage.setItem("accountImageMap",JSON.stringify(D)),k(f)}},[l==null?void 0:l.address]);const{getExplorerUrl:j}=Be();return e.jsxs(V,{w:"100%",align:"flex-start",gap:"12px",children:[e.jsxs(S,{w:"100%",justify:"space-between",children:[e.jsxs(S,{gap:{base:"12px",lg:"16px"},children:[e.jsx(Y,{w:{base:"48px",lg:"60px"},h:{base:"48px",lg:"60px"},bg:"primary_opacity.10",borderRadius:"8px",children:C&&e.jsx(rt,{src:C,w:"100%",h:"100%",borderRadius:"8px"})}),e.jsxs(V,{align:"flex-start",gap:{base:"4px",lg:"8px"},children:[c?e.jsxs(S,{gap:"4px",cursor:"pointer",align:"flex-end",onClick:L,children:[e.jsxs(V,{align:"flex-start",gap:"4px",children:[(l==null?void 0:l.label)&&e.jsx(b,{fontSize:"14px",lineHeight:"14px",children:Sn(l==null?void 0:l.label)}),e.jsx(b,{color:"text_caption",fontSize:"16px",fontWeight:"500",lineHeight:"14px",children:(p==null?void 0:p[l==null?void 0:l.address])||Kt(l==null?void 0:l.address)})]}),(i==null?void 0:i.length)>1&&e.jsx(N,{xlinkHref:"#icon-icon_descending_nor",svgFill:"text_caption",svgW:"20px",svgH:"20px",mb:"-3px",transform:"rotate(0deg)",transition:"transform 0.3s"})]}):e.jsx(Ms,{currentAccount:l,accounts:i,onClose:h,isProfile:!0}),e.jsxs(S,{gap:"8px",children:[e.jsx(ae,{showTooltip:!c,placement:"top",tooltip:e.jsx(b,{fontSize:"12px",children:"Copy address"}),children:e.jsx(ee,{children:e.jsx(Qt,{text:(l==null?void 0:l.address)||""})})}),e.jsx(ae,{showTooltip:!c,placement:"top",tooltip:e.jsx(b,{fontSize:"12px",children:"View on Explorer"}),children:e.jsx(ee,{children:e.jsx(N,{fontSize:"16px",xlinkHref:"#icon-icon_link1",onClick:()=>window.open(j(l==null?void 0:l.address,"account"))})})})]})]})]}),e.jsxs(S,{children:[e.jsxs(S,{w:{base:"28px",lg:"unset"},p:{base:"0px",lg:"6px 8px 6px 7px"},h:{base:"28px",lg:"32px"},justify:"center",align:"center",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",borderRadius:"8px",border:"1px solid",borderColor:"border",cursor:"pointer",gap:"2px",_hover:{svg:{fill:"text_caption"},p:{color:"text_caption"}},onClick:()=>{x(!0)},children:[e.jsx(N,{xlinkHref:"#icon-transactions",svgW:"20px",svgH:"20px"}),!c&&e.jsx(b,{children:"Transactions"})]}),e.jsx(S,{w:{base:"28px",lg:"32px"},h:{base:"28px",lg:"32px"},justify:"center",align:"center",bg:"block_color_opacity.50",backdropFilter:"blur(20px)",borderRadius:"8px",border:"1px solid",borderColor:"border",cursor:"pointer",gap:"2px",_hover:{svg:{fill:"text_caption"}},onClick:()=>o(!a),children:e.jsx(ae,{showTooltip:!c,placement:"top",tooltip:e.jsx(b,{fontSize:"12px",children:a?"Hide Value":"Show Value"}),children:e.jsx(ee,{children:e.jsx(N,{xlinkHref:a?"#icon-hide_eyes":"#icon-hide"})})})}),e.jsx(Vs,{handleRefresh:t,bg:"block_color_opacity.50",backdropFilter:"blur(20px)",w:{base:"28px",lg:"32px"},h:{base:"28px",lg:"32px"},isAutoRefresh:!0,refreshInterval:30,innerStyle:{bg:"transparent"}})]})]}),c&&e.jsx(Us,{isOpen:u,onClose:m}),r&&e.jsx(Es,{isOpen:r,onClose:()=>x(!1)})]})}function kn({tabList:t,activeTab:n,tabData:s,onClickTab:c}){const{isApp:l}=I();return e.jsx(S,{ml:{base:"0px",lg:"-24px"},w:{base:"100%",lg:"calc(100% + 24px)"},flexWrap:"wrap",mb:{base:"12px",lg:"0px"},mt:{base:"8px",lg:"12px"},gap:{base:"8px",lg:"32px"},children:t.map(i=>{var p,a;return e.jsxs(oe,{w:{base:"calc(50% - 4px )",lg:"unset"},p:{base:"2px 0px",lg:"12px 24px 20px 16px"},borderRadius:{base:"12px",lg:"unset"},display:"flex",alignItems:"center",cursor:"pointer",bg:"none",border:"1px solid",borderColor:l&&n===i.value?"primary":"transparent",onClick:()=>c(i.value),bgImage:!l&&n===i.value?"url(/images/wallet_active.png)":"none",bgSize:"240px 40px",backgroundRepeat:"no-repeat",backgroundPosition:"bottom",children:[e.jsx(rt,{w:{base:"48px",lg:"60px"},h:{base:"48px",lg:"60px"},src:i.activeImgUrl}),e.jsxs(V,{align:"flex-start",gap:{base:"4px",lg:"4px"},children:[e.jsx(b,{fontSize:{base:"12px",lg:"14px"},color:"primary_gray",children:i.title}),e.jsx(S,{h:"22px",children:e.jsx(J,{size:"l",children:e.jsx(ae,{placement:"top",tooltip:e.jsx(b,{fontSize:"12px",lineHeight:"20px",color:"text_caption",children:i.tooltip}),showTooltip:i.showTooltip,children:e.jsx(ee,{as:"button",children:e.jsx(je,{isLoaded:!((p=s[i.value])!=null&&p.isLoading),children:e.jsx(b,{letterSpacing:"0.3px",fontSize:{base:"16px",lg:"20px"},fontWeight:"500",color:"text_caption",children:(a=s[i.value])==null?void 0:a.totalValue})})})})})})]})]},i.value)})})}const Pn=(t,n)=>({coinHoldingList:[],isCoinHoldingLoading:!0,setIsCoinHoldingLoading:s=>t({isCoinHoldingLoading:s}),setCoinHoldingList:s=>t({coinHoldingList:s}),isCoinPriceLoading:!0,setIsCoinPriceLoading:s=>t({isCoinPriceLoading:s}),holdingsTotalUsd:"0",setHoldingsTotalUsd:s=>t({holdingsTotalUsd:s}),unknownCoinCount:0,setUnknownCoinCount:s=>t({unknownCoinCount:s}),filterUnknownCoinCount:0,setFilterUnknownCoinCount:s=>t({filterUnknownCoinCount:s})}),ze=We(Pn);function vt(){const{currentAccount:t}=G(),{fetchAccountBalance:n}=Bs(),{coinHoldingList:s,setCoinHoldingList:c,setIsCoinHoldingLoading:l,setIsCoinPriceLoading:i,setHoldingsTotalUsd:p,isCoinPriceLoading:a,setUnknownCoinCount:o,setFilterUnknownCoinCount:r}=ze(),{getTokenListInfo:x}=dt(),{getTokenPrice:h}=he(),{refreshCoinPriceInfo:u}=$e(),g=d.useRef(t==null?void 0:t.address);d.useEffect(()=>{g.current=t==null?void 0:t.address},[t==null?void 0:t.address]);const m=async()=>{const C=g.current;if(C){l(!0);const k=await n(C,!0);if(k){const j=await x(k.filter(D=>H(D.totalBalance).gt(0)).map(D=>D.coinType));if(!j)throw l(!1),c([]),new Error("get token list info error");const _=[];let O=0;return k.forEach(D=>{const v=j.get(D.coinType);if(v){const f=D.totalBalance,y=ue(f,v.decimals).toString(),P=te(y,void 0,void 0,Yt.ROUND_DOWN).toString(),A={balance:f,balance_format:y,balance_display:P,balance_usd:void 0,coin:v,coin_type:v==null?void 0:v.coin_type,price:"",price_diff_24:""};_.push(A),v.is_verified||O++}}),T(_),console.log("ðŸš€ ~ fetchCoinHoldingList ~ owner:",C),console.log("ðŸš€ ~ fetchCoinHoldingList ~ currentAccountRef.current:",g.current),C===g.current&&(c(_),o(O),R([..._])),l(!1),_}}else l(!1),c([]);return[]},R=async C=>{i(!0);try{await u(C.map(k=>k.coin.coin_type),!0)}catch(k){console.error("fetch coin price info error",k)}finally{i(!1)}},T=C=>{C.map(k=>{const{coin:j}=k,_=h(j.coin_type);_&&(k.price=_.price,k.price_diff_24=_.price_change||"",k.balance_usd=H(k.balance_format).mul(_.price).toString())})},L=async C=>{if(console.log("ðŸš€ ~ getFilterCoinHoldingList ~ filter:",{filter:C,coinHoldingList:s,currentAccount:t}),t){const{search:k,current_sort:j,current_sort_order:_,is_show_unknown:O=!1,is_hide_small_balance:D=!0}=C;let v=[];if(O?v.push(...s):v=s.filter(y=>y.coin.is_verified),k){const y=k.toLowerCase();v=v.filter(P=>P.coin.coin_type.toLowerCase().includes(y)||P.coin.symbol.toLowerCase().includes(y)||P.coin.name.toLowerCase().includes(y))}T(v),D&&!a&&(v=v.filter(y=>H(y.balance_usd).gt(.01))),v.sort((y,P)=>{if(j==="balance"){const A=H(y.balance_format).cmp(H(P.balance_format));if(A!==0)return _==="desc"?-A:A}if(j==="value"){const A=H(y.balance_usd).cmp(H(P.balance_usd));return A!==0?_==="desc"?-A:A:H(P.balance_format).cmp(H(y.balance_format))}if(j==="price"){const A=H(y.price||"0").cmp(H(P.price||"0"));return A!==0?_==="desc"?-A:A:H(P.balance_format).cmp(H(y.balance_format))}return 0}),console.log("ðŸš€ ~ getFilterCoinHoldingList ~ tempList:",v);const f=v.filter(y=>!y.coin.is_verified);return r(f==null?void 0:f.length),v}return[]};return d.useEffect(()=>{T(s);const C=s.reduce((k,j)=>k+Number(j.balance_usd||0),0);p(C.toString())},[s,a]),{getFilterCoinHoldingList:L,fetchCoinHoldingList:m,resetUserData:()=>{c([]),p("0"),o(0)}}}function _t({inputValue:t,changeInputValue:n}){const s=d.useRef(null),[c,l]=d.useState(!1),{isApp:i}=I();return e.jsxs(Tt,{w:i?"100%":c?"203px":"40px",h:"40px",transition:"width 0.1s ease",border:"1px solid",borderColor:"border",borderRadius:"8px",children:[e.jsx(kt,{top:"calc(50% - 10px)",left:"9px",children:e.jsx(N,{xlinkHref:"#icon-icon_search",svgHover:"text_paragraph",onClick:p=>{var a;(a=s.current)==null||a.focus(),l(!0)}})}),e.jsx(Pt,{bg:{base:"bg_secondary",lg:"background"},ref:s,h:"38px",lineHeight:"38px",variant:"unstyled",outline:"none",borderRadius:"8px",value:t,onChange:p=>{n(p.target.value)},onFocus:()=>{l(!0)},onBlur:()=>{t||(n(""),l(!1))},fontWeight:"500",textAlign:"left",fontSize:"14px",placeholder:i||c?"Search tokens":"",_placeholder:{color:"text_paragraph",fontSize:"12px"},pr:c||i?"28px":"8px",pl:c||i?"36px":"8px"}),t?e.jsx(Lt,{right:"5px",children:e.jsx(N,{xlinkHref:"#icon-icon_close",onMouseDown:p=>p.preventDefault(),onClick:p=>{var a;n(""),l(!1),(a=s.current)==null||a.blur()}})}):null]})}function Ln({inputValue:t,changeInputValue:n,isShowUnknownCoin:s,handleIsShowUnknownCoin:c,isHideLowAsset:l,handleIsHideLowAsset:i,unknownCoinCount:p,filterUnknownCoinCount:a}){const{isApp:o}=I(),r=Ee(),x={fontSize:"14px",whiteSpace:"nowrap"},h=()=>s&&(l||t)?e.jsxs(S,{gap:"0",ml:"-4px",children:[e.jsx(b,{...x,color:o&&s?"primary":"text_caption",children:"("}),e.jsx(b,{...x,color:"primary",children:a}),e.jsxs(b,{...x,color:o&&s?"primary":"text_caption",children:["/",p,")"]})]}):e.jsxs(b,{ml:"-4px",...x,color:o&&s?"primary":"text_caption",children:["(",p,")"]}),u=(g,m,R,T)=>e.jsx(oe,{w:{base:g==="Show Unknown Coin"?"60%":"40%",lg:"unset"},borderRadius:"8px",p:{base:"0 4px",lg:"0px 8px"},h:"40px",onClick:o?()=>R(!m):void 0,bg:o?m?"card_bg":"bg_secondary":"background",children:e.jsxs(S,{h:"100%",justify:{base:"center",lg:"space-between"},children:[e.jsx(b,{...x,color:o&&m?"primary":"text_caption",children:g}),T,!o&&e.jsx(Ot,{isChecked:m,onChange:R})]})});return e.jsxs(S,{w:{base:"100%",lg:"unset"},gap:"8px",flexDirection:{base:"column",lg:"row"},children:[!o&&e.jsx(_t,{inputValue:t,changeInputValue:n}),!o&&e.jsx($,{h:"40px",w:"124px",display:"flex",alignItems:"center",gap:"0px",bg:"primary",borderRadius:"8px",color:"bg_primary",cursor:"pointer",fontSize:"14px",textAlign:"center",fontWeight:"medium",leftIcon:e.jsx(N,{mr:"-4px",xlinkHref:"#icon-icon_merge_swap",fontSize:"18px",svgFill:"bg_primary"}),onClick:()=>r("/merge-swap"),children:"Merge Swap"}),e.jsxs(S,{w:{base:"100%",lg:"unset"},justify:"space-between",children:[u("Show Unknown Coin",s,c,h()),u("Hide Low Asset",l,i)]})]})}function On(){const{isApp:t}=I(),{getFilterCoinHoldingList:n}=vt(),{isCoinHoldingLoading:s,isCoinPriceLoading:c,unknownCoinCount:l,filterUnknownCoinCount:i}=ze(),{isAutoRefresh:p}=se(),[a,o]=d.useState([]),[r,x]=d.useState({current_sort:"value",current_sort_order:"desc",search:"",is_show_unknown:!1,is_hide_small_balance:!0}),[h,u]=d.useState(!1),[g,m]=d.useState(!0),[R,T]=d.useState("desc"),[L,M]=d.useState(Me[2]),[C,k]=d.useState(0),j=w=>{console.log("ðŸš€ ~ applyFilter ~ nextFilter:",w),p||F(1),x(w),n(w).then(o)},_=w=>{j({...r,search:w})},O=w=>{const z=(w==null?void 0:w.value)===(L==null?void 0:L.value),K=t||!z?"desc":R==="desc"?"asc":"desc";console.log("ðŸš€ ~ handleSortClick ~ item:",K,w),M(w),T(K),j({...r,current_sort:w.value,current_sort_order:K})};d.useEffect(()=>{console.log("ðŸš€ ~ useEffect ~ isCoinHoldingLoading:",s,c,a),!s&&!c&&j(r)},[s,c]),d.useEffect(()=>{const w=()=>{const z=window.innerWidth;k(Math.floor(z*.4))};return w(),window.addEventListener("resize",w),()=>{window.removeEventListener("resize",w)}},[]);const D=Ee(),v=w=>{D(`/swap/${w}/undefined?from=profile`)},[f,y]=d.useState([]),[P,A]=d.useState(0),[E,F]=d.useState(1),U=10;d.useEffect(()=>{if((a==null?void 0:a.length)>0){const w=(E-1)*U;(a==null?void 0:a.length)<=w&&F(1)}},[a]),d.useEffect(()=>{if((a==null?void 0:a.length)>0){A(a==null?void 0:a.length);const w=(E-1)*U,z=w+U;console.log("ðŸš€ ~ useEffect ~ start:",E,a.slice(0,z),w,z),(a==null?void 0:a.length)>w&&y(a.slice(w,z))}else y([])},[E,a]);const B=(w,z)=>{w==="is_show_unknown"&&u(z),w==="is_hide_small_balance"&&m(z)},Q=w=>{let z;typeof w=="boolean"?z=w:z=w.target.checked,B("is_show_unknown",z),j({...r,is_show_unknown:z})},Z=w=>{let z;typeof w=="boolean"?z=w:z=w.target.checked,B("is_hide_small_balance",z),j({...r,is_hide_small_balance:z})};return e.jsx(oe,{width:"100%",p:{base:"0",lg:"8px 16px 16px 0px"},bg:{base:"none",lg:"none"},backdropFilter:{base:"none",lg:"blur(20px)"},border:"none",mt:{base:"-4px",lg:"0px"},children:e.jsxs(V,{w:"100%",align:"flex-start",gap:{base:"8px",lg:"16px"},children:[e.jsxs(S,{w:"100%",flexDirection:{base:"column",lg:"row"},children:[e.jsxs(S,{w:"100%",justify:"space-between",children:[e.jsx(b,{fontSize:"16px",color:"text_caption",letterSpacing:"0.2px",children:"Wallet Holdings"}),t&&e.jsx($,{h:"40px",w:"124px",display:"flex",alignItems:"center",gap:"0px",bg:"primary",borderRadius:"8px",color:"bg_primary",cursor:"pointer",fontSize:"14px",textAlign:"center",fontWeight:"medium",leftIcon:e.jsx(N,{mr:"-4px",xlinkHref:"#icon-icon_merge_swap",fontSize:"18px",svgFill:"bg_primary"}),onClick:()=>D("/merge-swap"),children:"Merge Swap"})]}),t&&e.jsxs(S,{w:"100%",justify:"space-between",gap:"6px",children:[e.jsx(_t,{inputValue:r.search,changeInputValue:_}),e.jsx(mt,{minW:`${C-62}px`,currentSort:L,sortByList:Me,onSortByChange:O,xlinkHref:R==="desc"?"#icon-icon_sort2":"#icon-icon_sort_asc1",iconOnClick:()=>{j({...r,current_sort:L.value,current_sort_order:R==="desc"?"asc":"desc"}),T(w=>w==="desc"?"asc":"desc")}})]}),e.jsx(Ln,{unknownCoinCount:l,filterUnknownCoinCount:i,inputValue:r.search||"",changeInputValue:_,isShowUnknownCoin:h,handleIsShowUnknownCoin:Q,isHideLowAsset:g,handleIsHideLowAsset:Z})]}),!t&&e.jsx(Y,{h:"1px",w:"100%",bg:"border",mt:"-2px"}),e.jsxs(V,{w:"100%",position:"relative",gap:"20px",children:[(!s&&!c||p)&&(a==null?void 0:a.length)===0?e.jsx(le,{type:"nodata",text:"No tokens found",noBorder:!0}):t?e.jsx(De,{rowKey:"coin_type",columns:et(R,L,O,v,!p&&c,a==null?void 0:a.length,s),dataSource:f,loading:!p&&(s||c),itemSkeletonLength:4,haveDividingLine:!1,onRowClick:w=>{v(w==null?void 0:w.coin_type)},itemHeight:"30px",rowStyle:(w,z)=>({borderRadius:"12px",border:"1px solid",borderColor:"border",bg:"bg_secondary",p:"12px 8px"})}):e.jsx(Re,{rowKey:"coin_type",columns:et(R,L,O,v,!p&&c,a==null?void 0:a.length,s),dataSource:f,skeletonLength:5,loading:!p&&(s||c),rowStyle:{h:"72px",cursor:"pointer"},onRowClick:w=>{v(w==null?void 0:w.coin_type)}}),(a==null?void 0:a.length)>U&&e.jsx(ee,{children:e.jsx(Ae,{total:P,size:U,currentPage:E,onChange:w=>{F(w)}})})]})]})})}const Me=[{label:"Balance",value:"balance"},{label:"Price",value:"price"},{label:"Value",value:"value"}],He=Object.fromEntries(Me.map(t=>[t.value,t])),et=(t,n,s,c,l,i,p)=>[{title:e.jsxs(S,{children:[e.jsx(b,{children:"Token"}),!p&&e.jsx(oe,{p:"2px 6px",lineHeight:"1",w:"unset",borderRadius:"8px",children:e.jsx(b,{color:"primary",fontSize:"12px",children:i})})]}),key:"pool",thConfig:{w:"20%"},showLabel:!1,render:({coin:a})=>e.jsx(xt,{haveTooltip:!0,token:a,warningIcon:{iconW:"14px",iconH:"14px"}})},{title:e.jsx(me,{labelInfo:He.balance,sortRule:t,sortBy:n,clickSort:s}),key:"balance",thConfig:{w:"25%"},render:({coin:a,balance_display:o})=>e.jsx(S,{justify:"flex-end",children:e.jsx(J,{children:e.jsxs(b,{color:"text_caption",children:[o," ",Jt(a==null?void 0:a.symbol,10)]})})})},{title:e.jsx(me,{labelInfo:He.price,sortRule:t,sortBy:n,clickSort:s}),key:"price",thConfig:{w:"25%"},render:({price:a,price_diff_24:o})=>{const r=H(o).gt(0);return e.jsx(S,{justify:"flex-end",children:e.jsx(je,{isLoaded:!l,children:e.jsx(S,{gap:"2px",children:a===void 0||a===""?e.jsx(b,{color:"text_caption",children:"--"}):e.jsxs(e.Fragment,{children:[e.jsxs(b,{color:"text_caption",children:["$",ut(a)]}),e.jsxs(b,{color:Number(o)===0?"text_caption":r?"primary_green":"primary_red",children:["(",r?"+":H(o).gt(-1e-4)&&H(o).lt(0)?"-":"",H(o).gt(-1e-4)&&H(o).lt(1e-4)?"0%":Zt(H(o).mul(100).toString(),2,!1,!1),")"]})]})})})})}},{title:e.jsx(me,{labelInfo:He.value,sortRule:t,sortBy:n,clickSort:s}),key:"balance_usd",thConfig:{w:"15%"},render:({balance_usd:a})=>(console.log(a,"balance_usd"),e.jsx(S,{justify:"flex-end",children:e.jsx(je,{isLoaded:!l,children:e.jsx(J,{children:e.jsx(b,{color:"text_caption",children:a===void 0?"--":ce(a,2)})})})}))},{title:e.jsx(b,{textAlign:"right",children:"Action"}),showLabel:!1,thConfig:{w:"15%"},key:"actions",render:a=>e.jsx($,{w:{base:"calc(100vw - 48px)",lg:"unset"},p:"8px",h:"32px",fontSize:{base:"14px",lg:"12px"},borderRadius:"8px",variant:"outline",fontWeight:"500",onClick:()=>{c(a==null?void 0:a.coin_type)},children:"Swap"})}],Dn=(t,n)=>({isXCetusModalOpen:!1,setIsXCetusModalOpen:s=>t({isXCetusModalOpen:s}),isXCetusLoading:!1,setIsXCetusLoading:s=>t({isXCetusLoading:s}),currentXCetusTab:"Get xCETUS",setCurrentXCetusTab:s=>t({currentXCetusTab:s})}),Ve=We(Dn),Rn={cetus:{title:"CETUS Holdings",imgUrl:ne.cetus_coin.logo_url,bgUrl:"/images/bg_cetus.png"},xcetus:{title:"Available xCETUS",imgUrl:ne.x_cetus_coin.logo_url,bgUrl:"/images/bg_xcetus.png"},rewards:{title:"xCETUS Rewards",imgUrl:"/images/icon_rewards.png",bgUrl:"/images/bg_rewards.png"}};function Xe({type:t,amount:n,amountUSD:s,isLoading:c,children:l}){const{title:i,imgUrl:p,bgUrl:a}=Rn[t];return e.jsx(oe,{border:"none",flex:"1",bg:`center / cover no-repeat url(${a})`,p:{base:"8px",lg:"20px"},borderRadius:"16px",backdropFilter:"blur(50px)",children:e.jsxs(V,{w:"100%",align:"flex-start",h:"88px",gap:"22px",children:[e.jsxs(S,{children:[e.jsx(we,{imageUrl:p,imgBoxStyle:{w:"20px",h:"20px",bg:"block_color",borderColor:"transparent",borderRadius:"20px"}}),e.jsx(b,{children:i})]}),e.jsxs(S,{w:"100%",justify:"space-between",children:[e.jsx(J,{children:e.jsxs(V,{align:"flex-start",w:"100%",gap:"4px",children:[e.jsx(je,{isLoaded:!c,h:"24px",children:e.jsx(b,{color:"text_caption",h:"24px",lineHeight:"24px",fontSize:"20px",children:n})}),s!==void 0&&e.jsx(je,{isLoaded:!c,h:"17px",children:e.jsxs(b,{h:"17px",lineHeight:"17px",fontSize:"14px",children:["$",ut(s,2)]})})]})}),l]})]})})}function An(){const{currentAccount:t}=G(),{balanceInfo:n}=Ys(ne.cetus_coin),{getTokenAmountValue:s}=he(),{coinPriceObj:c}=Oe(),l=d.useMemo(()=>s(ne.cetus_coin.coin_type,ue((n==null?void 0:n.balance)||"0",ne.cetus_coin.decimals)).toString(),[n==null?void 0:n.balance,t==null?void 0:t.address,c]),{setCurrentXCetusTab:i,setIsXCetusModalOpen:p}=Ve(),a=()=>{p(!0),i("Get xCETUS")},{veNFT:o,veNFTLoading:r,lockCetusListLoading:x}=ie();return e.jsx(Xe,{type:"cetus",amount:t?te((n==null?void 0:n.balanceFormat)||"0"):"--",amountUSD:l,isLoading:(x||r)&&o!==void 0,children:e.jsx($,{onClick:a,variant:"outline",color:"primary",flex:"0 0 120px",h:"32px",lineHeight:"32px",w:{base:"122px",lg:"unset"},borderRadius:"8px",fontSize:{base:"12px",lg:"14px"},fontWeight:"500",children:"Convert to xCETUS"})})}function Fn(){const{lockCetusList:t,lockCetusListLoading:n}=ie(),[s,c]=d.useState([]),[l,i]=d.useState(0),[p,a]=d.useState(1),o=10;return d.useEffect(()=>{if((t==null?void 0:t.length)>0){const r=(p-1)*o;(t==null?void 0:t.length)<=r&&a(1)}},[t]),d.useEffect(()=>{if((t==null?void 0:t.length)>0){i(t==null?void 0:t.length);const r=(p-1)*o,x=r+o;console.log("ðŸš€ ~ useEffect ~ start:",p,t.slice(0,x),r,x),(t==null?void 0:t.length)>r&&c(t.slice(r,x))}},[p,t]),t&&t.length>0&&e.jsx(e.Fragment,{children:e.jsxs(V,{w:"100%",align:"flex-start",gap:"12px",children:[e.jsx(b,{fontWeight:"500",fontSize:"14px",color:"text_caption",children:"Vesting"}),e.jsx(V,{w:"100%",gap:"12px",children:s==null?void 0:s.map(r=>e.jsx(zn,{order:r},r==null?void 0:r.id))}),(t==null?void 0:t.length)>o&&e.jsx(ee,{w:"100%",children:e.jsx(Ae,{total:l,size:o,currentPage:p,onChange:r=>{a(r)}})})]})})}const zn=({order:t})=>{const[n,s]=d.useState(!ye.isLocked(t));d.useEffect(()=>{s(!ye.isLocked(t))},[t==null?void 0:t.id]);const{cancelOrderLoading:c,handleCancelOrder:l}=Ws(),{claimOrderLoading:i,handleClaimOrder:p}=$s(),{days:a,hours:o,minutes:r,seconds:x}=Ns(t.locked_until_time*1e3,()=>{s(!0)},"days"),h=u=>{u?p(t.id):l(t)};return e.jsxs(S,{flexDirection:{base:"column",lg:"row"},align:{base:"flex-start",lg:"center"},justify:"space-between",w:"100%",h:{base:"unset",lg:"80px"},p:{base:"12px",lg:"0 20px"},bg:{base:"bg_secondary",lg:"bg_nine"},borderRadius:"12px",children:[n?e.jsxs(S,{p:"8px 12px 8px 8px",borderRadius:"8px",bg:"primary_opacity.10",children:[e.jsx(N,{xlinkHref:"#icon-icon_check",svgFill:"primary",fontSize:"20px"}),e.jsx(b,{color:"primary",fontSize:"13px",children:"Available"})]}):e.jsxs(S,{p:"8px",borderRadius:"8px",bg:"text_paragraph_opacity.10",children:[e.jsx(N,{xlinkHref:"#icon-icon_time",svgFill:"text_paragraph",fontSize:"20px"}),e.jsxs(Y,{as:"div",children:[e.jsxs(b,{as:"span",color:"text_paragraph",fontSize:"13px",children:["Available in"," "]}),e.jsxs(b,{as:"span",color:"text_caption",fontSize:"13px",children:[a,"d : ",o,"h : ",r,"m : ",x,"s"]})]})]}),e.jsxs(S,{flexDirection:{base:"column",lg:"row"},align:{base:"flex-start",lg:"center"},w:{base:"100%",lg:"unset"},gap:"12px",children:[e.jsx(Xs,{xcetus_amount:t.xcetus_amount,cetus_amount:t.cetus_amount,imageSize:"20px"}),e.jsx($,{onClick:()=>{c||i||h(n)},variant:"unstyled",border:"none",h:"28px",w:{base:"100%",lg:"80px"},borderRadius:"8px",fontSize:"12px",display:"flex",justifyContent:"center",alignItems:"center",isLoading:c||i,color:n?"background":"primary_gray",bg:n?"primary":"card_bg",_hover:{bg:n?"primary_hover":"button_ghost_hov_bg",color:n?"background":"text_caption"},children:n?"Claim":"Cancel"})]})]})};function Vn({totalRewardValue:t,rewardList:n,summaryRewardList:s}){const{currentAccount:c}=G(),{veNFTLoading:l}=ie(),{claimRewardLoading:i,handleClaimReward:p}=Is(),a=()=>{i||p(n)};return I(),e.jsx(Xe,{type:"rewards",amount:c?H(t).gt("0")?e.jsx(ae,{tooltip:e.jsx(V,{w:"100%",align:"flex-start",bg:"bg_secondary",gap:"0px",children:s==null?void 0:s.map(o=>e.jsxs(S,{w:"100%",p:"10px 12px",minW:"300px",justify:"space-between",children:[e.jsx(xt,{coinType:o.coin_type,imgBoxStyle:{w:"20px",h:"20px"},haveName:!1,symbolFontSize:"12px",warningIcon:{iconW:"10px",iconH:"10px"}}),e.jsxs(S,{gap:"4px",children:[e.jsx(b,{fontSize:"12px",color:"text_caption",children:te(o==null?void 0:o.amount,6)}),e.jsxs(b,{fontSize:"12px",children:["(",ce(o==null?void 0:o.value,2),")"]})]})]},o.coin_type))}),children:e.jsx(b,{textDecoration:"underline dotted",textUnderlineOffset:"3px",textDecorationColor:"text_paragraph",cursor:"pointer",color:"text_caption",h:"24px",lineHeight:"24px",fontSize:"20px",children:ce(t,2)})}):e.jsx(b,{textUnderlineOffset:"3px",textDecorationColor:"text_paragraph",color:"text_caption",h:"24px",lineHeight:"24px",fontSize:"20px",children:ce(t,2)}):"--",isLoading:l,children:s.length>0&&e.jsx($,{onClick:a,variant:"unstyled",bg:"primary",border:"none",color:"background",flex:"0 0 120px",fontSize:{base:"12px",lg:"14px"},fontWeight:"500",h:"32px",lineHeight:"32px",w:{base:"122px",lg:"unset"},borderRadius:"8px",children:"Claim"})})}function Hn({availableXCetusAmount:t}){const{currentAccount:n}=G(),{veNFT:s,veNFTLoading:c,lockCetusListLoading:l}=ie(),{getTokenAmountValue:i}=he(),{coinPriceObj:p}=Oe(),a=d.useMemo(()=>i(ne.cetus_coin.coin_type,ue(t||"0",ne.x_cetus_coin.decimals)).toString(),[t,n==null?void 0:n.address,p]),{setCurrentXCetusTab:o,setIsXCetusModalOpen:r}=Ve(),x=()=>{r(!0),o("Redeem CETUS")},h=(l||c)&&s!==void 0;return e.jsx(Xe,{type:"xcetus",amount:n?te(ue(t||"0",9)).toString():"--",amountUSD:a,isLoading:h,children:e.jsx($,{onClick:x,variant:"outline",color:"primary",flex:"0 0 120px",h:"32px",lineHeight:"32px",w:{base:"122px",lg:"unset"},borderRadius:"8px",fontSize:{base:"12px",lg:"14px"},fontWeight:"500",children:"Redeem"})})}const Se=[{label:"Get xCETUS",value:"Get xCETUS"},{label:"Redeem CETUS",value:"Redeem CETUS"}];function Mn({isOpen:t,onClose:n,availableXCetusAmount:s}){const{currentXCetusTab:c,setCurrentXCetusTab:l}=Ve(),[i,p]=d.useState("#icon-a-icon_trade"),a=()=>{p("#icon-icon_swap1")},o=()=>{p("#icon-a-icon_trade")},r=()=>{var h;const x=(h=Se==null?void 0:Se.find(u=>(u==null?void 0:u.value)!==c))==null?void 0:h.value;x&&l(x)};return e.jsxs(st,{autoFocus:!1,returnFocusOnClose:!1,isOpen:t,onClose:n,isCentered:!0,children:[e.jsx(nt,{}),e.jsxs(ot,{children:[e.jsx(it,{p:"0 16px",children:e.jsx(Y,{borderBottom:"1px solid",borderColor:"border",children:e.jsx(Le,{type:"borderTab",wrapStyle:{w:"fix-content",border:"none",h:"58px",background:"transparent",gap:"40px"},itemStyle:{w:"auto",fontSize:"16px"},tabList:Se,currentTab:c,handleChangeTab:x=>{l(x==null?void 0:x.value)}})})}),e.jsx(at,{}),e.jsxs(lt,{p:"20px 16px 16px",children:[c==="Get xCETUS"&&e.jsx(Gs,{onClose:n,availableXCetusAmount:s,onIconClick:r,iconParams:{xlinkHref:i,svgFill:"text_caption",transform:i==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:i==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:a,onMouseLeave:o}}),c==="Redeem CETUS"&&e.jsx(qs,{onClose:n,availableXCetusAmount:ue(s,9),onIconClick:r,iconParams:{xlinkHref:i,svgFill:"text_caption",transform:i==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:i==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:a,onMouseLeave:o}})]})]})]})}function En(){const{isXCetusModalOpen:t,setIsXCetusModalOpen:n}=Ve(),{availableXCetusAmount:s,totalRewardValue:c,rewardList:l,summaryRewardList:i}=Ks();return e.jsx(oe,{mt:{base:"-6px",lg:"0"},p:{base:"8px 0px",lg:"12px 0px"},border:"none",w:"100%",bg:"none",backdropFilter:"blur(20px)",children:e.jsxs(V,{w:"100%",gap:"20px",children:[e.jsxs(S,{w:"100%",gap:"10px",flexDirection:{base:"column",lg:"row"},children:[e.jsx(Hn,{availableXCetusAmount:s}),e.jsx(An,{}),e.jsx(Vn,{totalRewardValue:c,rewardList:l,summaryRewardList:i})]}),e.jsx(Fn,{}),t&&e.jsx(Mn,{isOpen:t,onClose:()=>n(!1),availableXCetusAmount:s})]})})}function Un(){const{currentAccount:t}=G(),{orderListLoading:n,myOrderList:s}=Ce(),{isAutoRefresh:c,dcaOrderListLoading:l,dcaActiveOrderList:i}=se(),{getTokenAmountValue:p,coinPriceObj:a}=he(),o=d.useMemo(()=>{let h=H(0);if(c||!n)return(s==null?void 0:s.length)>0&&(t!=null&&t.address)?(s.forEach(u=>{const{pay_coin:g,target_coin:m,un_claimed_amount:R,remaining_amount:T}=u,L=p(g.coin_type,T),M=p(m.coin_type,R);h=H(h).plus(L).plus(M),console.log("ðŸš€ ~ myOrderList.forEach ~ limitTotalTvl:",h.toString())}),h.toString()):"0"},[c,s,t==null?void 0:t.address,n,a]),r=d.useMemo(()=>{let h=H(0);if(c||!l)return(i==null?void 0:i.length)>0&&(t!=null&&t.address)?(i.forEach(u=>{const{inBalance:g,inCoin:m,outBalance:R,outCoin:T}=u,L=p(m.coin_type,g),M=p(T.coin_type,R);h=H(h).plus(L).plus(M),console.log("ðŸš€ ~ dcaActiveOrderList.forEach ~ total:",h.toString())}),h):"0"},[c,i,t==null?void 0:t.address,l,a]),x=d.useMemo(()=>{if(console.log("ðŸš€ ~ useGetActivityTvl ~ dcaTotalTvl, limitTotalTvl:",r,o),r&&o){let h=H(0);return h=H(h).plus(r).plus(o),h.toString()}return"--"},[r,o]);return{limitTotalTvl:o,dcaTotalTvl:r,orderTotalTvl:x}}function Bn(){const{currentAccount:t}=G(),{isAutoRefresh:n}=se(),{veNFT:s,veNFTLoading:c,lockCetusListLoading:l}=ie(),{getTokenAmountValue:i}=he(),{coinPriceObj:p}=Oe();return{xCetusTotalTvl:d.useMemo(()=>{if(n||!c&&!l)return t!=null&&t.address&&s?i(ne.cetus_coin.coin_type,ue(s==null?void 0:s.xcetus_balance,ne.cetus_coin.decimals)).toString():"0"},[n,s==null?void 0:s.xcetus_balance,l,c,t==null?void 0:t.address,p])}}const Wn="fetch-coin-holding-list",$n="fetch-owner-nft",Nn="fetch-active-order-list",Xn="fetch-xcetus-base-info",In="fetch-vaults-position-list";function Gn(){const{currentAccount:t}=G(),{getTokenListInfo:n}=dt(),{getLimitUserIndexer:s,getDcaUserIndexer:c}=Qs(),{setOrderListLoading:l,setMyOrderList:i}=Ce(),{setDcaOrderListLoading:p,setDcaActiveOrderList:a,setDcaPastOrderList:o}=se(),{refreshCoinPriceInfo:r}=$e(),{buildDcaOrderList:x}=Js(),h=pe("limit"),u=pe("dca"),{formatLimitOrderList:g}=Fs(),m=d.useRef(t==null?void 0:t.address);d.useEffect(()=>{m.current=t==null?void 0:t.address},[t==null?void 0:t.address]);const R=async()=>{if(t){l(!0);const C=await s(t.address);if(console.log("ðŸš€ ~ fetchUserLimitOrderIds ~ indexer:",C),C)try{return(await h.FullClient.getDynamicFieldsByPage(C)).data.map(_=>_.name.value)}catch(k){console.log("ðŸš€ ~ fetchUserLimitOrderIds ~ error:",k)}}return[]},T=async()=>{if(t){p(!0);const C=await c(t.address);if(console.log("ðŸš€ ~ fetchUserDacOrderIds ~ indexer:",C),C)try{return(await u.FullClient.getDynamicFieldsByPage(C)).data.map(_=>_.name.value)}catch(k){console.log("ðŸš€ ~ fetchUserDacOrderIds ~ error:",k)}}return[]};return{fetchActiveOrderList:async()=>{try{const C=await R(),k=await T(),j=await h.FullClient.batchGetObjects([...C,...k],{showType:!0,showContent:!0}),_=j.filter(F=>{var U,B;return(B=(U=F.data)==null?void 0:U.type)==null?void 0:B.includes("limit_order::LimitOrder")}),O=j.filter(F=>{var U,B;return(B=(U=F.data)==null?void 0:U.type)==null?void 0:B.includes("order::Order")}),v=_.map(F=>es.buildLimitOrderInfo(F)).filter(F=>F!==void 0).filter(F=>F.status===Qe.PartialCompleted||F.status===Qe.Running),f=O.map(F=>{var Z,w,z,K,fe,de,ve,_e;const U=ke(((Z=F.data)==null?void 0:Z.type)||""),B=U.type_arguments[0],Q=U.type_arguments[1];return{in_coin_type:B,out_coin_type:Q,...(z=(w=F.data)==null?void 0:w.content)==null?void 0:z.fields,id:(ve=(de=(fe=(K=F.data)==null?void 0:K.content)==null?void 0:fe.fields)==null?void 0:de.id)==null?void 0:ve.id,version:(_e=F.data)==null?void 0:_e.version}}),y=new Set;for(const F of v)y.add(F.pay_coin_type),y.add(F.target_coin_type);for(const F of f)y.add(F.in_coin_type),y.add(F.out_coin_type);await n(Array.from(y));const P=await g(v);i(P);const{activeResult:A,pastResult:E}=await x(f);m.current===(t==null?void 0:t.address)&&(a(A),o(E),console.log("ðŸš€ ~ fetchActiveOrderList ~ limitOrderList:",P),console.log("ðŸš€ ~ fetchActiveOrderList ~ dcaOrderList:",f)),r(Array.from(y))}catch(C){console.log("ðŸš€ ~ fetchActiveOrderList ~ error:",C)}finally{l(!1),p(!1)}},resetUserData:()=>{console.log("ðŸš€ ~ resetUserData ~ resetUserData"),i([]),a([]),o([])}}}const St=We(t=>({isAutoRefresh:!1,setIsAutoRefresh:n=>{t(()=>({isAutoRefresh:n}))}}));function qn(){const{currentAccount:t}=G(),n=pe("clmm"),s=pe("xcetus"),{buildFarmsPositionType:c,buildBurnPositionType:l}=zt(),{setPosBaseList:i,setFullRangePosBaseList:p,setPosBaseListLoading:a}=ge(),{setVeNFT:o,setVeNFTLoading:r,setLockCetusList:x,clearData:h,setLockCetusListLoading:u,setAvailableXCetusAmount:g}=ie(),{formatPosBaseList:m}=ct(),{isAutoRefresh:R}=St(),T=d.useRef(t==null?void 0:t.address);return d.useEffect(()=>{T.current=t==null?void 0:t.address},[t==null?void 0:t.address]),{fetchOwnerNFT:async()=>{try{const C=T.current;if(C){r(!0);const k=await n.FullClient.getOwnedObjectsByPage(C,{options:{showType:!0,showContent:!0,showOwner:!0},filter:{MatchAny:[{Package:ts.clmm_pool.package_id},{StructType:c},{StructType:l},{StructType:Zs},{StructType:en}]}});let j=await m(k);i(j),a(!1),(j==null?void 0:j.length)==0&&p([]);const _=tn(k.data);if(_&&C===T.current){o(_,C);const O=await sn(k.data,s);O.sort((D,v)=>D.locked_until_time-v.locked_until_time),console.log("ðŸš€ ~ fetchOwnerLockCetusList ~ lockList1:",{lockList:O,veNFT:_,availableXCetusAmount:ye.getAvailableXCetus(_,O)}),x(O),g(ye.getAvailableXCetus(_,O))}else u(!1);return{veNFT:_,posBaseList:j}}}catch(C){console.error("ðŸš€ ~ fetchOwnerNFT ~ error:",C),C instanceof TypeError&&(a(!1),i([]))}finally{a(!1),u(!1),r(!1)}return{veNFT:void 0,posBaseList:[]}},resetUserData:()=>{i([]),h()}}}function Kn(){const t=pe("farms"),n=pe("clmm"),{getPosApiPoolData:s}=Vt(),{getPosPoolsOriginalObj:c,getPosPoolsRelatedData:l}=Ht(),{getPosLiquidityData:i}=Mt(),{setPosLiquidityData:p,setFarmsPosRewardsData:a,setFarmsPosRewardsDataLoading:o,setPosRewardsData:r,setPosRewardsDataLoading:x,setPosFeeData:h,setPosFeeDataLoading:u,setPosBaseListLoading:g}=ge(),{formatFarmsRewardsData:m}=Et(),{formatPosRewardsData:R}=Ut(),{formatPosFeeData:T}=Bt(),{refreshCoinPriceInfo:L}=$e(),M=async j=>{var v;const _=j.filter(f=>f.posType==="farms"&&f.farmsPool),O=await c(j);if(l(j,O),((v=Object.keys(O))==null?void 0:v.length)===0)throw p({}),g(!1),new Error("No pool data found");s(j),i(j,O);const D=new is;_.length>0&&_.forEach(f=>{t.Farms.buildCalculateFarmingReward({pool_id:f.farmsPool,position_nft_id:f.id},D)}),j.forEach(f=>{n.Position.buildFetchPosFee({pool_id:f.clmmPool,position_id:f.posId,coin_type_a:f.coinTypeA,coin_type_b:f.coinTypeB},D)}),j.filter(f=>f.posType!=="farms").forEach(f=>{var P;const y=O[f.clmmPool];n.Rewarder.buildFetchPosReward({pool_id:f.clmmPool,position_id:f.posId,coin_type_a:f.coinTypeA,coin_type_b:f.coinTypeB,rewarder_types:(P=y.rewarder_infos)==null?void 0:P.map(A=>A.coinAddress)},D)});try{o(!0),x(!0),u(!0);const f=await n.FullClient.devInspectTransactionBlock({transactionBlock:D,sender:as("0x0")}),y=t.Farms.parsedPosRewardData(f),P=n.Rewarder.parsedPosRewardData(f),A=n.Position.parsedPosFeeData(f);console.log("ðŸš€ ~ fetchPosRelatedData ~ parsedPosRewardData:",{farmsRewardData:y,clmmRewardData:P,clmmFeeData:A});const E=await m(y);a(E);const F=await R(Object.values(P).map(B=>{const Q=O[j.find(Z=>Z.posId===B.position_id).clmmPool];return{poolAddress:Q.pool_address,positionId:B.position_id,rewarderAmountOwed:B.rewarder_amount.map((Z,w)=>({coin_address:Q.rewarder_infos[w].coinAddress,amount_owed:new ls(Z)}))}}));r(F);const U=await T(Object.values(A).map(B=>({position_id:B.position_id,fee_owned_a:B.fee_owned_a,fee_owned_b:B.fee_owned_b})),j);h(U),console.log("ðŸš€ ~ fetchPosRelatedData ~ posFeeData:",{posFeeData:U,posRewardsData:F,posFarmsRewardsObj:E}),C(j,F,E)}catch(f){console.error("ðŸš€ ~ fetchPosRelatedData ~ error:",f)}finally{o(!1),x(!1),u(!1)}},C=async(j,_,O)=>{console.log("ðŸš€ ~ fetchTokenPrice ~ posRewardsData:",j,_);const D=[];if(j.length>0){j.map(f=>{D.push(ke(f==null?void 0:f.coinTypeA).full_address),D.push(ke(f==null?void 0:f.coinTypeB).full_address);const y=_[f==null?void 0:f.posId]||[],P=O[f==null?void 0:f.id]||[],A=y.concat(P);A==null||A.map(E=>{var F;ss(E==null?void 0:E.display_amount_owed).gt(0)&&D.push(ke((F=E==null?void 0:E.token)==null?void 0:F.coin_type).full_address)})}),console.log("ðŸš€ ~ fetchTokenPrice ~  Array.from(new Set(list)):",Array.from(new Set(D)));const v=Array.from(new Set(D));console.log("ðŸš€ ~ refreshTokenPrice ~ list:",v),L(v)}};return{fetchPosRelatedData:M,resetUserData:()=>{p({}),a({}),r({}),h({})}}}function Qn(){const{getVaultsTokenList:t,getVaultsLpTokenList:n}=ht(),{getVaultsContractInfo:s}=hs(),{getVaultsPosition:c}=fs(),{clearVaultsPositionObj:l}=xe(),{getVaultPoolList:i}=Xt(),{isAutoRefresh:p}=St(),{getHaedalFarmingList:a}=ms(),{vaultsFarmObj:o}=ft();return{fetchVaultsPositionList:async()=>{console.log("ðŸš€ðŸš€ðŸš€ ~ useProfileVaults.ts:20 ~ fetchVaultsPositionList ~ isAutoRefresh:",p);let h=o;if(!pt(h)){const{vaultsFarmObj:T}=await a();h=T}const{poolList:u}=await i();console.log("ðŸš€ðŸš€ðŸš€ ~ useProfileVaults.ts:27 ~ fetchVaultsPositionList ~ vaultsFarmInfoObj:",h),console.log("ðŸš€ ~ fetchVaultsPositionList ~ vaultsList:",u),t(u),n(u);const{lstVaultContractInfoObj:g,haedalVaultContractInfoObj:m,allClmmPoolContractInfoObj:R}=await s(u);await c(u,g,m,R,!0,h)},resetUserData:()=>{console.log("ðŸš€ðŸš€ðŸš€ ~ useProfileVaults.ts:39 ~ resetUserData ~ clearVaultsPositionObj:",l),l()}}}function Yn(){const{currentAccount:t}=G(),{setXCetusManager:n,setDividendManager:s}=ie(),c=pe("xcetus");return{fetchXCetusBaseInfo:async()=>{try{const{xcetus:i,xcetus_dividends:p}=ns,{dividend_manager_id:a}=Ye(p),{xcetus_manager_id:o}=Ye(i),r=await c.FullClient.batchGetObjects([o,a],{showType:!0,showContent:!0}),x=r.find(u=>{var g,m;return(m=(g=u.data)==null?void 0:g.type)==null?void 0:m.includes("xcetus::XcetusManager")});if(x){const u=Je(x),g={id:u.id.id,index:Number(u.index),has_venft:{handle:u.has_venft.fields.id.id,size:u.has_venft.fields.size},nfts:{handle:u.nfts.fields.id.id,size:u.nfts.fields.size},total_locked:u.total_locked,treasury:u.treasury.fields.total_supply.fields.value};console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ xCetusManager:",g),n(g)}const h=r.find(u=>{var g,m;return(m=(g=u.data)==null?void 0:g.type)==null?void 0:m.includes("dividend::DividendManager")});if(h){const u=Je(h),g=ye.buildDividendManager(u);console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ dividendManager:",g),c.updateCache(`${a}_getDividendManager`,g),s(g)}}catch(i){console.log("ðŸš€ ~ fetchXCetusBaseInfo ~ error:",i)}}}}function Jn(t){const{currentAccount:n}=G(),{fetchCoinHoldingList:s,resetUserData:c}=vt(),{fetchPosRelatedData:l,resetUserData:i}=Kn(),{fetchActiveOrderList:p,resetUserData:a}=Gn(),{fetchVaultsPositionList:o,resetUserData:r}=Qn(),{setAutoRefreshCount:x,setDcaOrderListLoading:h}=se(),{fetchOwnerNFT:u,resetUserData:g}=qn(),{fetchXCetusBaseInfo:m}=Yn(),{addTask:R,removeTask:T}=nn(),[L,M]=d.useState([]),C=d.useRef(n),{setOrderListLoading:k}=Ce(),{setLockCetusListLoading:j}=ie(),{setPosBaseListLoading:_}=ge(),{setIsCoinHoldingLoading:O}=ze(),{setVaultListLoading:D}=Ue(),{setVaultsPositionLoading:v}=xe(),[f,y]=d.useState(!1),P=()=>{c(),i(),a(),g(),r()};d.useEffect(()=>{var w,z;n?((w=C.current)!=null&&w.address&&((z=C.current)==null?void 0:z.address)!==(n==null?void 0:n.address)&&(x(!1),P(),L.forEach(K=>{T(K.id)})),Q(!1)):(P(),L.forEach(K=>{T(K.id)})),C.current=n},[n==null?void 0:n.address]);const A={id:Wn,run:s},E={id:$n,run:u,onSuccess:w=>{const{posBaseList:z}=w;l(z)}},F={id:Xn,run:m},U={id:Nn,run:p},B={id:In,run:o},Q=w=>{const z=[];k(!0),j(!0),O(!0),D(!0),h(!0),w||(v(!0),_(!0)),t==="wallet"?z.push(A,E,B,U,F):t==="liquidity"?z.push(E,B,A,U,F):t==="orders"?z.push(U,A,E,B,F):z.push(E,B,F,A,U),M(z),z.forEach(K=>{R(K)})};return{refreshTask:()=>{console.log("ðŸš€ðŸš€ðŸš€ ~ useProfileTask.ts:149 ~ refreshTask ~ refreshTask:"),n&&(y(!0),L.forEach(w=>{T(w.id)}),Q(!0))}}}const Te=t=>t?ce(t,2):"$--",Zn=(...t)=>t.reduce((n,s)=>n.plus(s&&+s?s:0),H(0)).toString();function Zi(){const{tab:t,tabDetail:n}=os(),{currentAccount:s,onWalletModal:c}=G(),l=Ee(),{posBaseListLoading:i,posLiquidityDataLoading:p}=ge(),{holdingsTotalUsd:a,isCoinPriceLoading:o,isCoinHoldingLoading:r}=ze(),{liquidityTotalTvl:x}=cs(),{orderTotalTvl:h}=Un(),{orderListLoading:u}=Ce(),{isAutoRefresh:g,dcaOrderListLoading:m,setAutoRefreshCount:R,resetAutoRefreshCount:T}=se(),{xCetusTotalTvl:L}=Bn(),{vaultsPositionLoading:M}=xe(),{lockCetusListLoading:C,veNFTLoading:k}=ie(),j=d.useMemo(()=>t,[t]),{refreshTask:_}=Jn(j),O=!g&&(r||o),D=!g&&(i||p||o||M),v=!g&&(u||m||o),f=!g&&(C||k||o),y=d.useMemo(()=>({wallet:{totalValue:Te(a),isLoading:O},liquidity:{totalValue:Te(x),isLoading:D},orders:{totalValue:Te(h),isLoading:v},xCetus:{totalValue:Te(L),isLoading:f}}),[a,x,h,L,O,D,v,f]),P=[{title:"Wallet Holdings",value:"wallet",route:"/portfolio?tab=wallet",activeImgUrl:"/images/icon_wallet@2x.png",showTooltip:!1},{title:"Liquidity",value:"liquidity",route:"/portfolio?tab=liquidity",activeImgUrl:"/images/icon_liquidity@2x.png",showTooltip:!1},{title:"Orders",value:"orders",route:"/portfolio?tab=orders",activeImgUrl:"/images/icon_orders@2x.png",showTooltip:!0,tooltip:" Total amount of active orders (Limit & DCA)"},{title:"xCETUS",value:"xCetus",route:"/portfolio?tab=xCetus",activeImgUrl:"/images/icon_xcetus@2x.png",showTooltip:!1}],A=d.useMemo(()=>Zn(L,x,h,a),[L,x,h,a]);d.useEffect(()=>T(!1),[]);const[E,F]=d.useState(!1);return d.useEffect(()=>{F(!0)},[]),I(),e.jsx(V,{minW:{base:"100%",lg:"1200px"},p:{base:"20px 0px 0",lg:"40px 20px 0"},margin:"0px auto",gap:"12px",alignItems:"start",children:E?s!=null&&s.address?e.jsxs(V,{w:"100%",gap:"12px",alignItems:"start",children:[e.jsx(Tn,{handleRefresh:U=>{R(!U),_()},totalValue:A,isLoading:!g&&(k||i||u||m)}),e.jsx(kn,{tabList:P,activeTab:j,tabData:y,onClickTab:U=>l(`/portfolio?tab=${U}`)}),j==="wallet"&&e.jsx(On,{}),j==="liquidity"&&e.jsx(cn,{}),j==="orders"&&e.jsx(_n,{}),j==="xCetus"&&e.jsx(En,{})]}):e.jsx(le,{type:"nowallet",mt:"20px",imgSize:"120px",imgUrl:"/images/img_wallet@2x.png",nowalletText:"Please connect your wallet to view portfolio page ",onboard:()=>c(!0)}):e.jsx(Dt,{h:"300px",w:"100%",justifyContent:"center",alignItems:"center",children:e.jsx(tt,{})})})}export{Zi as default};
//# sourceMappingURL=Profile-DZUsB8Ep.js.map
