import{i as ft,n as Lt,bU as st,M as pt,e as Tt,Q as gt,bV as Ct,d0 as Pt,z as w,E as bt,bX as Bt,f as Dt,g as rt,r as Ot,G as $,as as U,Z as B,aW as Vt,d1 as Rt,ad as vt,d as it,l as Gt,d2 as qt,d3 as Ht,V as _t,d4 as It,C as zt}from"./index-BpSfzecM.js";import{r as O,j as C,V as et,T as tt,H as Mt,B as Nt}from"./vendor-CBmAETR3.js";import{B as ht}from"./cross-DJ28FxNa.js";import{c as xt,d as Et,a as mt,u as At,v as Ft,b as Ut}from"./useGetPythTokenPrice-Co4DlB3j.js";import{d as wt}from"./utils-CMHkC_9A.js";import{a as $t}from"./useWrapPoolData-CMGMCXwG.js";import{H as ct}from"./HTextLabelBox-D0r99Smv.js";const Wt=(l,g)=>({vaultsFarmingStaked:{},setVaultsFarmingStaked:t=>{const v={...g().vaultsFarmingStaked||{},...t};l({vaultsFarmingStaked:v})},vaultsFarmingStakeLoading:!0,setVaultsFarmingStakeLoading:t=>l({vaultsFarmingStakeLoading:t}),vaultsFarmingRewards:{},setVaultsFarmingRewards:t=>{const v={...g().vaultsFarmingRewards||{},...t};l({vaultsFarmingRewards:v})},vaultsFarmingRewardsLoading:!0,setVaultsFarmingRewardsLoading:t=>l({vaultsFarmingRewardsLoading:t}),vaultsFarmObj:{},setVaultsFarmObj:t=>l({vaultsFarmObj:t}),autoClaimFarmingReward:!0,setAutoCliamFarmingReward:t=>l({autoClaimFarmingReward:t}),autoClaimStakeFarming:!0,setAutoClaimStakeFarming:t=>l({autoClaimStakeFarming:t}),clearVaultsFarmingInfo:()=>l({vaultsFarmingStaked:{},vaultsFarmingRewards:{}})}),ut=ft(Wt);function de(){const{fetchByApi:l}=Lt(),{volatileVaultsSdk:g,haedalFarmSdk:t}=st(),{currentAccount:P}=pt(),{getTokenInfo:v}=Tt(),{fetchTokenPrices:F}=gt(),{setVaultsFarmObj:j}=ut(),{getLocalVaultPoolList:T}=xt(),S=5,[k,x]=O.useState(0),L={"0x16140ced8f6641e56d7455cfb14acba7246b94049c442fb867a4c597d9841981":{id:"0x24bf7840d179ea8b1b0543e496053727c98c0eb3e2c92d3c5b221c241c40125d"},"0x3585ab68bf29e26e0ded505ead0d7eb43d1cc3b273a8678ba63ed685962be6c3":{id:"0x4bd386d95223b37cabee8265a66b8e1f5668efd63e7eb4c4387af67d036b60a4"},"0x9cddd2fe64c460183ea0e5ec21cd08a1591c4549850e3d29f83de267ae7a7824":{id:"0x083981a898882322f1ac035e9b56ea11474866bb4c97a1883e9b789bedca4412"}},b=async()=>{try{const a=await(await fetch("https://www.haedal.xyz/api/v1/farming/pools")).json();return a&&a.code===200?a.data.map(d=>({...d,vaultPool:L[d==null?void 0:d.poolId]}))||[]:[]}catch{return await t.Farms.getFarmsList()}},_=async()=>{try{return(await l(Ct,"GET")).list.reduce((d,n)=>(d[n.id]=n,d),{})}catch{const{vaultListObj:d}=await T();return d}},e=async(a,d)=>{var h,o;const n=[],y={};for(const u of a){const{rewardConfigs:s,vaultPool:p}=u,m=d==null?void 0:d[p==null?void 0:p.id];if(!m)continue;const{clmm_pool:r,clmmPoolAddress:V}=m,i=(m==null?void 0:m.id)||(m==null?void 0:m.vaultId),f=(m==null?void 0:m.coin_type_a)||(m==null?void 0:m.coinTypeA),A=(m==null?void 0:m.coin_type_b)||(m==null?void 0:m.coinTypeB);n.push(f,A);const G=await((h=g==null?void 0:g.CetusClmmSDK)==null?void 0:h.Pool.getPool(r||V)),q=await g.Vaults.getPool(i),H=Pt((P==null?void 0:P.address)||"",u.balance,q,G),R=await v(f),E=await v(A),I=w(H.amount_a).div(10**(R==null?void 0:R.decimals)).toString(),z=w(H.amount_b).div(10**(E==null?void 0:E.decimals)).toString();y[i]={...u,isVaultsFarming:!0,rewardList:[],farmingPoolAmountA:I,farmingPoolAmountB:z,coinTypeA:f,coinTypeB:A};for(const D of s){const M=w((D==null?void 0:D.rate)||0);if(M.lte(0))continue;const Y=(o=D==null?void 0:D.coinDetail)==null?void 0:o.decimals,W=M.mul(60*60*24).div(10**Y).toString(),N=bt(w(W).toString(),2);y[i].rewardList.push({rewardItemRate:W,...D,rewardCoinType:D.rewardCoinType,rewardItemRateDisplay:N}),n.push(D.rewardCoinType)}}return{vaultsFarmObj:y,rewardCoinList:[...new Set(n)]}},c=async()=>{if(console.log(k,"getHaedalFarmingList"),k>=S)return;const a=await b();console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultsFarmingApiInfo.ts:118 ~ getHaedalFarmingList ~ haedalList:",a);const d=await _(),{vaultsFarmObj:n,rewardCoinList:y}=await e(a,d);return console.log(a,d,n,y,"getHaedalFarmingList"),j(n),F(y),x(h=>h+1),{vaultsFarmObj:n}};return{getHaedalFarm:c,getHaedalFarmingList:c}}function Xt(l){const{vaultsFarmObj:g}=ut(),t=O.useMemo(()=>g[l],[g,l]),P=O.useMemo(()=>t==null?void 0:t.isVaultsFarming,[t,l]);return{currentVaultsFarm:t,isVaultsFarming:P}}const Kt=ft((l,g)=>({lstVaultContractInfoObj:{},haedalVaultContractInfoObj:{},vaultClmmPoolContractInfoObj:{},dlmmVaultContractInfoObj:{},vaultDlmmPoolContractInfoObj:{},setLstVaultContractInfoObj:t=>{const P=g().lstVaultContractInfoObj;l(()=>({lstVaultContractInfoObj:{...P,...t}}))},setHaedalVaultContractInfoObj:t=>{const P=g().haedalVaultContractInfoObj;l(()=>({haedalVaultContractInfoObj:{...P,...t}}))},setVaultClmmPoolContractInfoObj:t=>{const P=g().vaultClmmPoolContractInfoObj;l(()=>({vaultClmmPoolContractInfoObj:{...P,...t}}))},setDlmmVaultContractInfoObj:t=>{const P=g().dlmmVaultContractInfoObj;l(()=>({dlmmVaultContractInfoObj:{...P,...t}}))},setVaultDlmmPoolContractInfoObj:t=>{const P=g().vaultDlmmPoolContractInfoObj;l(()=>({vaultDlmmPoolContractInfoObj:{...P,...t}}))}}));function Yt(){const{volatileVaultsSdk:l}=st(),{setPythPriceMap:g}=Et();return{getPythLastPrice:async P=>{const v=P.map(F=>Bt(F));try{const F=await l.VaultsV2.PythPrice.getLatestPrice(v);return g(F),F}catch(F){console.log("ðŸš€ðŸš€ðŸš€ ~ useGetPythLastPrice.ts:16 ~ getPythLastPrice ~ error:",F)}}}}const Zt=ft(l=>({vaultsPoolObj:{},setVaultsPoolObj:g=>l(t=>({vaultsPoolObj:{...t.vaultsPoolObj,...g}}))}));function me(){const{volatileVaultsSdk:l}=st(),g=Dt("vaults"),{setLstVaultContractInfoObj:t,setHaedalVaultContractInfoObj:P,setVaultClmmPoolContractInfoObj:v,setDlmmVaultContractInfoObj:F,setVaultDlmmPoolContractInfoObj:j}=Kt(),{setVaultsPoolObj:T}=Zt(),S=async b=>{const _=[],e=[],c=[],a=[],d=[];b.forEach(i=>{i.category=="cetus"?(_.push(i.vaultId),a.push(i.clmmPoolAddress)):i.category=="haedal"?(e.push(i.vaultId),a.push(i.clmmPoolAddress)):i.category=="cetus-dlmm"&&(c.push(i.vaultId),d.push(i.dlmmPoolAddress))});const{data:n}=await g.Vaults.getVaultList(),y=n.reduce((i,f)=>(i[f.id]=f,i),{});t(y);const{data:h}=await l.Vaults.getPoolList(),o=h.reduce((i,f)=>(i[f.id]=f,i),{});P(o);const{data:u}=await l.VaultsV2.getPoolList(),s=u.reduce((i,f)=>(i[f.id]=f,i),{});F(s);const m=(await l.CetusClmmSDK.Pool.getAssignPools(a)).reduce((i,f)=>(i[f.id]=f,i),{}),V=(await l.CetusDlmmSDK.Pool.getAssignPoolList(d)).reduce((i,f)=>(i[f.id]=f,i),{});return v(m),j(V),k(b,m,y,o,V,s),{lstVaultContractInfoObj:y,haedalVaultContractInfoObj:o,allClmmPoolContractInfoObj:m,allDlmmPoolContractInfoObj:V,dlmmVaultContractInfoObj:s}},k=async(b,_,e,c,a,d)=>{for(let n=0;n<b.length;n++){const y=b[n],h=y.category=="cetus"?e[y.vaultId]:y.category=="haedal"?c[y.vaultId]:d[y.vaultId],o=_[y.clmmPoolAddress],u=a[y.dlmmPoolAddress],s=y.category=="cetus-dlmm"?await L(y,u,h):x(y,o,h);T(s)}},x=(b,_,e)=>{const{tokenA:c,tokenB:a,category:d,isReverse:n,vaultId:y}=b,h=d=="haedal"?e.clmm_vault.wrapped_position.tick_lower_index:e.position.tick_lower_index,o=d=="haedal"?e.clmm_vault.wrapped_position.tick_upper_index:e.position.tick_upper_index,u=rt.tickIndexToPrice(h,c.decimals,a.decimals).toString(),s=rt.tickIndexToPrice(o,c.decimals,a.decimals).toString(),p=d=="haedal"?e.clmm_vault.wrapped_position.liquidity:e.position.liquidity,m=w(1).div(w(s)).toString(),r=w(1).div(w(u)).toString(),V=new ht(_.current_sqrt_price),i=rt.sqrtPriceX64ToPrice(V,c.decimals,a.decimals).toString(),f=w(1).div(w(i)).toString(),A=rt.tickIndexToSqrtPriceX64(h),G=rt.tickIndexToSqrtPriceX64(o),q=Ot.getCoinAmountFromLiquidity(new ht(p),V,A,G,!1),H=$(q.coin_amount_a.toString(),c.decimals).toString(),R=$(q.coin_amount_b.toString(),a.decimals).toString(),E=n?R:H,I=n?H:R,{percentA:z,percentB:D}=wt(H,R,i,!1),M=n?D:z,Y=n?z:D,W=U(w(e.protocol_fee_rate).div(1e4).mul(100).toString(),"%"),N=B(c.coin_type,!1),X=B(a.coin_type,!1),Z=n?X:N,at=n?N:X;let J,K,ot,nt,dt;d=="haedal"&&(J=e==null?void 0:e.quote_type,K=B(J,!1)==B(c.coin_type,!1)?c:a,ot=w(e==null?void 0:e.hard_cap).div(10**(K==null?void 0:K.decimals)).toString(),nt=J==c.coin_type?a:c,dt=nt.coin_type);const Q=d=="cetus"?e==null?void 0:e.total_supply:e==null?void 0:e.lp_token_treasury;return{[y]:{minPrice:n?m:u,minPriceResever:n?u:m,maxPrice:n?r:s,maxPriceResever:n?s:r,liquidity:p,displayAmountA:E,displayAmountB:I,displayPercentA:M,displayPercentB:Y,currentPrice:n?f:i,currentPriceReverse:n?i:f,disPlayProtocolFeeRate:W,displayCoinTypeA:Z,displayCoinTypeB:at,hardCap:ot,quoteCoinType:J,quoteCoin:K,baseCoin:nt,baseCoinType:dt,totalSupply:Q}}},L=async(b,_,e)=>{console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultsContract.ts:217 ~ wrapDlmVaultPoolContractInfo ~ dlmmContractInfo:",{dlmmContractInfo:_,vaultContractInfo:e,vault:b});const{tokenA:c,tokenB:a,category:d,isReverse:n,vaultId:y}=b,{bin_step:h,active_id:o,bin_manager:u}=_,{markets:s}=e,p=c.decimals,m=a.decimals,{position:r,valid_lower_bin_id:V,valid_upper_bin_id:i}=s[0].position_list[0];console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultsContract.ts:227 ~ wrapDlmmVaultPoolContractInfo ~ markets:",s),console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultsContract.ts:226 ~ wrapDlmmVaultPoolContractInfo ~ position:",s[0].position_list[0]);const f=V,A=i,G=Vt.getPriceFromBinId(f,h,p,m),q=Vt.getPriceFromBinId(A,h,p,m),H=r.liquidity_shares,R=w(1).div(w(q)).toString(),E=w(1).div(w(G)).toString(),I=Vt.getPriceFromBinId(o,h,p,m),z=w(1).div(w(I)).toString(),D=B(c.coin_type,!1),M=B(a.coin_type,!1),Y=n?M:D,W=n?D:M;console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultsContract.ts:246 ~ wrapDlmmVaultPoolContractInfo ~ position:",r);const N=await Rt(l,e.lp_token_treasury,e,_);console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultsContract.ts:246 ~ wrapDlmmVaultPoolContractInfo ~ poolBalanceInfo:",N);const X=$(N.receive_amount_a.toString(),c.decimals).toString(),Z=$(N.receive_amount_b.toString(),a.decimals).toString(),at=n?Z:X,J=n?X:Z,{percentA:K,percentB:ot}=wt(X,Z,I,!1),nt=n?ot:K,dt=n?K:ot;let Q,lt,St,yt,kt;d=="cetus-dlmm"&&(Q=e==null?void 0:e.quote_type,lt=B(Q,!1)==B(c.coin_type,!1)?c:a,St=w(e==null?void 0:e.hard_cap).div(10**(lt==null?void 0:lt.decimals)).toString(),yt=Q==c.coin_type?a:c,kt=yt.coin_type);const jt=U(w(e.protocol_fee_rate).div(1e4).mul(100).toString(),"%");return{[y]:{minPrice:n?R:G,minPriceResever:n?G:R,maxPrice:n?E:q,maxPriceResever:n?q:E,liquidity:H,displayAmountA:at,displayAmountB:J,displayPercentA:nt,displayPercentB:dt,currentPrice:n?z:I,currentPriceReverse:n?I:z,disPlayProtocolFeeRate:jt,displayCoinTypeA:Y,displayCoinTypeB:W,hardCap:St,quoteCoinType:Q,quoteCoin:lt,baseCoin:yt,baseCoinType:kt,totalSupply:e==null?void 0:e.lp_token_treasury,dlmmPoolAddress:b.dlmmPoolAddress}}};return{getVaultsContractInfo:S,getVaultPool:k,wrapVaultPoolContractInfo:x}}function Jt(){const{haedalFarmSdk:l}=st(),{setVaultsFarmingRewardsLoading:g,setVaultsFarmingRewards:t,vaultsFarmObj:P}=ut(),{currentAccount:v}=pt(),F=async(T,S,k)=>{try{const x=await l.Farms.getAvailableRewards(T),L=j(x,S,k,l.senderAddress);return t({[S]:L}),g(!1),L}catch(x){console.error("[VaultFarming] Error fetching rewards:",x),t([])}},j=(T,S,k,x)=>(P[S]||k).rewardConfigs.filter(b=>w(b.rate).gt(0)).map(b=>{var c;const _=(T==null?void 0:T[b.rewardCoinType])??"0",e=w(_).div(10**(((c=b.coinDetail)==null?void 0:c.decimals)??0)).toString();return{...b,rewardAmount:_,rewardAmountDisplay:e,ownerAddress:x||""}});return{getVaultFarmingRewards:F}}function Qt(){const{haedalFarmSdk:l}=st(),{setVaultsFarmingStakeLoading:g,setVaultsFarmingStaked:t,setVaultsFarmingRewardsLoading:P,vaultsFarmObj:v,vaultsFarmingStaked:F,vaultsFarmingStakeLoading:j}=ut(),{getVaultFarmingRewards:T}=Jt(),{currentAccount:S}=pt(),k=O.useRef(S==null?void 0:S.address);O.useEffect(()=>{k.current=S==null?void 0:S.address},[S==null?void 0:S.address]);const x=async(b,_,e)=>{console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultFarmingStaked.ts:55 ~ getVaultsFarmingStaked ~ getVaultsFarmingStaked:",x),console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultFarmingStaked.ts:56 ~ getVaultsFarmingStaked ~ vaultsFarmingStaked:",F);const c=F[_];console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultFarmingStaked.ts:35 ~ getVaultsFarmingStaked ~ currentVaultStaked:",c,k.current),console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultFarmingStaked.ts:35 ~ getVaultsFarmingStaked ~ vaultsFarmingStakeLoading:",j),(!c||c.ownerAddress!=k.current)&&!j&&(g(!0),P(!0));try{l.senderAddress=k.current;const a=await l.Farms.getFarmDeposit(b);if((S==null?void 0:S.address)==k.current){const d=L(a,_,e,k.current);return t({[_]:d}),T({stakeCoinType:b.stakeCoinType,poolId:b.poolId,stakeObjectId:d==null?void 0:d.stakeObjectId},_,e),g(!1),d}else g(!1),P(!1)}catch(a){console.error("[VaultFarming] Failed to fetch staked info:",a),t(void 0)}},L=(b,_,e,c)=>{console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultFarmingStaked.ts:56 ~ warpVaultsFarmingStaked ~ stakedInfo:",b);const a=v[_]||e,{stakedBalance:d,stakeObjectId:n}=b,{coinDetail:y,rewardConfigs:h}=a,o=w(d).div(10**((y==null?void 0:y.decimals)??0)).toString();return{poolId:a.poolId,stakeObjectId:n,stakedBalance:d,stakedBalanceFormat:o,stakedBalanceDisplay:bt(o,void 0,void 0,vt.ROUND_DOWN).toString(),coinDetail:y,stakeCoinType:a.stakeCoinType,rewardConfigs:(h??[]).filter(u=>w(u.rate).gt(0)),ownerAddress:c||""}};return{getVaultsFarmingStaked:x}}function pe(){const{lpTokenInfoObj:l}=mt(),{volatileVaultsSdk:g}=st(),{currentAccount:t}=pt(),{setVaultsPositionObj:P,setVaultsPositionLoading:v,setShowVaultsList:F}=At(),{setVaultListLoading:j}=mt(),{getVaultsFarmingStaked:T}=Qt(),{vaultsFarmObj:S}=ut(),k=O.useRef(t==null?void 0:t.address);O.useEffect(()=>{k.current=t==null?void 0:t.address},[t==null?void 0:t.address]);const x=async(e,c,a,d,n=!1,y)=>{const o=(await g.FullClient.getAllBalances({owner:t==null?void 0:t.address})).reduce((s,p)=>(s[p.coinType.toLowerCase()]=p,s),{}),u=[];for(let s=0;s<e.length;s++){const p=e[s],m=p.category=="cetus"?c[p.vaultId]:a[p.vaultId],r=d[p.clmmPoolAddress],V=o[p.lpTokenType.toLowerCase()],i=y[p.vaultId];console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultsPosition.ts:56 ~ useGetVaultsPosition ~ vaultsFarmingInfo:",i);const f=await L(p,r,m,n,V,t==null?void 0:t.address,void 0,i);it(f&&f[p.vaultId].balance||"0").gt(0)&&u.push(f)}v(!1),j(!1),F(u)},L=async(e,c,a,d=!1,n,y=t==null?void 0:t.address,h,o)=>{try{const{category:u}=e;let s,p;const m=S[e.vaultId]||o;console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultsPosition.ts:100 ~ useGetVaultsPosition ~ haedalFarmingInfo:",m);let r="0";if(m){let f=await T({stakeCoinType:m.stakeCoinType,poolId:m.poolId},e.vaultId,m);r=(f==null?void 0:f.stakedBalance)||"0",console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultsPosition.ts:112 ~ useGetVaultsPosition ~ haedalFarmingBalance:",r)}Gt(n)?p=n:p=await g.FullClient.getBalance({owner:y,coinType:e.lpTokenType}),console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultsPosition.ts:98 ~ useGetVaultsPosition ~ balance:",p);let V;u=="cetus"?s=qt.buildVaultBalance(y,a,p,c):u=="cetus-dlmm"?(s=await Ht(g,p.totalBalance,a,c,y),console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultsPosition.ts:123 ~ getVaultPosition ~ positionInfo:",s)):(s=Pt(y,it(p.totalBalance).add(r).toString(),a,c),console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultsPosition.ts:124 ~ useGetVaultsPosition ~ positionInfo:",{positionInfo:s,vaultContractInfo:a,poolContractInfo:c,balance:it(p.totalBalance).add(r).toString()}),V=Pt(y,p.totalBalance,a,c));const i=b({...s,ownerAddress:k.current==y?y:void 0,vaultBalance:p==null?void 0:p.totalBalance,vaultFarmingBalance:r,vault_amount_a:V==null?void 0:V.amount_a,vault_amount_b:V==null?void 0:V.amount_b},e,a,h);return d&&k.current==y?P(i):d||P(i),i}catch(u){console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultsPosition.ts:59 ~ getVaultPosition ~ error:",u)}},b=(e,c,a,d=l)=>{const n=d[c.lpTokenType],{amount_a:y,amount_b:h,ownerAddress:o,vaultFarmingBalance:u,vaultBalance:s,vault_amount_a:p,vault_amount_b:m}=e,{isReverse:r,tokenA:V,tokenB:i,category:f}=c,A=$(y,V.decimals).toString(),G=$(h,i.decimals).toString(),q=$(p,V.decimals).toString(),H=$(m,i.decimals).toString(),R=e.clmm_pool_id,E=e.liquidity,I=e.vault_id,z=_t(e.coin_type_a).full_address,D=_t(e.coin_type_b).full_address,M=_(n,e.lp_token_balance),{balanceFormat:Y,balanceDisplay:W}=_(n,s),N=f=="cetus"?it(M.balance).div(a.total_supply).mul(100).toString():it(M.balance).div(a.lp_token_treasury).mul(100).toString(),X=`${It(N,2,6)}%`,Z=r?i:V,at=r?V:i;return{[I]:{...M,amountA:A,amountB:G,displayAmountA:r?G:A,displayAmountB:r?A:G,coinTypeA:z,coinTypeB:D,displayCoinTypeA:r?D:z,displayCoinTypeB:r?z:D,liquidity:E,clmmPool:R,vaultId:I,sharePoolRate:N,shartOfPoolDisplay:X,tokenA:V,tokenB:i,displayTokenA:Z,displayTokenB:at,ownerAddress:o,vaultBalance:s,vaultBalanceFormat:Y,vaultBalanceDisplay:W,vaultFarmingBalance:u,displayVaultAmountA:r?H:q,displayVaultAmountB:r?q:H}}},_=(e,c)=>{const a=$(c,e==null?void 0:e.decimals).toString();return{balance:c,balanceFormat:a,balanceDisplay:bt(a,void 0,!1,vt.ROUND_DOWN).toString()}};return{getVaultPosition:L,getVaultsPosition:x}}function ge(){const{fetchTokenPrices:l}=gt(),{setVaultListLoading:g,setVaultsTokenList:t,lpTokenInfoObj:P,setLpTokenInfoObj:v,vaultsList:F,vaultPageList:j,setVaultPageList:T}=mt(),{getVaultPoolList:S}=xt(),{fetchTokenInfo:k,getTokenListInfo:x}=Tt(),{vaultsPositionObj:L,setShowVaultsList:b}=At(),{getPythLastPrice:_}=Yt(),e=(o,u=F)=>{console.log("ðŸš€ðŸš€ðŸš€ ~ useVaultList.ts:22 ~ filterVaultList ~ originList:",u);const{currentTab:s,isYourHoldings:p,selectCoinList:m,sortOptions:r}=o;let V=[],i=[];(m==null?void 0:m.length)>0?i=y(u,m):i=u,s==="all"?V=i:s==="cetus"?V=i.filter(A=>A.category==s):V=i.filter(A=>A.quoteType==s&&A.category!=="cetus");let f;return p?f=c(r,h(V)):f=c(r,V),T(f),b(f),f},c=(o,u)=>{console.log("ðŸš€ ~ sortVaultList ~ options:",o);const{sortRule:s,sortType:p}=o;return u==null?void 0:u.sort((r,V)=>p==="apr"?s==="desc"?V.vaultsTotalApy-r.vaultsTotalApy:r.vaultsTotalApy-V.vaultsTotalApy:s==="desc"?V.vaultsTvl-r.vaultsTvl:r.vaultsTvl-V.vaultsTvl)},a=async(o,u=!0)=>{u&&g(!0);const{poolList:s}=await S();d(s),n(s);const p=e(o,JSON.parse(JSON.stringify(s)));g(!1),T(p),b(p)},d=async o=>{if(!o||o.length===0)return;const u=[],s=[];for(let r=0;r<o.length;r++)u.includes(o[r].displayTokenA.coin_type)||u.push(o[r].displayTokenA.coin_type),u.includes(o[r].displayTokenB.coin_type)||u.push(o[r].displayTokenB.coin_type),(o[r].category=="haedal"||o[r].category=="cetus-dlmm")&&!s.includes(B(o[r].displayTokenA.coin_type))&&s.push(B(o[r].displayTokenA.coin_type,!1)),(o[r].category=="haedal"||o[r].category=="cetus-dlmm")&&!s.includes(B(o[r].displayTokenB.coin_type))&&s.push(B(o[r].displayTokenB.coin_type,!1));_(s),u.length>0&&l(u);const p=await x(u),m=Array.from(p.values());t(m)},n=async o=>{var s,p;const u={};for(let m=0;m<o.length;m++){const r=o[m],V=r==null?void 0:r.lpTokenType;(s=Ft[r.clmmPoolAddress])!=null&&s.lpToken?u[V]=(p=Ft[r.clmmPoolAddress])==null?void 0:p.lpToken:P[V]?u[V]=P[V]:u[V]=await k(V)}return v(u),u},y=(o,u)=>{var r,V,i,f;const s=(r=u[0])!=null&&r.coin_type?B((V=u[0])==null?void 0:V.coin_type):void 0,p=(i=u[1])!=null&&i.coin_type?B((f=u[1])==null?void 0:f.coin_type):void 0;return o==null?void 0:o.filter(A=>s&&p?B(A.displayTokenA.coin_type)==s&&B(A.displayTokenB.coin_type)==p||B(A.displayTokenA.coin_type)==p&&B(A.displayTokenB.coin_type)==s:s?B(A.displayTokenA.coin_type)==s||B(A.displayTokenB.coin_type)==s:A)},h=o=>o.filter(u=>{const s=L[u.vaultId];return!!(s&&w(s.balance).gt(0))});return{filterVaultList:e,sortVaultList:c,fetchVaultList:a,vaultPageList:j,getVaultsLpTokenList:n,getVaultsTokenList:d,setVaultPageList:T}}function te(l){const{vaultListObj:g}=mt();return{currentVaults:O.useMemo(()=>g[l],[g,l])}}function ye(l,g,t,P,v,F,j){const{getTokenAmountValueByPyth:T}=Ut(),{getTokenAmountValue:S}=gt(),k=j=="haedal"||j=="cetus-dlmm"?T(t,l):S(t,l),x=j=="haedal"||j=="cetus-dlmm"?T(P,g):S(P,g),L=U(k,"$"),b=U(x,"$"),_=w(k).plus(x||0).toString(),e=U(_,"$"),c=S(t,v),a=S(P,F);U(c,"$"),U(a,"$");const d=w(c).plus(a||0).toString(),n=U(d,"$");return{holdCoinAValue:k,holdCoinBValue:x,holdCoinAValueDisplay:L,holdCoinBValueDisplay:b,holdingAmount:_,holdingAmountDisplay:e,holdingVaultAmount:d,holdingVaultAmountDisplay:n}}function ee(l){const{getTokenAmountValue:g}=gt(),[t,P]=O.useState(""),[v,F]=O.useState(""),[j,T]=O.useState(""),[S,k]=O.useState(""),[x,L]=O.useState(!0);return O.useEffect(()=>{if(!l){P(""),F(""),T(""),k("");return}L(!0);try{const{farmingPoolAmountA:b,farmingPoolAmountB:_,coinTypeA:e,coinTypeB:c,rewardList:a}=l,d=g(e,b),n=g(c,_),y=w(d).add(n);k(y.toString()),F(U(y.toString(),"$"));let h=w(0);for(const o of a)h=h.add(g(o.rewardCoinType,o.rewardItemRate));if(h.eq(0)||y.eq(0))P(""),T("");else{const o=h.div(y).mul(365).toString();T(o),P($t(o,!0)),L(!1)}}catch(b){console.error("[VaultFarming] APR calculation error:",b),P("")}},[l,g]),{vaultFarmingApr:j,vaultFarmingAprDisplay:t,farmingTvl:S,farmingTvlDisplay:v,vaultFarmingLoading:x}}function Ve({vaultId:l,wrapStyle:g,farmingTextStyle:t={}}){const{currentVaultsFarm:P,isVaultsFarming:v}=Xt(l),{vaultFarmingAprDisplay:F}=ee(P),{currentVaults:j}=te(l),{vaultsApyDisplay:T,vaultsLstApyDisplay:S,vaultsTotalApyDisplay:k,vaultsAprDisplay:x,category:L}=j||{};return C.jsx(zt,{tooltip:L=="cetus"?C.jsx(se,{vaultsApyDisplay:T,vaultsLstApyDisplay:S,vaultsTotalApyDisplay:k}):C.jsx(ae,{vaultsApyDisplay:T,vaultsAprDisplay:x,vaultFarmingAprDisplay:F,isVaultsFarming:v}),placement:"bottom",children:C.jsxs(et,{gap:{base:"4px",lg:"2px"},alignItems:{base:"flex-end",lg:"center"},...g,children:[C.jsx(tt,{textColor:"text_caption",textAlign:"right",fontWeight:"500",textDecoration:"underline dotted",color:"primary",children:L=="cetus"?k:T}),v&&F&&C.jsxs(tt,{bg:"primary_yellow_opacity.10",color:"primary_yellow",borderRadius:"4px",fontSize:"12px",p:{base:"0px 6px",lg:"0px 4px"},...t,children:["+",F]})]})})}const se=({vaultsLstApyDisplay:l,vaultsApyDisplay:g,vaultsTotalApyDisplay:t})=>C.jsx(et,{gap:"12px",w:"100%",pt:"8px",children:C.jsxs(et,{children:[C.jsx(ct,{label:"Total APY",labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},wrapStyle:{gap:"16px"},value:t}),C.jsx(Mt,{h:"1px",w:"100%",backgroundColor:"border"}),C.jsx(ct,{label:"Fees and Rewards",labelStyle:{fontSize:"12px"},valueStyle:{fontSize:"12px"},wrapStyle:{gap:"16px"},value:g}),C.jsx(ct,{label:"LST",labelStyle:{fontSize:"12px"},wrapStyle:{gap:"16px"},value:l,valueStyle:{fontSize:"12px"}})]})}),ae=({vaultsApyDisplay:l,vaultsAprDisplay:g,vaultFarmingAprDisplay:t,isVaultsFarming:P})=>{const[v,F]=O.useState(!1);return C.jsxs(et,{w:"250px",onClick:j=>{j.stopPropagation()},children:[C.jsxs(et,{bg:"bg_fifth",borderRadius:"8px",p:"12px 16px",gap:"10px",children:[C.jsx(ct,{label:"Cetus LP APR",value:g,labelStyle:{fontSize:"12px"},valueStyle:{fontSize:"12px"}}),C.jsx(Nt,{m:"8px 0",height:"1px",w:"100%",bg:"border"}),C.jsx(ct,{label:"Vault APY",value:l}),C.jsx(tt,{fontSize:"12px",lineHeight:"20px",children:"(Compounding Cetus LP APR Multiple Times a Day)"})]}),P&&t&&C.jsxs(et,{w:"100%",bg:"primary_yellow_opacity.10",borderRadius:"8px",p:"12px 16px",gap:"10px",alignItems:"flex-start",children:[C.jsx(tt,{color:"text_caption",fontSize:"12px",children:"3rd party farming rewards available."}),C.jsxs(tt,{mt:"4px",color:"primary_yellow",fontSize:"12px",children:["Farming APR +",t]}),C.jsx(tt,{fontSize:"12px",children:"Incentives on Haedal"})]})]})};export{Ve as V,Xt as a,Zt as b,ut as c,Yt as d,ee as e,ge as f,me as g,pe as h,de as i,Kt as j,Qt as k,te as l,ye as u};
