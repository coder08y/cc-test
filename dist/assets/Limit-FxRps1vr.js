import{r as l,j as e,i as fe,ai as G,aj as E,al as Ke,am as Xe,an as Y,ah as Ie,C as qe,l as ye,ao as Rt,M as et,o as tt,p as st,$ as it,a0 as $t,q as rt,t as nt,V as J,H as T,T as k,m as Nt,w as pe,I as $e,Z as Dt,B as Bt}from"./vendor-CBmAETR3.js";import{T as Ht,a as Ft,P as zt,L as Wt}from"./LimitPriceChart-Cr4mg9e0.js";import Vt from"./index-BgQmCaZo.js";import{O as Ne,H as De}from"./HistoryCard-CqU1nL7d.js";import{M as de,i as Gt,Q as Se,z as Be,f as He,e as Fe,d as z,O as ze,E as _e,a7 as Yt,j as We,Z as W,B as Ve,u as he,C as ot,I as ct,t as Ge,a8 as Ut,cU as Zt,v as Qt,a as Ct,w as Jt}from"./index-BpSfzecM.js";import"./cross-DJ28FxNa.js";import{P as at}from"./Table-CbnPAf5M.js";import{N as xe}from"./NoData-BFX9XpKb.js";import{b as lt}from"./FarmsTable-UIjeXFuA.js";import{C as pt,P as we,E as dt,F as ut,S as Kt,L as Xt,a as xt,O as It,u as mt,b as qt,c as es}from"./useGetLimitOrderHistory-EcuJl4tr.js";import{A as ts}from"./aggregator-CyPcoC3_.js";import{u as Ye}from"./useTransaction-uEos3ZjK.js";import{u as Pe}from"./index-FuOBGqkF.js";import{a as Ue}from"./useSwapHelper-RreJ3kMc.js";import{u as ft}from"./useAccountBalance-DV0qM_Vy.js";import{u as Ze}from"./useTokenBalance-c3RAkCCY.js";import{u as ss}from"./useInsufficientBalanceToast-BgAdjI7g.js";import{u as is}from"./useFindBestRouting-CX4IIQLi.js";import{T as rs}from"./TradeInputGroup-C0B6uidS.js";import{W as ns}from"./WarningTokenTipModal-BPL2NtCc.js";import{M as os,C as cs}from"./MenuDropBlock-CMpFPHwx.js";import"./AggregatorModal-BBTaBCXS.js";import"./useSwap-C3hmZP9P.js";import"./swap-BzZMpsSt.js";import"./FreshProgressV2-DfCij7Ow.js";import"./RfqRightWidget-Dhgrm_Tf.js";import{T as as}from"./TradeConfirmAmountInfo-C8pVFbTE.js";import{I as me}from"./InputBox-DUnOULwS.js";import{a as ls}from"./index-gw6wWhzj.js";import{u as ps}from"./useInterval-FApnpfRj.js";import{u as ds}from"./useRpcListener-BdFabOsZ.js";import{R as Qe}from"./RefreshButton-bgRHxGzR.js";import"./charting_library.esm-BuRCvzzK.js";import"./CarouselBlock-dT9fdd14.js";import"./en_US-KAK2ZBDO-C1Pw6Q2s.js";import"./v4-C6aID195.js";import"./useProData-Du7iVR5k.js";import"./SearchInput-BbbP2kao.js";import"./FilterTable-C8oTyqVr.js";import"./useTokenRank-CM-9-tXe.js";import"./useDocumentSize-BLl0gbMB.js";import"./index-CbQm3ih3.js";import"./debounce-MPJy35Ge.js";import"./index-D8UqOC8m.js";import"./CoinAuditCheck-CSsuXZxc.js";import"./TokenGoplusCard-D6NKwkuF.js";import"./HTextLabelBox-D0r99Smv.js";import"./VTextLabelBox-CuuDZpMe.js";import"./CheckBox-eomO844M.js";import"./usePositionList-heG2hQcx.js";import"./useWrapPoolData-CMGMCXwG.js";import"./dlmm-DdxfaipV.js";import"./utils-CMHkC_9A.js";import"./useFavoritePool-5MLb1oZG.js";import"./useGetPoolList-4kFQ2tyG.js";import"./index-DfyAgMoy.js";import"./ExpendItem-BR-Au2GE.js";import"./LiquidityValueBlock-CJnPKpci.js";import"./msafe-BzcjPV-e.js";import"./PositionPriceRangeBar-Bdy_fJqo.js";import"./RangeValue-CrFwA76f.js";import"./CoinPairInfo-BH5hoU3X.js";import"./config-DTm0VBgZ.js";import"./PoolTag-DVhitHGR.js";import"./IconText-CCehETWQ.js";import"./Drawer-DX1wga2y.js";import"./useTrack-Cdn9qear.js";import"./useSigner-Ct94kXtL.js";import"./useTransactionModal-DL7w_I3R.js";import"./_baseClone-B759QteI.js";import"./_getAllKeysIn-Juzb7Mj8.js";import"./_defineProperty-Bpc363rP.js";import"./last-CxFZ9vay.js";import"./IconBg-Bcw9JXPW.js";import"./TooltipIcon-DVhxXZmh.js";import"./index-CgYRIMgB.js";import"./index-Dq_SzPY7.js";import"./useChainTime-DNIcZpVU.js";import"./SolidPieCountdown-B9kgZHE-.js";import"./CurrentPrice-D1qM8kFS.js";import"./usePreviousValue-Da-o2xpb.js";function us({historyInfo:i}){const[a,c]=l.useState({});return e.jsxs(fe.Fragment,{children:[e.jsxs(G,{cursor:"pointer",onClick:()=>{a[i==null?void 0:i.order_id]?a[i==null?void 0:i.order_id]=!1:a[i==null?void 0:i.order_id]=!0,c({...a})},sx:{td:{pb:a[i==null?void 0:i.order_id]?"20px !important":"16px !important"}},children:[e.jsx(E,{w:"30%",children:e.jsx(pt,{info:i})}),e.jsx(E,{w:"20%",textAlign:"right",children:e.jsx(we,{info:i})}),e.jsx(E,{textAlign:"right",children:e.jsx(dt,{info:i})}),e.jsx(E,{textAlign:"right",children:e.jsx(ut,{info:i})}),e.jsx(E,{textAlign:"right",children:e.jsx(Kt,{historyInfo:i,openExpendItemObj:a})})]}),!a[i==null?void 0:i.order_id]&&e.jsx(G,{h:"16px"}),e.jsx(G,{position:"relative",top:"-20px",left:"0px",sx:{td:{p:"0 !important",bg:"transparent !important",border:"none !important",_first:{borderRadius:" 16px !important"},_last:{borderRadius:"0 0 16px 0 !important"}},_hover:{bg:"transparent !important",td:{bg:"transparent !important"}}},children:a[i==null?void 0:i.order_id]&&e.jsx(E,{colSpan:5,children:e.jsx(Xt,{historyInfo:i})})})]},i==null?void 0:i.order_id)}function xs(i){const{historyOrderList:a,historyOrderLoading:c}=i;console.log("ðŸš€ ~ HistoryTableList ~ historyOrderList:",a);const{currentAccount:f,onWalletModal:g}=de(),d=10,[h,p]=l.useState([]),[s,n]=l.useState(0),[j,m]=l.useState(1);return l.useEffect(()=>{if((a==null?void 0:a.length)>0){n(a==null?void 0:a.length);const P=(j-1)*d,t=P+d;p(a.slice(P,t))}},[j,a]),e.jsxs(Ke,{variant:"simple_list",w:"100%",sx:{td:{h:"66px !important"}},children:[e.jsx(Xe,{children:e.jsxs(G,{children:[e.jsx(Y,{children:"Order Info"}),e.jsx(Y,{textAlign:"right",children:"Limit Price"}),e.jsx(Y,{textAlign:"right",children:"Expiry"}),e.jsx(Y,{textAlign:"right",children:"Filled Size"}),e.jsx(Y,{textAlign:"right",children:"Status"})]})}),e.jsx(Ie,{children:f!=null&&f.address?c?e.jsx(lt,{itemList:[1,2,3],skeletonNum:5,rowStyle:{h:"66px"}}):a.length===0?e.jsx(G,{sx:{td:{bg:"none !important",p:"0 !important",border:"none !important"}},children:e.jsx(E,{colSpan:5,w:"100%",children:e.jsx(xe,{type:"nodata",text:"You don't have any order history."})})}):e.jsxs(fe.Fragment,{children:[h.map(P=>e.jsx(us,{historyInfo:P},P.order_id)),!c&&(a==null?void 0:a.length)>d&&e.jsx(E,{colSpan:5,w:"100%",pt:"0px !important",children:e.jsx(qe,{w:"100%",children:e.jsx(at,{total:s,size:d,currentPage:j,onChange:m})})})]}):e.jsx(G,{sx:{td:{bg:"none !important",p:"0 !important",border:"none !important"}},children:e.jsx(E,{colSpan:5,w:"100%",children:e.jsx(xe,{type:"nowallet",onboard:()=>{g(!0)}})})})})]})}const ms=(i,a)=>({quoteToken:void 0,payCoin:void 0,targetCoin:void 0,setPayCoin:c=>{i(()=>({payCoin:c}))},setTargetCoin:c=>{i(()=>({targetCoin:c}))},setQuoteToken:c=>{i(()=>({quoteToken:c}))},expiresIn:"7 Days",setExpiresIn:c=>{i(()=>({expiresIn:c}))},customExpiresVal:null,setCustomExpiresVal:c=>{i(()=>({customExpiresVal:c}))},refreshPriceLoading:!1,setRefreshPriceLoading:c=>{i(()=>({refreshPriceLoading:c}))}}),se=Gt(ms);function Ce(i,a){const{getTokenPrice:c}=Se(),f=c(i),g=c(a),d=l.useMemo(()=>{if(f&&g){const p=Be(f.price).div(g.price).toString(),s=p.toString();return{price:p,displayPrice:s}}},[f,g]),h=(p,s)=>{const n=c(p),j=c(s);if(n&&j)return Be(n.price).div(j.price).toString()};return{price:d==null?void 0:d.price,displayPrice:d==null?void 0:d.displayPrice,getPrice:h}}function ht(){const{payCoin:i,targetCoin:a,setRefreshPriceLoading:c}=se(),{fetchTokenPrices:f}=Se();return{refreshCoinMarketPrice:()=>{const d=[];i&&d.push(i.coin_type),a&&d.push(a.coin_type),d.length>0&&(c(!0),f(d).finally(()=>{c(!1)}))}}}function fs(){const{refreshCoinMarketPrice:i}=ht(),{fetchAccountBalance:a}=ft(),{fetchMyLimitOrder:c}=xt(),{signAndExecuteTransaction:f}=Ye(),g=He("limit"),{findBestRouters:d}=is(),{getTokenAmountValue:h}=Se(),p=ye(),{pay:s,target:n}=Rt();Fe();const{fetchTokenInfo:j}=Fe(),{setCurrentProTab:m,currentProTab:P}=Pe(),{payCoin:t,targetCoin:r,quoteToken:x,expiresIn:N,setPayCoin:_,setTargetCoin:B,setQuoteToken:D,customExpiresVal:R,setExpiresIn:U,setRefreshPriceLoading:w}=se(),[L,Z]=l.useState(""),[$,V]=l.useState(""),[K,q]=l.useState(!0),[F,X]=l.useState(!0),[y,S]=l.useState(""),{displayPrice:v}=Ce((x==null?void 0:x.coin_type)===(t==null?void 0:t.coin_type)?r==null?void 0:r.coin_type:t==null?void 0:t.coin_type,x==null?void 0:x.coin_type),{balanceInfo:M}=Ze(t),{balanceInfo:H}=Ze(r),O=h(t==null?void 0:t.coin_type,L),I=h(r==null?void 0:r.coin_type,$),[ee,ie]=l.useState(""),oe=l.useRef(ee);l.useEffect(()=>{oe.current=ee},[ee]);const[u,Le]=l.useState(void 0),[ce,ve]=l.useState(""),gt=l.useRef(L),bt=l.useRef($);l.useEffect(()=>{gt.current=L},[L]),l.useEffect(()=>{bt.current=$},[$]),l.useEffect(()=>{(async()=>{if(console.log("0630ðŸš€ ~ fetTokenInfo ~ pay:",s),console.log("0630ðŸš€ ~ fetTokenInfo ~ target:",n),(!s||s==="undefined")&&(!n||n==="undefined")){_(We.clmm_swap.from_coin),B(We.clmm_swap.to_coin);return}s&&s!=="undefined"?j(s).then(b=>{b?(b==null?void 0:b.coin_type)!==(t==null?void 0:t.coin_type)&&_(b):p(`/limit/${t==null?void 0:t.coin_type}/${r==null?void 0:r.coin_type}`)}).catch(()=>{p(`/limit/${t==null?void 0:t.coin_type}/${r==null?void 0:r.coin_type}`)}):_(void 0),n&&n!=="undefined"?j(n).then(b=>{b?(b==null?void 0:b.coin_type)!==(r==null?void 0:r.coin_type)&&B(b):p(`/limit/${t==null?void 0:t.coin_type}/${r==null?void 0:r.coin_type}`)}).catch(()=>{p(`/limit/${t==null?void 0:t.coin_type}/${r==null?void 0:r.coin_type}`)}):B(void 0)})()},[s,n]),l.useEffect(()=>()=>{_(void 0),D(void 0),B(void 0)},[]),l.useEffect(()=>{if(Le(void 0),i(),jt(),t&&r){const o=t.extensions&&t.extensions.rank||"0",b=r.extensions&&r.extensions.rank||"0";console.log("ðŸš€ ~ useEffect ~ payCoinRank:",t,r),z(o).gte(b)?D({...t}):D({...r})}},[t==null?void 0:t.coin_type,r==null?void 0:r.coin_type]);const jt=async()=>{if(t&&r){const o=`${t.coin_type}_${r.coin_type}`;ie(o);const b=Object.entries(ts).map(([C,te])=>te.id),Q=await d({fromToken:t,toToken:r,amount:ze(1,t.decimals),providersKeys:b,by_amount_in:!0,uuid:o});o===oe.current&&Le(Q)}};l.useEffect(()=>{F?S(v||""):Oe()},[v]),l.useEffect(()=>{x&&!F&&+y&&S(_e(z(1).div(y).toFixed(x.decimals)).toString())},[x==null?void 0:x.coin_type]),l.useEffect(()=>{Te(K?L:$,K),Oe()},[y]);const[ae,_t]=l.useState({tooltip:"",color:"",text:"",bg:""}),[yt,Me]=l.useState(!1),Oe=()=>{var o,b;if(!F&&v&&y){Me(!0);const Q=z(y).sub(v).div(v).mul(100).toFixed(2);ve(Q);const C=z(Q).gt(0),te=C?Q:Q.split("-")[1],A={tooltip:"",color:"",text:"",bg:""};A.tooltip=`Limit order price is ${te}% ${C?"higher":"lower"} than the market.`,((o=x==null?void 0:x.coin_type)==null?void 0:o.toLowerCase())==((b=r==null?void 0:r.coin_type)==null?void 0:b.toLowerCase())?Number(y)>Number(v)?(A.text="",A.color="#68FFD8"):Number(v)>Number(y)&&(A.text=`Your limit order price is ${te}% ${C?"higher":"lower"} than market. You are selling at a much ${C?"higher":"lower"} rate. We recommend you to use`,A.color="#ffb62d",A.bg="rgba(255,202,104,0.1)"):Number(y)>Number(v)?(A.text=`Your limit order price is ${te}% ${C?"higher":"lower"} than market. You are buying at a much ${C?"higher":"lower"} rate. We recommend you to use`,A.color="#ffb62d",A.bg="rgba(255,202,104,0.1)"):Number(v)>Number(y)&&(A.text="",A.color="#68FFD8"),_t(A),Me(!1);return}ve("")},St=(o=!0)=>{console.log("ðŸš€ ~ handleMarketPriceClick ~ marketPrice:",v),X(o),o&&(S(v||""),i())},Te=(o,b)=>{if(q(b),b?Z(o):V(o),x&&t&&r&&+y&&+o)if(b){x.coin_type===t.coin_type?V(z(o).div(y).toString().toString()):V(z(o).mul(y).toString().toString());return}else{x.coin_type===r.coin_type?Z(z(o).div(y).toString().toString()):Z(z(o).mul(y).toString().toString());return}b?V(""):Z("")},wt=(o,b)=>{Ae(),q(b),X(!0),b?W(o==null?void 0:o.coin_type)===W(r.coin_type)?(p(`/limit/${o==null?void 0:o.coin_type}/${t==null?void 0:t.coin_type}`),m(P==="Buy"?"Sell":"Buy")):p(`/limit/${o==null?void 0:o.coin_type}/${r==null?void 0:r.coin_type}`):W(o==null?void 0:o.coin_type)===W(t.coin_type)?(p(`/limit/${r==null?void 0:r.coin_type}/${o==null?void 0:o.coin_type}`),m(P==="Buy"?"Sell":"Buy")):p(`/limit/${t==null?void 0:t.coin_type}/${o==null?void 0:o.coin_type}`)},{getPrice:Pt}=Ce(),Lt=o=>{const b=Pt(r==null?void 0:r.coin_type,t==null?void 0:t.coin_type);S(b||""),t!=null&&t.coin_type&&W((t==null?void 0:t.coin_type)||"")===W(s||"")||t!=null&&t.coin_type&&!s?p(`/limit/${r==null?void 0:r.coin_type}/${t==null?void 0:t.coin_type}`):(t!=null&&t.coin_type&&(t==null?void 0:t.coin_type)!=="undefined"&&(!(r!=null&&r.coin_type)||(r==null?void 0:r.coin_type)=="undefined")||r!=null&&r.coin_type&&(r==null?void 0:r.coin_type)!=="undefined"&&(!(t!=null&&t.coin_type)||(t==null?void 0:t.coin_type)=="undefined"))&&(console.log("useLimitAddAction ðŸš€ ~ onReverseClick ~ targetCoin?.coin_type:",r==null?void 0:r.coin_type),console.log("useLimitAddAction ðŸš€ ~ onReverseClick ~ payCoin?.coin_type:",t==null?void 0:t.coin_type),p(`/limit/${r==null?void 0:r.coin_type}/${t==null?void 0:t.coin_type}`)),o&&m(P==="Buy"?"Sell":"Buy","toggleBtn")},Ae=()=>{Z(""),V("")};l.useEffect(()=>()=>{U("7 Days")},[]);const[vt,ge]=l.useState(!1),Mt=o=>{switch(o){case"5 Minutes":return 3e5;case"10 Minutes":return 6e5;case"30 Minutes":return 18e5;case"1 Hour":return 36e5;case"1 Day":return 864e5;case"3 Days":return 2592e5;case"7 Days":return 6048e5;case"1 Month":return 2592e6;default:return 0}},{showInsufficientBalanceToast:Ot}=ss(),{transactionConfirmation:Tt}=Ye(),At=He("clmm"),{addToken:Ee}=Yt(),Et=async()=>{const o={getShowInfo:(ne,Re)=>{const ue="Creating order",le={modalDescriptionText:ue,toastTitleText:ue};return ne==="success"&&(le.toastDescriptionContent="",le.modalDescriptionText="Created order successfully",le.toastTitleText="Created order successfully"),ne==="rejected"&&(le.toastTitleText="Create order"),le}};Tt(o);const b=Date.parse(new Date().toString())+(Mt(N)||R);console.log(" ~ handleSubmitOrder ~ expired_ts:",b),ge(!0);const Q=await At.CetusConfig.getTokenListByCoinTypes([t.coin_type,r.coin_type]),C=t.decimals,te=r.decimals,A=Q[t.coin_type].decimals,be=Q[r.coin_type].decimals;t&&C!==A&&Ee({...t,decimals:A}),r&&te!==be&&Ee({...r,decimals:be});let je;(x==null?void 0:x.coin_type)===(r==null?void 0:r.coin_type)?je=y:je=z(1).div(y).toString();try{const ne={pay_coin_type:t.coin_type,target_coin_type:r.coin_type,expired_ts:b,target_decimal:be,pay_decimal:A,price:Number(je),pay_coin_amount:String(ze(L,A))},Re=await g.LimitOrder.placeLimitOrder(ne),ue=await f(Re,o);ge(!1),ue&&(a(),c(),Ae())}catch(ne){Ot(String(ne)),ge(!1)}},{currentAccount:re}=de(),ke=l.useMemo(()=>{const o=h(t==null?void 0:t.coin_type,L);return Number(o)==0&&Number(L)>0?!1:Number(o)<5},[t,L]),kt=l.useMemo(()=>{const o={text:"Place Limit Order",disabled:!1};return re!=null&&re.address?!t||!r?(o.disabled=!0,o.text=" Select a token",o):!Number(L)||!Number($)?(o.disabled=!0,o.text="Enter an amount",o):ke?(o.disabled=!0,o.text="Order size should be higher than $5",o):Number(L)>Number(M==null?void 0:M.balanceFormat)||!(M!=null&&M.balanceFormat)?(o.disabled=!0,o.text=`Insufficient ${t==null?void 0:t.symbol} balance`,o):u&&u.errorCode&&(u.errorCode===Ue.NoRouter||u.errorCode===Ue.HoneyPot)?(o.text="No Available Route",o.disabled=!0,o):(console.log("ðŸš€ ~ buttonTextStatus ~ priceImpact:",12,ae.color,ae,ce),ae.color.toLowerCase()=="#ffb62d"&&(Number(ce)<-10||Number(ce)>10)&&(o.disabled=!0),o):(o.disabled=!1,o.text="Connect Wallet",o)},[re==null?void 0:re.address,t,r,u,L,$,ke,M,JSON.stringify(ae),ce]);return{priceImpactInfoLoading:yt,priceImpactInfo:ae,fixPayCoin:K,onReverseClick:Lt,handleSelectToken:wt,marketPrice:v,payCoin:t,targetCoin:r,handleAmountChange:Te,payAmount:L,targetAmount:$,payBalanceInfo:M,targetBalanceInfo:H,payAmountValue:O,targetAmountValue:I,useMarketPrice:F,handleMarketPriceClick:St,inputPrice:y,setInputPrice:S,priceImpact:ce,quoteToken:x,setQuoteToken:D,handleSubmitOrder:Et,submitOrderLoading:vt,buttonTextStatus:kt}}const hs=({confirmData:i,isOpen:a,onClose:c,handleSubmitOrder:f,submitOrderLoading:g})=>{const{payAmount:d,targetAmount:h,payCoin:p,targetCoin:s,inputPrice:n,expiresIn:j,quoteToken:m}=i,P=l.useMemo(()=>{var r,x;return console.log("ðŸš€ ~ price ~ inputPrice:",n),n?((r=m==null?void 0:m.coin_type)==null?void 0:r.toLowerCase())==((x=s==null?void 0:s.coin_type)==null?void 0:x.toLowerCase())?n:z(1).div(n).toString():""},[m,s,n]),t=l.useMemo(()=>{var r,x;return n?((r=m==null?void 0:m.coin_type)==null?void 0:r.toLowerCase())==((x=s==null?void 0:s.coin_type)==null?void 0:x.toLowerCase())?z(1).div(n).toString():n:""},[m,s,n]);return e.jsxs(et,{autoFocus:!1,returnFocusOnClose:!1,isOpen:a,onClose:c,isCentered:!0,children:[e.jsx(tt,{}),e.jsxs(st,{children:[e.jsx(it,{children:e.jsx($t,{fontWeight:"500",fontSize:"16px",children:"Review your order"})}),e.jsx(rt,{}),e.jsx(nt,{textAlign:"center",p:"0px",children:e.jsxs(J,{w:"100%",gap:"16px",p:"16px",children:[e.jsx(as,{coinA:{amount:_e(d,p==null?void 0:p.decimals).toString()||"0",...p},iconParams:{xlinkHref:"#icon-a-icon_trade",svgFill:"text_caption",fontSize:"12px"},coinB:{amount:_e(h,s==null?void 0:s.decimals).toString()||"0",...s}}),e.jsxs(T,{w:"100%",justify:"space-between",children:[e.jsx(k,{children:"Price"}),e.jsx(Nt,{isLoaded:!!n,children:e.jsx(we,{info:{pay_coin:p,target_coin:s,price:P,reseverPrice:t}})})]}),e.jsxs(T,{w:"100%",justify:"space-between",children:[e.jsx(k,{children:"Expires in"}),e.jsx(k,{color:"text_caption",children:j})]}),e.jsx(Ve,{borderRadius:"12px",p:"8px",children:e.jsx(k,{lineHeight:"20px",textAlign:"left",fontSize:"12px",children:"You will receive exactly what you have specified if your order is fully filled in the end."})}),e.jsx(Ve,{borderRadius:"12px",p:"8px",children:e.jsx(k,{lineHeight:"20px",textAlign:"left",fontSize:"12px",children:"Please note that your order may not be filled immediately after the price is triggered, depending on pending sequence and liquidity depth."})}),e.jsx(pe,{onClick:()=>{f(),c()},isDisabled:g,w:"calc(100% + 32px)",mb:"-30px",h:"52px",fontWeight:"500",children:"Place Order"})]})})]})]})},gs=({isOpen:i,onClose:a})=>{const{isApp:c}=he(),{setCustomExpiresVal:f,setExpiresIn:g}=se(),[d,h]=l.useState(""),[p,s]=l.useState(""),n=N=>{const _=N.target.value.replace(/[^\d]/g,"");h(_)},j=N=>{const _=N.target.value.replace(/[^\d]/g,"");s(_)},[m,P]=l.useState({}),t=(N,_)=>{const B=Number(N||0)*60+Number(_||0),D=Math.floor(B/(60*24)),R=Math.floor(B%(60*24)/60),U=B%60;let w="";D>0&&(w+=D+"d "),R>0&&(w+=R+"h "),U>0&&(w+=U+"m "),P({timeText:w.trim()||"0 m",time:B*60*1e3})};l.useEffect(()=>{t(d,p)},[d,p]);const r=l.useMemo(()=>!d&&!p||Number(d)==0&&!p||Number(p)==0&&!d||Number(d)==0&&Number(p)==0,[d,p]),x=()=>{g(m==null?void 0:m.timeText),f(m==null?void 0:m.time),a()};return e.jsxs(et,{autoFocus:!1,returnFocusOnClose:!1,isOpen:i,onClose:a,isCentered:!0,children:[e.jsx(tt,{}),e.jsxs(st,{maxW:"1200px",w:c?"calc(100vw - 32px)":"440px",children:[e.jsx(it,{mr:"-10px",children:e.jsxs(T,{w:"100%",gap:"24px",justify:"space-between",align:"center",children:[e.jsx(k,{fontSize:"16px",fontWeight:"500",color:"text_caption",children:"Custom Expiry Period"}),e.jsx(T,{gap:"0",align:"center",children:e.jsx(rt,{mt:"0",position:"static"})})]})}),e.jsx(nt,{p:{base:"8px 16px",lg:"16px"},pt:"0 !important",children:e.jsxs(J,{w:"100%",children:[e.jsx(me,{children:e.jsxs(T,{children:[e.jsx($e,{value:d,onChange:n,placeholder:"0.0",style:{width:"calc(100% - 8px)",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"20px",touchAction:"manipulation",transition:"all 0.3s"}}),e.jsx(k,{children:"Hours"})]})}),e.jsx(me,{children:e.jsxs(T,{children:[e.jsx($e,{value:p,onChange:j,placeholder:"0.0",style:{width:"calc(100% - 8px)",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"20px",touchAction:"manipulation",transition:"all 0.3s"}}),e.jsx(k,{children:"Minutes"})]})}),e.jsx(pe,{onClick:x,isDisabled:r,w:"calc(100% + 32px)",mb:"-30px",mt:"12px",h:"52px",fontWeight:"500",children:"Set Period"})]})})]})]})};function bs(i){const{expiresIn:a,setExpiresIn:c}=se(),[f,g]=l.useState(!1),d=["5 Minutes","10 Minutes","30 Minutes","1 Hour","1 Day","3 Days","7 Days","1 Month","Custom"];return e.jsxs(me,{w:"156px",borderRadius:"16px",children:[e.jsxs(J,{w:"100%",h:"100%",gap:"20px",alignItems:"start",justify:"space-between",sx:{button:{w:"100%",h:"23px",">span":{">div":{display:"flex",justifyContent:"space-between",p:{fontSize:"16px"}}}}},children:[e.jsx(ot,{placement:"top",tooltip:e.jsx(k,{fontSize:"12px",lineHeight:"20px",maxW:"280px",children:"No extra cancellation fee will be charged for order expiry or cancellation. Gas will be consumed upon manual cancellation."}),children:e.jsxs(T,{gap:"4px",children:[e.jsx(k,{fontSize:"13px",fontWeight:"500",children:"Expires in"}),e.jsx(ct,{xlinkHref:"#icon-icon_tips"})]})}),e.jsx(os,{label:a||"",list:d,onListItemClick:h=>{h=="Custom"?g(!0):c(h)}})]}),f&&e.jsx(gs,{isOpen:f,onClose:()=>g(!1)})]})}function js(i){he();const{marketPrice:a,priceImpactInfo:c,priceImpactInfoLoading:f,priceImpact:g,inputPrice:d,handleMarketPriceClick:h,setInputPrice:p}=i,{payCoin:s,targetCoin:n,quoteToken:j,refreshPriceLoading:m,setQuoteToken:P}=se();return e.jsx(me,{w:"calc(100% - 156px)",children:e.jsxs(J,{w:"100%",gap:"20px",children:[e.jsxs(T,{w:"100%",justifyContent:"space-between",h:"23px",children:[e.jsxs(T,{children:[e.jsx(k,{fontSize:"13px",fontWeight:"500",children:!n||!s?"-- at rate":(j==null?void 0:j.coin_type)===(s==null?void 0:s.coin_type)?`Buy ${Ge(n==null?void 0:n.symbol,10)} at rate`:`Sell ${Ge(s==null?void 0:s.symbol,10)} at rate`}),Number(g)!==0&&!m&&(f?e.jsx(Dt,{size:"sm"}):e.jsx(ot,{placement:"top",tooltip:e.jsx(k,{fontSize:"12px",lineHeight:"20px",maxW:"220px",children:c.tooltip}),children:e.jsxs(k,{color:c.color,children:[z(g).gt(0)?"+":"",Number(g)>1e4?">10000%":Ut(g)]})}))]}),s&&n&&(a||m)&&e.jsx(pe,{isLoading:m,loadingText:"Market",minW:"58px",h:"22px",pl:"4px",pr:"4px",color:"primary_gray",borderRadius:"4px",variant:"outline",fontWeight:"500",fontSize:"12px",onClick:()=>h(!0),children:"Market"})]}),e.jsxs(T,{w:"100%",justifyContent:"space-between",children:[e.jsx(Zt,{value:d?ls(d)&&Number(d)>0?Qt(d).toString():d:"",onChange:t=>{console.log("ðŸš€ ~ useEffect ~ useMarketPrice:",d,t),h(!1),p(t)},decimals:18,placeholder:"0.0",style:{width:"calc(100% - 8px)",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"20px",touchAction:"manipulation",transition:"all 0.3s"}}),n&&s&&e.jsxs(T,{gap:"4px",children:[e.jsx(k,{textColor:"text_caption",children:j==null?void 0:j.symbol}),e.jsx(ct,{xlinkHref:"#icon-icon_swap1",onClick:()=>{n&&s&&((j==null?void 0:j.coin_type)===(s==null?void 0:s.coin_type)?P(n):P(s))}})]})]})]})})}function _s(){const{expiresIn:i}=se(),{buttonTextStatus:a,payBalanceInfo:c,targetBalanceInfo:f,payAmountValue:g,targetAmountValue:d,payAmount:h,targetAmount:p,payCoin:s,targetCoin:n,marketPrice:j,handleAmountChange:m,handleMarketPriceClick:P,handleSelectToken:t,inputPrice:r,setInputPrice:x,priceImpact:N,quoteToken:_,handleSubmitOrder:B,submitOrderLoading:D,onReverseClick:R,priceImpactInfoLoading:U,priceImpactInfo:w}=fs(),L=l.useMemo(()=>({payAmount:h,targetAmount:p,payCoin:s,targetCoin:n,inputPrice:r,expiresIn:i,quoteToken:_}),[h,p,s,n,r,i,_]),{onWalletModal:Z}=de(),[$,V]=l.useState("#icon-a-icon_trade"),K=O=>V(O?"#icon-icon_swap1":"#icon-a-icon_trade"),[q,F]=l.useState(!1),X=ye(),y=l.useMemo(()=>{const O=[];return s&&O.push(s),n&&O.push(n),O},[s,n]),{showTokenInfo:S,isProMode:v,currentProTab:M,currentProTabUpdateWith:H}=Pe();return l.useEffect(()=>{H==="toggleBtn"||!H||(console.log("ðŸš€ ~ useEffect LimitAction0619 ~ showTokenInfo?.coin_type:",S==null?void 0:S.coin_type),console.log("ðŸš€ ~ useEffect LimitAction0619 ~ targetCoin?.coin_type:",n==null?void 0:n.coin_type),console.log("ðŸš€ ~ useEffect LimitAction0619 ~ payCoin?.coin_type:",s==null?void 0:s.coin_type),console.log("ðŸš€ ~ useEffect LimitAction0619 ~ currentProTab:",M),S!=null&&S.coin_type&&(n!=null&&n.coin_type)&&(s!=null&&s.coin_type)?(M=="Buy"&&W(S==null?void 0:S.coin_type)!==W(n==null?void 0:n.coin_type)||M=="Sell"&&W(S==null?void 0:S.coin_type)!==W(s==null?void 0:s.coin_type))&&R():(S!=null&&S.coin_type&&(n!=null&&n.coin_type)&&!(s!=null&&s.coin_type)||S!=null&&S.coin_type&&!(n!=null&&n.coin_type)&&(s!=null&&s.coin_type))&&R())},[M]),e.jsxs(J,{w:{base:"100%",lg:v?"380px":"470px"},gap:"8px",mb:"8px",children:[e.jsxs(T,{w:"100%",justifyContent:"space-between",mb:"8px",children:[e.jsx(Ht,{currTradeTab:Ft.Limit}),!v&&e.jsx(cs,{})]}),e.jsx(rs,{onClick:()=>R(!0),from:{title:"You Pay",balance:(c==null?void 0:c.balanceFormat)||"",value:h,amountValue:g,onChange:O=>{m(O,!0)},selectable:!0,placeholder:"0.0",token:s,onTokenChange:O=>{t(O,!0)}},to:{title:"You Receive",balance:(f==null?void 0:f.balanceFormat)||"",value:p,amountValue:d,onTokenChange:O=>{t(O,!1)},onChange:O=>{m(O,!1)},selectable:!0,placeholder:"0.0",token:n,half:!1,max:!1},iconParams:{xlinkHref:$,svgFill:"text_caption",transform:$==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:$==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:()=>K(!0),onMouseLeave:()=>K(!1)}}),e.jsxs(T,{w:"100%",justifyContent:"space-between",alignItems:"stretch",gap:"8px",flexDirection:{base:"column",lg:"row"},sx:{">div":{w:{base:"100% !important"}}},children:[e.jsx(js,{marketPrice:j,priceImpactInfoLoading:U,priceImpactInfo:w,priceImpact:N,inputPrice:r,setInputPrice:x,handleMarketPriceClick:P}),e.jsx(bs,{})]}),(w==null?void 0:w.text)&&j&&Number(N)!==0&&r&&e.jsxs(k,{color:w==null?void 0:w.color,lineHeight:"20px",bg:w==null?void 0:w.bg,p:"12px",borderRadius:"8px",children:[w==null?void 0:w.text,"Â ",e.jsx(k,{color:w==null?void 0:w.color,textDecoration:"underline",as:"span",cursor:"pointer",onClick:()=>X(`/swap/${s==null?void 0:s.coin_type}/${n==null?void 0:n.coin_type}`),children:"Cetus Swap"}),"Â instead."]}),e.jsx(pe,{isDisabled:(a==null?void 0:a.disabled)||D,isLoading:D,mt:"-1px",w:"100%",borderRadius:"12px",h:"52px",fontSize:"18px",fontWeight:"500",variant:v?`solid-${M==null?void 0:M.toLocaleLowerCase()}`:"solid",onClick:(a==null?void 0:a.text)=="Connect Wallet"?()=>Z(!0):()=>F(!0),children:v&&(a==null?void 0:a.text)=="Place Limit Order"?M:a==null?void 0:a.text}),q&&e.jsx(hs,{confirmData:L,isOpen:q,onClose:()=>F(!1),handleSubmitOrder:B,submitOrderLoading:D}),(s||n)&&e.jsx(ns,{addToken:!0,tokensInfo:y,waringModalCancel:O=>{O.forEach(I=>{(I.coin_type===(s==null?void 0:s.coin_type)||I.coin_type===(n==null?void 0:n.coin_type))&&t(void 0,I.coin_type===(s==null?void 0:s.coin_type))})}})]})}function ys({orderInfo:i}){return e.jsxs(fe.Fragment,{children:[e.jsxs(G,{cursor:"pointer",sx:{td:{pb:"16px !important"}},children:[e.jsx(E,{w:"30%",children:e.jsx(pt,{info:i})}),e.jsx(E,{w:"20%",textAlign:"right",children:e.jsx(we,{info:i})}),e.jsx(E,{textAlign:"right",children:e.jsx(ut,{info:i})}),e.jsx(E,{textAlign:"right",children:e.jsx(dt,{info:i})}),e.jsx(E,{textAlign:"right",children:e.jsx(It,{orderInfo:i})})]}),e.jsx(G,{h:"16px"})]},i==null?void 0:i.order_id)}function Ss(){const{currentAccount:i,onWalletModal:a}=de(),{myOrderList:c,orderListLoading:f}=mt(),g=10,[d,h]=l.useState([]),[p,s]=l.useState(0),[n,j]=l.useState(1);return l.useEffect(()=>{if((c==null?void 0:c.length)>0){s(c==null?void 0:c.length);const m=(n-1)*g,P=m+g;h(c.slice(m,P))}},[n,c]),e.jsxs(Ke,{variant:"simple_list",w:"100%",sx:{td:{h:"60px !important"}},children:[e.jsx(Xe,{children:e.jsxs(G,{children:[e.jsx(Y,{children:"Order Info"}),e.jsx(Y,{textAlign:"right",children:"Price"}),e.jsx(Y,{textAlign:"right",children:"Filled Size"}),e.jsx(Y,{textAlign:"right",children:"Expiry"}),e.jsx(Y,{textAlign:"right",children:"Action"})]})}),e.jsx(Ie,{children:i!=null&&i.address?f?e.jsx(lt,{itemList:[1,2,3],skeletonNum:5,rowStyle:{h:"66px"}}):c.length===0?e.jsx(G,{sx:{td:{bg:"none !important",p:"0 !important",border:"none !important"},_hover:{bg:"none !important",border:"none !important"}},children:e.jsx(E,{colSpan:5,w:"100%",children:e.jsx(xe,{type:"nodata",text:"You don't have any open orders yet.",borderRadius:"16px"})})}):e.jsxs(fe.Fragment,{children:[d.map(m=>e.jsx(ys,{orderInfo:m},m.order_id)),!f&&(c==null?void 0:c.length)>g&&e.jsx(E,{colSpan:5,w:"100%",pt:"0px !important",children:e.jsx(qe,{w:"100%",children:e.jsx(at,{total:p,size:g,currentPage:n,onChange:j})})})]}):e.jsx(G,{sx:{td:{bg:"none !important",p:"0 !important",border:"none !important"},_hover:{bg:"none !important",border:"none !important"}},children:e.jsx(E,{colSpan:5,w:"100%",children:e.jsx(xe,{type:"nowallet",onboard:()=>{a(!0)},borderRadius:"16px"})})})})]})}function Ki(){const{currentAccount:i}=de(),{getLimitOrderHistory:a,historyOrderList:c,historyOrderLoading:f}=qt(),{fetchMyLimitOrder:g}=xt(),{setMyOrderList:d,myOrderList:h,orderListLoading:p}=mt(),{payCoin:s,targetCoin:n,setTargetCoin:j,setPayCoin:m}=se(),{fetchAccountBalance:P}=ft();l.useEffect(()=>{i!=null&&i.address&&P()},[]);const{isShowTradeChart:t,isShowTradeOrders:r}=Ct(),[x,N]=l.useState([]),[_,B]=l.useState({label:"Open Orders"}),D=l.useMemo(()=>{console.log("ðŸš€ ~ Limit ~ myOrderList:",h);const u=[];return u.push({label:"Open Orders",num:_.label==="Open Orders"&&h.length>0&&!p?h.length.toString():void 0}),u.push({label:"Order History",num:_.label==="Order History"&&x.length>0&&!f?x.length.toString():void 0}),u},[_.label,h,x,f,p]);l.useEffect(()=>{R(!0)},[_.label,i,r]),ds({onRpcChange:()=>{R(!0),i!=null&&i.address&&P()}});const R=u=>{r&&(V(0),console.log("ðŸš€  ~ currentAccount:",_.label==="Open Orders",i==null?void 0:i.address),i!=null&&i.address&&(_.label==="Open Orders"?g(i.address,u):(console.log("ðŸš€ ~  ~ currentAccount:",i),a(i.address,u))))};l.useEffect(()=>{i!=null&&i.address&&(c==null?void 0:c.length)>0?N(c):N([])},[c,i==null?void 0:i.address]),l.useEffect(()=>{i!=null&&i.address||d([])},[i==null?void 0:i.address]);const U=u=>{B(u)},{windowWidth:w,isApp:L}=he(),{refreshCoinMarketPrice:Z}=ht(),[$,V]=l.useState(0),K=L?2e3:1e3,q=L?10:20;ps({interval:K,callback:()=>{V($+1),$>=q&&(V(0),Z(),i!=null&&i.address&&P(),R(!1))}});const[F,X]=l.useState(!1),{isProMode:y,currentProTab:S,showTokenInfo:v,setShowTokenInfo:M,setAnotherTokenInfo:H,coinBvPriceUnit:O,setIsCoinSelect:I}=Pe(),ee=()=>{X(!F),v&&W(v==null?void 0:v.coin_type)==W((s==null?void 0:s.coin_type)||"")?(M(n),H(s)):(M(s),H(n))},ie=ye(),oe=u=>{I(!0),M(u),S=="Buy"?(u==null?void 0:u.coin_type)==(s==null?void 0:s.coin_type)?(X(!F),H(n),ie(`/limit/${n==null?void 0:n.coin_type}/${u==null?void 0:u.coin_type}`)):((u==null?void 0:u.coin_type)===(n==null?void 0:n.coin_type)||ie(`/limit/${s==null?void 0:s.coin_type}/${u==null?void 0:u.coin_type}`),H(s)):(u==null?void 0:u.coin_type)==(n==null?void 0:n.coin_type)?(X(!F),H(s),ie(`/limit/${u==null?void 0:u.coin_type}/${n==null?void 0:n.coin_type}`)):((u==null?void 0:u.coin_type)===(s==null?void 0:s.coin_type)||ie(`/limit/${u==null?void 0:u.coin_type}/${n==null?void 0:n.coin_type}`),H(n))};return l.useEffect(()=>()=>{I(!1)},[]),e.jsxs(J,{mt:w&&w<1024||y?"0px":"42px",w:"100%",gap:"0px",className:y||L||t||r?"":"bg_img",children:[e.jsxs(T,{w:"100%",justifyContent:"center",alignItems:"start",gap:"0px",flexDirection:{base:"column-reverse",lg:"row"},children:[(y||t)&&e.jsx(Vt,{onCoinSelect:u=>oe(u),isChangeDirect:F,handleToggleDirect:ee,tokenA:s,tokenB:n}),!y&&!t&&r&&e.jsx(T,{pr:"20px",gap:"8px",w:{base:"100%",lg:"calc(100% - 470px)"},children:e.jsxs(J,{w:"100%",children:[e.jsx(Je,{tabList:D,currTab:_,myOrderList:h,handleChangeTab:U,handleGetOrderList:R}),_.label==="Open Orders"&&e.jsx(Ne,{}),_.label==="Order History"&&e.jsx(De,{historyOrderList:x,historyOrderLoading:f})]})}),e.jsx(_s,{}),L&&(t||y)?y?e.jsx(zt,{onCoinSelect:u=>oe(u),handleToggleDirect:ee,token:v,tokenPriceUnit:O}):e.jsx(J,{w:"100%",children:e.jsx(l.Suspense,{fallback:e.jsx("div",{}),children:e.jsx(Wt,{baseToken:s,quoteToken:n})})}):null]}),r&&t&&e.jsxs(J,{w:"100%",gap:"0",align:"flex-start",mt:{base:"8px",lg:"0px"},children:[e.jsx(Je,{handleGetOrderList:()=>R(!0),tabList:D,currTab:_,myOrderList:h,handleChangeTab:U}),L&&e.jsx(Bt,{h:"16px"}),_.label==="Open Orders"&&(L?e.jsx(Ne,{}):e.jsx(Ss,{})),_.label==="Order History"&&(L?e.jsx(De,{historyOrderList:x,historyOrderLoading:f}):e.jsx(xs,{historyOrderList:x,historyOrderLoading:f}))]})]})}const Je=({tabList:i,currTab:a,myOrderList:c,handleChangeTab:f,handleGetOrderList:g})=>{const{handleCancelOrder:d,cancelOrderLoading:h}=es(),{isApp:p}=he(),s=a.label==="Open Orders"&&c.length>1;return e.jsxs(T,{w:"100%",justifyContent:"space-between",flexDirection:{base:a.label==="Open Orders"&&c.length>1?"column":"row",lg:"row"},gap:{base:"16px",lg:"8px"},children:[e.jsxs(T,{w:{base:"100%",lg:"395px"},justifyContent:"space-between",children:[e.jsx(Jt,{type:"borderTab",wrapStyle:{w:"100%",h:"52px",gap:"32px",bg:"none",border:"none",mb:{base:"0px",lg:"8px"}},itemStyle:{fontSize:"16px"},tabList:i,currentTab:a.label,handleChangeTab:f}),p&&e.jsx(Qe,{handleRefresh:g,w:"28px",h:"28px",innerStyle:{bg:"none"}})]}),(!p||s)&&e.jsxs(T,{gap:"8px",w:{base:"100%",lg:"unset"},children:[s&&e.jsx(pe,{onClick:()=>{d(c)},isDisabled:h,isLoading:h,h:"28px",minH:"unset",borderRadius:"8px",fontSize:"14px",variant:"outline",color:"primary_gray",w:{base:"100%",lg:"92px"},mb:{base:"0px",lg:"0"},_hover:{color:"text_caption"},children:"Cancel All"}),!p&&e.jsx(Qe,{handleRefresh:g,w:"28px",h:"28px",innerStyle:{bg:"none"}})]})]})};export{Ki as default};
