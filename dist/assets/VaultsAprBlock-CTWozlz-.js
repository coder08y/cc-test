import{i as bt,n as Lt,bU as at,M as pt,e as vt,Q as gt,bV as Ct,d0 as ft,z as T,E as St,bX as Bt,f as Dt,g as lt,r as Ot,G as U,as as K,Z as B,aW as Vt,d1 as Rt,ad as xt,d as it,l as Gt,d2 as qt,d3 as Ht,V as ht,d4 as It,C as zt}from"./index-ihcskjKt.js";import{r as O,j as C,V as st,T as et,H as Mt,B as Nt}from"./vendor-CBmAETR3.js";import{B as Ft}from"./cross-CbhIs7DK.js";import{c as At,d as Et,a as mt,u as jt,v as wt,b as Ut}from"./useGetPythTokenPrice-DxHNOitR.js";import{d as Tt}from"./utils-GUDa3Y46.js";import{a as $t}from"./useWrapPoolData-CzWcfmSl.js";import{H as rt}from"./HTextLabelBox-Cv1F2u1A.js";const Kt=(l,g)=>({vaultsFarmingStaked:{},setVaultsFarmingStaked:t=>{const v={...g().vaultsFarmingStaked||{},...t};l({vaultsFarmingStaked:v})},vaultsFarmingStakeLoading:!0,setVaultsFarmingStakeLoading:t=>l({vaultsFarmingStakeLoading:t}),vaultsFarmingRewards:{},setVaultsFarmingRewards:t=>{const v={...g().vaultsFarmingRewards||{},...t};l({vaultsFarmingRewards:v})},vaultsFarmingRewardsLoading:!0,setVaultsFarmingRewardsLoading:t=>l({vaultsFarmingRewardsLoading:t}),vaultsFarmObj:{},setVaultsFarmObj:t=>l({vaultsFarmObj:t}),autoClaimFarmingReward:!0,setAutoCliamFarmingReward:t=>l({autoClaimFarmingReward:t}),autoClaimStakeFarming:!0,setAutoClaimStakeFarming:t=>l({autoClaimStakeFarming:t}),clearVaultsFarmingInfo:()=>l({vaultsFarmingStaked:{},vaultsFarmingRewards:{}})}),ct=bt(Kt);function de(){const{fetchByApi:l}=Lt(),{volatileVaultsSdk:g,haedalFarmSdk:t}=at(),{currentAccount:V}=pt(),{getTokenInfo:v}=vt(),{fetchTokenPrices:F}=gt(),{setVaultsFarmObj:j}=ct(),{getLocalVaultPoolList:w}=At(),S=5,[_,x]=O.useState(0),L={"0x16140ced8f6641e56d7455cfb14acba7246b94049c442fb867a4c597d9841981":{id:"0x24bf7840d179ea8b1b0543e496053727c98c0eb3e2c92d3c5b221c241c40125d"},"0x3585ab68bf29e26e0ded505ead0d7eb43d1cc3b273a8678ba63ed685962be6c3":{id:"0x4bd386d95223b37cabee8265a66b8e1f5668efd63e7eb4c4387af67d036b60a4"},"0x9cddd2fe64c460183ea0e5ec21cd08a1591c4549850e3d29f83de267ae7a7824":{id:"0x083981a898882322f1ac035e9b56ea11474866bb4c97a1883e9b789bedca4412"}},b=async()=>{try{const s=await(await fetch("https://www.haedal.xyz/api/v1/farming/pools")).json();return s&&s.code===200?s.data.map(d=>({...d,vaultPool:L[d==null?void 0:d.poolId]}))||[]:[]}catch{return await t.Farms.getFarmsList()}},h=async()=>{try{return(await l(Ct,"GET")).list.reduce((d,n)=>(d[n.id]=n,d),{})}catch{const{vaultListObj:d}=await w();return d}},e=async(s,d)=>{var k,o;const n=[],y={};for(const u of s){const{rewardConfigs:a,vaultPool:p}=u,m=d==null?void 0:d[p==null?void 0:p.id];if(!m)continue;const{clmm_pool:i,clmmPoolAddress:P}=m,r=(m==null?void 0:m.id)||(m==null?void 0:m.vaultId),f=(m==null?void 0:m.coin_type_a)||(m==null?void 0:m.coinTypeA),A=(m==null?void 0:m.coin_type_b)||(m==null?void 0:m.coinTypeB);n.push(f,A);const q=await((k=g==null?void 0:g.CetusClmmSDK)==null?void 0:k.Pool.getPool(i||P)),H=await g.Vaults.getPool(r),R=ft((V==null?void 0:V.address)||"",u.balance,H,q),G=await v(f),N=await v(A),I=T(R.amount_a).div(10**(G==null?void 0:G.decimals)).toString(),z=T(R.amount_b).div(10**(N==null?void 0:N.decimals)).toString();y[r]={...u,isVaultsFarming:!0,rewardList:[],farmingPoolAmountA:I,farmingPoolAmountB:z,coinTypeA:f,coinTypeB:A};for(const D of a){const M=T((D==null?void 0:D.rate)||0);if(M.lte(0))continue;const W=(o=D==null?void 0:D.coinDetail)==null?void 0:o.decimals,$=M.mul(60*60*24).div(10**W).toString(),E=St(T($).toString(),2);y[r].rewardList.push({rewardItemRate:$,...D,rewardCoinType:D.rewardCoinType,rewardItemRateDisplay:E}),n.push(D.rewardCoinType)}}return{vaultsFarmObj:y,rewardCoinList:[...new Set(n)]}},c=async()=>{if(console.log(_,"getHaedalFarmingList"),_>=S)return;const s=await b();console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultsFarmingApiInfo.ts:118 ~ getHaedalFarmingList ~ haedalList:",s);const d=await h(),{vaultsFarmObj:n,rewardCoinList:y}=await e(s,d);return console.log(s,d,n,y,"getHaedalFarmingList"),j(n),F(y),x(k=>k+1),{vaultsFarmObj:n}};return{getHaedalFarm:c,getHaedalFarmingList:c}}function Wt(l){const{vaultsFarmObj:g}=ct(),t=O.useMemo(()=>g[l],[g,l]),V=O.useMemo(()=>t==null?void 0:t.isVaultsFarming,[t,l]);return{currentVaultsFarm:t,isVaultsFarming:V}}const Xt=bt((l,g)=>({lstVaultContractInfoObj:{},haedalVaultContractInfoObj:{},vaultClmmPoolContractInfoObj:{},dlmmVaultContractInfoObj:{},vaultDlmmPoolContractInfoObj:{},setLstVaultContractInfoObj:t=>{const V=g().lstVaultContractInfoObj;l(()=>({lstVaultContractInfoObj:{...V,...t}}))},setHaedalVaultContractInfoObj:t=>{const V=g().haedalVaultContractInfoObj;l(()=>({haedalVaultContractInfoObj:{...V,...t}}))},setVaultClmmPoolContractInfoObj:t=>{const V=g().vaultClmmPoolContractInfoObj;l(()=>({vaultClmmPoolContractInfoObj:{...V,...t}}))},setDlmmVaultContractInfoObj:t=>{const V=g().dlmmVaultContractInfoObj;l(()=>({dlmmVaultContractInfoObj:{...V,...t}}))},setVaultDlmmPoolContractInfoObj:t=>{const V=g().vaultDlmmPoolContractInfoObj;l(()=>({vaultDlmmPoolContractInfoObj:{...V,...t}}))}}));function Yt(){const{volatileVaultsSdk:l}=at(),{setPythPriceMap:g}=Et();return{getPythLastPrice:async V=>{const v=V.map(F=>Bt(F));try{const F=await l.VaultsV2.PythPrice.getLatestPrice(v);return g(F),F}catch(F){console.log("ðŸš€ðŸš€ðŸš€ ~ useGetPythLastPrice.ts:16 ~ getPythLastPrice ~ error:",F)}}}}const Zt=bt(l=>({vaultsPoolObj:{},setVaultsPoolObj:g=>l(t=>({vaultsPoolObj:{...t.vaultsPoolObj,...g}}))}));function me(){const{volatileVaultsSdk:l}=at(),g=Dt("vaults"),{setLstVaultContractInfoObj:t,setHaedalVaultContractInfoObj:V,setVaultClmmPoolContractInfoObj:v,setDlmmVaultContractInfoObj:F,setVaultDlmmPoolContractInfoObj:j}=Xt(),{setVaultsPoolObj:w}=Zt(),S=async b=>{const h=[],e=[],c=[],s=[],d=[];b.forEach(r=>{r.category=="cetus"?(h.push(r.vaultId),s.push(r.clmmPoolAddress)):r.category=="haedal"?(e.push(r.vaultId),s.push(r.clmmPoolAddress)):r.category=="cetus-dlmm"&&(c.push(r.vaultId),d.push(r.dlmmPoolAddress))});const{data:n}=await g.Vaults.getVaultList(),y=n.reduce((r,f)=>(r[f.id]=f,r),{});t(y);const{data:k}=await l.Vaults.getPoolList(),o=k.reduce((r,f)=>(r[f.id]=f,r),{});V(o);const{data:u}=await l.VaultsV2.getPoolList(),a=u.reduce((r,f)=>(r[f.id]=f,r),{});F(a);const m=(await l.CetusClmmSDK.Pool.getAssignPools(s)).reduce((r,f)=>(r[f.id]=f,r),{}),P=(await l.CetusDlmmSDK.Pool.getAssignPoolList(d)).reduce((r,f)=>(r[f.id]=f,r),{});return v(m),j(P),_(b,m,y,o,P,a),{lstVaultContractInfoObj:y,haedalVaultContractInfoObj:o,allClmmPoolContractInfoObj:m,allDlmmPoolContractInfoObj:P,dlmmVaultContractInfoObj:a}},_=async(b,h,e,c,s,d)=>{for(let n=0;n<b.length;n++){const y=b[n],k=y.category=="cetus"?e[y.vaultId]:y.category=="haedal"?c[y.vaultId]:d[y.vaultId],o=h[y.clmmPoolAddress],u=s[y.dlmmPoolAddress],a=y.category=="cetus-dlmm"?await L(y,u,k):x(y,o,k);w(a)}},x=(b,h,e)=>{const{tokenA:c,tokenB:s,category:d,isReverse:n,vaultId:y}=b,k=d=="haedal"?e.clmm_vault.wrapped_position.tick_lower_index:e.position.tick_lower_index,o=d=="haedal"?e.clmm_vault.wrapped_position.tick_upper_index:e.position.tick_upper_index,u=lt.tickIndexToPrice(k,c.decimals,s.decimals).toString(),a=lt.tickIndexToPrice(o,c.decimals,s.decimals).toString(),p=d=="haedal"?e.clmm_vault.wrapped_position.liquidity:e.position.liquidity,m=T(1).div(T(a)).toString(),i=T(1).div(T(u)).toString(),P=new Ft(h.current_sqrt_price),r=lt.sqrtPriceX64ToPrice(P,c.decimals,s.decimals).toString(),f=T(1).div(T(r)).toString(),A=lt.tickIndexToSqrtPriceX64(k),q=lt.tickIndexToSqrtPriceX64(o),H=Ot.getCoinAmountFromLiquidity(new Ft(p),P,A,q,!1),R=U(H.coin_amount_a.toString(),c.decimals).toString(),G=U(H.coin_amount_b.toString(),s.decimals).toString(),N=n?G:R,I=n?R:G,{percentA:z,percentB:D}=Tt(R,G,r,!1),M=n?D:z,W=n?z:D,$=K(T(e.protocol_fee_rate).div(1e4).mul(100).toString(),"%"),E=B(c.coin_type,!1),X=B(s.coin_type,!1),Y=n?X:E,Z=n?E:X;let Q,J,ot,tt,ut;d=="haedal"&&(Q=e==null?void 0:e.quote_type,J=B(Q,!1)==B(c.coin_type,!1)?c:s,ot=T(e==null?void 0:e.hard_cap).div(10**(J==null?void 0:J.decimals)).toString(),tt=Q==c.coin_type?s:c,ut=tt.coin_type);const yt=d=="cetus"?e==null?void 0:e.total_supply:e==null?void 0:e.lp_token_treasury;return{[y]:{minPrice:n?m:u,minPriceResever:n?u:m,maxPrice:n?i:a,maxPriceResever:n?a:i,liquidity:p,displayAmountA:N,displayAmountB:I,displayPercentA:M,displayPercentB:W,currentPrice:n?f:r,currentPriceReverse:n?r:f,disPlayProtocolFeeRate:$,displayCoinTypeA:Y,displayCoinTypeB:Z,hardCap:ot,quoteCoinType:Q,quoteCoin:J,baseCoin:tt,baseCoinType:ut,totalSupply:yt}}},L=async(b,h,e)=>{console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultsContract.ts:217 ~ wrapDlmVaultPoolContractInfo ~ dlmmContractInfo:",{dlmmContractInfo:h,vaultContractInfo:e,vault:b});const{tokenA:c,tokenB:s,category:d,isReverse:n,vaultId:y}=b,{bin_step:k,active_id:o,bin_manager:u}=h,{markets:a}=e,p=c.decimals,m=s.decimals,{position:i,valid_lower_bin_id:P,valid_upper_bin_id:r}=a[0].position_list[0];console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultsContract.ts:226 ~ wrapDlmmVaultPoolContractInfo ~ position:",a[0].position_list[0]);const f=P,A=r,q=Vt.getPriceFromBinId(f,k,p,m),H=Vt.getPriceFromBinId(A,k,p,m),R=i.liquidity_shares,G=T(1).div(T(H)).toString(),N=T(1).div(T(q)).toString(),I=Vt.getPriceFromBinId(o,k,p,m),z=T(1).div(T(I)).toString(),D=B(c.coin_type,!1),M=B(s.coin_type,!1),W=n?M:D,$=n?D:M,E=await l.CetusDlmmSDK.Pool.getBinInfo(u.bin_manager_handle,o,k),X=Rt(R,k,i.lower_bin_id,E),Y=U(X.amount_a.toString(),c.decimals).toString(),Z=U(X.amount_b.toString(),s.decimals).toString(),Q=n?Z:Y,J=n?Y:Z,{percentA:ot,percentB:tt}=Tt(Y,Z,I,!1),ut=n?tt:ot,yt=n?ot:tt;let dt,nt,_t,Pt,kt;return d=="cetus-dlmm"&&(dt=e==null?void 0:e.quote_type,nt=B(dt,!1)==B(c.coin_type,!1)?c:s,_t=T(e==null?void 0:e.hard_cap).div(10**(nt==null?void 0:nt.decimals)).toString(),Pt=dt==c.coin_type?s:c,kt=Pt.coin_type),{[y]:{minPrice:n?G:q,minPriceResever:n?q:G,maxPrice:n?N:H,maxPriceResever:n?H:N,liquidity:R,displayAmountA:Q,displayAmountB:J,displayPercentA:ut,displayPercentB:yt,currentPrice:n?z:I,currentPriceReverse:n?I:z,disPlayProtocolFeeRate:0,displayCoinTypeA:W,displayCoinTypeB:$,hardCap:_t,quoteCoinType:dt,quoteCoin:nt,baseCoin:Pt,baseCoinType:kt,totalSupply:e==null?void 0:e.lp_token_treasury,dlmmPoolAddress:b.dlmmPoolAddress}}};return{getVaultsContractInfo:S,getVaultPool:_,wrapVaultPoolContractInfo:x}}function Jt(){const{haedalFarmSdk:l}=at(),{setVaultsFarmingRewardsLoading:g,setVaultsFarmingRewards:t,vaultsFarmObj:V}=ct(),{currentAccount:v}=pt(),F=async(w,S,_)=>{try{const x=await l.Farms.getAvailableRewards(w),L=j(x,S,_,l.senderAddress);return t({[S]:L}),g(!1),L}catch(x){console.error("[VaultFarming] Error fetching rewards:",x),t([])}},j=(w,S,_,x)=>(V[S]||_).rewardConfigs.filter(b=>T(b.rate).gt(0)).map(b=>{var c;const h=(w==null?void 0:w[b.rewardCoinType])??"0",e=T(h).div(10**(((c=b.coinDetail)==null?void 0:c.decimals)??0)).toString();return{...b,rewardAmount:h,rewardAmountDisplay:e,ownerAddress:x||""}});return{getVaultFarmingRewards:F}}function Qt(){const{haedalFarmSdk:l}=at(),{setVaultsFarmingStakeLoading:g,setVaultsFarmingStaked:t,setVaultsFarmingRewardsLoading:V,vaultsFarmObj:v,vaultsFarmingStaked:F,vaultsFarmingStakeLoading:j}=ct(),{getVaultFarmingRewards:w}=Jt(),{currentAccount:S}=pt(),_=O.useRef(S==null?void 0:S.address);O.useEffect(()=>{_.current=S==null?void 0:S.address},[S==null?void 0:S.address]);const x=async(b,h,e)=>{console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultFarmingStaked.ts:55 ~ getVaultsFarmingStaked ~ getVaultsFarmingStaked:",x),console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultFarmingStaked.ts:56 ~ getVaultsFarmingStaked ~ vaultsFarmingStaked:",F);const c=F[h];console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultFarmingStaked.ts:35 ~ getVaultsFarmingStaked ~ currentVaultStaked:",c,_.current),console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultFarmingStaked.ts:35 ~ getVaultsFarmingStaked ~ vaultsFarmingStakeLoading:",j),(!c||c.ownerAddress!=_.current)&&!j&&(g(!0),V(!0));try{l.senderAddress=_.current;const s=await l.Farms.getFarmDeposit(b);if((S==null?void 0:S.address)==_.current){const d=L(s,h,e,_.current);return t({[h]:d}),w({stakeCoinType:b.stakeCoinType,poolId:b.poolId,stakeObjectId:d==null?void 0:d.stakeObjectId},h,e),g(!1),d}else g(!1),V(!1)}catch(s){console.error("[VaultFarming] Failed to fetch staked info:",s),t(void 0)}},L=(b,h,e,c)=>{console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultFarmingStaked.ts:56 ~ warpVaultsFarmingStaked ~ stakedInfo:",b);const s=v[h]||e,{stakedBalance:d,stakeObjectId:n}=b,{coinDetail:y,rewardConfigs:k}=s,o=T(d).div(10**((y==null?void 0:y.decimals)??0)).toString();return{poolId:s.poolId,stakeObjectId:n,stakedBalance:d,stakedBalanceFormat:o,stakedBalanceDisplay:St(o,void 0,void 0,xt.ROUND_DOWN).toString(),coinDetail:y,stakeCoinType:s.stakeCoinType,rewardConfigs:(k??[]).filter(u=>T(u.rate).gt(0)),ownerAddress:c||""}};return{getVaultsFarmingStaked:x}}function pe(){const{lpTokenInfoObj:l}=mt(),{volatileVaultsSdk:g}=at(),{currentAccount:t}=pt(),{setVaultsPositionObj:V,setVaultsPositionLoading:v,setShowVaultsList:F}=jt(),{setVaultListLoading:j}=mt(),{getVaultsFarmingStaked:w}=Qt(),{vaultsFarmObj:S}=ct(),_=O.useRef(t==null?void 0:t.address);O.useEffect(()=>{_.current=t==null?void 0:t.address},[t==null?void 0:t.address]);const x=async(e,c,s,d,n=!1,y)=>{const o=(await g.FullClient.getAllBalances({owner:t==null?void 0:t.address})).reduce((a,p)=>(a[p.coinType.toLowerCase()]=p,a),{}),u=[];for(let a=0;a<e.length;a++){const p=e[a],m=p.category=="cetus"?c[p.vaultId]:s[p.vaultId],i=d[p.clmmPoolAddress],P=o[p.lpTokenType.toLowerCase()],r=y[p.vaultId];console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultsPosition.ts:56 ~ useGetVaultsPosition ~ vaultsFarmingInfo:",r);const f=await L(p,i,m,n,P,t==null?void 0:t.address,void 0,r);it(f&&f[p.vaultId].balance||"0").gt(0)&&u.push(f)}v(!1),j(!1),F(u)},L=async(e,c,s,d=!1,n,y=t==null?void 0:t.address,k,o)=>{try{const{category:u}=e;let a,p;const m=S[e.vaultId]||o;console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultsPosition.ts:100 ~ useGetVaultsPosition ~ haedalFarmingInfo:",m);let i="0";if(m){let f=await w({stakeCoinType:m.stakeCoinType,poolId:m.poolId},e.vaultId,m);i=(f==null?void 0:f.stakedBalance)||"0",console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultsPosition.ts:112 ~ useGetVaultsPosition ~ haedalFarmingBalance:",i)}Gt(n)?p=n:p=await g.FullClient.getBalance({owner:y,coinType:e.lpTokenType}),console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultsPosition.ts:98 ~ useGetVaultsPosition ~ balance:",p);let P;u=="cetus"?a=qt.buildVaultBalance(y,s,p,c):u=="cetus-dlmm"?(a=await Ht(g,p.totalBalance,s,c,y),console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultsPosition.ts:123 ~ getVaultPosition ~ positionInfo:",a)):(a=ft(y,it(p.totalBalance).add(i).toString(),s,c),console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultsPosition.ts:124 ~ useGetVaultsPosition ~ positionInfo:",{positionInfo:a,vaultContractInfo:s,poolContractInfo:c,balance:it(p.totalBalance).add(i).toString()}),P=ft(y,p.totalBalance,s,c));const r=b({...a,ownerAddress:_.current==y?y:void 0,vaultBalance:p==null?void 0:p.totalBalance,vaultFarmingBalance:i,vault_amount_a:P==null?void 0:P.amount_a,vault_amount_b:P==null?void 0:P.amount_b},e,s,k);return d&&_.current==y?V(r):d||V(r),r}catch(u){console.log("ðŸš€ðŸš€ðŸš€ ~ useGetVaultsPosition.ts:59 ~ getVaultPosition ~ error:",u)}},b=(e,c,s,d=l)=>{const n=d[c.lpTokenType],{amount_a:y,amount_b:k,ownerAddress:o,vaultFarmingBalance:u,vaultBalance:a,vault_amount_a:p,vault_amount_b:m}=e,{isReverse:i,tokenA:P,tokenB:r,category:f}=c,A=U(y,P.decimals).toString(),q=U(k,r.decimals).toString(),H=U(p,P.decimals).toString(),R=U(m,r.decimals).toString(),G=e.clmm_pool_id,N=e.liquidity,I=e.vault_id,z=ht(e.coin_type_a).full_address,D=ht(e.coin_type_b).full_address,M=h(n,e.lp_token_balance),{balanceFormat:W,balanceDisplay:$}=h(n,a),E=f=="cetus"?it(M.balance).div(s.total_supply).mul(100).toString():it(M.balance).div(s.lp_token_treasury).mul(100).toString(),X=`${It(E,2,6)}%`,Y=i?r:P,Z=i?P:r;return{[I]:{...M,amountA:A,amountB:q,displayAmountA:i?q:A,displayAmountB:i?A:q,coinTypeA:z,coinTypeB:D,displayCoinTypeA:i?D:z,displayCoinTypeB:i?z:D,liquidity:N,clmmPool:G,vaultId:I,sharePoolRate:E,shartOfPoolDisplay:X,tokenA:P,tokenB:r,displayTokenA:Y,displayTokenB:Z,ownerAddress:o,vaultBalance:a,vaultBalanceFormat:W,vaultBalanceDisplay:$,vaultFarmingBalance:u,displayVaultAmountA:i?R:H,displayVaultAmountB:i?H:R}}},h=(e,c)=>{const s=U(c,e==null?void 0:e.decimals).toString();return{balance:c,balanceFormat:s,balanceDisplay:St(s,void 0,!1,xt.ROUND_DOWN).toString()}};return{getVaultPosition:L,getVaultsPosition:x}}function ge(){const{fetchTokenPrices:l}=gt(),{setVaultListLoading:g,setVaultsTokenList:t,lpTokenInfoObj:V,setLpTokenInfoObj:v,vaultsList:F,vaultPageList:j,setVaultPageList:w}=mt(),{getVaultPoolList:S}=At(),{fetchTokenInfo:_,getTokenListInfo:x}=vt(),{vaultsPositionObj:L,setShowVaultsList:b}=jt(),{getPythLastPrice:h}=Yt(),e=(o,u=F)=>{console.log("ðŸš€ðŸš€ðŸš€ ~ useVaultList.ts:22 ~ filterVaultList ~ originList:",u);const{currentTab:a,isYourHoldings:p,selectCoinList:m,sortOptions:i}=o;let P=[],r=[];(m==null?void 0:m.length)>0?r=y(u,m):r=u,a==="all"?P=r:a==="cetus"?P=r.filter(A=>A.category==a):P=r.filter(A=>A.quoteType==a&&A.category!=="cetus");let f;return p?f=c(i,k(P)):f=c(i,P),w(f),b(f),f},c=(o,u)=>{console.log("ðŸš€ ~ sortVaultList ~ options:",o);const{sortRule:a,sortType:p}=o;return u==null?void 0:u.sort((i,P)=>p==="apr"?a==="desc"?P.vaultsTotalApy-i.vaultsTotalApy:i.vaultsTotalApy-P.vaultsTotalApy:a==="desc"?P.vaultsTvl-i.vaultsTvl:i.vaultsTvl-P.vaultsTvl)},s=async(o,u=!0)=>{u&&g(!0);const{poolList:a}=await S();d(a),n(a);const p=e(o,JSON.parse(JSON.stringify(a)));g(!1),w(p),b(p)},d=async o=>{if(!o||o.length===0)return;const u=[],a=[];for(let i=0;i<o.length;i++)u.includes(o[i].displayTokenA.coin_type)||u.push(o[i].displayTokenA.coin_type),u.includes(o[i].displayTokenB.coin_type)||u.push(o[i].displayTokenB.coin_type),(o[i].category=="haedal"||o[i].category=="cetus-dlmm")&&!a.includes(B(o[i].displayTokenA.coin_type))&&a.push(B(o[i].displayTokenA.coin_type,!1)),(o[i].category=="haedal"||o[i].category=="cetus-dlmm")&&!a.includes(B(o[i].displayTokenB.coin_type))&&a.push(B(o[i].displayTokenB.coin_type,!1));h(a),u.length>0&&l(u);const p=await x(u),m=Array.from(p.values());t(m)},n=async o=>{var a,p;const u={};for(let m=0;m<o.length;m++){const i=o[m],P=i==null?void 0:i.lpTokenType;(a=wt[i.clmmPoolAddress])!=null&&a.lpToken?u[P]=(p=wt[i.clmmPoolAddress])==null?void 0:p.lpToken:V[P]?u[P]=V[P]:u[P]=await _(P)}return v(u),u},y=(o,u)=>{var i,P,r,f;const a=(i=u[0])!=null&&i.coin_type?B((P=u[0])==null?void 0:P.coin_type):void 0,p=(r=u[1])!=null&&r.coin_type?B((f=u[1])==null?void 0:f.coin_type):void 0;return o==null?void 0:o.filter(A=>a&&p?B(A.displayTokenA.coin_type)==a&&B(A.displayTokenB.coin_type)==p||B(A.displayTokenA.coin_type)==p&&B(A.displayTokenB.coin_type)==a:a?B(A.displayTokenA.coin_type)==a||B(A.displayTokenB.coin_type)==a:A)},k=o=>o.filter(u=>{const a=L[u.vaultId];return!!(a&&T(a.balance).gt(0))});return{filterVaultList:e,sortVaultList:c,fetchVaultList:s,vaultPageList:j,getVaultsLpTokenList:n,getVaultsTokenList:d,setVaultPageList:w}}function te(l){const{vaultListObj:g}=mt();return{currentVaults:O.useMemo(()=>g[l],[g,l])}}function ye(l,g,t,V,v,F,j){const{getTokenAmountValueByPyth:w}=Ut(),{getTokenAmountValue:S}=gt(),_=j=="haedal"||j=="cetus-dlmm"?w(t,l):S(t,l),x=j=="haedal"||j=="cetus-dlmm"?w(V,g):S(V,g),L=K(_,"$"),b=K(x,"$"),h=T(_).plus(x||0).toString(),e=K(h,"$"),c=S(t,v),s=S(V,F);K(c,"$"),K(s,"$");const d=T(c).plus(s||0).toString(),n=K(d,"$");return{holdCoinAValue:_,holdCoinBValue:x,holdCoinAValueDisplay:L,holdCoinBValueDisplay:b,holdingAmount:h,holdingAmountDisplay:e,holdingVaultAmount:d,holdingVaultAmountDisplay:n}}function ee(l){const{getTokenAmountValue:g}=gt(),[t,V]=O.useState(""),[v,F]=O.useState(""),[j,w]=O.useState(""),[S,_]=O.useState(""),[x,L]=O.useState(!0);return O.useEffect(()=>{if(!l){V(""),F(""),w(""),_("");return}L(!0);try{const{farmingPoolAmountA:b,farmingPoolAmountB:h,coinTypeA:e,coinTypeB:c,rewardList:s}=l,d=g(e,b),n=g(c,h),y=T(d).add(n);_(y.toString()),F(K(y.toString(),"$"));let k=T(0);for(const o of s)k=k.add(g(o.rewardCoinType,o.rewardItemRate));if(k.eq(0)||y.eq(0))V(""),w("");else{const o=k.div(y).mul(365).toString();w(o),V($t(o,!0)),L(!1)}}catch(b){console.error("[VaultFarming] APR calculation error:",b),V("")}},[l,g]),{vaultFarmingApr:j,vaultFarmingAprDisplay:t,farmingTvl:S,farmingTvlDisplay:v,vaultFarmingLoading:x}}function Pe({vaultId:l,wrapStyle:g,farmingTextStyle:t={}}){const{currentVaultsFarm:V,isVaultsFarming:v}=Wt(l),{vaultFarmingAprDisplay:F}=ee(V),{currentVaults:j}=te(l),{vaultsApyDisplay:w,vaultsLstApyDisplay:S,vaultsTotalApyDisplay:_,vaultsAprDisplay:x,category:L}=j||{};return C.jsx(zt,{tooltip:L=="cetus"?C.jsx(se,{vaultsApyDisplay:w,vaultsLstApyDisplay:S,vaultsTotalApyDisplay:_}):C.jsx(ae,{vaultsApyDisplay:w,vaultsAprDisplay:x,vaultFarmingAprDisplay:F,isVaultsFarming:v}),placement:"bottom",children:C.jsxs(st,{gap:{base:"4px",lg:"2px"},alignItems:{base:"flex-end",lg:"center"},...g,children:[C.jsx(et,{textColor:"text_caption",textAlign:"right",fontWeight:"500",textDecoration:"underline dotted",color:"primary",children:L=="cetus"?_:w}),v&&F&&C.jsxs(et,{bg:"primary_yellow_opacity.10",color:"primary_yellow",borderRadius:"4px",fontSize:"12px",p:{base:"0px 6px",lg:"0px 4px"},...t,children:["+",F]})]})})}const se=({vaultsLstApyDisplay:l,vaultsApyDisplay:g,vaultsTotalApyDisplay:t})=>C.jsx(st,{gap:"12px",w:"100%",pt:"8px",children:C.jsxs(st,{children:[C.jsx(rt,{label:"Total APY",labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},wrapStyle:{gap:"16px"},value:t}),C.jsx(Mt,{h:"1px",w:"100%",backgroundColor:"border"}),C.jsx(rt,{label:"Fees and Rewards",labelStyle:{fontSize:"12px"},valueStyle:{fontSize:"12px"},wrapStyle:{gap:"16px"},value:g}),C.jsx(rt,{label:"LST",labelStyle:{fontSize:"12px"},wrapStyle:{gap:"16px"},value:l,valueStyle:{fontSize:"12px"}})]})}),ae=({vaultsApyDisplay:l,vaultsAprDisplay:g,vaultFarmingAprDisplay:t,isVaultsFarming:V})=>{const[v,F]=O.useState(!1);return C.jsxs(st,{w:"250px",onClick:j=>{j.stopPropagation()},children:[C.jsxs(st,{bg:"bg_fifth",borderRadius:"8px",p:"12px 16px",gap:"10px",children:[C.jsx(rt,{label:"Cetus LP APR",value:g,labelStyle:{fontSize:"12px"},valueStyle:{fontSize:"12px"}}),C.jsx(Nt,{m:"8px 0",height:"1px",w:"100%",bg:"border"}),C.jsx(rt,{label:"Vault APY",value:l}),C.jsx(et,{fontSize:"12px",lineHeight:"20px",children:"(Compounding Cetus LP APR Multiple Times a Day)"})]}),V&&t&&C.jsxs(st,{w:"100%",bg:"primary_yellow_opacity.10",borderRadius:"8px",p:"12px 16px",gap:"10px",alignItems:"flex-start",children:[C.jsx(et,{color:"text_caption",fontSize:"12px",children:"3rd party farming rewards available."}),C.jsxs(et,{mt:"4px",color:"primary_yellow",fontSize:"12px",children:["Farming APR +",t]}),C.jsx(et,{fontSize:"12px",children:"Incentives on Haedal"})]})]})};export{Pe as V,Wt as a,Zt as b,ct as c,Yt as d,ee as e,ge as f,me as g,pe as h,de as i,Xt as j,Qt as k,te as l,ye as u};
//# sourceMappingURL=VaultsAprBlock-CTWozlz-.js.map
