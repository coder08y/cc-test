import{r as c,j as s,V as E,H as R,T as W,w as we,C as Nt,Y as Dt,m as ut,l as Et,ao as Vt,M as Ft,o as Ut,p as qt,$ as Gt,a0 as Yt,q as Qt,t as Kt,B as Zt,I as Xt,at as Jt,au as Ct,av as es,aw as bt,n as ts}from"./vendor-CBmAETR3.js";import{L as vt,T as ss,a as ns,P as os}from"./LimitPriceChart-5hthKx3o.js";import{M as rs,C as as}from"./MenuDropBlock-CrHXDs_u.js";import is from"./index-VBU6PYPD.js";import{u as cs,D as ls,a as us,R as ps,O as ds,b as xs}from"./OverviewOrders-BEcZiioI.js";import{u as xt,av as fs,I as Je,M as Ce,d as j,w as ms,B as Le,n as ft,f as mt,c_ as gs,c$ as hs,k as ys,Q as _s,e as $t,V as Ss,ad as ze,s as Ds,aT as Ke,O as dt,E as _e,bX as Ze,j as jt,bL as Bt,v as je,Z as ie,x as bs,S as vs,ah as Xe,A as wt,cU as js,b as ws,t as ks,a as Ts}from"./index-Lo8eQgA0.js";import"./cross-J9VCREIf.js";import{P as Ps}from"./Table-N6ht64Bc.js";import{N as kt}from"./NoData-BFX9XpKb.js";import{R as Tt}from"./RefreshButton-BEUAg1WA.js";import{u as It}from"./useTokenRank-CM-9-tXe.js";import{u as As}from"./useInsufficientBalanceToast-XNiA1ZKV.js";import{u as Os}from"./useTransaction-C3m_5TTr.js";import{A as Ms}from"./aggregator-CK22pvE4.js";import{d as ce,b as Rs}from"./useGetDcaOrderHistory-CecPEcq4.js";import{u as gt}from"./index-9yHNdYxH.js";import{a as pt}from"./useSwapHelper-BDfKH-rI.js";import{u as Pt}from"./useTokenBalance-B8pbbpGD.js";import{u as Ns}from"./useFindBestRouting-CPdS9aqM.js";import{C as Es}from"./CurrentPrice-fVnoCZ1x.js";import{E as ve}from"./ErrorTips-BLWaROlb.js";import{u as zt}from"./useAccountBalance-Bp-GiNHM.js";import{T as $s}from"./TooltipIcon-Bqqgb7rr.js";import{T as Bs}from"./TradeInputGroup-DzPgsb9a.js";import{W as Is}from"./WarningTokenTipModal-BnWACfTU.js";import{H as ye}from"./HTextLabelBox-0wWY3DfK.js";import{R as zs}from"./RangeValue-D-wFxWdA.js";import{I as Lt}from"./InputBox-DUnOULwS.js";import{u as Ls}from"./activeOrders-Blk-EQ9B.js";import{u as Ws}from"./useInterval-FApnpfRj.js";import{u as Hs}from"./useRpcListener-aeXKG1ty.js";import"./charting_library.esm-BuRCvzzK.js";import"./CarouselBlock-BQy99RwQ.js";import"./en_US-KAK2ZBDO-KTAiToGz.js";import"./v4-C6aID195.js";import"./useProData-C_Hyt5cN.js";import"./SearchInput-Ci9E2gMO.js";import"./FilterTable-DLAlxMD_.js";import"./IconBg-DKFlpANj.js";import"./useDocumentSize-DzZXzGS0.js";import"./index-BgoHGJbV.js";import"./debounce-MPJy35Ge.js";import"./index-D8UqOC8m.js";import"./CoinAuditCheck-CQOI1WtB.js";import"./TokenGoplusCard-CpJyEa2D.js";import"./VTextLabelBox-BsJ2fzM-.js";import"./CheckBox-BfyJMUfq.js";import"./useTrack-T_4vPqTb.js";import"./useSigner-Dol5aKH6.js";import"./useTransactionModal-Bz8Bofje.js";import"./useGetPoolList-Bo7JxsYj.js";import"./utils-BTUfT3hi.js";import"./useWrapPoolData-tzYpVDlL.js";import"./_baseClone-BEKueZbq.js";import"./_getAllKeysIn-Doplhvy3.js";import"./_defineProperty-DWWEPMFy.js";import"./last-CUqZBUsg.js";import"./usePreviousValue-Da-o2xpb.js";function Vs({currentTabVal:i,orderInfo:e}){const{isApp:t}=xt(),{inCoin:g,outCoin:y}=e,[a,d]=c.useState(!1);c.useEffect(()=>{d(!1)},[i]);const{getTokenRank:r}=It(),[_,o]=c.useState(!1);c.useEffect(()=>{const u=r(g,y);console.log("🚀 ~ useEffectDcaItem ~ direct:",y,g,u),o(!u)},[g==null?void 0:g.coin_type,y==null?void 0:y.coin_type]);const{closeOrderAction:D,isCloseLoading:h}=cs(),f=async()=>{D(e)},{getExplorerUrl:S}=fs();return s.jsxs(E,{w:"100%",gap:"12px",align:"flex-start",children:[s.jsxs(R,{w:"100%",justify:"space-between",flexDirection:{base:"column",lg:"row"},align:{base:"flex-start",lg:"center"},children:[s.jsxs(R,{children:[s.jsx(ls,{orderInfo:e}),s.jsx(Je,{xlinkHref:"#icon-icon_link1",onClick:()=>{window.open(S(e==null?void 0:e.orderID,"poolAddress"))},fontSize:"16px"})]}),!t&&s.jsx(At,{currentTabVal:i,isCloseLoading:h,closeOrder:f,orderInfo:e,isDetail:a,onClickDetail:()=>d(!a)})]}),s.jsx(us,{orderInfo:e}),s.jsxs(R,{w:"100%",children:[s.jsx(W,{color:"primary_gray",fontSize:"12px",children:"Price Range"}),s.jsx(ps,{orderInfo:e,isRank:!0})]}),t&&s.jsx(At,{currentTabVal:i,isCloseLoading:h,closeOrder:f,orderInfo:e,isDetail:a,onClickDetail:()=>d(!a)}),a&&s.jsx(ds,{pageDirect:_,isDetail:a,currentTabVal:i,orderInfo:e})]})}const At=({currentTabVal:i,isCloseLoading:e,closeOrder:t,orderInfo:g,isDetail:y,onClickDetail:a})=>s.jsxs(R,{w:{base:"100%",lg:"unset"},flexDirection:{base:"column",lg:"row"},children:[i=="active"&&s.jsx(we,{w:{base:"100%",lg:"unset"},isLoading:e,isDisabled:e,onClick:t,h:"32px",minH:"unset",p:"0px 12px",fontSize:"14px",borderRadius:"8px",variant:"outline",children:(g==null?void 0:g.outBalance)<=0?"Close":"Close and Withdraw"}),s.jsx(we,{w:{base:"100%",lg:"unset"},h:"32px",borderRadius:"8px",minH:"unset",p:"0px 12px",fontSize:"14px",variant:"ghost",rightIcon:s.jsx(Je,{svgW:"12px",svgH:"12px",xlinkHref:"#icon-icon_arrow",transform:y?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.5s",ml:"-4px",mr:"-4px"}),onClick:a,children:"Details"})]});function Ot({handleRefresh:i,activeList:e,pastList:t,isOrderLoading:g}){const[a,d]=c.useState([]),[r,_]=c.useState([]),[o,D]=c.useState(0),[h,f]=c.useState(1),{currentAccount:S,onWalletModal:u}=Ce(),[p,$]=c.useState({label:"Active DCAs",value:"active"}),P=c.useMemo(()=>[{label:"Active DCAs",value:"active",num:(e==null?void 0:e.length)>0?e==null?void 0:e.length:void 0},{label:"Past DCAs",value:"past",num:(t==null?void 0:t.length)>0?t==null?void 0:t.length:void 0}],[p==null?void 0:p.value,e,t]),v=k=>{f(1),$(k)};c.useEffect(()=>{const k=(p==null?void 0:p.value)==="active"?e:t;d(k),D(k==null?void 0:k.length)},[p==null?void 0:p.value,e,t]),c.useEffect(()=>{const k=(h-1)*10,M=k+10;_(a==null?void 0:a.slice(k,M))},[h,a,p==null?void 0:p.value]);const Z=c.useMemo(()=>(p==null?void 0:p.value)==="past"||(a==null?void 0:a.length)===0?0:a==null?void 0:a.reduce((k,M)=>j(k).plus(M==null?void 0:M.outBalance),j(0)).toString(),[p==null?void 0:p.value,a]),{closeAll:U,claimAll:A,isClaimAllLoading:I,isCloseAllLoading:C}=xs(),{isApp:re}=xt();return s.jsxs(E,{w:"100%",children:[s.jsxs(R,{w:"100%",justify:"space-between",flexDirection:{base:"column",lg:"row"},children:[s.jsxs(R,{w:{base:"100%",lg:"unset"},justify:"space-between",children:[s.jsx(ms,{type:"borderTab",wrapStyle:{w:{base:"100%",lg:"300px"},h:"52px",gap:"32px",bg:"none",border:"none",mb:"8px"},itemStyle:{fontSize:"16px"},tabList:P,currentTab:p.label,handleChangeTab:v}),re&&s.jsx(Tt,{handleRefresh:i,w:"28px",h:"28px",innerStyle:{bg:"none"}})]}),s.jsxs(R,{w:{base:"100%",lg:"unset"},children:[p.value==="active"&&(a==null?void 0:a.length)>0&&(S==null?void 0:S.address)&&s.jsx(we,{w:{base:"50%",lg:"unset"},h:"28px",minH:"unset",p:"0 10px",fontSize:"14px",borderRadius:"8px",variant:"outline",color:"primary_gray",_hover:{color:"text_caption"},isLoading:I,isDisabled:Number(Z)===0||I,onClick:()=>A(a),leftIcon:s.jsx(Je,{xlinkHref:"#icon-icon_incentive",svgFill:"primary",mr:"-4px",ml:"-4px"}),children:"Claim all"}),p.value==="active"&&(a==null?void 0:a.length)>0&&(S==null?void 0:S.address)&&s.jsx(we,{w:{base:"50%",lg:"unset"},isLoading:C,isDisabled:(a==null?void 0:a.length)==0||C,h:"28px",borderRadius:"8px",minH:"unset",p:"0 12px",fontSize:"14px",variant:"outline",color:"primary_gray",_hover:{color:"text_caption"},onClick:()=>U(a),children:"Close All"}),!re&&s.jsx(Tt,{handleRefresh:i,w:"28px",h:"28px",innerStyle:{bg:"none"}})]})]}),S!=null&&S.address?g?s.jsx(Le,{children:s.jsx(E,{gap:"16px",sx:{">div":{borderBottom:"1px solid",borderColor:"border",pb:"16px",_last:{borderBottom:"none",pb:"0px"}}},children:[{},{}].map((k,M)=>s.jsx(Fs,{},M))})}):(a==null?void 0:a.length)===0?s.jsx(kt,{type:"nodata",text:(p==null?void 0:p.value)==="active"?"No active orders":"No closed orders"}):s.jsxs(Le,{h:(r==null?void 0:r.length)>8?"927px":"unset",overflowY:"auto",p:{base:"12px",lg:"20px 16px"},children:[s.jsx(E,{gap:"16px",sx:{">div":{borderBottom:"1px solid",borderColor:"border",pb:"16px",_last:{borderBottom:"none",pb:"0px"}}},children:r==null?void 0:r.map(k=>s.jsx(Vs,{currentTabVal:p.value,orderInfo:k},k==null?void 0:k.orderID))}),!g&&(a==null?void 0:a.length)>10&&s.jsx(Nt,{mt:"28px",children:s.jsx(Ps,{total:o,size:10,currentPage:h,onChange:f})})]}):s.jsx(kt,{type:"nowallet",onboard:()=>u(!0)})]})}const Fs=()=>s.jsxs(E,{w:"100%",gap:"16px",align:"flex-start",children:[s.jsxs(R,{w:"100%",gap:"0",justify:"space-between",children:[s.jsxs(R,{gap:"0",children:[s.jsxs(R,{gap:"0px",mr:"8px",align:"flex-start",children:[s.jsx(Dt,{size:"8"}),s.jsx(Dt,{size:"8"})]}),s.jsx(ut,{height:"4",width:"100px"})]}),s.jsx(ut,{height:"4",width:"150px"})]}),s.jsx(ut,{height:"4",width:"180px"})]});function Us(){const{fetchByApi:i}=ft(),e=mt("dca"),{setDcaConfig:t}=ce(),g=async()=>await i(gs,"GET")||null,y=async()=>await e.Dca.getDcaGlobalConfig();return{getDcaConfig:async()=>{const d={};try{const r=await g();r&&(d.minCycleAmountInUsd=r==null?void 0:r.min_amount_in_usd)}catch(r){console.log("🚀 ~ file: useDcaConfig.ts:22 ~ getDcaConfig ~ error:",r)}try{const r=await y();d.minCycleCount=r==null?void 0:r.min_cycle_count,d.minCycleFrequency=r==null?void 0:r.min_cycle_frequency,d.whitelistMode=r==null?void 0:r.whitelist_mode}catch(r){console.log("🚀 ~ file: useDcaConfig.ts:32 ~ getDcaConfig ~ error:",r)}return console.log("🚀🚀🚀 ~ file: useDcaConfig.ts:45 ~ getDcaConfig ~ dcaConfig:",d),t(d),d}}}function Wt(){const{fetchByApi:i}=ft(),{setDcaQuote:e}=ce();return{getDcaQuote:async({inCoin:g,freq:y,count:a,sender:d})=>{try{const r=await i(hs,"GET",{in_coin:g,freq:y,count:a,sender:d});if(r){const _={amountInLimitPerCycle:r==null?void 0:r.amount_in_limit_per_cycle,coinType:r==null?void 0:r.coin_type,feeRate:r==null?void 0:r.fee_rate,signature:r==null?void 0:r.signature,signer:r==null?void 0:r.signer,timestamp:r==null?void 0:r.timestamp};return e(_),_}}catch(r){console.log("getDcaQuote ~ error:",r)}return null}}}function qs(){var yt,_t,St;const i=Et(),{sellCoin:e,buyCoin:t,setSellCoin:g,setBuyCoin:y,sellAmount:a,buyAmount:d,setBuyAmount:r,setSellAmount:_,dcaConfig:o,setCurrentCoinKey:D,currentCoinKey:h,investNum:f,currentInvest:S,orderNum:u,dcaQuote:p,setInvestNum:$,setOrderNum:P,setCurrentInvest:v,setPageDirect:Z,pageDirect:U,dcaMode:A,sellTotalAmount:I,setSellTotalAmount:C,setLowerPriceSize:re,setUpperPriceSize:k}=ce(),{from:M,to:O}=Vt(),{currentAccount:b}=Ce(),{getDcaConfig:T}=Us(),{getDcaQuote:de}=Wt(),{coinPriceObj:X}=ys(),{fetchTokenPrices:ke,getTokenAmountValue:le}=_s(),[Y,Q]=c.useState(""),ee=c.useRef(Y),{fetchTokenInfo:m}=$t(),{setCurrentProTab:te,currentProTab:Se,currentProTabUpdateWith:et}=gt();c.useEffect(()=>{ee.current=Y},[Y]),c.useEffect(()=>{(async()=>{if(console.log("dca hook0619 🚀 ~ fetTokenInfo ~ from:",M),console.log("dca hook0619 🚀 ~ fetTokenInfo ~ to:",O),(!M||M==="undefined")&&(!O||O==="undefined")){g(jt.clmm_swap.from_coin),y(jt.clmm_swap.to_coin);return}M&&M!=="undefined"?m(M).then(x=>{x?(x==null?void 0:x.coin_type)!==(e==null?void 0:e.coin_type)&&g(x):i(`/dca/${e==null?void 0:e.coin_type}/${t==null?void 0:t.coin_type}`)}).catch(()=>{i(`/dca/${e==null?void 0:e.coin_type}/${t==null?void 0:t.coin_type}`)}):g(void 0),O&&O!=="undefined"?m(O).then(x=>{x?(x==null?void 0:x.coin_type)!==(t==null?void 0:t.coin_type)&&y(x):i(`/dca/${e==null?void 0:e.coin_type}/${t==null?void 0:t.coin_type}`)}).catch(()=>{i(`/dca/${e==null?void 0:e.coin_type}/${t==null?void 0:t.coin_type}`)}):y(void 0)})()},[M,O]),c.useEffect(()=>()=>{y(void 0),g(void 0)},[]),c.useEffect(()=>(re("0%"),k("0%"),T(),()=>{Pe()}),[]);const[H,fe]=c.useState(""),[q,De]=c.useState(""),{balanceInfo:V}=Pt(e),{balanceInfo:xe}=Pt(t),tt=le(e==null?void 0:e.coin_type,a),Te=n=>{D("sellCoin"),_(n),Ie()};c.useEffect(()=>{+a&&+u?A=="total"?C(a):C(j(a).mul(u).toString()):C("")},[a,A,u]);const st=()=>{const n=U?e==null?void 0:e.decimals:t==null?void 0:t.decimals;if(Z(!U),H&&q){const x=H,w=j(1).div(q).toString(),oe=j(1).div(x).toString();fe(je(w,n,!0).toString()),De(je(oe,n,!0).toString())}},nt=(n,x=!0)=>{console.log("🚀🚀🚀 ~ useDcaHook.ts:143 ~ handleSelectToken ~ handleSelectToken:"),fe(""),De(""),x?(ie(n==null?void 0:n.coin_type)===ie(t.coin_type)?(Ae(),te(Se==="Buy"?"Sell":"Buy")):i(`/dca/${n==null?void 0:n.coin_type}/${t==null?void 0:t.coin_type}`),D("sellCoin")):(ie(n==null?void 0:n.coin_type)===ie(e.coin_type)?(Ae(),te(Se==="Buy"?"Sell":"Buy")):i(`/dca/${e==null?void 0:e.coin_type}/${n==null?void 0:n.coin_type}`),D("buyCoin"))},Pe=()=>{_(""),fe(""),De(""),Q(""),$("1"),P("2"),v("Hour")},Ae=n=>{e!=null&&e.coin_type&&(e==null?void 0:e.coin_type)===M||e!=null&&e.coin_type&&!M?i(`/dca/${t==null?void 0:t.coin_type}/${e==null?void 0:e.coin_type}`):(e!=null&&e.coin_type&&(e==null?void 0:e.coin_type)!=="undefined"&&(!(t!=null&&t.coin_type)||(t==null?void 0:t.coin_type)=="undefined")||t!=null&&t.coin_type&&(t==null?void 0:t.coin_type)!=="undefined"&&(!(e!=null&&e.coin_type)||(e==null?void 0:e.coin_type)=="undefined"))&&(console.log("useDcaHook 🚀 ~ onReverseClick ~ buyCoin?.coin_type:",t==null?void 0:t.coin_type),console.log("useDcaHook 🚀 ~ onReverseClick ~ sellCoin?.coin_type:",e==null?void 0:e.coin_type),i(`/dca/${t==null?void 0:t.coin_type}/${e==null?void 0:e.coin_type}`)),n&&te(Se==="Buy"?"Sell":"Buy","toggleBtn")},Oe=c.useMemo(()=>{const n=o==null?void 0:o.whitelistMode;return console.log("🚀 ~ useDcaHook ~ whitelistMode:",n),n===3?!0:n===0?!1:h==="sellCoin"?n===1:h==="buyCoin"?n===2:!1},[o==null?void 0:o.whitelistMode]),me=((yt=X[Ss(e==null?void 0:e.coin_type).full_address])==null?void 0:yt.price)||0,B=c.useMemo(()=>I&&u?j(I).div(u).toString():0,[I,u]),We=c.useMemo(()=>I&&u&&me&&j(I).div(u).mul(me).toString()||0,[I,u,me]),ot=j(p==null?void 0:p.feeRate).div(ze.pow(10,6)).mul(100).toString()+"%"||"0%",ge=c.useMemo(()=>{if(p!=null&&p.amountInLimitPerCycle&&(e!=null&&e.decimals))return Ds(p==null?void 0:p.amountInLimitPerCycle,e==null?void 0:e.decimals)},[p==null?void 0:p.amountInLimitPerCycle]),Me=c.useMemo(()=>(console.log("🚀 ~ orderSizeError ~ sellPerOrder:",B,ge),o!=null&&o.minCycleAmountInUsd&&u&&a&&ge&&Number(B)<Number(ge)?{status:!0,tips:`Each order size should be higher than $${o==null?void 0:o.minCycleAmountInUsd}.`}:a&&u&&Number(We)>1e4?{status:!0,tips:"Each order size should be less than $10,000"}:{status:!1,tips:""}),[A,ge,u,B,a,We,o==null?void 0:o.minCycleAmountInUsd]),Re=c.useMemo(()=>(console.log("🚀 ~ orderInputError ~ orderNum:",u,u&&Number(u)<Number(o==null?void 0:o.minCycleCount)),o!=null&&o.minCycleCount&&u&&Number(u)<Number(o==null?void 0:o.minCycleCount)?{status:!0,tips:`Number of Orders cannot be lower than ${o==null?void 0:o.minCycleCount}.`}:u&&Number(f)<=0?{status:!0,tips:"Please enter an interval above 0"}:u&&f&&Number(f)>1e4?{status:!0,tips:"The maximum interval is 10,000."}:{status:!1,tips:""}),[u,o==null?void 0:o.minCycleCount,f]),Ne=c.useMemo(()=>H&&Number(H)==0||q&&Number(q)==0?{status:!0,tips:"Please enter a price greater than 0."}:H&&q&&Number(H)>=Number(q)?{status:!0,tips:"The max price should be higher than min price."}:{status:!1,tips:""},[H,q]),[Ee,J]=c.useState(""),[K,ue]=c.useState({status:!1,tips:""}),rt=()=>{const n=new Date().getTime();let x=0;switch(console.log("🚀🚀🚀 ~ file: dca-detail.vue:34 ~ estEndDate ~ currentTime.value:",S),S){case"Minute":x=Number(f)*60*1e3*(Number(u)-1)+6e4;break;case"Hour":x=Number(f)*60*60*1e3*(Number(u)-1)+6e4;break;case"Day":x=Number(f)*60*60*24*1e3*(Number(u)-1)+6e4;break;case"Week":x=Number(f)*60*60*24*7*1e3*(Number(u)-1)+6e4;break;case"Month":x=Number(f)*60*60*24*30*1e3*(Number(u)-1)+6e4;break}console.log("🚀🚀🚀 ~ file: dca-detail.vue:46 ~ estEndDate ~ date + investTime:",u,n,x,x>60*60*24*365*1e3);const w=Bt(n+x,"YMDHM");console.log("🚀🚀🚀 ~ file: dca-data.ts:303 ~ getEstEndDate ~ result:",w),J(w),w=="NaN-NaN-NaN NaN:NaN"&&J("--"),x>60*60*24*365*1e3?ue({status:!0,tips:"The maximum execution period is 1 year"}):ue({status:!1,tips:"The maximum execution period is 1 year"})};c.useEffect(()=>{rt()},[a,f,u,H,q,S]);const he=c.useMemo(()=>{let n=0;switch(S){case"Minute":n=Number(f)*60;break;case"Hour":n=Number(f)*60*60;break;case"Day":n=Number(f)*60*60*24;break;case"Week":n=Number(f)*60*60*24*7;break;case"Month":n=Number(f)*60*60*24*30;break}return console.log("🚀🚀🚀 ~ file: dca-data.ts:333 ~ cycleFrequency ~ investTime:",n),n},[S,f]);c.useEffect(()=>{e!=null&&e.coin_type&&he&&u&&Ve(e==null?void 0:e.coin_type,he,u,b==null?void 0:b.address)},[e==null?void 0:e.coin_type,he,u,b==null?void 0:b.address]);const He=async(n,x,w,oe)=>{const lt=oe||"0x0000000000000000000000000000000000000000000000000000000000000000";try{const ae=await de({inCoin:n,freq:x,count:w,sender:lt});return console.log("🚀 ~ queryDcaQuote ~ result:",ae),ae}catch(ae){console.log("🚀🚀🚀 ~ file: dca-data.ts:344 ~ queryDcaQuote ~ error:",ae)}},Ve=Ke((n,x,w,oe)=>{He(n,x,w,oe)},500),{findBestRouters:Fe}=Ns(),[Ue,$e]=c.useState(!1),[se,Be]=c.useState(void 0),{getTokenRank:at}=It(),{fetchByApi:it}=ft(),[ct,be]=c.useState([]);c.useEffect(()=>{Ge();const n=at(e,t);console.log("🚀 ~ useEffect ~ direct:",n),Z(n)},[e==null?void 0:e.coin_type,t==null?void 0:t.coin_type]),c.useEffect(()=>{Ie(),e!=null&&e.coin_type&&(t!=null&&t.coin_type)&&(be([]),ht())},[B,e==null?void 0:e.coin_type,t==null?void 0:t.coin_type]);const Ie=()=>{j(B).gt(0)&&(e!=null&&e.coin_type)&&(t!=null&&t.coin_type)&&($e(!0),console.log("🚀 ~ useDcaHook ~ sellAmountDebounce:",Number(B)>0,B,e==null?void 0:e.coin_type,t==null?void 0:t.coin_type,u),qe())},qe=Ke(()=>{z()},500),z=async()=>{if(console.log("🚀 ~ findAvailableRouter ~ findAvailableRouter:",B),e&&t){const n=`${e.coin_type}_${t.coin_type}`;Q(n);const x=Object.entries(Ms).map(([w,oe])=>oe.id);try{const w=await Fe({fromToken:e,toToken:t,amount:dt(B||1,e==null?void 0:e.decimals),providersKeys:x,by_amount_in:!0,uuid:n});console.log("🚀 ~ findAvailableRouter ~ newUuid:",n,Y,w),n===ee.current&&(w!=null&&w.routerData)?(Be(w),r((w==null?void 0:w.toAmountUi)||""),$e(!1)):(Be(w),r("0"),$e(!1))}catch(w){console.log("🚀 ~ findAvailableRouter ~ error:",w)}}},Ge=()=>{const n=((e==null?void 0:e.coin_type)||(t==null?void 0:t.coin_type))&&Array.from(new Set([e==null?void 0:e.coin_type,t==null?void 0:t.coin_type]));(n==null?void 0:n.length)>0&&ke(n)},pe=c.useMemo(()=>{console.log("🚀 ~ btnStatus ~ routerData:",se);const n={text:"Create DCA Order",disabled:!1};return b!=null&&b.address?!(e!=null&&e.coin_type)||!(t!=null&&t.coin_type)?(n.disabled=!0,n.text="Select a token",n):!a||Number(a)==0?(n.disabled=!0,n.text="Enter an amount",n):j(I).gt((V==null?void 0:V.balanceFormat)||0)?(n.disabled=!0,n.text=`Insufficient ${e==null?void 0:e.symbol} balance`,n):j(o==null?void 0:o.minCycleCount).gt(u||0)?(n.disabled=!0,n.text=`Minimum ${o==null?void 0:o.minCycleCount} orders`,n):j(ge).gt(B||0)?(n.disabled=!0,n.text=`Minimum $${o==null?void 0:o.minCycleAmountInUsd} per order`,n):Me.status||Re.status||Ne.status||K.status||!(e!=null&&e.coin_type)||!(t!=null&&t.coin_type)||!u||!f||!H||!q?(n.disabled=!0,n.text="Create DCA Order",n):(console.log("🚀 ~ btnStatus ~ routerData:",se),se&&se.errorCode&&(se.errorCode===pt.NoRouter||se.errorCode===pt.HoneyPot||se.errorCode===pt.InsufficientLiquidity)&&(n.text="No Available Route",n.disabled=!0),n):(n.text="Connect Wallet",n.disabled=!1,n)},[b==null?void 0:b.address,V,Me,Re,Ne,K,e==null?void 0:e.coin_type,t==null?void 0:t.coin_type,I,f,u,H,q,(St=(_t=se==null?void 0:se.routerData)==null?void 0:_t.routes)==null?void 0:St.length]),Ye=c.useMemo(()=>{const n=[];return t&&n.push(t),e&&n.push(e),n},[t,e]),l=c.useMemo(()=>U&&d&&B?_e(j(d).div(B).toString(),t==null?void 0:t.decimals,!0):!U&&d&&B?_e(j(B).div(d).toString(),e==null?void 0:e.decimals,!0):"",[U,B,d]),N=Ke(n=>{fe(n)},500),L=Ke(n=>{De(n)},500),F=n=>{console.log("🚀 ~ handleMinInputChange ~ val:",n),N(n)},G=n=>{console.log("🚀 ~ handleMaxInputChange ~ val:",n),L(n)};c.useEffect(()=>{Qe(H)},[H,l]),c.useEffect(()=>{ne(q)},[q,l]);const Qe=n=>{if(console.log("🚀 ~ changeLowerPriceSize ~ val:",n),l&&n){const x=j(n).div(l).sub(1).mul(100).toString();console.log("🚀 ~ handleMaxInputChange ~ upperPrice:",x),re(j(x).gt(1e4)?">10,000%":`${_e(x,1,!1,ze.ROUND_HALF_DOWN)}%`)}},ne=n=>{if(l&&n){const x=j(n).div(l).sub(1).mul(100).toString();console.log("🚀 ~ handleMaxInputChange ~ upperPrice:",x),k(j(x).gt(1e4)?">10,000%":`${_e(x,1,!1,ze.ROUND_HALF_DOWN)}%`)}},ht=async()=>{const n=[Ze(e==null?void 0:e.coin_type),Ze(t==null?void 0:t.coin_type)].filter(Boolean);try{const x=await it("/v2/sui/price","GET",{base_symbol_address_pair:n.join(",")});if(console.log("🚀🚀🚀 ~ useDcaHook.ts:478 ~ checkPriceAvailability ~ priceResponse:",x),x&&x.prices){const w=x.prices.map(ae=>ae.base_symbol),oe=n.filter(ae=>!w.includes(ae));console.log("🚀 ~ checkPriceAvailability ~ availableCoinTypes:",w),console.log("🚀 ~ checkPriceAvailability ~ unsupportedCoinTypes:",oe),console.log("🚀 ~ checkPriceAvailability ~ requestedCoinTypes:",n),oe.length>0&&console.log("🚀 ~ checkPriceAvailability ~ 缺失价格的币种:",oe);const lt=oe.map(ae=>ae===Ze((e==null?void 0:e.coin_type)||"")?e:ae===Ze((t==null?void 0:t.coin_type)||"")?t:null).filter(Boolean);be(lt),console.log("🚀 ~ checkPriceAvailability ~ priceResponse:",x)}else{const w=[e,t].filter(Boolean);be(w)}}catch(x){console.log("🚀 ~ checkPriceAvailability ~ error:",x);const w=[e,t].filter(Boolean);be(w)}};return{currentPrice:l,handleMinInputChange:F,handleMaxInputChange:G,warningTokenList:Ye,resetInputAmount:Pe,cycleFrequency:he,btnStatus:pe,fetchFindAvailableRouterDebounce:Ie,queryDcaQuote:He,findRouterLoading:Ue,platformFee:ot,estEndDate:Ee,sellPerOrder:B,isDcaSelect:Oe,onReverseClick:Ae,sellBalanceInfo:V,buyBalanceInfo:xe,sellAmountValue:tt,handleAmountChange:Te,handleSelectToken:nt,minPriceValue:H,maxPriceValue:q,handlePageToggleDirect:st,orderSizeError:Me,orderInputError:Re,priceError:Ne,orderTimeError:K,missingCoins:ct,checkPriceAvailability:ht}}function Gs(){const i=mt("dca"),{getTokenListInfo:e}=$t(),{setFilterTokenLoading:t}=bs(),{setInCoinWhiteList:g,setOutCoinWhiteList:y}=ce();return{getDcaCoinWhiteList:async d=>{var r,_;console.log("🚀🚀🚀 ~ file: useGetDcaTokenList.ts:44 ~ getDcaCoinWhiteList ~ getDcaCoinWhiteList:");try{t(!0);const{in_coin_list:o,out_coin_list:D}=await i.Dca.getDcaCoinWhiteList(d);console.log("🚀🚀🚀 ~ file: useGetDcaTokenList.ts:18 ~ getDcaCoinWhiteList ~ outCoinList:",D),console.log("🚀🚀🚀 ~ file: useGetDcaTokenList.ts:18 ~ getDcaCoinWhiteList ~ inCoinList:",o);const h=[],f=[],S=o.map(P=>P),u=await e(S);if(u)for(let P=0;P<o.length;P++){const v=u.get(o[P]);v&&h.push({...v,labels:((r=v==null?void 0:v.labels)==null?void 0:r.length)>0?v==null?void 0:v.labels:""})}const p=D.map(P=>P),$=await e(p);if($)for(let P=0;P<D.length;P++){const v=$.get(D[P]);v&&f.push({...v,labels:((_=v==null?void 0:v.labels)==null?void 0:_.length)>0?v==null?void 0:v.labels:""})}console.log("🚀🚀🚀 ~ file: useDca.ts:351 ~ getDcaCoinWhiteList ~ outList:",f),console.log("🚀🚀🚀 ~ file: useDca.ts:351 ~ getDcaCoinWhiteList ~ inList:",h),g(h),y(f),t(!1)}catch(o){g([]),y([]),t(!1),console.log("🚀 ~ file: useGetDcaTokenList.ts:35 ~ getDcaCoinWhiteList ~ error:",o)}}}}function Ys(){const i=mt("dca"),{getDcaQuote:e}=Wt(),t=(a,d,r,_,o,D)=>{const h=j(dt(a,r)).div(d),f=j(h).div(j(o)),S=j(h).div(j(D));let u,p;if(r>_){const $=ze.pow(10,r-_);u=S.div($).ceil().toString(),p=f.div($).ceil().toString()}else if(r<_){const $=ze.pow(10,_-r);u=S.mul($).ceil().toString(),p=f.mul($).ceil().toString()}else u=S.ceil().toString(),p=f.ceil().toString();return{perCycleMinOutAmount:u,perCycleMaxOutAmount:p,cycleCountAmount:h}},g=(a,d,r,_)=>{const{in_coin:o,in_coin_amount:D,freq:h,cycle_count:f,out_coin:S}=a;return{in_coin_amount:String(dt(D,o.decimals)),in_coin_type:o.coin_type,out_coin_type:S.coin_type,cycle_frequency:h,cycle_count:f,per_cycle_min_out_amount:r,per_cycle_max_out_amount:_,per_cycle_in_amount_limit:d.amountInLimitPerCycle,fee_rate:d.feeRate,timestamp:d.timestamp,signature:d.signature}};return{openDcaOrder:async a=>{const{in_coin:d,out_coin:r,in_coin_amount:_,cycle_count:o,min_price:D,max_price:h,freq:f}=a,S=await i.getSenderAddress()||"0x0000000000000000000000000000000000000000000000000000000000000000",u=await e({inCoin:d.coin_type,freq:f,count:o,sender:S});if(!u)throw new Error("Request timed out");const{perCycleMinOutAmount:p,perCycleMaxOutAmount:$}=t(_,o,d.decimals,r.decimals,D,h),P=g(a,u,p,$);console.log("🚀🚀🚀 ~ file: useOpenDcaOrder.ts:91 ~ openDcaOrder ~ dcaOpenOrderPayloadParams:",P);const v=await i.Dca.dcaOpenOrderPayload(P);return console.log("🚀🚀🚀 ~ file: useOpenDcaOrder.ts:55 ~ openDcaOrder ~ tx:",v),v}}}function Ht({detailsData:i,isConfirm:e=!1}){const{sellPerOrder:t,estEndDate:g,platformFee:y,minPriceValue:a,maxPriceValue:d,minPriceResever:r,maxPriceResever:_}=i,{sellCoin:o,buyCoin:D,sellTotalAmount:h,investNum:f,currentInvest:S,pageDirect:u}=ce();return console.log("🚀 ~ DetailsBlock ~ investNum:",i,f),s.jsxs(E,{w:"100%",gap:e?"20px":"16px",children:[s.jsx(ye,{isLoading:!1,label:"Sell total",value:h?`${_e(h,o==null?void 0:o.decimals)} ${o==null?void 0:o.symbol}`:`-- ${o==null?void 0:o.symbol}`,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),s.jsx(ye,{isLoading:!1,label:"Sell per order",value:t?`${_e(t,o==null?void 0:o.decimals)} ${o==null?void 0:o.symbol}`:`-- ${o==null?void 0:o.symbol}`,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),!e&&s.jsx(ye,{isLoading:!1,label:"Receive",value:s.jsxs(R,{gap:"4px",children:[s.jsx(vs,{imageUrl:D==null?void 0:D.logo_url,w:"20px",h:"20px",coinType:D==null?void 0:D.coin_type,showTagHeight:"10px",showTagWidth:"10px"}),s.jsx(W,{color:"text_caption",children:D==null?void 0:D.symbol})]}),labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),e&&s.jsxs(R,{w:"100%",justify:"space-between",children:[s.jsx(W,{textAlign:"left",whiteSpace:"nowrap",children:"Price range"}),s.jsx(zs,{displayTokenA:D,displayTokenB:o,isRank:!0,justify:"flex-end",priceInfo:{minPrice:Xe(a).toString(),maxPrice:Xe(d).toString(),minPriceResever:Xe(r).toString(),maxPriceResever:Xe(_).toString()},fontSize:"14px",color:"text_caption"})]}),s.jsx(ye,{isLoading:!1,label:"Invest every",value:Number(f)>1?`${f} ${S}s`:`${f} ${S}`,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),e&&s.jsx(ye,{isLoading:!1,label:"Start date",value:String(Bt(Date.now(),"YMDHM")),labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),s.jsx(ye,{isLoading:!1,label:"Est. end date(UTC)",value:g,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}}),s.jsx(ye,{isLoading:!1,label:"Platform fee",value:y,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueW:"128px"}})]})}const Qs=({confirmData:i,isOpen:e,onClose:t,toOpenDca:g,toOpenDcaLoading:y})=>{const{sellCoin:a,buyCoin:d}=ce();return s.jsxs(Ft,{autoFocus:!1,returnFocusOnClose:!1,isOpen:e,onClose:t,isCentered:!0,children:[s.jsx(Ut,{}),s.jsxs(qt,{children:[s.jsx(Gt,{children:s.jsx(Yt,{fontWeight:"500",fontSize:"16px",children:"Review your order"})}),s.jsx(Qt,{}),s.jsx(Kt,{textAlign:"center",p:"0px",children:s.jsxs(E,{w:"100%",gap:"16px",p:"16px",children:[s.jsxs(Le,{borderRadius:"12px",position:"relative",p:"0 12px",children:[s.jsxs(R,{w:"100%",justify:"space-between",children:[s.jsxs(E,{align:"flex-start",w:"calc(50% - 24px)",children:[s.jsx(W,{children:"Sell"}),s.jsx(wt,{token:a,haveName:!1,symbolEllipsesDecimals:10})]}),s.jsx(Zt,{w:"1px",h:"100px",bg:"border"}),s.jsxs(E,{align:"flex-end",w:"calc(50% - 24px)",children:[s.jsx(W,{children:"Buy"}),s.jsx(wt,{token:d,haveName:!1,symbolEllipsesDecimals:10})]})]}),s.jsx(Nt,{w:"36px",h:"36px",borderRadius:"50%",position:"absolute",left:"calc(50% - 18px)",top:"calc(50% - 18px)",border:"1px solid",borderColor:"border",boxShadow:"trade_icon_shadow",bg:"input_bg",children:s.jsx(Je,{mt:"-1px",svgW:"12px",svgH:"12px",xlinkHref:"#icon-a-icon_trade",svgFill:"text_caption",transform:"rotate(-90deg)"})})]}),s.jsx(Ht,{detailsData:i,isConfirm:!0}),s.jsx(we,{mt:"12px",onClick:()=>{g(),t()},isDisabled:y,w:"calc(100% + 32px)",mb:"-30px",h:"52px",fontWeight:"500",children:"Create DCA Order"})]})})]})]})};function Ks({detailsData:i}){return s.jsx(Le,{children:s.jsxs(E,{gap:"20px",children:[s.jsxs(R,{w:"100%",justify:"space-between",children:[s.jsx(W,{color:"text_caption",children:"Details"}),s.jsx(W,{fontSize:"12px",children:"Your first invest cycle will begin immediately"})]}),s.jsx(Ht,{detailsData:i})]})})}function Mt({title:i,label:e,inputValue:t,inputChange:g=()=>{},list:y=[],onListItemClick:a=()=>{}}){const d=r=>{const _=r.target.value.replace(/[^\d]/g,"");g(_)};return s.jsx(Lt,{w:"50%",borderRadius:"16px",children:s.jsxs(E,{gap:"16px",align:"flex-start",children:[typeof i=="string"?s.jsx(W,{fontWeight:"500",lineHeight:"18px",fontSize:"13px",children:i}):i,s.jsxs(R,{w:"100%",justify:"space-between",children:[s.jsx(Xt,{value:t,onChange:d,style:{width:"calc(100% - 8px)",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"20px",fontWeight:"500",touchAction:"manipulation",transition:"all 0.3s"}}),y.length>0?s.jsx(rs,{label:e,list:y,onListItemClick:a}):s.jsx(W,{color:"text_caption",children:e})]})]})})}function Rt({direct:i,text:e,align:t,inputValue:g,inputChange:y=()=>{}}){const{sellCoin:a,buyCoin:d}=ce();return s.jsx(Lt,{w:"unset",borderRadius:"8px",children:s.jsx(R,{children:s.jsxs(E,{align:t,children:[s.jsx(js,{value:g,placeholder:"0.0",decimals:18,onChange:r=>y(r),style:{width:"calc(100% - 8px)",textAlign:t=="flex-start"?"left":"right",background:"none",whiteSpace:"nowrap",opacity:1,outline:"none",color:"var(--chakra-colors-text_caption)",fontSize:"20px",fontWeight:"500",touchAction:"manipulation",transition:"all 0.3s"}}),s.jsxs(R,{w:"100%",justify:"space-between",children:[s.jsx(W,{fontSize:"12px",fontWeight:"500",children:i?`${d==null?void 0:d.symbol} per ${a==null?void 0:a.symbol}`:`${a==null?void 0:a.symbol} per ${d==null?void 0:d.symbol}`}),e&&s.jsx(W,{fontSize:"12px",fontWeight:"500",children:e})]})]})})})}const Zs="/images/icon_currentprice@2x.png";function Xs({handleGetDcaOrderList:i}){const{sellCoin:e,buyCoin:t,sellAmount:g,buyAmount:y,setInvestNum:a,setOrderNum:d,investNum:r,orderNum:_,currentInvest:o,setCurrentInvest:D,pageDirect:h,isDcaRefresh:f,dcaMode:S,setDcaMode:u,sellTotalAmount:p,upperPriceSize:$,lowerPriceSize:P,setLowerPriceSize:v,setUpperPriceSize:Z}=ce(),{currentPrice:U,btnStatus:A,findRouterLoading:I,sellBalanceInfo:C,buyBalanceInfo:re,sellAmountValue:k,handleAmountChange:M,handleSelectToken:O,minPriceValue:b,maxPriceValue:T,handleMinInputChange:de,handleMaxInputChange:X,handlePageToggleDirect:ke,onReverseClick:le,orderSizeError:Y,orderInputError:Q,orderTimeError:ee,priceError:m,sellPerOrder:te,estEndDate:Se,platformFee:et,fetchFindAvailableRouterDebounce:H,cycleFrequency:fe,resetInputAmount:q,warningTokenList:De,missingCoins:V}=qs();c.useEffect(()=>{f&&H()},[f]);const{currentAccount:xe,onWalletModal:tt}=Ce(),[Te,st]=c.useState("#icon-a-icon_trade"),nt=["Minute","Hour","Day","Week","Month"],Pe=l=>st(l?"#icon-icon_swap1":"#icon-a-icon_trade"),{openDcaOrder:Ae}=Ys(),[Oe,me]=c.useState(!1),{fetchCoinBalance:B}=zt(),{signAndExecuteTransaction:We,transactionRejected:ot,transactionConfirmation:ge}=Os(),{failedTsToast:Me}=ws(),{showInsufficientBalanceToast:Re}=As(),Ne=async()=>{me(!0);const l={getShowInfo:F=>{`${_e(p)}${e==null?void 0:e.symbol}${t==null?void 0:t.symbol}${_}`;const G={modalDescriptionText:"Creating DCA Order",toastTitleText:"Creating DCA Order"};return F==="success"&&(G.modalDescriptionText="DCA Order Created",G.toastDescriptionContent="",G.toastTitleText="DCA Order Created"),G}};ge(l);const N=h?j(1).div(T).toString():b,L=h?j(1).div(b).toString():T;try{const F={in_coin:e,out_coin:t,in_coin_amount:p,cycle_count:_,min_price:N,max_price:L,freq:fe};console.log("🚀 ~ toOpenDca ~ params:",!h,b,T,N,L,F);const G=await Ae(F);console.log("🚀 ~ toOpenDca ~ tx:",G);const Qe={inCoin:e==null?void 0:e.coin_type,outCoin:t==null?void 0:t.coin_type,inCoinAmount:p,cycleCount:_,minPrice:N,maxPrice:L,freq:fe,txAction:"openDcaOrder"},ne=await We(G,l,{trackData:Qe});console.log("🚀 ~ toOpenDca ~ res:",ne),ne&&(q(),setTimeout(()=>{B(xe==null?void 0:xe.address,e==null?void 0:e.coin_type),i(xe==null?void 0:xe.address)},2e3)),me(!1)}catch(F){const G={getShowInfo:Qe=>{const ne={};return String(F)==="Error: Each order size should be higher than $10"&&(ne.toastTitleText="Transaction Submission Error",ne.toastDescriptionContent="Each order size should be higher than $10."),String(F)==="Error: Request timed out"&&(ne.toastTitleText="Request timed out",ne.toastDescriptionContent="Please confirm the network status and resubmit the transaction."),String(F)==="Error: minPrice error"&&(ne.toastTitleText="DCA order submission failed",ne.toastDescriptionContent="Your nominated prices are out of scope. Please modify your accepted price range and submit it again."),ne}};console.log("🚀 ~ toOpenDca ~ error:",F),console.error("Open DCA Order Error: ",F),Re(String(F)),ot(G),Me(G),me(!1)}},{currentCoinKey:Ee,inCoinWhiteList:J,outCoinWhiteList:K,dcaConfig:ue,whiteTokenList:rt,setWhiteTokenList:he}=ce(),{getDcaCoinWhiteList:He}=Gs();c.useEffect(()=>{Ee=="sellCoin"?he(J):he(K)},[Ee,J,K]),c.useEffect(()=>{ue&&(ue.whitelistMode||ue.whitelistMode==0)&&(console.log("🚀🚀🚀 ~ file: DcaInputBlock.tsx:101 ~ DcaInputBlock ~ dcaConfig:",ue),He(ue.whitelistMode))},[ue]);const[Ve,Fe]=c.useState(!1),Ue=c.useMemo(()=>{const l=h?t==null?void 0:t.decimals:e==null?void 0:e.decimals;let N="",L="",F="",G="";return b&&T&&(N=h?je(j(1).div(T).toString(),l,!0).toString():b,L=h?je(j(1).div(b).toString(),l,!0).toString():T,F=h?b:je(j(1).div(T).toString(),l,!0).toString(),G=h?T:je(j(1).div(b).toString(),l,!0).toString()),{estEndDate:Se,sellPerOrder:te,platformFee:et,minPriceValue:N,maxPriceValue:L,minPriceResever:F,maxPriceResever:G}},[h,Se,te,et,b,T]),$e=[{label:"Total",value:"total"},{label:"Per Order",value:"perOrder"}],[se,Be]=c.useState([0,0]),[at,it]=c.useState(0),[ct,be]=c.useState(0),Ie=l=>{console.log("🚀 ~ handleSlider ~ val:",l),Be(l),de(l[0].toString()),X(l[1].toString())};c.useEffect(()=>{if(b&&T){const l=Number(b),N=Number(T);Be([l,N]),console.log("🚀 ~ useEffect ~ start:",l,N)}b||v("0%"),T||Z("0%")},[b,T]),c.useEffect(()=>{if(U){const l=j("-100").div(100).plus(1).mul(U).toNumber(),N=j("100").div(100).plus(1).mul(U).toNumber();console.log("🚀 ~ useEffect ~ min:",l,N),it(l),be(N)}},[U]);const qe=c.useMemo(()=>{const l=J==null?void 0:J.filter(L=>(L==null?void 0:L.coin_type)==(e==null?void 0:e.coin_type)),N=K==null?void 0:K.filter(L=>(L==null?void 0:L.coin_type)==(t==null?void 0:t.coin_type));return!!(J!=null&&J.length&&(K!=null&&K.length)&&((l==null?void 0:l.length)<1||(N==null?void 0:N.length)<1))},[J,K,e,t]),{showTokenInfo:z,isProMode:Ge,currentProTab:pe,currentProTabUpdateWith:Ye}=gt();return c.useEffect(()=>{Ye==="toggleBtn"||!Ye||(z!=null&&z.coin_type&&(t!=null&&t.coin_type)&&(e!=null&&e.coin_type)?(pe=="Buy"&&ie(z==null?void 0:z.coin_type)!==ie(t==null?void 0:t.coin_type)||pe=="Sell"&&ie(z==null?void 0:z.coin_type)!==ie(e==null?void 0:e.coin_type))&&le():(z!=null&&z.coin_type&&(t!=null&&t.coin_type)&&!(e!=null&&e.coin_type)||z!=null&&z.coin_type&&!(t!=null&&t.coin_type)&&(e!=null&&e.coin_type))&&le())},[pe]),s.jsxs(E,{w:"100%",children:[s.jsx(Bs,{onClick:()=>le(!0),currentCoinKey:Ee,whiteTokenList:rt,from:{inputTabOptions:{type:"outlineTab",tabList:$e,currentTab:S=="total"?"Total":"Per Order",handleChangeTab:l=>{u(l==null?void 0:l.value)},wrapStyle:{w:"168px",h:"28px",p:"3px",borderRadius:"10px"},itemStyle:{flex:"1",fontSize:"12px",margin:"0px",borderRadius:"6px"}},title:"You Pay",balance:(C==null?void 0:C.balanceFormat)||"",value:g,amountValue:k,loading:!1,onChange:M,selectable:!0,placeholder:"0.0",token:e,whiteTokenList:J,onTokenChange:l=>O(l,!0)},to:{isDcaTo:!0,wrapStyle:{backgroundColor:"bg_secondary",h:"94px"},title:"You Receive",inputAllowed:!1,balance:(re==null?void 0:re.balanceFormat)||"",value:"",amountValue:"",loading:!1,onChange:()=>{},token:t,whiteTokenList:K,onTokenChange:l=>O(l,!1),selectable:!0,placeholder:"",half:!1,max:!1},iconParams:{xlinkHref:Te,svgFill:"text_caption",transform:Te==="#icon-a-icon_trade"?"":"rotate(90deg)",fontSize:Te==="#icon-a-icon_trade"?"12px":"16px",onMouseEnter:()=>Pe(!0),onMouseLeave:()=>Pe(!1)}}),(Y==null?void 0:Y.status)&&s.jsx(ve,{tips:Y==null?void 0:Y.tips,bg:"primary_red_bg"}),s.jsxs(R,{w:"100%",children:[s.jsx(Mt,{title:"Invest Every",label:o,inputValue:r,list:nt,onListItemClick:l=>{D(l)},inputChange:l=>{console.log("🚀 ~ DcaInputBlock ~ item:",l),a(l)}}),s.jsx(Mt,{title:s.jsx($s,{tooltipCon:"How many orders your want to repeat in total.",children:s.jsx(W,{fontSize:"13px",fontWeight:"500",mr:"4px",children:"Over"})}),label:"Orders",inputValue:_,inputChange:l=>{d(l),H()}})]}),(Q==null?void 0:Q.status)&&s.jsx(ve,{tips:Q==null?void 0:Q.tips,bg:"primary_red_bg"}),(ee==null?void 0:ee.status)&&s.jsx(ve,{tips:ee==null?void 0:ee.tips,bg:"primary_red_bg"}),s.jsxs(Le,{zIndex:"1",p:"16px",borderRadius:"16px",children:[s.jsxs(E,{align:"flex-start",children:[s.jsx(W,{color:"text_caption",children:"Set Price Range"}),s.jsx(W,{lineHeight:"16px",fontSize:"12px",m:{base:"4px 0",lg:"0"},mb:{base:g?"4px":"0"},children:"DCA will only be executed if the price falls within the range of your pricing strategy."}),g&&te&&y&&y!="0"&&s.jsxs(R,{mt:"8px",w:"100%",justify:"space-between",flexDirection:{base:"column",lg:"row"},align:{base:"align",lg:"center"},children:[s.jsx(W,{children:"Current Rate"}),s.jsx(E,{align:{base:"flex-start",lg:"flex-end"},children:s.jsx(Es,{color:"text_caption",pageDirect:h,handlePageToggleDirect:ke,fromToken:e,toToken:t,fromValue:te,toValue:y,isLoading:I||!y||!te})})]})]}),s.jsxs(R,{justify:"space-between",gap:"8px",mt:"20px",children:[s.jsx(Rt,{direct:h,text:g&&b?P:"",inputValue:b,inputChange:l=>de(l),align:"flex-start"}),s.jsx(W,{color:"text_caption",children:"-"}),s.jsx(Rt,{direct:h,text:g&&T?$:"",inputValue:T,inputChange:l=>X(l),align:"flex-start"})]}),!I&&g&&b&&T&&Number(T)>=Number(b)&&(A==null?void 0:A.text)!=="No Available Route"&&y&&y!="0"&&s.jsxs(E,{w:"100%",gap:"0",mt:"20px",children:[s.jsxs(Jt,{min:at,max:ct,step:.1,value:se,onChange:l=>{Ie(l)},colorScheme:"teal",children:[s.jsx(Ct,{children:s.jsx(es,{})}),s.jsx(bt,{index:0}),s.jsx(bt,{index:1})]}),s.jsx(ts,{src:Zs,w:"32px",h:"32px"}),s.jsx(R,{w:"100%",h:"14px",justify:"center",mt:"-2px",children:s.jsx(W,{children:"Current Rate"})})]})]}),(m==null?void 0:m.status)&&s.jsx(ve,{tips:m==null?void 0:m.tips,bg:"primary_red_bg"}),qe&&t&&e&&s.jsx(ve,{tips:"This token is not supported for DCA yet. Please select from the supported list.",type:"warning",isShowIcon:!1}),V&&(V==null?void 0:V.length)>0&&s.jsx(ve,{tips:`${V.map(l=>ks(l.symbol)).join(V.length===2?" and ":", ")} ${V.length===1?"is":"are"} not supported for DCA yet.`,type:"warning",isShowIcon:!1}),s.jsx(we,{isLoading:Oe,isDisabled:(A==null?void 0:A.disabled)||Oe||qe||(V==null?void 0:V.length)>0,w:"100%",h:"52px",fontSize:"18px",fontWeight:"500",variant:Ge?`solid-${pe==null?void 0:pe.toLocaleLowerCase()}`:"solid",onClick:(A==null?void 0:A.text)=="Connect Wallet"?()=>tt(!0):()=>Fe(!0),children:Ge&&(A==null?void 0:A.text)=="Create DCA Order"?pe:A==null?void 0:A.text}),g&&s.jsx(Ks,{detailsData:Ue}),Ve&&s.jsx(Qs,{confirmData:Ue,isOpen:Ve,onClose:()=>Fe(!1),toOpenDca:Ne,toOpenDcaLoading:Oe}),(t||e)&&s.jsx(Is,{addToken:!0,tokensInfo:De,waringModalCancel:l=>{l.forEach(N=>{(N.coin_type===(t==null?void 0:t.coin_type)||N.coin_type===(e==null?void 0:e.coin_type))&&O(void 0,N.coin_type===(t==null?void 0:t.coin_type))})}})]})}function no(){const{currentAccount:i}=Ce(),{sellCoin:e,buyCoin:t,setIsDcaRefresh:g,whiteTokenList:y,setBuyCoin:a,setSellCoin:d}=ce(),{isShowTradeChart:r,isShowTradeOrders:_}=Ts(),{getDcaOrderList:o}=Rs(),{fetchAccountBalance:D}=zt(),{dcaOrderListLoading:h,setDcaOrderListLoading:f,dcaActiveOrderList:S,dcaPastOrderList:u,setDcaActiveOrderList:p,setDcaPastOrderList:$}=Ls(),P=async(m,te=!1)=>{!O&&!_||(te&&f(!0),o(m,te))};c.useEffect(()=>{i!=null&&i.address?P(i==null?void 0:i.address,!0):(p([]),$([]))},[i==null?void 0:i.address,_]);const v=(m=!0)=>{I(0),g(!0),setTimeout(()=>{g(!1)},1e3),i!=null&&i.address&&(m||D(),P(i==null?void 0:i.address,m))};Hs({onRpcChange:()=>{v()}}),c.useEffect(()=>{i!=null&&i.address&&D()},[i==null?void 0:i.address]);const{isApp:Z,windowWidth:U}=xt(),[A,I]=c.useState(0),C=Z?2e3:1e3,re=Z?10:20;Ws({interval:C,callback:()=>{I(A+1),A>=re&&!O&&v(!1)}});const[k,M]=c.useState(!1),{isProMode:O,currentProTab:b,showTokenInfo:T,setShowTokenInfo:de,setAnotherTokenInfo:X,coinBvPriceUnit:ke,setIsCoinSelect:le}=gt(),Y=()=>{M(!k),T&&ie(T==null?void 0:T.coin_type)==ie((t==null?void 0:t.coin_type)||"")?(de(e),X(t)):(de(t),X(e))},Q=Et(),ee=m=>{le(!0),de(m),b=="Buy"?(m==null?void 0:m.coin_type)==(e==null?void 0:e.coin_type)?(M(!k),X(t),Q(`/dca/${t==null?void 0:t.coin_type}/${m==null?void 0:m.coin_type}`)):((m==null?void 0:m.coin_type)===(t==null?void 0:t.coin_type)||Q(`/dca/${e==null?void 0:e.coin_type}/${m==null?void 0:m.coin_type}`),X(e)):(m==null?void 0:m.coin_type)==(t==null?void 0:t.coin_type)?(M(!k),X(e),Q(`/dca/${m==null?void 0:m.coin_type}/${t==null?void 0:t.coin_type}`)):((m==null?void 0:m.coin_type)===(e==null?void 0:e.coin_type)||Q(`/dca/${m==null?void 0:m.coin_type}/${t==null?void 0:t.coin_type}`),X(t))};return c.useEffect(()=>()=>{le(!1)},[]),s.jsxs(R,{mt:U&&U<1024||O?"0px":"42px",className:O||Z||r||_?"":"bg_img",w:"100%",gap:"0px",justify:"center",align:"flex-start",flexDirection:{base:"column-reverse",lg:"row"},children:[Z&&_&&s.jsx(E,{w:{base:"100%",lg:"calc(100% - 470px)"},children:s.jsx(Ot,{handleRefresh:v,activeList:S,pastList:u,isOrderLoading:h})}),(r||_||O)&&(O?s.jsx(is,{whiteTokenList:y,onCoinSelect:m=>ee(m),isChangeDirect:k,tokenA:e,tokenB:t,handleToggleDirect:Y}):Z?null:s.jsxs(E,{pr:O?"0":"20px",w:{base:"100%",lg:O?"calc(100% + 380px)":"calc(100% - 470px)"},children:[r&&s.jsx(vt,{baseToken:e,quoteToken:t}),_&&s.jsx(Ot,{handleRefresh:v,activeList:S,pastList:u,isOrderLoading:h})]})),s.jsxs(E,{w:{base:"100%",lg:O?"380px":"470px"},children:[s.jsxs(R,{w:"100%",justify:"space-between",mb:"8px",children:[s.jsx(ss,{currTradeTab:ns.DCA}),!O&&s.jsx(as,{})]}),s.jsx(Xs,{handleGetDcaOrderList:m=>P(m)})]}),Z&&(r||O)?O?s.jsx(os,{onCoinSelect:m=>ee(m),handleToggleDirect:Y,token:T,tokenPriceUnit:ke}):s.jsx(E,{w:"100%",children:s.jsx(c.Suspense,{fallback:s.jsx("div",{}),children:s.jsx(vt,{baseToken:t,quoteToken:e})})}):null]})}export{no as default};
