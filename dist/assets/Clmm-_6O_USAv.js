import{r as j,j as e,T as _,H as L,V as E,C as Rt,w as Ae,Z as ns,S as Se,a0 as Ye,ar as ir,m as Oe,B as ee,ad as nr,M as cs,o as as,p as ls,$ as ds,q as cr,t as xs,X as Lt,l as jt,v as ar,a8 as kt,F as lr,a1 as dr,n as Gt,ac as xr}from"./vendor-CBmAETR3.js";import{S as os}from"./Slippage-8fJCLOYr.js";import{b as or,c as Zt}from"./CoinPairInfo-BH5hoU3X.js";import{E as qe,u as pr,I as it,T as Dt,a as ps,D as Kt,b as ur,c as Qt}from"./useLiquidityInteraction-BSyDnc7K.js";import{f as gr,n as mr,dV as hr,aq as ke,s as Xt,co as yr,dg as br,I as Re,u as Le,S as ut,ah as us,t as te,av as gs,d as N,G as Yt,E as ms,aO as jr,bo as hs,v as Ce,a as ys,M as ft,Q as fr,aj as _t,aJ as Sr,z as be,h as nt,m as gt,l as le,ad as Ar,bn as Jt,dW as vr,a5 as Ee,c as bs,C as pt,cS as ct,ai as at,P as wr,aX as Ne,w as Je,B as js,e as kr}from"./index-BpSfzecM.js";import"./cross-DJ28FxNa.js";import{u as de}from"./index-CqgM3rES.js";import{u as Pe}from"./index-CbQm3ih3.js";import{H as _r}from"./H5MapTable-DTBE_3Qm.js";import{N as Xe}from"./NoData-BFX9XpKb.js";import{T as Cr}from"./Table-CbnPAf5M.js";import{A as Rr}from"./AnalyticsCharts-BMwK7tjv.js";import{a as fs,u as Lr}from"./useGetTvlInfo-QgMBT0Ce.js";import{c as Fr}from"./usePosClaimFeeAndReward-COsUjXqP.js";import{H as Ct}from"./HTextLabelBox-D0r99Smv.js";import{T as Tr}from"./TooltipIcon-DVhxXZmh.js";import{D as Ft}from"./DepositRatio-D2zurS6C.js";import{P as Mr}from"./PoolTag-DVhitHGR.js";import{T as Tt}from"./TotalAmount-B2jkoq59.js";import{P as Br}from"./PositionStatus-CKFJf5Ct.js";import{c as Mt,a as Ss,d as As,u as Er,e as vs,Z as ws}from"./RemoveBlock-CGdGO_rZ.js";import{a as ze,u as ks}from"./addLiquidity-DNM9DGI2.js";import{u as Fe,b as St,L as _s,S as lt}from"./StatsInfo-BBP9Tgib.js";import{T as Pt}from"./TradeConfirmAmountInfo-C8pVFbTE.js";import{d as Cs}from"./usePosRemove-04piisVo.js";import{u as qr}from"./useTransaction-uEos3ZjK.js";import{c as Rs,n as Ie,a as zr,o as Hr}from"./usePositionList-heG2hQcx.js";import{f as dt,i as Ue}from"./index-gw6wWhzj.js";import{d as Wr,h as mt,i as ht}from"./utils-CMHkC_9A.js";import{u as Ls}from"./useAccountBalance-DV0qM_Vy.js";import{u as $r}from"./useTransactionModal-DL7w_I3R.js";import{u as yt}from"./useTokenBalance-c3RAkCCY.js";import{u as Fs,S as It}from"./SelectToken-COX6g62D.js";import{u as Ur}from"./useNotifiSubscription-UwVjL9WV.js";import{u as Nr}from"./usePosAdd-DG3IUn6t.js";import{W as Ts}from"./WithTooltipInfo-Vqx8IrEo.js";import{P as es}from"./PriceInput-CVvMrCd6.js";import{a as Or,V as Vr,i as Gr,c as Zr}from"./VaultsAprBlock-Bvb3Su6d.js";import{a as Dr,F as Kr}from"./VaultsAction-DQ6-bqcC.js";import{V as Qr,P as Xr}from"./PositionItem-DfdoLJIX.js";import{u as Ms}from"./usePriceImpact-DTCbq_0I.js";import{E as bt}from"./ErrorTips-lJshH5MT.js";import{T as Bs}from"./TradeInputGroup-C0B6uidS.js";import{s as Yr}from"./PositionItemContent-DLz2oagg.js";import{u as Jr}from"./useRpcListener-BdFabOsZ.js";import{A as Pr}from"./index-DfyAgMoy.js";import{S as Ir}from"./SelectTokenAndFeeConfirm-BsMtMGIm.js";import{g as ei}from"./dlmm-DdxfaipV.js";import{c as ts}from"./config-DTm0VBgZ.js";import{u as ti}from"./useGetPoolList-4kFQ2tyG.js";import{m as vt}from"./maxBy-BjNHtTns.js";import{B as si}from"./BackButton-DoozH78n.js";import{R as ri}from"./RefreshButton-bgRHxGzR.js";import{C as ii}from"./CurrentPrice-D1qM8kFS.js";import{F as ni}from"./FeeSelectBlock-D_jVInvd.js";import{W as ci}from"./WarningTokenTipModal-BPL2NtCc.js";import"./useWrapPoolData-CMGMCXwG.js";import"./ExamplePieChart-BwD2tvSq.js";import"./PieChart-D9NtH4qL.js";import"./generateCategoricalChart-CmRMqbFo.js";import"./debounce-MPJy35Ge.js";import"./index-C7OfScvw.js";import"./useFavoritePool-5MLb1oZG.js";import"./useCreatePool-CDFSrv9X.js";import"./swapWidget-DsvWJZa9.js";import"./swapWidgetConfig-UYiO35jy.js";import"./index-D8UqOC8m.js";import"./TvlChart-CBoLRZaM.js";import"./EmptyTooltip-DzkM7sEr.js";import"./_getAllKeysIn-Juzb7Mj8.js";import"./_defineProperty-Bpc363rP.js";import"./YAxis-DLEZvSSr.js";import"./AreaChart-DBMzOkAF.js";import"./Area-Bqahw1_r.js";import"./VolumeChart-CgtIPmnL.js";import"./BarChart-3cDt1x1m.js";import"./msafe-BzcjPV-e.js";import"./LiquidityValueBlock-CJnPKpci.js";import"./icon_active_new@2x-Bekkt6Xc.js";import"./v4-C6aID195.js";import"./FreshProgressV2-DfCij7Ow.js";import"./index-CgYRIMgB.js";import"./index-Dq_SzPY7.js";import"./MarketSource-Zu8s3YB-.js";import"./detail-Cbbl8wNo.js";import"./useCurrentPos-C5suLYji.js";import"./AutoClaimCheckBox-lw6rJPdV.js";import"./CheckBox-eomO844M.js";import"./ExpendItem-BR-Au2GE.js";import"./PositionPriceRangeBar-Bdy_fJqo.js";import"./RangeValue-CrFwA76f.js";import"./useTokenRank-CM-9-tXe.js";import"./usePreviousValue-Da-o2xpb.js";import"./VTextLabelBox-CuuDZpMe.js";import"./useTrack-Cdn9qear.js";import"./useSigner-Ct94kXtL.js";import"./en_US-KAK2ZBDO-C1Pw6Q2s.js";import"./index-S9fozw96.js";import"./Loading-DOvYGudd.js";import"./useNotifiAlerts-7h-tWLbZ.js";import"./useXCetusHelper-rG98hv61.js";import"./ActionButton-1ExqaF95.js";import"./InputBox-DUnOULwS.js";import"./useGetPythTokenPrice-Co4DlB3j.js";import"./useFavoriteDlmmPool-BAgWoipQ.js";import"./useGetDlmmPoolList-DgjXNLvP.js";import"./RemoveBlock-C31WZQk2.js";import"./useSwapHelper-RreJ3kMc.js";import"./useFindBestRouting-CX4IIQLi.js";import"./useInterval-FApnpfRj.js";import"./TableSortTh-B7oL9qGd.js";import"./_baseClone-B759QteI.js";import"./last-CxFZ9vay.js";import"./detail-C9A3dtWB.js";import"./HiddenDotted-BCHLZhII.js";import"./StatusPosition-CL7kLY-2.js";import"./useGetClmmPositionDailyEarning-DV5RvJKu.js";import"./useDocumentSize-BLl0gbMB.js";import"./index-BTngaqMa.js";import"./CetusMenu-D6ll9Vbb.js";function ai(){const s=gr("clmm"),{fetchByApi:t}=mr();return{getTransactionsHistory:async m=>{try{const d=await t(hr,"GET",m);if(console.log(d,"getTransactionsHistory"),d)return d;throw new Error("no data")}catch(d){console.error(d,"getTransactionsHistory ~ error")}},getTransactionsHistoryBySDK:async(m,d)=>{const o=["https://rpc-mainnet.suiscan.xyz:443","https://cetus-mainnet-endpoint.blockvision.org"];for(const h of o)try{const i=await s.Pool.getPoolTransactionList({pool_id:m,pagination_args:d,full_rpc_url:h});return console.log(i,`getTransactionsHistoryBySDK with ${h}`),i}catch(i){console.error(i,`getTransactionsHistoryBySDK ~ error with ${h}`)}}}}function li(){const{getTransactionsHistoryBySDK:t}=ai(),[a,l]=j.useState(!0),[m,d]=j.useState([]),[o,h]=j.useState(1),[i,x]=j.useState(),[y,c]=j.useState(!0),{apiPoolInfo:p,manualRefresh:b,setManualRefresh:w}=de(),{poolAddress:k}=ke();j.useEffect(()=>{d([]),h(1),x(void 0),c(!0)},[k]),j.useEffect(()=>{b&&(d([]),h(1),x(void 0),c(!0),g({cursor:void 0,limit:10}))},[k,b]);const g=async q=>{var R;try{if(!y)return;if(k){l(!0),console.log("ðŸš€ ~ fetchData ~ params:",{poolAddress:k,params:q});const f=await t(k,{...q});if(console.log("ðŸš€ ~ fetchData ~ result:",f),f){const M=(R=f==null?void 0:f.data)==null?void 0:R.map(u=>{var B,F;const r=u==null?void 0:u.parsed_json,n=r!=null&&r.amount_a||r!=null&&r.atob?p==null?void 0:p.tokenA:p==null?void 0:p.tokenB,S=r!=null&&r.amount_b||r!=null&&r.atob?p==null?void 0:p.tokenB:p==null?void 0:p.tokenA;return{...u,type:(B=u.type)!=null&&B.includes("Add")?qe.add:(F=u.type)!=null&&F.includes("Remove")?qe.remove:qe.swap,items:[{amount:Xt(r!=null&&r.amount_a?r==null?void 0:r.amount_a:r==null?void 0:r.amount_in,n==null?void 0:n.decimals).toString(),address:n==null?void 0:n.coin_type,url:n==null?void 0:n.logo_url,symbol:n==null?void 0:n.symbol},{amount:Xt(r!=null&&r.amount_b?r==null?void 0:r.amount_b:r==null?void 0:r.amount_out,S==null?void 0:S.decimals).toString(),address:S==null?void 0:S.coin_type,url:S==null?void 0:S.logo_url,symbol:S==null?void 0:S.symbol}]}});console.log("ðŸš€ ~ const_data=result?.data?.map ~ _data:",M),q!=null&&q.cursor?d(u=>[...u,...M||[]]):d(M||[]),x(f==null?void 0:f.next_cursor),c(f==null?void 0:f.has_next_page),l(!1)}else o===1&&c(!1)}}catch(f){console.log(f,"getTransactionsHistoryBySDK-error"),l(!1)}finally{l(!1)}};return Pe(()=>{g({cursor:i,limit:10})},[o,k],{wait:500,leading:!0,trailing:!1}),{isLoading:a,list:m,apiPoolInfo:p,currentPage:o,onCurrentPageChange:()=>{h(q=>q+1)},hasNextPage:y}}const xt={[qe.add]:{icon:"#icon-a-icon_add1",color:"primary_green",title:"Add Liquidity"},[qe.remove]:{icon:"#icon-tx_remove",color:"light_coral",title:"Remove Liquidity"},[qe.swap]:{icon:"#icon-icon_swap",color:"primary",title:"Swap"}},di=({type:s})=>{var t,a,l,m;return e.jsxs(L,{children:[e.jsx(Re,{xlinkHref:(t=xt[s])==null?void 0:t.icon,svgFill:(a=xt[s])==null?void 0:a.color,svgHover:(l=xt[s])==null?void 0:l.color}),e.jsx(_,{color:"text_caption",children:(m=xt[s])==null?void 0:m.title})]})},xi=({items:s,type:t,isReverse:a})=>{var m,d;const{isApp:l}=Le();return s?t===qe.swap?l?e.jsxs(E,{align:"flex-end",gap:"8px",children:[e.jsx($e,{item:s==null?void 0:s[0]}),e.jsxs(L,{justify:"flex-end",children:[e.jsx(Re,{xlinkHref:"#icon-icon_right",svgFill:"text_caption",svgHover:"text_caption"}),e.jsx($e,{item:s==null?void 0:s[1]})]})]}):e.jsxs(L,{justify:"flex-end",gap:"8px",children:[e.jsx($e,{item:s==null?void 0:s[0]}),e.jsx(Re,{xlinkHref:"#icon-icon_right",svgFill:"text_caption",svgHover:"text_caption"}),e.jsx($e,{item:s==null?void 0:s[1]})]}):l?e.jsx(E,{align:"flex-end",gap:"8px 16px",flexDir:a?"column-reverse":"column",children:(m=s==null?void 0:s.filter(o=>!!+o.amount))==null?void 0:m.map(o=>e.jsx($e,{item:o},o==null?void 0:o.address))}):e.jsx(L,{justify:a?"flex-start":"flex-end",gap:"8px 16px",flexDir:a?"row-reverse":"row",children:(d=s==null?void 0:s.filter(o=>!!+o.amount))==null?void 0:d.map(o=>e.jsx($e,{item:o},o==null?void 0:o.address))}):null},$e=({item:s})=>e.jsxs(L,{gap:"4px",children:[e.jsx(ut,{imageUrl:s==null?void 0:s.url,w:"20px",h:"20px"}),e.jsx(_,{color:"text_caption",children:us(s==null?void 0:s.amount)}),e.jsx(_,{children:te(s==null?void 0:s.symbol,10)})]}),ss=(s,t=!1)=>[{title:e.jsx(_,{children:"Event"}),key:"type",render:({type:a})=>e.jsx(di,{type:a}),thConfig:{h:"52px",p:"0 !important"},tdConfig:{p:"0 !important"}},{title:e.jsx(_,{textAlign:"right",children:"Amounts"}),key:"amounts",render:({items:a,type:l})=>e.jsx(xi,{items:a,type:l,isReverse:t}),thConfig:{h:"52px",p:"0 !important"},tdConfig:{p:"0 !important"}},{title:e.jsx(_,{textAlign:"right",children:"Transactions"}),key:"tx",render:({tx:a})=>e.jsx(yr,{address:a,color:"primary",fontSize:"14px",onClickLink:()=>{window.open(s(a,"tx"),"_blank")}}),thConfig:{h:"52px",p:"0 !important"},tdConfig:{p:"0 !important"}},{title:e.jsx(_,{textAlign:"right",children:"Time"}),key:"block_time",render:({block_time:a})=>e.jsx(_,{color:"text_caption",children:br(a)}),thConfig:{h:"52px",p:"0 !important"},tdConfig:{p:"0 !important"}}];function oi(){const{getExplorerUrl:s}=gs(),{isLoading:t,list:a,apiPoolInfo:l,currentPage:m,onCurrentPageChange:d,hasNextPage:o}=li(),{isApp:h}=Le();return e.jsxs(E,{w:"100%",position:"relative",mt:{base:"12px",lg:"24px"},gap:"0px",children:[e.jsx(L,{w:"100%",justify:"space-between",children:e.jsx(_,{fontSize:"24px",color:"text_caption",fontWeight:"500",children:"Transactions"})}),!t&&(a==null?void 0:a.length)==0?e.jsx(Xe,{type:"nodata",mt:"16px",text:"No Recent Transactions"}):h?e.jsx(_r,{columns:ss(s,l==null?void 0:l.isReverse),dataSource:a,loading:t&&m===1,itemSkeletonLength:5,itemHeight:"30px",wrapStyle:{gap:0},rowStyle:(i,x)=>({w:"100%",p:"0px",mt:"20px"}),onRowClick:i=>{window.open(s(i==null?void 0:i.tx,"tx"),"_blank")}}):e.jsx(Cr,{columns:ss(s,l==null?void 0:l.isReverse),dataSource:a,skeletonLength:10,loading:t&&m===1,onRowClick:i=>{window.open(s(i==null?void 0:i.tx,"tx"),"_blank")},rowStyle:{h:"52px",cursor:"pointer"}}),o&&e.jsx(Rt,{mt:{base:"40px",lg:"20px"},children:e.jsx(Ae,{w:"120px",h:"32px",fontSize:"12px",borderRadius:"8px",bg:"button_ghost_bg",color:"primary",borderColor:"border",variant:"outline",onClick:d,children:t?e.jsx(ns,{size:"sm",color:"text_caption"}):"Load More"})})]})}function pi(){const{getBurnPositionAmountByPool:s}=Fr(),{apiPoolInfo:t,contractPoolInfo:a}=de(),[l,m]=j.useState("0"),[d,o]=j.useState("0"),[h,i]=j.useState("0"),[x,y]=j.useState("0"),[c,p]=j.useState(!1),{poolAddress:b}=ke(),{tokenAPrice:w,tokenBPrice:k}=fs(),g=async(A,q)=>{try{p(!0),console.log("ðŸš€ðŸš€ðŸš€ ~ file: burn-position-amount 29 ~ getBurnAmount ~ getBurnAmount:");const{totalA:R,totalB:f}=await s(A,q);m(R),o(f),w&&i(N(R).mul(w==null?void 0:w.price).toString()),k&&y(N(f).mul(k==null?void 0:k.price).toString())}catch(R){console.log("ðŸš€ðŸš€ðŸš€  ~ getBurnAmount ~ error:",R)}finally{p(!1)}};return Pe(()=>{t&&(a!=null&&a.current_sqrt_price)&&g(t,a==null?void 0:a.current_sqrt_price)},[b,a==null?void 0:a.current_sqrt_price,w==null?void 0:w.price,k==null?void 0:k.price],{wait:500}),{burnAmountA:l,burnAmountB:d,burnAmountAUSD:h,burnAmountBUSD:x,loading:c}}function ui(){const{apiPoolInfo:s}=de(),{burnAmountA:t,burnAmountB:a,burnAmountAUSD:l,burnAmountBUSD:m,loading:d}=pi();return N(t).gt(0)||N(a).gt(0)?e.jsxs(Se,{flexDir:{base:"column",lg:"row"},w:"100%",bg:"bg_secondary",borderRadius:"16px",border:"1px solid",borderColor:"border",justify:"space-between",align:"flex-start",p:{base:"16px 8px 8px",lg:"20px 16px 20px 20px"},children:[e.jsxs(L,{children:[e.jsx(_,{fontSize:"16px",color:"text_caption",children:"Burned Liquidity"}),e.jsx(Tr,{tooltipCon:"The following liquidity has been permanently locked in the pool. Please note that LP locking could not eliminate all the risks of a token, especially when the token issuer holds a significant amount of the token."})]}),e.jsxs(Se,{gap:"16px",flexDir:{base:s!=null&&s.isReverse?"column-reverse":"column",lg:s!=null&&s.isReverse?"row-reverse":"row"},w:{base:"100%",lg:"822px",xl:"862px"},children:[e.jsx(rs,{token:s==null?void 0:s.tokenA,amount:t,amountUSD:l,loading:d}),e.jsx(rs,{token:s==null?void 0:s.tokenB,amount:a,amountUSD:m,loading:d})]})]}):null}const rs=({token:s,amount:t,amountUSD:a,loading:l})=>e.jsxs(E,{flex:"1",align:"flex-start",gap:"16px",p:{base:"16px 8px",lg:"16px 20px"},borderRadius:"8px",bg:"background",borderColor:"border",children:[e.jsxs(L,{gap:"12px",children:[e.jsx(ut,{imageUrl:s==null?void 0:s.logo_url,w:"28px",h:"28px"}),e.jsxs(E,{align:"flex-start",gap:"4px",children:[e.jsx(_,{color:"text_caption",fontSize:"16px",children:te(s==null?void 0:s.symbol,10)}),e.jsx(_,{fontSize:"12px",children:s==null?void 0:s.name})]})]}),e.jsx(Ct,{label:"Amount",labelStyle:{fontSize:"14px"},value:us(Yt(t,s==null?void 0:s.decimals)),valueStyle:{fontSize:"14px"},isLoading:l,wrapStyle:{h:"14px"},skeletonStyle:{valueW:"120px"}}),e.jsx(Ct,{label:"Amount (USD)",labelStyle:{fontSize:"14px"},value:N(a).gt("0")?`$${ms(Yt(a,s==null?void 0:s.decimals),2)}`:"--",valueStyle:{fontSize:"14px"},isLoading:l,wrapStyle:{h:"14px"},skeletonStyle:{valueW:"120px"}})]}),ot=s=>s==="--"?"--":`${s}%`;function gi(){var p,b,w,k,g,A;const{apiPoolInfo:s,contractPoolInfo:t}=de(),{getExplorerUrl:a}=gs(),{poolAddress:l}=ke(),{tokenAAmount:m,tokenBAmount:d,tokenAAmountUSD:o,tokenBAmountUSD:h,totalAmountUSD:i,tvlLoading:x}=fs(),{tokenARatio:y,tokenBRatio:c}=pr(o,i);return e.jsxs(E,{w:{base:"100%",lg:"482px"},gap:{base:"20px",lg:"40px"},p:{base:"20px 8px 8px",lg:"20px 16px"},borderRadius:"16px",border:"1px solid",borderColor:"border",bg:"bg_secondary",minW:{base:"100%",lg:"482px"},maxW:{base:"100%",lg:"482px"},children:[e.jsxs(E,{gap:"20px",w:"100%",children:[e.jsx(L,{w:"100%",justify:"space-between",children:e.jsx(Ye,{fontSize:"16px",fontWeight:"400",children:"Pool Info"})}),e.jsxs(ir,{templateColumns:{base:"repeat(1, 1fr)",lg:"repeat(2, 1fr)"},w:"100%",gap:"12px",children:[e.jsx(it,{label:"Address",value:e.jsx(jr,{address:l||"",fontSize:"14px",color:"text_caption",onClickLink:()=>window.open(a(l,"poolAddress")),wrapStyle:{gap:"6px"},iconGap:"6px"})}),e.jsx(it,{label:"Pool ID",value:(t==null?void 0:t.index)!==void 0?`#${t==null?void 0:t.index}`:"--"}),e.jsx(it,{label:"Tick Spacing",value:(t==null?void 0:t.tickSpacing)||""}),e.jsx(it,{label:"Fee Tier",value:`${s==null?void 0:s.feeDisplay}`||"--"})]})]}),e.jsxs(E,{gap:"20px",w:"100%",children:[e.jsx(L,{justify:"flex-start",w:"100%",children:e.jsx(Ye,{fontSize:"16px",fontWeight:"400",children:"Pool Composition"})}),e.jsxs(E,{gap:"16px",w:"100%",children:[e.jsxs(L,{w:"100%",justify:"space-between",children:[e.jsxs(L,{gap:"12px",children:[e.jsx(ut,{imageUrl:(p=s==null?void 0:s.displayTokenA)==null?void 0:p.logo_url,w:"28px",h:"28px",coinType:s!=null&&s.displayTokenA?(b=s==null?void 0:s.displayTokenA)==null?void 0:b.coin_type:""}),e.jsxs(E,{align:"flex-start",gap:"4px",children:[e.jsx(_,{fontSize:"16px",fontWeight:"500",color:"text_caption",children:te((w=s==null?void 0:s.displayTokenA)==null?void 0:w.symbol,10)}),x?e.jsx(Oe,{h:"12px",w:"46px"}):e.jsx(_,{fontSize:"12px",fontWeight:"500",children:s!=null&&s.isReverse?ot(c):ot(y)})]})]}),e.jsx(ee,{w:"200px",children:e.jsx(nr,{value:Number(s!=null&&s.isReverse?c:y),size:"xs",h:"4px",borderRadius:"4px",bg:[y,c].includes("--")?"border":"quote_green",sx:{'div[role="progressbar"]':{bg:[y,c].includes("--")?"background":"primary"}}})}),e.jsxs(L,{gap:"12px",children:[e.jsxs(E,{align:"flex-end",gap:"4px",children:[e.jsx(_,{fontSize:"16px",fontWeight:"500",color:"text_caption",children:te((k=s==null?void 0:s.displayTokenB)==null?void 0:k.symbol,10)}),x?e.jsx(Oe,{h:"12px",w:"46px"}):e.jsx(_,{fontSize:"12px",fontWeight:"500",children:s!=null&&s.isReverse?ot(y):ot(c)})]}),e.jsx(ut,{imageUrl:(g=s==null?void 0:s.displayTokenB)==null?void 0:g.logo_url,w:"28px",h:"28px",coinType:s!=null&&s.displayTokenB?(A=s==null?void 0:s.displayTokenB)==null?void 0:A.coin_type:""})]})]}),e.jsxs(E,{w:"100%",flexDir:s!=null&&s.isReverse?"column-reverse":"column",gap:"16px",children:[e.jsx(Dt,{loading:x,token:s==null?void 0:s.tokenA,amount:m,amountUSD:o}),e.jsx(Dt,{loading:x,token:s==null?void 0:s.tokenB,amount:d,amountUSD:h})]})]})]})]})}function mi(){return e.jsxs(E,{w:"100%",gap:"16px",minW:{base:"100%",lg:"1024px"},children:[e.jsxs(Se,{flexDir:{base:"column",lg:"row"},w:"100%",gap:"16px",children:[e.jsx(Rr,{}),e.jsx(gi,{})]}),e.jsx(ui,{}),e.jsx(oi,{})]})}function hi(s){var u;const{onClose:t,onSubmit:a,data:{feeTier:l,zapData:m}}=s,{fromToken:d,toToken:o,fromAmount:h,toAmount:i,totalAmount:x,percentMap:y,fromTokenLock:c,toTokenLock:p}=ze();console.log("ðŸš€ðŸš€ðŸš€ ~ AddLiquidityConfirmModal.tsx:57 ~ AddLiquidityConfirmModal ~ fromTokenLock:",c,p);const{lowerTickData:b,upperTickData:w}=Fe(),{currentPriceData:k,apiPoolInfo:g}=de();console.log("ðŸš€ðŸš€ðŸš€ ~ AddLiquidityConfirmModal.tsx:58 ~ AddLiquidityConfirmModal ~ lowerTickData:",b),console.log("ðŸš€ðŸš€ðŸš€ ~ AddLiquidityConfirmModal.tsx:59 ~ AddLiquidityConfirmModal ~ upperTickData:",w),console.log("ðŸš€ðŸš€ðŸš€ ~ AddLiquidityConfirmModal.tsx:61 ~ AddLiquidityConfirmModal ~ currentPriceData:",k);const[A,q]=j.useState(!0),R=j.useMemo(()=>{var r;return((r=g==null?void 0:g.tokenA)==null?void 0:r.coin_type)===(d==null?void 0:d.coin_type)?!A:!!A},[g,d,o,A]),f=j.useMemo(()=>A?`${te(o==null?void 0:o.symbol,10)} per ${te(d==null?void 0:d.symbol,10)}`:`${te(d==null?void 0:d.symbol,10)} per ${te(o==null?void 0:o.symbol)}`,[A,d==null?void 0:d.symbol,o==null?void 0:o.symbol]),M=Cs(()=>{a(),t()},1e3,{leading:!0,trailing:!1});return e.jsxs(cs,{isOpen:!0,onClose:()=>{t()},isCentered:!0,children:[e.jsx(as,{}),e.jsxs(ls,{children:[e.jsx(ds,{children:e.jsx(Ye,{fontWeight:"500",fontSize:"16px",children:"Add Liquidity"})}),e.jsx(cr,{}),e.jsx(xs,{textAlign:"center",p:"0px",children:e.jsxs(E,{w:"100%",gap:"20px",p:"8px 16px",pb:"0px",children:[e.jsxs(L,{w:"100%",justifyContent:"space-between",h:"40px",children:[e.jsxs(L,{children:[e.jsx(hs,{coinACoinType:d==null?void 0:d.coin_type,coinBCoinType:o==null?void 0:o.coin_type,coinAIconUrl:d==null?void 0:d.logo_url,coinBIconUrl:o==null?void 0:o.logo_url,imageStyle:{w:"40px",h:"40px"},imgBoxStyle:{w:"40px",h:"40px"}}),e.jsx(_,{fontSize:"16px",color:"text_caption",textAlign:"left",children:`${te(d==null?void 0:d.symbol,10)} - ${te(o==null?void 0:o.symbol,10)}`})]}),e.jsx(Mr,{poolType:"clmm",displayFee:l==null?void 0:l.feeDisplay})]}),m?e.jsx(Pt,{coinA:{amount:m==null?void 0:m.amount,...m==null?void 0:m.token}}):e.jsx(Pt,{coinA:{amount:h,...d},coinB:{amount:i,...o}}),e.jsxs(ee,{w:"100%",children:[e.jsxs(L,{w:"100%",justify:"space-between",h:"32px",children:[e.jsx(_,{fontSize:"16px",fontWeight:"500",color:"text_caption",children:"Selected Range"}),e.jsx(Br,{isActive:!c&&!p,isRow:!0,imgStyle:{imgW:"29px",imgH:"16px"},w:"105px",h:"32px"})]}),e.jsxs(E,{gap:"0",border:"1px solid",bg:"bg_secondary",borderColor:"border",borderRadius:"12px",mt:"8px",children:[e.jsxs(L,{justify:"center",h:"48px",w:"100%",gap:"4px",children:[e.jsx(_,{children:"Current Price"}),e.jsx(_,{as:"span",color:"text_caption",maxW:"200px",wordBreak:"break-all",children:Ce(R?k.reverseCurrentPrice:k==null?void 0:k.currentPrice,6)}),e.jsx(_,{children:f}),e.jsx(Ae,{variant:"unstyled",onClick:()=>q(!A),children:e.jsx(Re,{xlinkHref:"#icon-icon_swap1"})})]}),e.jsx(ee,{h:"1px",w:"calc(100% - 32px)",p:"0 12px",bg:"border"}),e.jsxs(L,{w:"100%",h:"100px",children:[e.jsx(is,{title:"Min Price",price:Ce(R?w==null?void 0:w.reversePrice:b==null?void 0:b.price,6),perText:f}),e.jsx(Lt,{orientation:"vertical",h:"40px"}),e.jsx(is,{title:"Max Price",price:Ce(R?b==null?void 0:b.reversePrice:w==null?void 0:w.price,6),perText:f})]})]})]}),m?e.jsx(Mt,{action:"Deposit",inConfirmModal:!0}):e.jsxs(e.Fragment,{children:[e.jsx(Ft,{tokenA:d,tokenB:o,isReverse:(d==null?void 0:d.coin_type)!==((u=g==null?void 0:g.tokenA)==null?void 0:u.coin_type),type:"text",percentMap:y}),e.jsx(Tt,{loading:!1,totalAmount:x})]}),e.jsx(Ae,{w:"calc(100% + 32px)",bottom:"0px",mt:"4px",h:"52px",borderRadius:"12px",fontSize:"16px",fontWeight:"500",onClick:M,children:"Add Liquidity"})]})})]})]})}const is=({title:s,price:t,perText:a})=>e.jsxs(E,{flex:"1",children:[e.jsx(_,{children:s}),e.jsx(_,{color:"text_caption",wordBreak:"break-all",children:t}),e.jsx(_,{children:a})]});function yi(s,t){const{preAdd:a,getClmmCreateAddData:l,getFarmsCreateAddData:m}=Nr(),[d,o]=j.useState(!1),{currentPriceData:h,apiPoolInfo:i,contractPoolInfo:x}=de(),{getContractPoolInfo:y}=Ss(),{lowerTickData:c,upperTickData:p}=Fe(),{signAndExecuteTransaction:b,getTransactionStatus:w,transactionSuccess:k}=qr(),{mevProtect:g,maxCapForGas:A,transactionMode:q,customGasPrice:R,slippage:f,zapSlippage:M}=ys(),{transactionConfirmation:u}=$r(),{getCurrentPrice:r}=As(),{fromAmount:n,setFromAmount:S,fromAmountValue:B,setFromAmountValue:F,toAmount:J,setToAmount:ae,toAmountValue:V,setToAmountValue:T,byAmountIn:z,setByAmountIn:H,isTokenA:D,setIsTokenA:G,percentMap:se,setPercentMap:ue,isFullRange:Q,setIsFullRange:X,fromToken:v,setFromToken:me,toToken:C,setToToken:Z,totalAmount:re,setTotalAmount:he,fromTokenLock:O,setFromTokenLock:ie,toTokenLock:xe,setToTokenLock:je,setTokenMaxA:Te,setTokenMaxB:oe,tokenMaxA:ne,tokenMaxB:He,autoStakePosition:_e,liquidityAmount:P,setLiquidityAmount:U,useZapIn:I,setUseZapIn:Ve,confirmModalOpen:Me,setConfirmModalOpen:Ge,nftOpen:Ns,setNftOpen:Bt,relatedPosId:Os,setRelatedPosId:Et}=ze(),{currentAccount:ge,onWalletModal:Vs}=ft(),{getTokenAmountValue:et}=fr(),{getZapDepositTx:Gs,getZapDepositToastInfo:Zs,reCalculateZapData:Ds}=Er(),{setZapAmount:Ks}=ks(),{getPositionBaseList:qt}=Rs();j.useEffect(()=>{ge!=null&&ge.address&&qt(ge==null?void 0:ge.address)},[ge==null?void 0:ge.address]),_t(()=>{var $,ce;i&&G((($=i==null?void 0:i.displayTokenA)==null?void 0:$.coin_type)===((ce=i==null?void 0:i.tokenA)==null?void 0:ce.coin_type))},[i]);const{isWhiteQuoteToken:Qs}=Fs(),{notifiSubscription:Xs}=Ur(),{isChecked:zt}=Sr();Pe(()=>{if(Q){ue({percentA:"50",percentB:"50"});return}if(i&&(i!=null&&i.tokenA)&&(i!=null&&i.tokenB)&&typeof(x==null?void 0:x.current_tick_index)=="number"&&(c==null?void 0:c.tick)!==void 0&&(p==null?void 0:p.tick)!==void 0&&h.currentSqrtPrice){if(be(c.tick).lte(x.current_tick_index)&&be(p.tick).gt(x.current_tick_index)){const $=Qs(i.tokenA.coin_type)?i.tokenA:i.tokenB,ce=$.coin_type===i.tokenA.coin_type,fe=a({amount:nt("1",$.decimals).toString(),tokenA:i==null?void 0:i.tokenA,tokenB:i==null?void 0:i.tokenB,isTokenA:ce,lowerTick:c==null?void 0:c.tick,upperTick:p==null?void 0:p.tick,curSqrtPrice:h.currentSqrtPrice,isReverse:i==null?void 0:i.isReverse,roundUp:!0}),Be=Wr(fe.coinAmountA,fe.coinAmountB,h==null?void 0:h.currentPrice,Q);ue(Be);return}if(be(c.tick).gt(x.current_tick_index)){ue({percentA:"100",percentB:"0"});return}if(be(p.tick).lte(x.current_tick_index)){ue({percentA:"0",percentB:"100"});return}}},[JSON.stringify(i),h,c==null?void 0:c.tick,p==null?void 0:p.tick,Q],{wait:300});const Ys=({amount:$,isTokenA:ce,isFullRange:fe})=>{var Be,Ze,De,ve;if(i&&(i!=null&&i.tokenA)&&(i!=null&&i.tokenB)&&Object.keys(h).length>0&&(c==null?void 0:c.tick)!==void 0&&(p==null?void 0:p.tick)!==void 0&&v&&C){let W;if(typeof(x==null?void 0:x.current_tick_index)=="number"&&be(c==null?void 0:c.tick).lte(x==null?void 0:x.current_tick_index)&&be(p==null?void 0:p.tick).gt(x==null?void 0:x.current_tick_index))W=a({amount:nt($&&+$?$+"":"1",z?v==null?void 0:v.decimals:C==null?void 0:C.decimals).toString(),tokenA:i==null?void 0:i.tokenA,tokenB:i==null?void 0:i.tokenB,isTokenA:ce,lowerTick:c==null?void 0:c.tick,upperTick:p==null?void 0:p.tick,curSqrtPrice:h.currentSqrtPrice,isReverse:i==null?void 0:i.isReverse,roundUp:!0});else if(O&&!xe){const K=(C==null?void 0:C.coin_type)===((Be=i==null?void 0:i.tokenA)==null?void 0:Be.coin_type);W=a({amount:nt($?$+"":"1",C==null?void 0:C.decimals).toString(),tokenA:i==null?void 0:i.tokenA,tokenB:i==null?void 0:i.tokenB,isTokenA:K,lowerTick:c==null?void 0:c.tick,upperTick:p==null?void 0:p.tick,curSqrtPrice:h.currentSqrtPrice,isReverse:i==null?void 0:i.isReverse,roundUp:!0})}else if(xe&&!O){const K=(v==null?void 0:v.coin_type)===((Ze=i==null?void 0:i.tokenA)==null?void 0:Ze.coin_type);W=a({amount:nt($?$+"":"1",v==null?void 0:v.decimals).toString(),tokenA:i==null?void 0:i.tokenA,tokenB:i==null?void 0:i.tokenB,isTokenA:K,lowerTick:c==null?void 0:c.tick,upperTick:p==null?void 0:p.tick,curSqrtPrice:h.currentSqrtPrice,isReverse:i==null?void 0:i.isReverse,roundUp:!0})}else O&&xe&&(W=ce?{coinAmountA:$?$+"":"1",coinAmountB:"",tokenMaxA:$?$+"":"1",tokenMaxB:""}:{coinAmountA:"",coinAmountB:$?$+"":"1",tokenMaxA:"",tokenMaxB:$?$+"":"1"});if(Te(W==null?void 0:W.tokenMaxA),oe(W==null?void 0:W.tokenMaxB),$)if(be($).gt("0"))if(z){const K=(C==null?void 0:C.coin_type)===((De=i==null?void 0:i.tokenA)==null?void 0:De.coin_type)?W==null?void 0:W.coinAmountA:W==null?void 0:W.coinAmountB,pe=et(v==null?void 0:v.coin_type,$+""),ye=et(C==null?void 0:C.coin_type,K),we=be(pe).plus(ye).toString();console.log(K,pe,ye,we,"_totalAmountValue"),ae(K||""),F(pe),T(ye),he(we)}else{const K=(v==null?void 0:v.coin_type)===((ve=i==null?void 0:i.tokenA)==null?void 0:ve.coin_type)?W==null?void 0:W.coinAmountA:W==null?void 0:W.coinAmountB,pe=et(v==null?void 0:v.coin_type,K),ye=et(C==null?void 0:C.coin_type,$+""),we=be(pe).plus(ye).toString();console.log(K,pe,ye,we,"_totalAmountValue"),F(pe),T(ye),S(K||""),he(we)}else z?(ae(""),F(""),T(""),he("")):(S(""),F(""),T(""),he(""));else S(""),ae(""),F(""),T(""),he("");W&&U((W==null?void 0:W.liquidityAmount)||"")}};Pe(()=>{Ys({amount:z?n:J,isTokenA:D,isFullRange:Q})},[JSON.stringify(i),h,c==null?void 0:c.tick,p==null?void 0:p.tick,n,J,z,D,O,xe,Q],{wait:300});const Js=($,ce,fe)=>{H(ce),ce?S($):ae($),G(fe!==void 0?fe:!1)},{balanceInfo:Ps}=yt(v),{balanceInfo:Is}=yt(C);_t(()=>{var $,ce;G(z?(v==null?void 0:v.coin_type)===(($=i==null?void 0:i.tokenA)==null?void 0:$.coin_type):(C==null?void 0:C.coin_type)===((ce=i==null?void 0:i.tokenA)==null?void 0:ce.coin_type))},[i,z,v,C]),j.useEffect(()=>{(c==null?void 0:c.tick)===gt.getMinIndex(Number((c==null?void 0:c.tickSpacing)||0))&&(p==null?void 0:p.tick)===gt.getMaxIndex(Number((p==null?void 0:p.tickSpacing)||0))?X(!0):X(!1)},[c==null?void 0:c.tick,p==null?void 0:p.tick]),j.useEffect(()=>{(x==null?void 0:x.current_tick_index)!==void 0&&le(c)&&le(p)&&(be(c==null?void 0:c.tick).gte(be(p.tick))?(ie(!0),je(!0)):be(c==null?void 0:c.tick).gt(x==null?void 0:x.current_tick_index)?(ie(!t),je(!!t)):be(p.tick).lte(x==null?void 0:x.current_tick_index)?(ie(!!t),je(!t)):(ie(!1),je(!1)))},[c==null?void 0:c.tick,p==null?void 0:p.tick,x,t]);const er=Cs(()=>{ge?Ge(!0):Vs(!0)},300,{leading:!0,trailing:!1}),Ht=()=>{S(""),ae(""),F(""),T(""),he("")},{fetchAccountBalance:tr}=Ls(),sr=async()=>{var Be,Ze,De;let $=null,ce,fe;try{let ve,W,K;if(I)W=Zs(),u(W),ve=await Gs(c==null?void 0:c.tick,p==null?void 0:p.tick,_e);else{const ye=z?n:J,we=z?v.decimals:C.decimals,We=be(ye).mul(Ar.pow(10,we)).toString(),At=z&&(v==null?void 0:v.coin_type)===((Be=i==null?void 0:i.tokenA)==null?void 0:Be.coin_type)?!0:(C==null?void 0:C.coin_type)===((Ze=i==null?void 0:i.tokenA)==null?void 0:Ze.coin_type)&&!z,tt=c.tick,st=p.tick,Ke=x==null?void 0:x.current_tick_index;tt!==void 0&&st!==void 0&&Ke!==void 0&&(Ke>=tt&&Ke<=st?(ce=At?We:ne,fe=At?He:We):Ke>st?(ce=0,fe=We):Ke<tt&&(ce=We,fe=0));let Wt=[];if(x!=null&&x.index){const{rewarder_infos:Y}=x;Wt=(Y==null?void 0:Y.length)>0&&(Y==null?void 0:Y.map(Qe=>Qe.coinAddress))||[]}const $t={poolAddress:x==null?void 0:x.poolAddress,coinTypeA:x==null?void 0:x.coinTypeA,coinTypeB:x==null?void 0:x.coinTypeB,amountA:ce,amountB:fe,fixAmountA:At,lowerTick:tt,upperTick:st,currentSqrtPrice:x==null?void 0:x.current_sqrt_price,rewarderCoinTypes:Wt,farmsPoolId:i==null?void 0:i.farmsPoolAddress};if(W={getShowInfo:(Y,Qe)=>{const Ut="Add "+[dt(n,v==null?void 0:v.symbol),dt(J,C==null?void 0:C.symbol)].filter(Boolean).join(" and "),rt={modalDescriptionText:Ut,toastTitleText:Ut};if(Y==="success"){let Nt=n,Ot=J;Qe&&(Nt=Jt(Qe,v)||n,Ot=Jt(Qe,C)||J);const Vt="Add "+[dt(Nt,v==null?void 0:v.symbol),dt(Ot,C==null?void 0:C.symbol)].filter(Boolean).join(" and ");rt.toastDescriptionContent=Vt,rt.modalDescriptionText=Vt,rt.toastTitleText="Supplied Successful"}return rt}},u(W),_e){const Y=await m($t);ve=Y==null?void 0:Y.tx,K=Y==null?void 0:Y.msafeParams}else{const Y=await l($t);ve=Y==null?void 0:Y.tx,K=Y==null?void 0:Y.msafeParams}}$={pool:x==null?void 0:x.poolAddress,lower:c==null?void 0:c.tick,upper:p==null?void 0:p.tick,coinTypeA:x==null?void 0:x.coinTypeA,coinTypeB:x==null?void 0:x.coinTypeB,amountA:ce,amountB:fe,currentSqrtPrice:x==null?void 0:x.current_sqrt_price,slippage:f,zapSlippage:M,autoStack:_e,txAction:I?"addLiquidity-zap":"addLiquidity"};let pe=await b(ve,W,{useDevInspect:!0,useMev:g,showSuccessModal:!1,useFastMode:q==="Fast Mode",maxCapForGas:A,customGasPrice:R,msafeParams:K,trackData:$});if(pe){console.log("ðŸš€ðŸš€ðŸš€ ~ file: useAddLiquidity.ts:403 ~ handleSubmit ~ res:",pe),console.log("ðŸš€ðŸš€ðŸš€ ~ file: useAddLiquidity.ts:411 ~ handleSubmit ~ isChecked:",zt),((De=pe==null?void 0:pe.events)==null?void 0:De.length)===0&&(pe=await w(pe.digest));const{posId:ye,farmsPosId:we}=vr(pe);if(console.log("ðŸš€ ~ file: useAddLiquidity.ts:436 ~ handleSubmit ~ posId:",{posId:ye,farmsPosId:we}),ye?(Bt(!0),Et(we||ye)):k(W),zt){const We={subscriptionSource:"AddLiquidity",events:pe.events};Xs(We)}tr(),Ht(),Ks(""),s(),ge!=null&&ge.address&&setTimeout(()=>{qt(ge==null?void 0:ge.address)},2e3)}else x&&y(x==null?void 0:x.poolAddress).then(ye=>{Ds()})}catch(ve){console.error(ve,"handleSubmit ~ error");const W=String(ve).toLocaleLowerCase();if(W.includes("user")&&W.includes("reject")&&i!=null&&i.poolAddress){const K=await y(i==null?void 0:i.poolAddress);K&&r(K==null?void 0:K.current_sqrt_price,i,K==null?void 0:K.current_tick_index)}throw ve}},rr=()=>{Ve(!I)};return j.useEffect(()=>{Ht()},[I]),{percentMap:se,handleAmountChange:Js,fromToken:v,setFromToken:me,toToken:C,setToToken:Z,byAmountIn:z,setByAmountIn:H,fromAmount:n,fromAmountValue:B,setFromAmount:S,toAmount:J,toAmountValue:V,setToAmount:ae,liquidityAmount:P,fromBalanceInfo:Ps,toBalanceInfo:Is,totalAmount:re,fromTokenLock:O,toTokenLock:xe,handleAdd:er,confirmModalOpen:Me,setConfirmModalOpen:Ge,nftOpen:Ns,setNftOpen:Bt,relatedPosId:Os,handleSubmit:sr,useZapIn:I,handleChangeZapIn:rr}}function bi(){const{fromAmount:s,toAmount:t,fromToken:a,toToken:l,fromTokenLock:m,toTokenLock:d,liquidityAmount:o}=ze(),{currentAccount:h}=ft(),{balanceInfo:i}=yt(a),{balanceInfo:x}=yt(l),y=j.useMemo(()=>{const c={text:"Add Liquidity",disabled:!1};return h!=null&&h.address?!m&&!d&&(!s||!t||s&&!+s||t&&!+t)||m&&!d&&(!t||t&&!+t)||d&&!m&&(!s||s&&!+s)?(c.text="Enter an amount",c.disabled=!0,c):s&&+s&&N(s).gt((i==null?void 0:i.balanceFormat)||0)?(c.disabled=!0,c.text=`Insufficient ${te(a==null?void 0:a.symbol,10)} Balance`,c):t&&+t&&N(t).gt((x==null?void 0:x.balanceFormat)||0)?(c.disabled=!0,c.text=`Insufficient ${te(l==null?void 0:l.symbol,10)} Balance`,c):((!m&&!d&&(!s||!t)||N(o).lte("0"))&&(c.disabled=!0),c):(c.text="Connect Wallet",c.disabled=!1,c)},[h==null?void 0:h.address,s,t,i==null?void 0:i.balanceDisplay,x==null?void 0:x.balanceDisplay,a,l,m,d,o]);return{btnText:y.text,btnDisabled:y.disabled}}function ji(){return{getLeverage:(t,a)=>t&&a&&t!=="0"&&a!=="âˆž"?ms(1/(1-Number(N(t).div(a).toNumber()**.25)),2)+"x":"1x"}}function fi({rangeTabList:s}){var z;const{apiPoolInfo:t}=de(),{fromToken:a,toToken:l,setFromToken:m,setToToken:d,byAmountIn:o,setByAmountIn:h,setIsFarmRewardsRange:i,setAutoStakePosition:x,fromTokenLock:y,toTokenLock:c,fromAmount:p,toAmount:b,setFromAmount:w,setToAmount:k}=ze(),{lowerTickData:g,upperTickData:A}=Fe(),[q,R]=j.useState(),[f,M]=j.useState("distribution"),{handleInitTickData:u}=St(),{getLeverage:r}=ji(),n=[{key:"distribution",beforeIcon:{xlinkHref:"#icon-liquiditydistribution",svgW:"16px",svgH:"16px",svgHover:"primary",activeColor:"primary",activeHoverColor:"primary"},tooltip:"Liquidity Distribution"},{key:"prices",beforeIcon:{xlinkHref:"#icon-poolhistoricprices",svgW:"16px",svgH:"16px",svgHover:"primary",activeColor:"primary",activeHoverColor:"primary"},tooltip:"Historical Pool Prices"}],S=H=>{M(H==null?void 0:H.key)};j.useEffect(()=>{var H;if(t){const D=(H=t==null?void 0:t.displayTokenA)==null?void 0:H.coin_type;R(D)}},[t==null?void 0:t.poolAddress]);const B=j.useMemo(()=>{var H;return q===((H=t==null?void 0:t.tokenA)==null?void 0:H.coin_type)},[q,(z=t==null?void 0:t.tokenA)==null?void 0:z.coin_type]),F=j.useMemo(()=>{var H,D,G,se;return!(t!=null&&t.tokenA)||!(t!=null&&t.tokenB)?"":B?`${te((H=t==null?void 0:t.tokenB)==null?void 0:H.symbol,10)} per ${te((D=t==null?void 0:t.tokenA)==null?void 0:D.symbol,10)}`:`${te((G=t==null?void 0:t.tokenA)==null?void 0:G.symbol,10)} per ${te((se=t==null?void 0:t.tokenB)==null?void 0:se.symbol,10)}`},[B,t==null?void 0:t.tokenA,t==null?void 0:t.tokenB]),J=j.useMemo(()=>{const H=g==null?void 0:g.price,D=A==null?void 0:A.price;return r(H,D)},[g==null?void 0:g.price,A==null?void 0:A.price]),ae=H=>{i(H.target.checked),H.target.checked&&(t!=null&&t.farmsEffectiveTickLower)&&(t!=null&&t.farmsEffectiveTickUpper)&&u(t==null?void 0:t.farmsEffectiveTickLower,t==null?void 0:t.farmsEffectiveTickUpper,t)};j.useEffect(()=>{N(g==null?void 0:g.tick).eq(N(t==null?void 0:t.farmsEffectiveTickLower))&&N(A==null?void 0:A.tick).eq(N(t==null?void 0:t.farmsEffectiveTickUpper))?i(!0):i(!1)},[g==null?void 0:g.tick,A==null?void 0:A.tick,t==null?void 0:t.farmsEffectiveTickLower,t==null?void 0:t.farmsEffectiveTickUpper]);const V=j.useMemo(()=>(g==null?void 0:g.price)==="0"&&(A==null?void 0:A.price)==="âˆž",[g==null?void 0:g.price,A==null?void 0:A.price]),T=H=>{var D;H&&(H!=null&&H.coin_type)?R(H==null?void 0:H.coin_type):R((D=s==null?void 0:s.find(G=>G.key!==q))==null?void 0:D.key),m(l),d(a),h(!o),o?(k(p),w("")):(w(b),k(""))};return j.useEffect(()=>{t!=null&&t.haveFarming&&x(!(y||c))},[y,c,t==null?void 0:t.haveFarming]),j.useEffect(()=>{o&&y&&!c&&(w(""),k("")),!o&&!y&&c&&(w(""),k("")),o&&!y&&c&&k(""),!o&&y&&!c&&w(""),y&&c&&(w(""),k(""))},[y,c]),{direct:B,perText:F,handleChangeIsFarmRewardsRange:ae,onReverseClick:T,leverage:J,currentRangeTab:q,isFullRange:V,handleChangeLiquidityChartTab:S,liquidityChartTab:f,liquidityChartTabList:n}}function Si({onClose:s,posId:t,tokenA:a,tokenB:l,fee:m,isReverse:d}){const o=jt(),[h,i]=j.useState(!0),{lowerTickData:x,upperTickData:y}=Fe();return j.useLayoutEffect(()=>{d&&i(!1)},[d]),e.jsxs(cs,{isOpen:!0,autoFocus:!1,returnFocusOnClose:!1,onClose:s,isCentered:!0,children:[e.jsx(as,{}),e.jsxs(ls,{w:"400px",children:[e.jsx(ds,{children:e.jsxs(L,{justify:"space-between",w:"100%",children:[e.jsx(_,{fontSize:"16px",fontWeight:"500",color:"text_caption",children:"Open position successful"}),e.jsx(Ae,{onClick:s,variant:"unstyled",p:"0",minW:"unset",minH:"unset",w:"20px",h:"20px",children:e.jsx(Re,{xlinkHref:"#icon-icon_close"})})]})}),e.jsx(xs,{children:e.jsxs(E,{gap:"36px",children:[e.jsxs(E,{gap:"16px",bg:"center / contain no-repeat url('/images/active-sui.gif') ",w:"240px",h:"240px",justify:"center",border:"1px solid",borderColor:"border",borderRadius:"16px",children:[e.jsx(hs,{coinAIconUrl:a==null?void 0:a.logo_url,coinBIconUrl:l==null?void 0:l.logo_url,coinACoinType:a==null?void 0:a.coin_type,coinBCoinType:l==null?void 0:l.coin_type,w:"48px",h:"48px"}),e.jsxs(_,{fontSize:"20px",fontWeight:"500",color:"text_caption",lineHeight:"28px",children:[te(a==null?void 0:a.symbol,10)," - ",te(l==null?void 0:l.symbol,10)]}),e.jsxs(L,{bg:"bg_secondary",p:"8px 12px",border:"1px solid",borderColor:"border",borderRadius:"12px",children:[e.jsx(_,{fontSize:"14px",children:"Fee tier"}),e.jsx(_,{fontSize:"14px",color:"text_highlight",children:m})]})]}),e.jsxs(E,{w:"100%",justify:"center",borderRadius:"8px",border:"1px solid",borderColor:"border",bg:"input_bg",p:"16px 8px",children:[e.jsxs(_,{color:"text_caption",whiteSpace:"nowrap",children:[h?Ee(x==null?void 0:x.price,6):Ee(y==null?void 0:y.reversePrice,6)," -Â ",h?Ee(y==null?void 0:y.price,6):Ee(x==null?void 0:x.reversePrice,6)]}),e.jsxs(L,{children:[e.jsxs(L,{gap:"0",children:[e.jsx(_,{color:"primary_gray",children:te(h?d?a==null?void 0:a.symbol:l==null?void 0:l.symbol:d?l==null?void 0:l.symbol:a==null?void 0:a.symbol,10)}),e.jsx(_,{color:"primary_gray",children:"Â perÂ "}),e.jsx(_,{color:"primary_gray",children:te(h?d?l==null?void 0:l.symbol:a==null?void 0:a.symbol:d?a==null?void 0:a.symbol:l==null?void 0:l.symbol,10)})]}),e.jsx(Re,{xlinkHref:"#icon-icon_swap1",w:"16px",h:"16px",onClick:c=>{bs(c),i(!h)}})]})]})]})}),e.jsx(ar,{p:"20px 0 0",children:e.jsx(Ae,{flex:"1",onClick:()=>o(`/position-detail/${t}`),h:"52px",borderRadius:"12px",fontSize:"16px",fontWeight:"500",children:"View Detail"})})]})]})}function Es({perText:s,direct:t,minPriceData:a,maxPriceData:l,isFullRange:m=!1}){const{tickDataLoading:d}=Fe(),{handleAddPrice:o,handleSubPrice:h,setTickDataBasedOnPrice:i}=St();return e.jsxs(Se,{flexDir:{base:"column",lg:"row"},w:"100%",gap:{base:"8px",lg:"16px"},children:[e.jsx(es,{title:"Min Price",perText:s,data:a,direct:t,loading:d,handleAddPrice:o,handleSubPrice:h,setTickDataBasedOnPrice:i,isFullRange:m}),e.jsx(es,{title:"Max Price",perText:s,data:l,direct:t,loading:d,handleAddPrice:o,handleSubPrice:h,setTickDataBasedOnPrice:i,isFullRange:m})]})}const qs=({minPrice:s,maxPrice:t,perText:a,checked:l,onChange:m,loading:d})=>e.jsxs(L,{w:"100%",justify:{base:"space-between",lg:"center"},align:{base:"flex-start",lg:"center"},p:{base:"0px",lg:"0"},children:[e.jsxs(Se,{flexDir:{base:"column",lg:"row"},children:[e.jsxs(L,{children:[e.jsx(or,{tooltip:e.jsxs(ee,{as:"div",lineHeight:"20px",fontSize:"12px",children:["Farm reward range: Only liquidity within this range is eligible to receive farming rewards of the pool. Â ",e.jsx(ee,{as:"a",color:"primary",onClick:o=>{bs(o),window.open("https://medium.com/@CetusProtocol/cetus-new-farms-everything-you-should-know-about-it-c6b60e6a6ae5")},children:"Learn More"})]})}),e.jsx(_,{children:"Farm rewards range"})]}),e.jsxs(L,{children:[d?e.jsx(Oe,{w:"120px",h:"14px"}):e.jsxs(_,{color:"primary_yellow",children:[s,"Â -Â ",t]}),e.jsx(_,{children:a})]})]}),e.jsx(kt,{isChecked:l,onChange:m})]}),zs=({disabled:s,checked:t,onChange:a})=>e.jsxs(L,{p:{base:"12px 8px",lg:"16px"},borderRadius:{base:"12px",lg:"12px"},bg:"card_bg",gap:"12px",width:"100%",justify:"space-between",children:[e.jsx(_,{lineHeight:"20px",color:"text_highlight",fontSize:"12px",children:"Automatically stake your position into the farm to enjoy higher yield."}),s?e.jsx(pt,{tooltip:e.jsxs(E,{gap:"4px",align:"flex-start",children:[e.jsx(_,{fontSize:"12px",children:"Farming rewards only available"}),e.jsx(_,{fontSize:"12px",children:"for active positions."})]}),placement:"top",maxW:"198px",children:e.jsx(kt,{isChecked:t,isDisabled:s,maxW:"24px",onChange:a})}):e.jsx(kt,{isChecked:t,isDisabled:s,maxW:"24px",onChange:a})]});function Hs({direct:s,tab:t,wrapStyle:a={},setTab:l,liquidityChartTab:m}){const{priceRangeMap:d}=Ie(),{minPriceForDate:o,maxPriceForDate:h,setMinPriceForDate:i,setMaxPriceForDate:x}=de();return j.useEffect(()=>{var p,b;let y="",c="";if(le(d)){const w=(p=d[t==null?void 0:t.key])==null?void 0:p[0],k=s?w:N(1).div(w).toString(),g=(b=d[t==null?void 0:t.key])==null?void 0:b[1],A=s?g:N(1).div(g).toString();y=Ee(k,6),c=Ee(A,6)}else y="-",c="-";i(y),x(c)},[s,t.key,d]),Le(),e.jsx(L,{w:"100%",justify:"center",...a,children:e.jsxs(Se,{flexDir:"column",align:{base:"center",lg:"flex-start"},gap:{base:"8px",lg:"4px"},children:[e.jsxs(L,{children:[m!=="prices"&&e.jsx(Rt,{borderRadius:"4px",border:"1px solid",borderColor:"border",w:"20px",h:"20px",color:"text_caption",children:e.jsx(Lt,{w:"14px",border:"1px dashed"})}),e.jsxs(_,{fontSize:{base:"12px",lg:"14px"},whiteSpace:"nowrap",h:"20px",lineHeight:"20px",children:[t==null?void 0:t.type,"Â Price Range"]})]}),e.jsxs(_,{color:"text_caption",fontSize:{base:"12px",lg:"14px"},lineHeight:{base:"12px",lg:"14px"},h:{base:"12px",lg:"14px"},whiteSpace:"nowrap",children:[s?o==="-"?o:ct(at(o)):h==="-"?h:ct(at(h)),"Â -Â ",s?h==="-"?h:ct(at(h)):o==="-"?o:ct(at(o))]})]})})}function Ai(){const[s,t]=j.useState(""),a=(o,h)=>({default:{lower:o,upper:h,sort:3}}),l=o=>({"full range":{lower:gt.getMinIndex(o),upper:gt.getMaxIndex(o),sort:2}}),m=(o,h,i)=>{const x=N(i).mul(h==="unstable"?2:3).toNumber(),y=wr(Number(o),Number(i));return{custom:{lower:N(y).sub(x).toNumber(),upper:N(y).add(x).toNumber(),sort:1}}};return{getRecommendRangesList:async o=>{try{const h=o.farmsEffectTickLower&&o.farmsEffectTickUpper?a(o.farmsEffectTickLower,o.farmsEffectTickUpper):null,i=o.farmsEffectTickLower&&o.farmsEffectTickUpper?{ranges:{},type:""}:o==null?void 0:o.recommendRangesInfo;if(console.log(i,"recommendRangesResult"),i){t(i.type);const x=l(o.tickSpacing),y=m(o.currentTick,i.type,o.tickSpacing),c={...h,...i.ranges,...x,...y},p=Object.entries(c).map(([b,w])=>({key:b,...w})).sort((b,w)=>w.sort-b.sort);return le(i.ranges)||le(h)?{rangeList:p,error:!1}:{rangeList:p,error:!0}}else return{rangeList:[],error:!0}}catch(h){return console.error("Error in getRecommendRangesList:",h),{rangeList:[],error:!0}}},poolType:s}}const wt=(s,t=!1)=>{switch(s){case"passive":return{name:"Conservative",image:t?"img_conservative_sel@2x.png":"img_conservative_nor@2x.png"};case"active":return{name:"Active",image:t?"img_active_sel@2x.png":"img_active_nor@2x.png"};case"full range":return{name:"Full Range",image:t?"img_fullrange_sel@2x.png":"img_fullrange_nor@2x.png"};case"custom":return{name:"Custom",image:t?"img_custom_sel@2x.png":"img_custom_nor@2x.png"};case"suggested":return{name:"Stable",image:t?"img_stable_sel@2x.png":"img_stable_nor@2x.png"};default:return{name:"Default",image:t?"img_stable_sel@2x.png":"img_stable_nor@2x.png"}}},vi=s=>{switch(s){case"passive":return"Lower yields and lower impermanent loss. Less frequent rebalancing.";case"active":return"Higher yields but higher impermanent loss potentially. Requires frequent rebalancing.";case"full range":return"Full range positions are active all the time with no need to be rebalanced but may earn less fees than concentrated liquidity.";case"custom":return"Recommended only if you understand how concentrated liquidity works.";case"suggested":return"Stable range according to the price history of last 7 days.";default:return"The default range of this pool is set following the real-time valid range of its farm."}},wi={1:"100%",2:"50%",3:"33.33%",4:"50%"};function Ws(s){const{getRecommendRangesList:t}=Ai(),[a,l]=j.useState(),{poolAddress:m,currentTick:d,tickSpacing:o,farmsEffectTickLower:h,farmsEffectTickUpper:i}=s;Le();const{handleInitTickData:x}=St(),{apiPoolInfo:y,currentRange:c,setCurrentRange:p}=de(),{lowerTickData:b,upperTickData:w,setLowerTickData:k,setUpperTickData:g,setTickDataLoading:A,tickDataLoading:q}=Fe(),{recommendRangesInfo:R}=Ie(),f=j.useMemo(()=>({...y,tickSpacing:o}),[y,o]),M=async()=>{var u,r,n;try{c||A(!0);const{rangeList:S,error:B}=await t({...s,recommendRangesInfo:R});if(l(S),B){if(p("custom"),!c&&(f!=null&&f.tokenA)&&(f!=null&&f.tokenB)){const F=S.find(J=>J.key==="custom");F&&x(F==null?void 0:F.lower,F==null?void 0:F.upper,f)}}else p((u=S[0])==null?void 0:u.key),!c&&(f!=null&&f.tokenA)&&(f!=null&&f.tokenB)&&x((r=S[0])==null?void 0:r.lower,(n=S[0])==null?void 0:n.upper,f)}catch(S){console.error(S)}finally{A(!1)}};return Pe(()=>{m&&d!==void 0&&o!==void 0&&M()},[m,o,R],{wait:500}),j.useEffect(()=>{if(a&&a.length>0&&le(b)&&le(w)){const u=a==null?void 0:a.find(r=>N(r.lower).eq(N(b==null?void 0:b.tick))&&N(r.upper).eq(N(w==null?void 0:w.tick)));u?u.key!==c&&p(u.key):p("custom")}},[b==null?void 0:b.tick,w==null?void 0:w.tick,a]),e.jsx(e.Fragment,{children:e.jsx(lr,{w:"100%",flexDirection:{base:"row",lg:"column"},flexWrap:"wrap",borderRadius:"16px",rowGap:{base:"20px",lg:"12px"},marginTop:"0",children:a==null?void 0:a.map((u,r)=>{var n,S;return e.jsx(dr,{label:vi(u.key),lineHeight:"1.5",placement:"top",gutter:-4,children:e.jsxs(E,{cursor:"pointer",textAlign:"center",width:{base:a!=null&&a.length?wi[a.length+""]:"auto",lg:"auto"},p:"4px 8px",pb:"8px",gap:"4px",onClick:()=>{u.key!==c&&(p(u.key),f!=null&&f.tokenA&&(f!=null&&f.tokenB)&&x(u.lower,u.upper,f))},bg:u.key==c?"primary_opacity.10":"transparent",borderRadius:"12px",sx:{_hover:{p:{color:"primary"}}},children:[e.jsx(Gt,{decoding:"async",display:u.key===c?"block":"none",src:`/images/${(n=wt(u.key,!0))==null?void 0:n.image}`,w:"90px",h:u.key===c?"28px":"0px",fallback:e.jsx(ee,{bg:"background",w:"72px",h:u.key===c?"28px":"0px",borderRadius:"4px"})}),e.jsx(Gt,{decoding:"async",display:u.key===c?"none":"block",src:`/images/${(S=wt(u.key,!1))==null?void 0:S.image}`,w:"90px",h:u.key===c?"0px":"28px",fallback:e.jsx(ee,{bg:"background",w:"72px",h:u.key===c?"0px":"28px",borderRadius:"4px"})}),e.jsx(_,{color:u.key==c?"primary":"primary_gray",fontSize:"12px",children:wt(u.key).name})]})},u.key)})})})}function $s(s){const[t,a]=j.useState(!1),{displayTokenA:l,displayTokenB:m,feeDisplay:d,clmmPool:o,vaultId:h,isReverse:i,category:x}=s,{isApp:y}=Le(),{clearVaultsActionData:c}=Dr();j.useEffect(()=>{c()},[t]);const{isVaultsFarming:p}=Or(h),[b,w]=j.useState(!1),[k,g]=j.useState("Stake");return e.jsxs(e.Fragment,{children:[e.jsxs(E,{width:y?"100%":"460px",height:"128px",backgroundImage:"/images/bg_autorebalancer@2x.png",backgroundSize:"100% 100%",padding:"12px 16px 20px",flexDirection:"column",justifyContent:"space-between",children:[e.jsxs(L,{width:"100%",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(_,{color:"primary",fontWeight:"500",children:["Join via an Auto Vault"," "]}),e.jsxs(L,{children:[e.jsx(Ct,{label:"",wrapStyle:{w:"unset",gap:"6px"},labelStyle:{fontSize:"14px",color:"text_highlight",fontWeight:"500"},value:e.jsx(Vr,{wrapStyle:{flexDirection:"row"},vaultId:h}),valueStyle:{color:"text_highlight",h:"20px",lineHeight:"20px",fontSize:"14px",fontWeight:"500",textDecoration:"none"}}),e.jsx(Ae,{width:"88px",height:"24px",borderRadius:"4px",fontSize:"12px",onClick:()=>a(!0),fontWeight:"500",children:"Deposit"})]})]}),e.jsx(L,{w:"100%",mt:"14px",children:e.jsxs(_,{lineHeight:"20px",maxWidth:"290px",fontSize:"12px",children:["Automate your LPing by selecting a ",x=="haedal"?"3rd party":""," strategy provider and enjoy higher yields powered by experts!"," "]})})]}),e.jsx(Qr,{isOpen:t,setIsOpen:a,displayTokenA:l,displayTokenB:m,feeDisplay:d,clmmPool:o,vaultId:h,isReverse:i,category:x,isVaultsFarming:p,setIsOpenFarmingModal:w,setFarmingModalAction:g,onClose:()=>a(!1)}),b&&e.jsx(Kr,{isOpen:b,setIsOpen:w,setIsOpenPre:a,onClose:()=>w(!1),farmingModalAction:k,vaultsId:h,isDetail:!1})]})}const Us=({price:s,perText:t,wrapStyle:a,loading:l})=>e.jsxs(Se,{flexDir:{base:"column",lg:"row"},align:"flex-start",...a,children:[e.jsx(_,{children:"Current Price"}),e.jsxs(L,{as:"div",h:"14px",children:[l||s==="--"?e.jsx(Oe,{w:"66px",h:"14px",display:"inline-block"}):e.jsx(_,{as:"span",color:"text_caption",display:"inline-block",h:"14px",lineHeight:"14px",children:s}),e.jsx(_,{as:"span",display:"inline-block",h:"14px",lineHeight:"14px",children:` ${t}`})]})]});function ki({btnText:s,btnDisabled:t,handleChangeIsFarmRewardsRange:a,onReverseClick:l,leverage:m,direct:d,perText:o,rangeTabList:h,currentRangeTab:i,fromBalanceInfo:x,toBalanceInfo:y,fromAmountValue:c,toAmountValue:p,handleAmountChange:b,handleAdd:w,isFullRange:k,useZapIn:g,handleChangeZapIn:A,handleChangeLiquidityChartTab:q,liquidityChartTab:R,liquidityChartTabList:f}){var He,_e;const{currentPriceData:M,contractPoolInfo:u,apiPoolInfo:r,resetLiquidity:n,contractPoolInfoLoading:S,apiPoolInfoLoading:B,minPriceForDate:F,maxPriceForDate:J,currentRange:ae}=de(),{lowerTickData:V,upperTickData:T}=Fe(),{autoStakePosition:z,setAutoStakePosition:H,isFarmRewardsRange:D,fromAmount:G,toAmount:se,byAmountIn:ue,percentMap:Q,fromToken:X,toToken:v,totalAmount:me,fromTokenLock:C,toTokenLock:Z}=ze(),{poolAddress:re}=ke(),he=P=>{H(P.target.checked)},O=j.useMemo(()=>{if(M!=null&&M.currentPrice&&M.pool===re)return M==null?void 0:M.currentPrice},[M==null?void 0:M.currentPrice,re]),{priceImpactBasedOnMarket:ie}=Ms(X,v,d?"1":Ne(O),d?Ne(O):"1",!0),xe=j.useMemo(()=>{if(ie&&N(ie).abs().gte(30))return N(ie).gte(30)?`+${N(ie).toFixed(0)}%`:`${N(ie).toFixed(0)}%`},[ie]);j.useMemo(()=>!!(r!=null&&r.haveFarming)&&!!(r!=null&&r.displayFarmsEffectMaxPrice)&&!!(r!=null&&r.displayFarmsEffectMinPrice),[r==null?void 0:r.haveFarming,r==null?void 0:r.displayFarmsEffectMaxPrice,r==null?void 0:r.displayFarmsEffectMinPrice]);const[je,Te]=j.useState({type:"30D",key:"month"}),{recommendRangesInfo:oe}=Ie(),ne=j.useMemo(()=>{var P,U;if(oe!=null&&oe.dateTypeRanges&&((P=oe==null?void 0:oe.dateTypeRanges)==null?void 0:P.length)>0)return(U=oe==null?void 0:oe.dateTypeRanges)==null?void 0:U.reduce((Ve,Me)=>(Ve[Me.dateType]=Me,Ve),{})},[oe==null?void 0:oe.dateTypeRanges]);return e.jsxs(E,{w:"100%",gap:"20px",children:[e.jsxs(ee,{w:"100%",bg:"card_bg",p:"16px 8px 0px",borderRadius:"12px",children:[e.jsxs(L,{w:"100%",justify:"space-between",mb:"16px",children:[e.jsx(Ye,{fontSize:"14px",fontWeight:"500",children:"Select Range"}),B?e.jsx(Oe,{h:"28px",borderRadius:"8px",w:"150px"}):e.jsx(L,{children:e.jsx(Je,{type:"outlineTab",tabList:h,currentTab:i,handleChangeTab:P=>l(P),wrapStyle:{h:"28px",p:"3px",border:"1px solid",borderColor:"border",borderRadius:"8px",gap:"4px"},itemStyle:{flex:1,h:"20px",p:"0 4px",borderRadius:"4px",gap:"4px"}})})]}),e.jsx(Ws,{poolAddress:re,currentTick:u==null?void 0:u.current_tick_index,tickSpacing:u==null?void 0:u.tickSpacing,farmsEffectTickLower:r==null?void 0:r.farmsEffectiveTickLower,farmsEffectTickUpper:r==null?void 0:r.farmsEffectiveTickUpper}),e.jsx(Us,{price:Ne(d?M==null?void 0:M.currentPrice:M.reverseCurrentPrice,6),perText:o,loading:S,wrapStyle:{mt:"28px",gap:"12px"}}),e.jsxs(E,{position:"relative",flex:"1",h:"180px",pos:"relative",mt:"20px",children:[e.jsx(ee,{position:"absolute",top:"-5px",left:"0",zIndex:"99999",children:e.jsx(Je,{type:"outlineTab",tabList:f,currentTab:R,handleChangeTab:P=>q&&q(P),wrapStyle:{h:"28px",p:"3px",border:"1px solid",borderColor:"border",borderRadius:"8px",gap:"0px",zIndex:"99"},itemStyle:{h:"20px",p:"0px 4px",borderRadius:"4px",gap:"0px"}})}),e.jsx(_s,{handleClickRefresh:()=>{},direct:d,minPriceData:d?V:T,maxPriceData:d?T:V,dashedMarkerLine:[F,J],currentRange:ae,liquidityChartTab:R})]}),xe&&e.jsx(bt,{tips:`The current pool price deviates largely from the real-time market price (${xe}). Please be careful with your price range setting to avoid large impermanent loss.`,borderRadius:"12px",p:"8px",w:"100%",mt:"90px",mb:"-70px",tipsFontSize:"12px"}),e.jsx(Hs,{liquidityChartTab:R,tab:je,setTab:Te,direct:d,wrapStyle:{mt:"90px",align:"center",gap:"20px"}}),e.jsxs(E,{borderRadius:"16px",bg:"card_bg",mt:"8px",mb:"8px",p:"8px 0px",gap:"12px",children:[e.jsx(Es,{perText:o,direct:d,isFullRange:k,minPriceData:d?V:T,maxPriceData:d?T:V}),C&&Z&&e.jsx(bt,{isShowIcon:!1,tipsFontSize:"12px",justifyContent:"center",tips:"The max price should be higher than min price.",h:"32px",borderRadius:"8px"})]}),e.jsxs(E,{mb:"20px",gap:"12px",children:[(r==null?void 0:r.haveFarming)&&(r==null?void 0:r.displayFarmsEffectMaxPrice)&&(r==null?void 0:r.displayFarmsEffectMinPrice)&&e.jsx(qs,{minPrice:d?mt(r==null?void 0:r.displayFarmsEffectMinPrice):ht(r==null?void 0:r.displayFarmsEffectMaxPrice),maxPrice:d?mt(r==null?void 0:r.displayFarmsEffectMaxPrice):ht(r==null?void 0:r.displayFarmsEffectMinPrice),loading:B,perText:o,checked:D,onChange:a}),e.jsx(Ts,{label:"Leverage",tooltip:"This parameter indicates the concentration rate of your liquidity relative to a full range position.",wrapStyle:{flexDir:"row",gap:"8px",p:"0",mt:"4px"},children:e.jsx(_,{color:"primary",children:C&&Z?"--":m})}),e.jsx(ps,{tab:je,setTab:Te,ranges:ne,currentPosPoolsRelatedData:{minPriceRaw:Ce(r!=null&&r.isReverse?T==null?void 0:T.reversePrice:V==null?void 0:V.price,void 0,!0),maxPriceRaw:Ce(r!=null&&r.isReverse?V==null?void 0:V.reversePrice:T==null?void 0:T.price,void 0,!0)},posPoolInfo:r,isActive:!C||!Z})]})]}),e.jsx(ee,{w:"100%",children:e.jsxs(E,{w:"calc(100%)",gap:"16px",p:"16px 8px",bg:"card_bg",borderColor:"border",borderRadius:"12px",margin:"-1px -1px 0px -1px",children:[e.jsxs(L,{w:"100%",justify:"space-between",children:[e.jsxs(L,{gap:"20px",children:[e.jsx(Ye,{fontSize:"14px",fontWeight:"500",children:"Deposit Amounts"}),(r==null?void 0:r.haveZap)&&e.jsx(vs,{action:"Deposit",value:g,onChange:A})]}),e.jsx(L,{children:e.jsx(os,{slippageType:"liquidity",poolType:"clmm"})})]}),e.jsx(E,{w:"100%",gap:"12px",children:e.jsx(ee,{w:"100%",position:"relative",children:g&&!(C&&Z)?e.jsx(ws,{apiPoolInfo:r,action:"Deposit",currentSqrtPrice:M==null?void 0:M.currentSqrtPrice,lowerTick:V==null?void 0:V.tick,upperTick:T==null?void 0:T.tick}):e.jsx(Bs,{onClick:l,from:{wrapStyle:{h:"108px"},balance:(x==null?void 0:x.balanceFormat)||"",value:G+"",amountValue:c,loading:!1,onChange:P=>{var U;b(P,!0,(X==null?void 0:X.coin_type)===((U=r==null?void 0:r.tokenA)==null?void 0:U.coin_type))},selectable:!1,placeholder:"0.0",token:X,onFocusChange:P=>{var U;P&&+(G+"")&&!ue&&b(G+"",!0,(X==null?void 0:X.coin_type)===((U=r==null?void 0:r.tokenA)==null?void 0:U.coin_type))},lock:{isLock:C&&!Z,text:"The market price is outside your specified price range. Single-asset deposit only."}},to:{wrapStyle:{h:"108px"},balance:(y==null?void 0:y.balanceFormat)||"",value:se+"",amountValue:p,loading:!1,onFocusChange:P=>{var U;P&&+(se+"")&&ue&&b(se+"",!1,(v==null?void 0:v.coin_type)===((U=r==null?void 0:r.tokenA)==null?void 0:U.coin_type))},onChange:P=>{var U;b(P,!1,(v==null?void 0:v.coin_type)===((U=r==null?void 0:r.tokenA)==null?void 0:U.coin_type))},selectable:!1,placeholder:"0.0",token:v,lock:{isLock:!C&&Z,text:"The market price is outside your specified price range. Single-asset deposit only."}},iconParams:{xlinkHref:"#icon-icon_add",svgFill:"text_caption"},lock:{isLock:C&&Z,style:{h:"224px"}}})})}),!g&&!!(r!=null&&r.poolAddress)&&!(C&&Z)&&e.jsxs(e.Fragment,{children:[e.jsxs(E,{gap:"12px",w:"100%",children:[e.jsx(Tt,{labelStyle:{color:"primary_gray"},totalAmount:me,loading:!1}),e.jsx(Ft,{type:"image",percentMap:Q,lockRatio:C&&Z,tokenA:X,tokenB:v,isReverse:(X==null?void 0:X.coin_type)!==((He=r==null?void 0:r.tokenA)==null?void 0:He.coin_type)})]}),e.jsx(Ae,{w:"100%",h:"52px",fontSize:"20px",fontWeight:"500",borderRadius:"16px",isDisabled:t||!!(r!=null&&r.isFrozen),isLoading:!1,onClick:w,children:s})]}),g&&e.jsx(Mt,{action:"Deposit",isReverse:(X==null?void 0:X.coin_type)!==((_e=r==null?void 0:r.tokenA)==null?void 0:_e.coin_type)})]})}),(r==null?void 0:r.haveFarming)&&e.jsx(zs,{disabled:C||Z,checked:z,onChange:he}),r!=null&&r.vaultCategory?e.jsx(E,{w:"100%",children:e.jsx($s,{displayTokenA:r==null?void 0:r.displayTokenA,displayTokenB:r==null?void 0:r.displayTokenB,feeDisplay:r==null?void 0:r.feeDisplay,clmmPool:r==null?void 0:r.poolAddress,vaultId:r==null?void 0:r.vaultId,isReverse:r==null?void 0:r.isReverse,category:r==null?void 0:r.vaultCategory})}):null]})}function _i({btnText:s,btnDisabled:t,handleChangeIsFarmRewardsRange:a,onReverseClick:l,leverage:m,direct:d,perText:o,rangeTabList:h,currentRangeTab:i,fromBalanceInfo:x,toBalanceInfo:y,fromAmountValue:c,toAmountValue:p,handleAmountChange:b,handleAdd:w,isFullRange:k,useZapIn:g,handleChangeZapIn:A,handleSubmit:q,handleChangeLiquidityChartTab:R,liquidityChartTab:f,liquidityChartTabList:M}){var _e,P;const{currentPriceData:u,contractPoolInfo:r,apiPoolInfo:n,resetLiquidity:S,contractPoolInfoLoading:B,apiPoolInfoLoading:F,minPriceForDate:J,maxPriceForDate:ae,currentRange:V}=de(),{lowerTickData:T,upperTickData:z}=Fe(),{autoStakePosition:H,setAutoStakePosition:D,isFarmRewardsRange:G,fromAmount:se,toAmount:ue,byAmountIn:Q,percentMap:X,fromToken:v,toToken:me,totalAmount:C,fromTokenLock:Z,toTokenLock:re}=ze(),{poolAddress:he}=ke(),O=U=>{D(U.target.checked)},ie=j.useMemo(()=>{if(u!=null&&u.currentPrice&&u.pool===he)return u==null?void 0:u.currentPrice},[u==null?void 0:u.currentPrice,he]),{priceImpactBasedOnMarket:xe}=Ms(v,me,d?"1":Ne(ie),d?Ne(ie):"1",!0),je=j.useMemo(()=>{if(xe&&N(xe).abs().gte(30))return N(xe).gte(30)?`+${N(xe).toFixed(0)}%`:`${N(xe).toFixed(0)}%`},[xe]),[Te,oe]=j.useState({type:"30D",key:"month"}),{recommendRangesInfo:ne}=Ie(),He=j.useMemo(()=>{var U,I;if(console.log("ðŸš€ðŸš€ðŸš€ ~ PC.tsx:118 ~ PCProvideLiquidity ~ recommendRangesInfo?.dateTypeRanges:",ne==null?void 0:ne.dateTypeRanges),ne!=null&&ne.dateTypeRanges&&((U=ne==null?void 0:ne.dateTypeRanges)==null?void 0:U.length)>0)return(I=ne==null?void 0:ne.dateTypeRanges)==null?void 0:I.reduce((Me,Ge)=>(Me[Ge.dateType]=Ge,Me),{})},[ne==null?void 0:ne.dateTypeRanges]);return e.jsx(e.Fragment,{children:e.jsxs(L,{gap:"16px",align:"flex-start",children:[e.jsxs(Kt,{title:"Select Range",wrapStyle:{flex:1,minW:"588px",gap:"0",border:"none",bg:"card_bg"},children:[!h||!h.length?e.jsx(Oe,{h:"32px",borderRadius:"8px",w:"180px"}):e.jsxs(L,{children:[e.jsx(Je,{type:"outlineTab",tabList:h,currentTab:i,handleChangeTab:U=>l(U),wrapStyle:{h:"32px",p:"3px",border:"1px solid",borderColor:"border",borderRadius:"8px",gap:"4px",zIndex:"99"},itemStyle:{h:"24px",p:"4px 12px",borderRadius:"4px",gap:"4px"}}),e.jsx(Je,{type:"outlineTab",tabList:M,currentTab:f,tooltipGutter:8,handleChangeTab:U=>R&&R(U),wrapStyle:{h:"32px",p:"3px",border:"1px solid",borderColor:"border",borderRadius:"8px",gap:"0px",zIndex:"99"},itemStyle:{h:"24px",p:"4px 12px",borderRadius:"4px",gap:"0px"}})]}),e.jsxs(E,{w:"100%",flex:"1",pos:"relative",gap:"16px",mt:"12px",children:[e.jsxs(E,{w:"100%",pos:"relative",gap:"0px",children:[e.jsx(L,{pl:"126px",w:"100%",h:"24px",justify:f==="prices"?"center":"flex-start",children:e.jsx(Us,{loading:F,price:le(u)?Ne(d?u==null?void 0:u.currentPrice:u.reverseCurrentPrice,6):"--",perText:o,wrapStyle:{ml:"0px",zIndex:99}})}),e.jsxs(L,{w:"100%",align:"flex-start",gap:"20px",children:[e.jsx(ee,{mt:"16px",w:{base:"100%",lg:"106px"},children:e.jsx(Ws,{poolAddress:he,currentTick:r==null?void 0:r.current_tick_index,tickSpacing:r==null?void 0:r.tickSpacing,farmsEffectTickLower:n==null?void 0:n.farmsEffectiveTickLower,farmsEffectTickUpper:n==null?void 0:n.farmsEffectiveTickUpper})}),e.jsxs(E,{w:"calc(100% - 126px)",gap:"12px",children:[e.jsx(L,{w:"100%",gap:"32px",alignItems:"start",children:e.jsxs(E,{w:"100%",gap:je?"72px":"32px",children:[e.jsx(ee,{w:"100%",h:"230px",pt:f!=="prices"?"20px":0,children:e.jsx(_s,{handleClickRefresh:()=>{},direct:d,minPriceData:d?T:z,maxPriceData:d?z:T,dashedMarkerLine:[J,ae],currentRange:V,liquidityChartTab:f})}),je?e.jsx(bt,{tips:`The current pool price deviates largely from the real-time market price (${je}). Please be careful with your price range setting to avoid large impermanent loss.`,borderRadius:"12px",p:"8px",w:"100%",tipsFontSize:"12px"}):e.jsx(ee,{h:"24px"})]})}),e.jsxs(E,{w:"100%",gap:"12px",position:"relative",children:[e.jsxs(L,{w:"100%",children:[le(T)&&le(z)&&Yr&&e.jsx(js,{bg:"none",border:"none",borderRadius:"12px",p:"8px",w:"110px",position:"absolute",left:"-126px",top:"16px",children:e.jsx(Ts,{label:"Leverage",tooltip:"This parameter indicates the concentration rate of your liquidity relative to a full range position.",wrapStyle:{flexDir:"column",align:"flex-start",gap:"2px"},children:e.jsx(_,{color:"primary",children:Z&&re?"--":m})})}),e.jsx(Es,{perText:o,direct:d,isFullRange:k,minPriceData:d?T:z,maxPriceData:d?z:T})]}),Z&&re&&e.jsx(bt,{isShowIcon:!1,tipsFontSize:"12px",justifyContent:"center",tips:"The max price should be higher than min price.",h:"32px",borderRadius:"8px"}),(n==null?void 0:n.haveFarming)&&(n==null?void 0:n.displayFarmsEffectMaxPrice)&&(n==null?void 0:n.displayFarmsEffectMinPrice)&&e.jsx(qs,{minPrice:d?mt(n==null?void 0:n.displayFarmsEffectMinPrice):ht(n==null?void 0:n.displayFarmsEffectMaxPrice),maxPrice:d?mt(n==null?void 0:n.displayFarmsEffectMaxPrice):ht(n==null?void 0:n.displayFarmsEffectMinPrice),loading:F,perText:o,checked:G,onChange:a})]})]})]})]}),e.jsx(Lt,{orientation:"horizontal"}),e.jsx(ps,{tab:Te,setTab:oe,ranges:He,currentPosPoolsRelatedData:{minPriceRaw:Ce(n!=null&&n.isReverse?z==null?void 0:z.reversePrice:T==null?void 0:T.price,void 0,!0),maxPriceRaw:Ce(n!=null&&n.isReverse?T==null?void 0:T.reversePrice:z==null?void 0:z.price,void 0,!0)},posPoolInfo:n,isActive:!Z&&!re,wrapStyle:{w:!le(T)||!le(z)?"100%":"auto"},children:le(T)&&le(z)&&e.jsx(Hs,{direct:d,tab:Te,setTab:oe,liquidityChartTab:f,wrapStyle:{w:"auto",mt:je?"-20px":"0"}})})]})]}),e.jsxs(E,{gap:"12px",minW:"420px",maxW:"460px",w:"460px",children:[e.jsxs(Kt,{title:"Deposit Amounts",wrapStyle:{gap:"12px",w:"100%",border:"none",bg:"card_bg"},children:[e.jsx(L,{children:(n==null?void 0:n.haveZap)&&e.jsx(vs,{action:"Deposit",value:g,onChange:A})}),e.jsxs(ee,{w:"100%",position:"relative",children:[g&&!(Z&&re)?e.jsx(ws,{apiPoolInfo:n,action:"Deposit",currentSqrtPrice:u==null?void 0:u.currentSqrtPrice,lowerTick:T==null?void 0:T.tick,upperTick:z==null?void 0:z.tick}):e.jsx(e.Fragment,{children:e.jsx(Bs,{onClick:l,from:{wrapStyle:{h:"108px"},balance:(x==null?void 0:x.balanceFormat)||"",value:se,amountValue:c,loading:!1,onChange:U=>{var I;b(U,!0,(v==null?void 0:v.coin_type)===((I=n==null?void 0:n.tokenA)==null?void 0:I.coin_type))},selectable:!1,placeholder:"0.0",token:v,onFocusChange:U=>{var I;U&&+(se+"")&&!Q&&b(se+"",!0,(v==null?void 0:v.coin_type)===((I=n==null?void 0:n.tokenA)==null?void 0:I.coin_type))},lock:{isLock:Z&&!re,text:"The market price is outside your specified price range. Single-asset deposit only."},rightJustify:"space-around"},to:{wrapStyle:{h:"108px"},balance:(y==null?void 0:y.balanceFormat)||"",value:ue,amountValue:p,loading:!1,onFocusChange:U=>{var I;U&&+(ue+"")&&Q&&b(ue+"",!1,(me==null?void 0:me.coin_type)===((I=n==null?void 0:n.tokenA)==null?void 0:I.coin_type))},onChange:U=>{var I;b(U,!1,(me==null?void 0:me.coin_type)===((I=n==null?void 0:n.tokenA)==null?void 0:I.coin_type))},selectable:!1,placeholder:"0.0",token:me,lock:{isLock:!Z&&re,text:"The market price is outside your specified price range. Single-asset deposit only."},rightJustify:"space-around"},iconParams:{xlinkHref:"#icon-icon_add",svgFill:"text_caption"},lock:{isLock:Z&&re,style:{h:"224px"}}})}),e.jsxs(E,{w:"100%",gap:"8px",mt:"12px",children:[!g&&!!(n!=null&&n.poolAddress)&&!(Z&&re)&&e.jsxs(E,{gap:"12px",w:"100%",borderRadius:"16px",children:[e.jsx(Ae,{w:"100%",h:"52px",margin:"-1px -1px 5px",fontSize:"18px",fontWeight:"500",borderRadius:"12px",isDisabled:t||!!(n!=null&&n.isFrozen),isLoading:!1,onClick:w,children:s}),(n==null?void 0:n.displayTokenA)&&(n==null?void 0:n.displayTokenB)&&e.jsxs(e.Fragment,{children:[e.jsx(Tt,{labelStyle:{color:"primary_gray"},totalAmount:C,loading:!1,valueStyle:{h:"20px",lineHeight:"20px"}}),e.jsx(Ft,{type:"image",percentMap:X,lockRatio:Z&&re,tokenA:v,tokenB:me,isReverse:(v==null?void 0:v.coin_type)!==((_e=n==null?void 0:n.tokenA)==null?void 0:_e.coin_type)})]})]}),g&&e.jsx(Mt,{action:"Deposit",isPositionStyle:!0,isReverse:(v==null?void 0:v.coin_type)!==((P=n==null?void 0:n.tokenA)==null?void 0:P.coin_type)})]})]})]}),e.jsxs(E,{gap:"0",children:[(n==null?void 0:n.haveFarming)&&e.jsx(E,{w:"100%",gap:"8px",mb:"12px",children:e.jsx(zs,{disabled:Z||re,checked:H,onChange:O})}),(n==null?void 0:n.vaultCategory)&&e.jsx($s,{displayTokenA:n==null?void 0:n.displayTokenA,displayTokenB:n==null?void 0:n.displayTokenB,feeDisplay:n==null?void 0:n.feeDisplay,clmmPool:n==null?void 0:n.poolAddress,vaultId:n==null?void 0:n.vaultId,isReverse:n==null?void 0:n.isReverse,category:n==null?void 0:n.vaultCategory})]})]})]})})}function Ci({rangeTabList:s,currentFeeTier:t,getList:a,getPrice:l}){const{apiPoolInfo:m}=de(),{zapAmount:d,currentZapToken:o}=ks(),{direct:h,perText:i,handleChangeIsFarmRewardsRange:x,onReverseClick:y,leverage:c,currentRangeTab:p,isFullRange:b,handleChangeLiquidityChartTab:w,liquidityChartTab:k,liquidityChartTabList:g}=fi({rangeTabList:s}),{handleAmountChange:A,fromAmountValue:q,toAmountValue:R,fromBalanceInfo:f,toBalanceInfo:M,relatedPosId:u,nftOpen:r,setNftOpen:n,handleAdd:S,handleSubmit:B,useZapIn:F,handleChangeZapIn:J,confirmModalOpen:ae,setConfirmModalOpen:V}=yi(a,h),{btnText:T,btnDisabled:z}=bi(),{isApp:H}=Le(),D={btnText:T,btnDisabled:z,handleChangeIsFarmRewardsRange:x,onReverseClick:y,leverage:c,direct:h,perText:i,rangeTabList:s,currentRangeTab:p,fromBalanceInfo:f,toBalanceInfo:M,fromAmountValue:q,toAmountValue:R,handleAmountChange:A,handleAdd:S,isFullRange:b,useZapIn:F,handleChangeZapIn:J,handleSubmit:B,handleChangeLiquidityChartTab:w,liquidityChartTab:k,liquidityChartTabList:g},{getHaedalFarmingList:G}=Gr(),{vaultsFarmObj:se}=Zr();return j.useEffect(()=>{le(se)||G()},[se]),e.jsxs(e.Fragment,{children:[H?e.jsx(ki,{...D}):e.jsx(_i,{...D}),ae&&e.jsx(hi,{onClose:()=>V(!1),data:{feeTier:t,zapData:F?{amount:d,token:o}:void 0},onSubmit:B}),r&&u&&le(m)&&e.jsx(Si,{onClose:()=>n(!1),tokenA:m==null?void 0:m.displayTokenA,tokenB:m==null?void 0:m.displayTokenB,posId:u,fee:m==null?void 0:m.feeDisplay,isReverse:m==null?void 0:m.isReverse})]})}function Ri(){const{posBaseListLoading:s,posBaseListGroupByPool:t}=zr(),{manualRefresh:a}=de(),{currentAccount:l,onWalletModal:m}=ft(),{getPositionBaseList:d,getPosRelatedData:o}=Rs(),[h,i]=j.useState(""),{poolAddress:x}=ke(),y=async p=>{const b=await d(p);console.log("ðŸš€ðŸš€ðŸš€ ~ useMyPositions.ts:23 ~ handleGetPositionList ~ res:",b),Array.isArray(b)&&o(b),typeof b=="string"&&i(b)};return j.useEffect(()=>{l!=null&&l.address&&y(l==null?void 0:l.address)},[l==null?void 0:l.address]),j.useEffect(()=>{a&&(l!=null&&l.address)&&y(l==null?void 0:l.address)},[a]),Jr({onRpcChange:()=>{l!=null&&l.address&&y(l==null?void 0:l.address)}}),{data:j.useMemo(()=>{if(x){const p=t[x.toLowerCase()||""];return p?p==null?void 0:p.list:[]}return[]},[x,JSON.stringify(t)]),rpcNodeErrorStr:h,posBaseListLoading:s,currentAccount:l,onWalletModal:m}}function Li({priceDirect:s}){const t=jt(),{apiPoolInfo:a}=de(),{currentAccount:l,data:m,rpcNodeErrorStr:d,onWalletModal:o}=Ri();return e.jsx(E,{minW:{base:"100%",lg:"1024px"},children:l!=null&&l.address?m&&(m==null?void 0:m.length)>0?e.jsx(js,{p:{base:"12px",lg:"16px"},borderRadius:"16px",children:e.jsx(Xr,{poolInfo:{list:m},priceDirect:s})}):d?e.jsx(Xe,{type:"nodata",text:d}):e.jsx(Xe,{type:"nodata",text:"You don't have positions for this pool",children:e.jsx(Ae,{borderRadius:"8px",mt:"8px",fontWeight:"500",w:"120px",h:"28px",fontSize:"12px",onClick:()=>t(`/clmm?tab=deposit&poolAddress=${a==null?void 0:a.poolAddress}`),children:"Create Position"})}):e.jsx(Xe,{type:"nowallet",onboard:()=>o(!0)})})}function Fi({apiPoolInfo:s,apiPoolInfoLoading:t,tvlLoading:a,totalTvl:l}){const m=j.useMemo(()=>s!=null&&s.haveFarming||s!=null&&s.miningAprList&&(s==null?void 0:s.miningAprList.length)>0?"help":"text",[s]),{isApp:d}=Le();return e.jsxs(Se,{flexDir:{base:"column",lg:"row"},gap:{base:"20px",lg:"28px"},children:[e.jsx(lt,{label:"Pool APR",value:e.jsx(Pr,{poolInfo:s,placement:d?"bottom-end":"bottom",children:e.jsxs(L,{justify:"flex-end",align:"flex-end",gap:"4px",lineHeight:"14px",h:"14px",children:[e.jsxs(_,{as:"span",fontSize:"14px",color:m=="help"?"primary":"text_caption",fontWeight:"500",cursor:m,pos:"relative",children:[(s==null?void 0:s.feeAndMiningAprDisplay)!==""?s==null?void 0:s.feeAndMiningAprDisplay:"0%",m=="help"&&e.jsx(ee,{w:"100%",borderBottom:"1px dotted",borderColor:"primary",pos:"absolute",bottom:"-1px"})]}),(s==null?void 0:s.haveFarming)&&e.jsxs(_,{fontSize:"12px",lineHeight:"12px",h:"12px",color:"primary",fontWeight:"500",children:["+",s==null?void 0:s.farmingAprDisplay]})]})})}),e.jsx(lt,{label:"TVL",value:l&&l!=="--"?`$${Ee(l,2)}`:"--",loading:t||a}),e.jsx(lt,{label:"Volume (24H)",value:(s==null?void 0:s.volume24Display)||"",loading:t}),e.jsx(lt,{label:"Fees (24H)",value:(s==null?void 0:s.fees24Display)||"",loading:t})]})}function Ti(){const{tab:s,poolAddress:t,from:a,to:l,fee:m}=ke(),{getPoolList:d}=ti(),[o,h]=j.useState([]),{apiPoolInfo:i,setApiPoolInfo:x,setApiPoolInfoLoading:y,setNetError:c}=de(),p=jt(),{fetchTokenInfo:b}=kr(),w=async({poolAddress:k,from:g,to:A})=>{var q,R,f,M;console.log("ðŸš€ðŸš€ðŸš€ ~ useGetRelatedPools.ts:148 ~ getList ~ getList:");try{y(!0);let u,r;if(k&&k!=="undefined"){console.log("ðŸš€ðŸš€ðŸš€ ~ useGetRelatedPools.ts:32 ~ getList ~ poolAddress:",k);const n=await d({pools:[k],display_all_pools:!0});console.log("ðŸš€ðŸš€ðŸš€ ~ useGetRelatedPools.ts:52 ~ getList ~ _res:",n),n&&n.list&&n.list.length?(r=n.list[0],u=await d({coin_type:`${(q=r==null?void 0:r.displayTokenA)==null?void 0:q.coin_type},${(R=r==null?void 0:r.displayTokenB)==null?void 0:R.coin_type}`,is_vaults:!1,display_all_pools:!0,has_mining:!0,has_farming:!0,no_incentives:!0,order_by:"-vol",offset:0})):i&&le(i)?(r=i,u={list:o}):(r={poolAddress:k,displayTokenA:void 0,displayTokenB:void 0},u={list:[]}),y(!1)}else if(g&&A&&g!=="undefined"&&A!=="undefined"&&g!==A){const n=await d({coin_type:`${g},${A}`,is_vaults:!1,display_all_pools:!0,has_mining:!0,has_farming:!0,no_incentives:!0,order_by:"-vol",offset:0});if(console.log(n,"res_getPoolList"),n&&n.list&&n.list.length)if(m&&m!=="undefined"){const S=(f=n==null?void 0:n.list)==null?void 0:f.find(B=>N(B==null?void 0:B.feeRate).eq(m));if(S)p(s?`/clmm?tab=${s}&poolAddress=${S==null?void 0:S.poolAddress}`:`/clmm?poolAddress=${S==null?void 0:S.poolAddress}`);else{const B=vt(n==null?void 0:n.list,F=>Number((F==null?void 0:F.tvl)||"0"));p(s?`/clmm?tab=${s}&poolAddress=${B==null?void 0:B.poolAddress}`:`/clmm?poolAddress=${B==null?void 0:B.poolAddress}`)}}else{let S=vt(n==null?void 0:n.list,B=>Number((B==null?void 0:B.tvl)||"0"));S||(S=vt(n==null?void 0:n.list,B=>{var F;return Number(((F=B==null?void 0:B.object)==null?void 0:F.liquidity)||"0")}),S||(S=n==null?void 0:n.list[0])),p(s?`/clmm?tab=${s}&poolAddress=${S==null?void 0:S.poolAddress}`:`/clmm?poolAddress=${S==null?void 0:S.poolAddress}`)}else{const S=await b([g,A].filter(Boolean)),B=S==null?void 0:S.get(g),F=S==null?void 0:S.get(A);r={poolAddress:void 0,displayTokenA:B,displayTokenB:F},u={list:[]},y(!1)}}else(!g||g==="undefined")&&A&&A!=="undefined"&&(r={poolAddress:void 0,displayTokenA:void 0,displayTokenB:await b(A)}),(!A||A==="undefined")&&g&&g!=="undefined"&&(r={poolAddress:void 0,displayTokenA:await b(g),displayTokenB:void 0}),u={list:[]},y(!1);u&&(c(!1),h(u==null?void 0:u.list),console.log(r,"setApiPoolInfo"),r&&(r!=null&&r.poolAddress&&k?(r==null?void 0:r.poolAddress)===k&&x(r):x(r))),y(!1)}catch(u){if(u!=null&&u.list&&((M=u==null?void 0:u.list)==null?void 0:M.length)===1){c(!0);const r=u==null?void 0:u.list[0];console.log(u==null?void 0:u.list,"setApiPoolInfo"),x(r),h([]),y(!1)}}};return j.useEffect(()=>{t&&t==="undefined"||!t&&t===void 0&&!a&&!l||w({poolAddress:t,from:a,to:l})},[t,a,l]),{getList:w,relatedPoolList:o}}function Mi(){var p,b,w,k;const{poolAddress:s}=ke(),{apiPoolInfo:t,apiPoolInfoLoading:a}=de(),{quoteWhiteTokenList:l}=Fs(),{getList:m,relatedPoolList:d}=Ti(),o=j.useMemo(()=>{var A,q;const g=ei(d);return g?t!=null&&t.tokenA&&(t!=null&&t.tokenB)?(A=ts)==null?void 0:A.map(R=>{var M,u;const f=((M=g.find(r=>r.feeRate===R.feeRate))==null?void 0:M.title)||R.title;return{...R,title:f,poolAddress:(u=g.find(r=>r.feeRate===R.feeRate))==null?void 0:u.poolAddress,disabled:f==="Not Created"&&!Ue(t==null?void 0:t.tokenA,l)&&!Ue(t==null?void 0:t.tokenB,l)}}):(q=ts)==null?void 0:q.map(R=>{var M,u;const f=((M=g.find(r=>r.feeRate===R.feeRate))==null?void 0:M.title)||R.title;return{...R,title:f,poolAddress:(u=g.find(r=>r.feeRate===R.feeRate))==null?void 0:u.poolAddress,disabled:!Ue(t==null?void 0:t.displayTokenA,l)&&!Ue(t==null?void 0:t.displayTokenB,l)}}):[]},[JSON.stringify(d),JSON.stringify(l),(p=t==null?void 0:t.displayTokenA)==null?void 0:p.coin_type,(b=t==null?void 0:t.displayTokenB)==null?void 0:b.coin_type]),h=j.useMemo(()=>t?[t==null?void 0:t.displayTokenA,t==null?void 0:t.displayTokenB].filter(Boolean).map(g=>({label:g==null?void 0:g.symbol,key:g==null?void 0:g.coin_type,isToken:!0,imgInfo:{src:g==null?void 0:g.logo_url,w:"16px",h:"16px",coinType:g?g==null?void 0:g.coin_type:"",showTagWidth:"8px",showTagHeight:"8px"}})):[],[(w=t==null?void 0:t.displayTokenA)==null?void 0:w.symbol,(k=t==null?void 0:t.displayTokenB)==null?void 0:k.symbol]),i=j.useMemo(()=>{const g=o==null?void 0:o.find(A=>A.poolAddress===s);return g||t},[JSON.stringify(o),s,JSON.stringify(t)]),{fetchPriceRange:x}=Hr(),y=async g=>{console.log("ðŸš€ ~ setPriceRangeMap ~ this.addressHistTokens:ðŸš€ ~ getContractPrices ~ address:",g),await x(g,t==null?void 0:t.tokenA,t==null?void 0:t.tokenB)};_t(()=>{s&&s===(t==null?void 0:t.poolAddress)&&(t!=null&&t.tokenA)&&(t!=null&&t.tokenB)&&y(s)},[s,t==null?void 0:t.tokenA,t==null?void 0:t.tokenB]);const c=j.useMemo(()=>{const g=[];return t!=null&&t.displayTokenA&&g.push(t==null?void 0:t.displayTokenA),t!=null&&t.displayTokenB&&g.push(t==null?void 0:t.displayTokenB),g},[JSON.stringify(t==null?void 0:t.displayTokenA),JSON.stringify(t==null?void 0:t.displayTokenB)]);return{getList:m,feeTierList:o,apiPoolInfo:t,rangeTabList:h,currentFeeTier:i,apiPoolInfoLoading:a,quoteWhiteTokenList:l,warningTokenList:c}}function Bi(){const{currentAccount:s}=ft(),{apiPoolInfo:t,resetLiquidity:a,setManualRefresh:l,setCurrentPriceData:m}=de(),{feeTierList:d,currentFeeTier:o,rangeTabList:h,getList:i,quoteWhiteTokenList:x,warningTokenList:y}=Mi(),{poolAddress:c}=ke(),{handleResetRange:p}=St(),{resetAddLiquidity:b,setFromToken:w,setToToken:k}=ze(),{resetDeposit:g}=Ie(),{fetchAccountBalance:A}=Ls(),{getContractPoolInfo:q}=Ss(),{getCurrentPrice:R}=As(),{currentTab:f,setCurrentTab:M,tabList:u,favoriteStyle:r,onChangeFavorites:n,selectedTokenA:S,selectedTokenB:B,setSelectedTokenA:F,setSelectedTokenB:J,onConfirm:ae,setFeeTier:V,refreshMarketPrice:T,onJump2Swap:z,handleSelectToken:H,getSelectTokenProps:D}=ur({apiPoolInfo:t});j.useEffect(()=>{le(t)&&(w(t==null?void 0:t.displayTokenA),k(t==null?void 0:t.displayTokenB))},[t==null?void 0:t.poolAddress]);const G=async()=>{if(c&&t&&c===(t==null?void 0:t.poolAddress)){const Q=await q(c);Q&&R(Q==null?void 0:Q.current_sqrt_price,t,Q==null?void 0:Q.current_tick_index)}},se=()=>{T==null||T(),G==null||G()},ue=async Q=>{console.log("ðŸš€ ~ handleRefresh ~ handleRefresh111:"),Q&&l(!0),c&&c!=="undefined"&&await i({poolAddress:c}),s!=null&&s.address&&await A(),se(),l(!1)};return j.useEffect(()=>(s!=null&&s.address&&A(),m({}),()=>{p(),b(),a(),g()}),[]),j.useEffect(()=>{c&&(t==null?void 0:t.poolAddress)!==c&&(p(),b(),a(),g()),c&&c===(t==null?void 0:t.poolAddress)&&G()},[c,t==null?void 0:t.poolAddress]),{feeTierList:d,currentFeeTier:o,rangeTabList:h,quoteWhiteTokenList:x,warningTokenList:y,currentTab:f,setCurrentTab:M,tabList:u,favoriteStyle:r,onChangeFavorites:n,selectedTokenA:S,selectedTokenB:B,setSelectedTokenA:F,setSelectedTokenB:J,onConfirm:ae,setFeeTier:V,handleRefresh:ue,handleGetPrice:G,onJump2Swap:z,handleSelectToken:H,getSelectTokenProps:D}}function Kc(){const s=jt(),{apiPoolInfo:t,apiPoolInfoLoading:a,currentPriceData:l,netError:m}=de(),{poolAddress:d,from:o,to:h}=ke(),{feeTierList:i,currentFeeTier:x,rangeTabList:y,quoteWhiteTokenList:c,warningTokenList:p,currentTab:b,setCurrentTab:w,tabList:k,favoriteStyle:g,onChangeFavorites:A,selectedTokenA:q,selectedTokenB:R,onConfirm:f,setFeeTier:M,handleRefresh:u,handleGetPrice:r,onJump2Swap:n,handleSelectToken:S,getSelectTokenProps:B}=Bi(),{isApp:F}=Le(),{isOpen:J,onOpen:ae,onClose:V}=xr(),{totalAmountUSD:T,tvlLoading:z}=Lr(),H=d&&(t==null?void 0:t.tokenA)&&(t==null?void 0:t.tokenB),{tooltip:D,xlinkHref:G,svgFill:se,svgHover:ue}=g,[Q,X]=j.useState({}),[v,me]=j.useState({}),C=j.useCallback(async()=>{const O=await B(o,q),ie=await B(h,R);X(O),me(ie)},[o,h,q,R,B]);j.useEffect(()=>{C()},[C]);const{backUrl:Z}=ys(),[re,he]=j.useState(!0);return e.jsxs(e.Fragment,{children:[e.jsxs(ee,{w:"100%",mt:"20px",children:[e.jsxs(L,{w:"100%",minW:{base:"100%",lg:"1024px"},justify:"space-between",children:[e.jsx(si,{text:"Back",onClick:()=>s(Z||"/pools")}),H&&e.jsxs(L,{gap:"8px",children:[e.jsx(pt,{placement:"top",tooltip:D,fontSize:"12px",children:e.jsx(Ae,{variant:"outline",w:"32px",h:"32px",lineHeight:"32px",onClick:A,p:"0 6px",borderRadius:"8px",color:"text_paragraph",bg:"bg_secondary",display:"flex",justifyContent:"center",gap:"4px",sx:{_hover:{color:"text_caption",svg:{fill:ue}}},children:e.jsx(Re,{xlinkHref:G,svgFill:se,svgHover:ue,fontSize:"18px"})})}),e.jsx(pt,{placement:"top",tooltip:"Trade",fontSize:"12px",children:e.jsx(Ae,{variant:"outline",bg:"bg_secondary",h:"32px",w:"32px",onClick:n,borderRadius:"8px",p:"0 6px",color:"text_paragraph",display:"flex",justifyContent:"center",gap:"4px",sx:{_hover:{color:"text_caption",svg:{fill:"text_caption"}}},children:e.jsx(Re,{xlinkHref:"#icon-icon_swap1",fontSize:"16px"})})}),e.jsx(pt,{placement:"top",tooltip:"Refresh",fontSize:"12px",children:e.jsx(ee,{children:e.jsx(ri,{handleRefresh:u,isAutoRefresh:!0,refreshInterval:60,innerStyle:{bg:"bg_secondary"},w:"32px",h:"32px",borderRadius:"8px",bg:"bg_secondary"},d)})})]})]}),e.jsxs(Se,{flexDir:{base:"column",lg:"row"},w:"100%",minW:{base:"100%",lg:"1024px"},justify:"space-between",mt:"20px",gap:{base:"20px",lg:"8px"},children:[e.jsxs(Se,{flexDir:{base:"column",lg:"row"},gap:{base:"20px",lg:"12px"},align:{base:"flex-start",lg:"center"},children:[e.jsxs(L,{gap:"12px",children:[e.jsx(It,{onChange:O=>{S(O,q,R,o,h,!0)},...Q}),e.jsx(It,{onChange:O=>{S(O,R,q,h,o,!1)},...v}),F&&(t!=null&&t.isFrozen)?e.jsx(Zt,{blockSize:"large"}):null]}),e.jsx(ni,{poolType:"clmm",value:x,loading:!x&&a,options:i,disabled:m,isShowSelect:!(t!=null&&t.isFrozen),onChange:O=>{O!=null&&O.poolAddress?s(`/clmm?poolAddress=${O==null?void 0:O.poolAddress}`):(M(O),ae())}}),!F&&(t!=null&&t.isFrozen)?e.jsx(Zt,{blockSize:"large"}):null]}),H&&e.jsx(Fi,{apiPoolInfo:t,totalTvl:T,apiPoolInfoLoading:a,tvlLoading:z})]}),H?e.jsxs(e.Fragment,{children:[e.jsxs(Se,{w:"100%",flexDir:{base:"column",lg:"row"},justify:{base:"center",lg:"space-between"},align:{base:"flex-start",lg:"center"},minW:{base:"100%",lg:"1024px"},children:[e.jsx(Je,{type:"borderTab",tabList:k,currentTab:b,handleChangeTab:O=>{const ie=Object.keys(Qt).find(xe=>Qt[xe]===O.label);d&&s(`/clmm?tab=${ie}&poolAddress=${d}`),w(ie)},wrapStyle:{w:{base:"100%",lg:"auto"},justify:{base:"space-between",lg:"flex-start"},p:{base:"0px",lg:"0"},bg:{base:"transparent",lg:"transparent"},h:F?"60px":"58px",gap:{base:"8px",lg:"45px"},border:{base:"1px solid",lg:"none"},borderColor:{base:"transparent",lg:"transparent"},borderRadius:{base:"16px",lg:"unset"},mt:{base:"0px",lg:"12px"}},itemStyle:{fontSize:F?"14px":"16px",fontWeight:"500"}}),b==="deposit"&&!F&&e.jsx(ee,{mt:"24px",children:e.jsx(os,{slippageType:"liquidity",poolType:"clmm"})}),b!=="deposit"&&t&&e.jsxs(Se,{w:F?"100%":"auto",mt:{base:"4px",lg:"12px"},gap:"12px",flexDir:{base:"column",lg:"row"},justify:{base:"center",lg:"space-between"},align:{base:"flex-start",lg:"center"},children:[e.jsx(_,{children:"Current Price"}),e.jsx(ii,{noCenter:!!F,fromToken:t==null?void 0:t.displayTokenA,toToken:t==null?void 0:t.displayTokenB,fromValue:"1",toValue:Ce(t!=null&&t.isReverse?l==null?void 0:l.reverseCurrentPrice:l==null?void 0:l.currentPrice,6,!0).toString(),color:"text_caption",wrapStyle:F?{w:"100%"}:{},handlePageToggleDirect:()=>he(!re)})]})]}),e.jsx(ee,{h:{base:"20px",lg:"12px"}}),b==="deposit"&&e.jsx(Ci,{rangeTabList:y,getList:u,getPrice:r,currentFeeTier:x}),b==="positions"&&e.jsx(Li,{priceDirect:re}),b==="analytics"&&e.jsx(mi,{})]}):e.jsx(ee,{mt:"20px",children:!t&&a?e.jsx(Rt,{w:"100%",h:"480px",background:"bg_secondary",borderRadius:"12px",border:"1px solid",borderColor:"border",children:e.jsx(ns,{})}):e.jsx(Xe,{type:"custom",imgUrl:"/images/img_pool@2x.png",h:"480px",children:e.jsx(E,{children:q&&R?Ue(q,c)||Ue(R,c)?e.jsxs(e.Fragment,{children:[e.jsx(_,{h:"20px",lineHeight:"20px",fontSize:"14px",color:"text_caption",fontWeight:"500",children:"This Pool has not been initialized"}),e.jsx(_,{fontSize:"14px",children:"Do you want to initialize it?"}),e.jsx(Ae,{mt:"12px",w:"120px",h:"32px",borderRadius:"8px",colorScheme:"blue",fontSize:"14px",fontWeight:"500",onClick:()=>{V(),f()},children:"Initialized Pool"})]}):e.jsx(_,{h:"20px",lineHeight:"20px",fontSize:"14px",color:"text_caption",children:"No Liquidity Data"}):e.jsx(_,{h:"20px",lineHeight:"20px",fontSize:"14px",color:"text_caption",children:"Select the token you want to provide liquidity for."})})})})]}),(t==null?void 0:t.displayTokenA)&&(t==null?void 0:t.displayTokenB)&&e.jsx(ci,{tokensInfo:p,waringModalCancel:O=>{s("/pools")}}),e.jsx(Ir,{title:"This Pool has not been initialized",subTitle:"Do you want to initialize it?",btnText:"Initialized Pool",isOpen:J,onClose:V,onConfirm:f})]})}export{Kc as default};
