import{r as B,j as s,V as O,T as _,m as Bt,H,B as nt,M as Ht,o as Wt,p as vt,$ as Et,a0 as Ot,q as Ft,t as Ut,w as ct,O as dt,Q as Vt,U as Kt,ab as $t,l as Gt}from"./vendor-CBmAETR3.js";import{bB as qt,c5 as Yt,b$ as Qt,d6 as Xt,bh as Jt,i as Zt,aM as Rt,d7 as kt,av as Pt,u as pt,B as mt,bo as Lt,t as Z,aO as ft,f as Tt,d as k,ai as P,A as Nt,ah as wt,d8 as ot,E as f,Z as J,h as It,d9 as ts,C as ss,I as ut,Q as yt,z as y,l as et,c8 as es,a2 as ls,M as is,V as ns,s as cs,p as os,e as ps,aj as as,be as gt,da as xs,ad as at,bJ as Dt,a8 as jt,aF as us,aq as gs}from"./index-ihcskjKt.js";import{T as hs}from"./cross-CbhIs7DK.js";import{b as ms}from"./config-DTm0VBgZ.js";import{A as ys}from"./index-C9gsxTUl.js";import{R as js}from"./RewardsBlock-CiciTiU-.js";import{H as xt}from"./HTextLabelBox-Cv1F2u1A.js";import{T as ht}from"./TooltipIcon-CBgjM1b2.js";import{C as Ts}from"./CheckBox-CkL01dAe.js";import{u as At}from"./index-CgYRIMgB.js";import{u as bs}from"./useTransaction-BEUdFaaa.js";import{u as rs}from"./useDocumentSize-BZINkChT.js";import{E as _s}from"./ErrorTips-D8Nv331n.js";import{u as Ss}from"./useTokenBalance-EOIPKTy-.js";import{s as Cs,o as Rs,l as ks,b as Ns}from"./last-CTTiHFcU.js";import{u as bt}from"./index-1SLshnYc.js";import{R as Ds,X as As,Y as rt}from"./YAxis-1VNgHXtM.js";import{C as Ms}from"./ComposedChart-2FKu6rZb.js";import{T as zs,p as Bs}from"./generateCategoricalChart-DzovH4HE.js";import{A as _t}from"./Area-Ch6FbRWU.js";import{a as Hs,u as Ws}from"./useGetDlmmContractPoolInfo-NnEy3AV5.js";import{B as vs}from"./BackButton-B9dAauAl.js";import"./index-Dq_SzPY7.js";import"./useTrack-Cu3it5QI.js";import"./v4-C6aID195.js";import"./useSigner-C1gsxlX5.js";import"./useTransactionModal-DhEdYJgg.js";import"./index-BgZD3vRA.js";import"./debounce-MPJy35Ge.js";import"./index-D8UqOC8m.js";import"./useAccountBalance-D7pkS3C9.js";import"./_defineProperty-BPanLZZj.js";import"./index-CPyR2bLz.js";import"./isBrowser-DgCPUZ4c.js";import"./Line-vNo3CyOS.js";import"./utils-GUDa3Y46.js";import"./useWrapPoolData-CzWcfmSl.js";import"./en_US-KAK2ZBDO-7b1QhAeP.js";import"./useGetDlmmPoolList-x-FGvX6E.js";import"./index-9vefoQ6F.js";import"./addDlmmLiquidity-CmH4aIaT.js";function Es(t,e){return Cs(Rs(t,e,qt),t+"")}function St(t){return Yt(t)&&Qt(t)}var Os=Es(function(t){var e=ks(t);return St(e)&&(e=void 0),Xt(Ns(t,1,St,!0),Jt(e))});const Fs=(t,e)=>({incentiveApiPoolInfo:void 0,setIncentiveApiPoolInfo:n=>{t(()=>({incentiveApiPoolInfo:n}))},incentiveContractPoolInfo:void 0,setIncentiveContractPoolInfo:n=>{t(()=>({incentiveContractPoolInfo:n}))},poolWhiteTokenList:[],setPoolWhiteTokenList:n=>{Rt.setItem(kt,n),t(()=>({poolWhiteTokenList:n}))},globalConfig:void 0,setGlobalConfig:n=>{t(()=>({globalConfig:n}))}}),L=Zt(Fs);Rt.getItem(kt).then(t=>{console.log("ðŸš€ ~ CommonContentTable.getItem<any> ~ data:",t),t!==null&&L.getState().setPoolWhiteTokenList(t)});function Us(){var l,o,r,h,R,j,a,D,u,i,S;const{incentiveApiPoolInfo:t}=L(),{getExplorerUrl:e}=Pt(),{isApp:n}=pt(),c=B.useMemo(()=>t!=null&&t.haveFarming||t!=null&&t.miningAprList&&(t==null?void 0:t.miningAprList.length)>0?"help":"text",[t]);return s.jsxs(O,{gap:{base:"8px",lg:"12px"},w:"100%",align:"flex-start",bg:"#1B1D21",borderRadius:"16px",p:{base:"16px 8px",lg:"32px"},children:[s.jsx(_,{color:"text_caption",fontSize:"16px",fontWeight:"500",children:"Pool Info"}),s.jsx(mt,{display:"flex",alignItems:"center",borderRadius:"12px",p:{base:"12px",lg:"12px 16px"},mt:"4px",children:s.jsx(Bt,{w:"100%",isLoaded:!!t,children:s.jsxs(H,{w:"100%",justify:"space-between",children:[s.jsxs(H,{children:[s.jsx(Lt,{coinACoinType:(l=t==null?void 0:t.displayTokenA)==null?void 0:l.coin_type,coinBCoinType:(o=t==null?void 0:t.displayTokenB)==null?void 0:o.coin_type,coinAIconUrl:(r=t==null?void 0:t.displayTokenA)==null?void 0:r.logo_url,coinBIconUrl:(h=t==null?void 0:t.displayTokenB)==null?void 0:h.logo_url,imageStyle:{w:n?"24px":"28px",h:n?"24px":"28px"},imgBoxStyle:{w:n?"24px":"28px",h:n?"24px":"28px"}}),s.jsxs(O,{align:"flex-start",gap:"0px",children:[n?s.jsx(_,{color:"text_caption",fontWeight:"500",lineHeight:{base:"16px",lg:"20px"},whiteSpace:"nowrap",children:Z(`${(R=t==null?void 0:t.displayTokenA)==null?void 0:R.symbol} - ${(j=t==null?void 0:t.displayTokenB)==null?void 0:j.symbol}`,12)}):s.jsxs(_,{color:"text_caption",fontWeight:"500",lineHeight:{base:"16px",lg:"20px"},whiteSpace:"nowrap",children:[Z((a=t==null?void 0:t.displayTokenA)==null?void 0:a.symbol,10)," - ",Z((D=t==null?void 0:t.displayTokenB)==null?void 0:D.symbol,10)]}),s.jsx(ft,{address:(t==null?void 0:t.poolAddress)||"",onClickLink:()=>window.open(e(t==null?void 0:t.poolAddress,"poolAddress"))})]})]}),s.jsxs(H,{children:[s.jsx(_,{color:"text_caption",fontWeight:"500",whiteSpace:"nowrap",children:t==null?void 0:t.feeDisplay}),s.jsx(nt,{h:"12px",w:"1px",bg:"border"}),s.jsxs(_,{color:"text_caption",fontWeight:"500",whiteSpace:"nowrap",children:[(u=ms)==null?void 0:u[t==null?void 0:t.fee]," bps"]})]})]})})}),(!(t!=null&&t.miningRewardList)||((i=t==null?void 0:t.miningRewardList)==null?void 0:i.length)===0)&&(!(t!=null&&t.farmsRewarderList)||((S=t==null?void 0:t.farmsRewarderList)==null?void 0:S.length)===0)?null:s.jsxs(H,{w:"100%",justify:"space-between",h:"20px",lineHeight:"20px",children:[s.jsx(_,{children:"Mining Rewards"}),s.jsx(nt,{children:s.jsx(js,{miningRewardList:t==null?void 0:t.miningRewardList,farmsRewarderList:t==null?void 0:t.farmsRewarderList,isParent:!1})})]}),s.jsxs(H,{w:"100%",justify:"space-between",h:"20px",lineHeight:"20px",children:[s.jsx(_,{children:"Pool APR"}),s.jsx(nt,{children:s.jsx(ys,{poolInfo:t,placement:n?"auto-start":"bottom",children:s.jsxs(H,{justify:"flex-end",align:"flex-end",gap:"4px",lineHeight:"14px",h:"14px",children:[s.jsxs(O,{gap:"1px",children:[s.jsx(_,{as:"span",fontSize:"14px",color:c=="help"?"primary":"text_caption",fontWeight:"500",cursor:c,children:(t==null?void 0:t.feeAndMiningAprDisplay)!==""?t==null?void 0:t.feeAndMiningAprDisplay:"--"}),c=="help"&&s.jsx(nt,{w:"100%",borderBottom:"1px dotted",borderColor:"primary"})]}),(t==null?void 0:t.haveFarming)&&s.jsxs(_,{fontSize:"12px",lineHeight:"12px",h:"12px",color:"primary",fontWeight:"500",children:["+",t==null?void 0:t.farmingAprDisplay]})]})})})]})]})}function Mt(){const t=Tt("dlmm");return{getAddIncentivePayload:(l,o)=>{console.log("ðŸš€ ~ getAddIncentivePayload ~ option:",l);const r=t==null?void 0:t.Reward.addRewardPayload(l,o);return console.log("ðŸš€ ~ getAddIncentivePayload ~ txf:",r),r},getInitIncentivePayload:(l,o)=>{console.log("ðŸš€ ~ getInitIncentivePayload ~ option:",l);const r=t==null?void 0:t.Reward.initRewardPayload(l,o);return console.log("ðŸš€ ~ getInitIncentivePayload ~ txf:",r),r},getRewardPeriodEmission:async(l,o,r)=>{try{return await t.Reward.getRewardPeriodEmission(l,o,r)}catch(h){console.error("getDlmmContractPoolInfo error:",h)}finally{}}}}function ds({totalAmount:t,rewardList:e,isOpen:n,onClose:c}){const l={fontSize:"14px"},{size:o}=rs(),r=(e==null?void 0:e.length)*209+((e==null?void 0:e.length)-1)*8>(o==null?void 0:o.h)-236?(o==null?void 0:o.h)-236:"unset",{incentiveContractPoolInfo:h,incentiveApiPoolInfo:R}=L(),[j,a]=B.useState(!1),{getInitIncentivePayload:D,getAddIncentivePayload:u}=Mt(),{signAndExecuteTransaction:i}=bs(),S=async()=>{var m,W,z,V,E;console.log("ðŸš€ ~ ConfirmModal ~ incentiveContractPoolInfo:",h),a(!0);try{let d=new hs;const w=((m=h==null?void 0:h.reward_manager)==null?void 0:m.rewards)||[];console.log("ðŸš€ ~ toAddIncentive ~ existingRewards:",w);const $=new Set(w.map(b=>J(b==null?void 0:b.reward_coin))),G=new Set;for(const b of e){const T=J((W=b==null?void 0:b.rewardCoin)==null?void 0:W.coin_type),A={pool_id:h==null?void 0:h.id,reward_coin_type:(z=b==null?void 0:b.rewardCoin)==null?void 0:z.coin_type,reward_amount:It(b==null?void 0:b.rewardNum,(V=b==null?void 0:b.rewardCoin)==null?void 0:V.decimals).toString(),end_time_seconds:Math.floor((b==null?void 0:b.endTime)/1e3),coin_type_a:h==null?void 0:h.coin_type_a,coin_type_b:h==null?void 0:h.coin_type_b,reward_coin_types:[(E=b==null?void 0:b.rewardCoin)==null?void 0:E.coin_type]};b!=null&&b.startIsNow||(A.start_time_seconds=Math.floor((b==null?void 0:b.startTime)/1e3)),!$.has(T)&&!G.has(T)&&(console.log("ðŸš€ ~ toAddIncentive ~ params:",A),d=D(A,d),G.add(T)),console.log("ðŸš€ ~ toAddIncentive ~ tx:",A,d),d=u(A,d)}console.log("ðŸš€ ~ toAddIncentive ~ tx:",JSON.stringify(d),d);const F=await i(d,{getShowInfo:b=>{const T={modalDescriptionText:"Add Incentives",toastTitleText:"Add Incentives"};return console.log("ðŸš€ ~ toAddIncentive ~ status:",b),T}});console.log("ðŸš€ ~ toAddIncentive ~ res:",F),F&&c()}catch(d){console.log("ðŸš€ ~ toAddIncentive ~ error:",d),a(!1)}finally{a(!1)}},{isApp:U}=pt();return s.jsxs(Ht,{autoFocus:!1,closeOnOverlayClick:!1,returnFocusOnClose:!1,isOpen:n,onClose:c,isCentered:!0,children:[s.jsx(Wt,{}),s.jsxs(vt,{children:[s.jsx(Et,{children:s.jsx(Ot,{fontWeight:"500",fontSize:"16px",ml:{base:"-4px",lg:"0"},children:"Add Incentives"})}),s.jsx(Ft,{}),s.jsxs(Ut,{p:{base:"0px 0px 16px !important",lg:"0  0px 16px !important"},children:[s.jsx(O,{w:"100%",p:{base:"0 12px",lg:"0 16px"},align:"flex-start",userSelect:"none",minH:"180px",h:r,overflow:"auto",children:e==null?void 0:e.map((m,W)=>{var V,E;const z=m!=null&&m.releaseRate?k(P((m==null?void 0:m.releaseRate)+"")).mul(86400).toString():"--";return s.jsxs(mt,{borderRadius:"16px",p:"16px",children:[s.jsxs(H,{w:"100%",justify:"space-between",borderBottom:"1px solid",borderColor:"border",pb:"16px",children:[s.jsx(Nt,{symbolFontSize:"16px",token:m==null?void 0:m.rewardCoin,imgBoxStyle:{w:U?"28px":"32px",h:U?"28px":"32px"}}),s.jsx(_,{fontSize:"20px",fontWeight:"500",color:"text_caption",children:m!=null&&m.rewardNum?wt(m==null?void 0:m.rewardNum):"--"})]}),s.jsxs(O,{mt:"16px",gap:"12px",children:[s.jsx(xt,{label:"Start Time (UTC)",isLoading:!1,labelStyle:l,value:m!=null&&m.startIsNow?"Now":ot((m==null?void 0:m.startTime)||0),valueStyle:l,wrapStyle:{h:"20px",lineHeight:"20px"}}),s.jsx(xt,{label:"End Time (UTC)",isLoading:!1,labelStyle:l,value:ot((m==null?void 0:m.endTime)||0),valueStyle:l,wrapStyle:{h:"20px",lineHeight:"20px"}}),s.jsx(xt,{label:"Vesting Period",isLoading:!1,labelStyle:l,value:lt(m==null?void 0:m.startTime,m==null?void 0:m.endTime),valueStyle:l,wrapStyle:{h:"20px",lineHeight:"20px"}}),s.jsxs(H,{w:"100%",justify:"space-between",h:"20px",lineHeight:"20px",children:[s.jsxs(H,{gap:"4px",children:[s.jsx(_,{children:"Emission Rate"}),s.jsx(ht,{tooltipCon:"Rewards emitted to the pool per day"})]}),s.jsxs(_,{color:"text_caption",children:[z?f(z,(V=m==null?void 0:m.rewardCoin)==null?void 0:V.decimal):"--"," ",Z((E=m==null?void 0:m.rewardCoin)==null?void 0:E.symbol,10)||""," per day"]})]})]})]},W)})}),s.jsxs(H,{p:{base:"16px 12px",lg:"16px"},w:"100%",justify:"space-between",children:[s.jsx(_,{children:"Total Amount"}),s.jsx(_,{children:t})]}),s.jsx(ct,{isDisabled:j,isLoading:j,m:{base:"0 12px",lg:"0 16px"},w:{base:"calc(100% - 24px)",lg:"calc(100% - 32px)"},h:"48px",fontSize:"18px",fontWeight:"500",onClick:S,children:"Confirm"})]})]})]})}const Vs=7*24*60*60*1e3;function Ks(){return{getIncentiveTimeOptions:async({maxIntervals:e,baseTime:n=new Date().getTime(),timeInterval:c=Vs})=>{const l=new Date,o=new Date(Date.UTC(l.getUTCFullYear(),l.getUTCMonth(),l.getUTCDate()-2,12,0,0,0)),r=Math.floor(o.getTime()/1e3),h=n+e*c,R=Math.floor((h-r*1e3)/c);try{const j=await ts(r,R,c);return console.log("ðŸš€ ~ getIncentiveTimeOptions ~ res:",j),j}catch(j){console.error("getDlmmContractPoolInfo error:",j)}finally{}}}}function Ct({title:t,rewardInfo:e,fieldKey:n,onSelect:c}){const l=t==="End Time",o=e==null?void 0:e[n],{getIncentiveTimeOptions:r}=Ks(),[h,R]=B.useState([]);B.useEffect(()=>{async function a(){if(l&&k((e==null?void 0:e.startTime)??0).lte(0))return;const D=l?26:2;try{const u=await r({maxIntervals:D,baseTime:l?e==null?void 0:e.startTime:new Date().getTime()}),i=l?u.slice(1):[Date.now()].concat(u);R(i)}catch(u){console.log("ðŸš€ ~ fetchTimeOptions ~ error:",u)}}a()},[l,e==null?void 0:e.startTime]);const j=B.useCallback(a=>l?e!=null&&e.startTime?k(a).minus(e.startTime).gte(60*60*1e3):!0:e!=null&&e.endTime?k(a).lte(k(e==null?void 0:e.endTime).minus(7*24*60*60*1e3)):!0,[l,e==null?void 0:e.startTime,e==null?void 0:e.endTime]);return s.jsx(ss,{showTooltip:l&&k((e==null?void 0:e.startTime)??0).lte(0),tooltip:s.jsx(_,{fontSize:"12px",children:"Select a start time to proceed."}),triggerStyle:{flex:1,w:"100%"},children:s.jsx(dt,{isLazy:!0,placement:"bottom-start",children:({onClose:a})=>s.jsxs(s.Fragment,{children:[s.jsx(Vt,{as:ct,variant:"outline",h:"66px",lineHeight:"66px",w:{base:"100%",lg:"100%"},isDisabled:l&&k((e==null?void 0:e.startTime)??0).lte(0),_disabled:{bg:"bg_secondary",cursor:"not-allowed"},_hover:{bg:"bg_secondary"},_active:{bg:"bg_secondary",borderColor:"token_active_border !important",boxShadow:"0px 0px 6px 0px #0067AD"},children:s.jsxs(O,{w:"100%",align:"flex-start",justify:"center",children:[o&&s.jsx(_,{fontSize:"12px",lineHeight:"12px",h:"12px",fontWeight:"500",children:l?"To (UTC)":"From (UTC)"}),s.jsxs(H,{w:"100%",justify:"space-between",children:[s.jsx(_,{color:o?"text_caption":"text_paragraph",lineHeight:"1",children:o?e!=null&&e.startIsNow&&!l?"Now":ot(o):`${t} (UTC)`}),s.jsx(ut,{xlinkHref:"#icon-canlender"})]})]})}),s.jsxs(Kt,{zIndex:9999,p:"8px 0",w:{base:"calc(100vw - 48px)",lg:"234px"},children:[s.jsx(O,{maxH:"200px",overflow:"auto",p:"0px 4px 0 4px",gap:"4px",children:h==null?void 0:h.map((D,u)=>{const i=j(D),S=u===0&&!l;return s.jsxs($t,{h:"32px",borderRadius:"8px",_hover:{bg:i?"primary_opacity.10":void 0},cursor:i?"pointer":"not-allowed",onClick:()=>{i&&(c(S?new Date().getTime():D,S),a())},children:[s.jsx(_,{mr:"4px",color:i?"text_caption":"text_paragraph",children:S?"Now":ot(D)}),S&&s.jsx(ht,{tooltipCon:"The reward will activate when the transaction is executed."})]},D)})}),s.jsx(H,{p:"8px 16px 2px",gap:"4px",children:s.jsx(_,{fontSize:"12px",w:"100%",textAlign:"left",children:"Times are in UTC"})})]})]})})})}function $s({whiteTokenList:t,index:e,rewardListLength:n,rewardInfo:c,deleteReward:l,updateReward:o,isLast:r}){var u,i;const{balanceInfo:h}=Ss(c==null?void 0:c.rewardCoin),{getTokenAmountValue:R}=yt(),{isApp:j}=pt(),a=[{label:"Total",value:"total"},{label:"Per Day",value:"perDay"}],D=S=>{o(e,"amountMode",S==null?void 0:S.value)};return s.jsxs(O,{w:"100%",align:"flex-start",pb:r?"4px":"16px",borderBottom:n==e+1?"none":"1px solid",borderColor:n&&n>1?"border":"transparent",children:[s.jsxs(H,{w:"100%",justify:"space-between",children:[s.jsxs(_,{color:"text_caption",h:"20px",lineHeight:"20px",children:["Reward ",e+1]}),n&&n>1&&s.jsx(ut,{w:"18px",h:"18px",xlinkHref:"#icon-icon_del",svgHover:"primary",onClick:()=>l(e)})]}),s.jsxs(H,{w:"100%",justify:"space-between",flexDir:{base:"column",lg:"row"},children:[s.jsx(Ct,{rewardInfo:c,title:"Start Time",fieldKey:"startTime",onSelect:(S,U)=>o(e,"startTime",S,U)}),s.jsx(Ct,{rewardInfo:c,title:"End Time",fieldKey:"endTime",onSelect:S=>o(e,"endTime",S)})]}),s.jsx(es,{title:"Input Amount",value:(c==null?void 0:c.inputNum)||"",onChange:S=>o(e,"inputNum",S),token:c==null?void 0:c.rewardCoin,placeholder:"0.0",balance:(h==null?void 0:h.balanceFormat)||"",amountValue:R((u=c==null?void 0:c.rewardCoin)==null?void 0:u.coin_type,c==null?void 0:c.inputNum),selectable:!0,onTokenChange:S=>o(e,"rewardCoin",S),wrapStyle:{height:"122px"},whiteTokenList:t,isShowTokenListTab:!1,isShowLabelTab:!1,isShowHotList:!1,isShowOperate:!1,isShowTokenName:!1,showSearchInput:!1,inputTabOptions:{type:"outlineTab",tabList:a,currentTab:(c==null?void 0:c.amountMode)=="total"?"Total":"Per Day",handleChangeTab:S=>{D(S)},wrapStyle:{w:"168px",h:"28px",p:"3px",borderRadius:"10px"},itemStyle:{flex:"1",fontSize:"12px",margin:"0px",borderRadius:"6px"}}}),(c==null?void 0:c.startTime)&&(c==null?void 0:c.endTime)&&(c==null?void 0:c.rewardNum)&&y(c==null?void 0:c.rewardNum).gt(0)&&et(c==null?void 0:c.rewardCoin)&&y(P((c==null?void 0:c.releaseRate)+"")).lt(y(1).div(y(10).pow((i=c==null?void 0:c.rewardCoin)==null?void 0:i.decimals)))&&s.jsx(_s,{type:"error",tipsFontSize:"12px",tipsLineHeight:"16px",tips:"The reward rate is too low. Try shortening the epoch duration or increasing the reward amount"}),j&&s.jsx(zt,{rewardInfo:c})]})}function Gs({rewardList:t,changeRewardList:e}){const{incentiveApiPoolInfo:n,setIncentiveApiPoolInfo:c,poolWhiteTokenList:l,globalConfig:o}=L(),[r,h]=B.useState(!1),[R,j]=B.useState(!1),[a,D]=B.useState(!1),{tokenBalanceObj:u}=ls(),{currentAccount:i,onWalletModal:S}=is(),[U,m]=B.useState([]);B.useEffect(()=>{!a&&(n!=null&&n.displayTokenA)&&(e([{startTime:0,endTime:0,rewardCoin:n.displayTokenA,rewardNum:"",inputNum:"",releaseRate:"",startIsNow:!1,amountMode:"total"}]),D(!0))},[n,a]);const W=(p,N,x,C=!1)=>{e(v=>v.map((M,Y)=>{var X;if(Y!==p)return M;let g={...M};if(N==="rewardCoin"?(g.rewardCoin=x,g.rewardNum="",g.inputNum="",g.releaseRate=""):N==="startTime"?(g.startIsNow=C,g.startTime=x):g[N]=x,g!=null&&g.startTime&&(g!=null&&g.endTime)){const st=lt(g==null?void 0:g.startTime,g==null?void 0:g.endTime,"seconds");g.amountMode==="perDay"&&st&&g.inputNum?(g.rewardNum=f(k(g.inputNum).div(24*60*60).mul(st).toString(),(X=g==null?void 0:g.rewardCoin)==null?void 0:X.decimals,!0),g.releaseRate=g.inputNum?k(g.inputNum||0).div(24*60*60).toString():"--"):(g.rewardNum=g.inputNum,g.releaseRate=st?k(g.rewardNum||0).div(st).toString():"--")}return g}))};At(()=>{e(p=>p==null?void 0:p.map(N=>{var C;let x={...N};if(x!=null&&x.startIsNow&&(x!=null&&x.startTime)&&(x!=null&&x.endTime)){const v=new Date().getTime();x.startTime=v;const M=lt(x==null?void 0:x.startTime,x==null?void 0:x.endTime,"seconds");console.log("ðŸš€ ~ prev.map ~ duration:",x.rewardNum,M),x.amountMode==="perDay"&&M&&x.inputNum?(x.rewardNum=f(k(x.inputNum).div(24*60*60).mul(M).toString(),(C=x==null?void 0:x.rewardCoin)==null?void 0:C.decimals,!0),x.releaseRate=x.inputNum?k(x.inputNum||0).div(24*60*60).toString():"--"):(x.rewardNum=x.inputNum,x.releaseRate=M?k(x.rewardNum||0).div(M).toString():"--")}return x}))},60*1e3);const z=()=>({startTime:"",endTime:"",rewardCoin:void 0,rewardNum:"",inputNum:"",releaseRate:"",startIsNow:!1,amountMode:"total"}),V=()=>{n!=null&&n.displayTokenA&&e(p=>[...p,z()])},E=p=>{e(N=>N.filter((x,C)=>C!==p))},d=B.useMemo(()=>{if(!et(u))return!0;const p={};for(const N of t){const{rewardCoin:x,rewardNum:C}=N;if(!(x!=null&&x.coin_type)||!C)continue;const v=ns(x.coin_type).full_address;p[v]||(p[v]={total:k(0),decimals:x.decimals??9}),p[v].total=p[v].total.plus(C)}return Object.entries(p).some(([N,{total:x,decimals:C}])=>{const v=u[N];return v?x.gt(cs(v.totalBalance,C)):!0})},[t,u]),w=B.useMemo(()=>t.length>0&&t.every(p=>(p==null?void 0:p.startTime)&&(p==null?void 0:p.endTime)&&(p==null?void 0:p.rewardCoin)&&k(p==null?void 0:p.rewardNum).gt(0)&&(p==null?void 0:p.releaseRate)!==0),[t]),$=B.useMemo(()=>o&&(o!=null&&o.non_manager_initialize_reward_cap)&&!isNaN(o==null?void 0:o.non_manager_initialize_reward_cap)?o==null?void 0:o.non_manager_initialize_reward_cap:4,[o]),{getTokenAmountValue:G,fetchTokenPrices:F}=yt(),b=B.useMemo(()=>{const p=t.reduce((N,x)=>{var v;const C=G((v=x==null?void 0:x.rewardCoin)==null?void 0:v.coin_type,x==null?void 0:x.rewardNum);return N.plus(C)},k(0));return os(p.toString(),2)},[t]);B.useEffect(()=>{const p=Array.from(new Set(t.map(N=>{var x;return(x=N==null?void 0:N.rewardCoin)==null?void 0:x.coin_type}).filter(Boolean)));F(p)},[t]);const{getTokenInfo:T}=ps(),[A,K]=B.useState([]),q=async p=>{if(!p)return null;try{return await T(p)}catch(N){return console.error("Error fetching token info:",p,N),null}},I=async()=>{var p,N,x;try{const C=(p=n==null?void 0:n.miningRewardList)==null?void 0:p.map(g=>g==null?void 0:g.coinType);let v=[];C&&C.length>0&&(v=await Promise.all(C==null?void 0:C.map(q)),v&&v.length>0&&m(v==null?void 0:v.map(g=>J((g==null?void 0:g.coinType)||(g==null?void 0:g.coin_type)||""))));let M=[];if(k((N=n==null?void 0:n.miningRewardList)==null?void 0:N.length).gte($)&&(M=v),k((x=n==null?void 0:n.miningRewardList)==null?void 0:x.length).lt($)){const g=!l||l.length===0?[]:await Promise.all(l.map(q));M=[n==null?void 0:n.displayTokenA,n==null?void 0:n.displayTokenB,...g].filter(Boolean),M=Os(M==null?void 0:M.concat(v),X=>X==null?void 0:X.coin_type)}const Y=Array.from(new Map(M.map(g=>[g.coin_type,g])).values());console.log("ðŸš€ uniqueTokens:",Y),K(Y)}catch(C){console.error("Failed to fetch token list:",C)}};as(()=>{console.log("ðŸš€ ~ RewardTokenAndDuration ~ poolWhiteTokenList:",n,l),et(n)&&I()},[l,n,$]);const tt=B.useMemo(()=>t==null?void 0:t.some(p=>{var N;return(p==null?void 0:p.startTime)&&(p==null?void 0:p.endTime)&&(p==null?void 0:p.rewardNum)&&k(p==null?void 0:p.rewardNum).gt(0)&&et(p==null?void 0:p.rewardCoin)&&k(P((p==null?void 0:p.releaseRate)+"")).lt(k(1).div(k(10).pow((N=p==null?void 0:p.rewardCoin)==null?void 0:N.decimals)))}),[t]),{isApp:it}=pt(),Q=B.useMemo(()=>(A==null?void 0:A.length)>=$+1?$+1:(A==null?void 0:A.length)>=$?$:A==null?void 0:A.length,[$,A==null?void 0:A.length]);return s.jsxs(O,{w:"100%",align:"flex-start",bg:"#1B1D21",borderRadius:"16px",p:{base:"16px 8px",lg:"32px"},children:[s.jsxs(H,{w:"100%",justify:"space-between",children:[s.jsxs(O,{align:"flex-start",children:[s.jsx(_,{color:"text_caption",fontSize:"16px",fontWeight:"500",children:"Add Incentives"}),s.jsx(_,{fontSize:"12px",lineHeight:"16px",children:"Any users can allocate extra incentives to a DLMM pool"})]}),!it&&s.jsxs(ct,{onClick:V,borderRadius:"8px",p:{base:"0 8px",lg:"0 12px"},h:"36px",fontWeight:"500",variant:"outline",bg:"primary_opacity.10",fontSize:"12px",borderColor:"transparent",isDisabled:(t==null?void 0:t.length)>=Q,children:[s.jsx(ut,{svgW:"20px",svgH:"20px",w:"20px",h:"20px",xlinkHref:"#icon-icon_add",svgFill:(t==null?void 0:t.length)>=Q?"primary_gray":"primary",svgHover:(t==null?void 0:t.length)>=Q?"primary_gray":"primary"}),"Add Reward"]})]}),s.jsxs(O,{w:"100%",align:"flex-start",mt:"8px",gap:"16px",children:[t==null?void 0:t.map((p,N)=>{var x;return s.jsx($s,{index:N,isLast:N===(t==null?void 0:t.length)-1,rewardListLength:t==null?void 0:t.length,rewardInfo:p,deleteReward:E,updateReward:W,whiteTokenList:A==null?void 0:A.map(C=>{var v;return{...C,isDisabled:(v=t==null?void 0:t.filter(M=>{var Y,g;return((Y=M==null?void 0:M.rewardCoin)==null?void 0:Y.coinType)||((g=M==null?void 0:M.rewardCoin)==null?void 0:g.coin_type)}))==null?void 0:v.some(M=>{var Y,g,X,st;return J(((Y=M==null?void 0:M.rewardCoin)==null?void 0:Y.coinType)||((g=M==null?void 0:M.rewardCoin)==null?void 0:g.coin_type)||"")===J((C==null?void 0:C.coinType)||(C==null?void 0:C.coin_type)||"")&&J(((X=p==null?void 0:p.rewardCoin)==null?void 0:X.coinType)||((st=p==null?void 0:p.rewardCoin)==null?void 0:st.coin_type)||"")!==J((C==null?void 0:C.coinType)||(C==null?void 0:C.coin_type)||"")})}})},((x=p==null?void 0:p.rewardCoin)==null?void 0:x.coin_type)??N)}),it&&s.jsxs(ct,{w:"100%",onClick:V,borderRadius:"8px",p:{base:"0 8px",lg:"0 12px"},h:"36px",fontWeight:"500",variant:"outline",bg:"transparent",fontSize:"12px",borderColor:"primary_opacity.30 !important",border:"1px dashed",isDisabled:(t==null?void 0:t.length)>=Q,mt:{base:"-10px",lg:"-28px"},mb:"8px",children:[s.jsx(ut,{bg:"primary_opacity.10",mr:"4px",borderRadius:"50%",svgW:"20px",svgH:"20px",w:"20px",h:"20px",xlinkHref:"#icon-icon_add",svgFill:(t==null?void 0:t.length)>=Q?"primary_gray":"primary",svgHover:(t==null?void 0:t.length)>=Q?"primary_gray":"primary"}),"Add Reward"]})]}),s.jsxs(H,{align:"flex-start",bg:"primary_opacity.10",borderRadius:"8px",width:"100%",p:"12px",mb:"4px",sx:{div:{svg:{fill:"#000 !important",w:"16px",h:"16px"}}},cursor:"pointer",onClick:()=>h(!r),children:[s.jsx(Ts,{height:"16px",width:"16px",wrapStyle:{border:"1px solid",borderColor:r?"transparent":"primary",bg:r?"primary":"transparent"},checked:r,onClick:()=>{}}),s.jsx(_,{userSelect:"none",lineHeight:"16px",w:"calc(100% - 24px)",fontSize:"12px",color:"primary",children:"I acknowledge that once incentives are added, they can NOT be withdrawn under any circumstances"})]}),s.jsx(ct,{w:"100%",fontWeight:"500",height:"48px",isDisabled:i!=null&&i.address?!w||!r||d||tt:!1,onClick:i!=null&&i.address?()=>j(!0):()=>{S(!0)},children:i!=null&&i.address?d?"Insufficient Balance":"Incentivize":"Connect Wallet"}),s.jsxs(H,{w:"100%",justify:"space-between",mt:"12px",children:[s.jsx(_,{children:"Total Amount"}),s.jsx(_,{children:b})]}),R&&s.jsx(ds,{totalAmount:b,rewardList:t,isOpen:R,onClose:()=>j(!1)})]})}function lt(t,e,n){if(!t||!e)return n?void 0:"";const c=gt(t),l=gt(e);if(n)return console.log("ðŸš€ ~ formatEpoch ~ end.diff(start, returnType, true).toFixed(4):",l.diff(c,n,!0).toFixed(4)),l.diff(c,n,!0).toFixed(4);const o=l.diff(c,"hour"),r=Math.floor(o/24),h=o%24,R=r>0?`${r} day${r>1?"s":""}`:"",j=h>0?`${h} hour${h>1?"s":""}`:"";return[R,j].filter(Boolean).join(" ")}const qs=({rewardInfo:t})=>{const{incentiveContractPoolInfo:e,incentiveApiPoolInfo:n}=L(),{getRewardPeriodEmission:c}=Mt(),{getTokenAmountValue:l}=yt(),[o,r]=B.useState([]);B.useEffect(()=>{et(e)&&h(e,t)},[e,t]);const h=async(u,i)=>{var S,U,m,W,z;if(n!=null&&n.tvl){const V=(U=(S=u==null?void 0:u.reward_manager)==null?void 0:S.rewards)==null?void 0:U.filter(F=>{var b;return J(F==null?void 0:F.reward_coin)==J(((b=i==null?void 0:i.rewardCoin)==null?void 0:b.coin_type)||"")});let E;const d=Math.floor((i==null?void 0:i.startTime)/1e3),w=Math.floor((i==null?void 0:i.endTime)/1e3),$=60*60*24,G=V==null?void 0:V[0];if(console.log(G,V,n,u,"incentiveApiPoolInfo"),G){const F=await c((m=G==null?void 0:G.period_emission_rates)==null?void 0:m.id,G==null?void 0:G.emissions_per_second,(W=u==null?void 0:u.reward_manager)==null?void 0:W.last_updated_time),b=xs(F??[],d,w,$);if(E=b==null?void 0:b.map(T=>{var K,q,I,tt;const A=l((K=i==null?void 0:i.rewardCoin)==null?void 0:K.coin_type,y(T==null?void 0:T.emissions_per_second).div(y(10).pow((q=i==null?void 0:i.rewardCoin)==null?void 0:q.decimals)).mul(31536e3).toString()||"0");return{date:gt(y(T==null?void 0:T.time).mul(1e3).toNumber()).format("MM/DD"),time:T==null?void 0:T.time,visualized_time:T==null?void 0:T.visualized_time,Current:y(T==null?void 0:T.emissions_per_second).div(y(10).pow((I=i==null?void 0:i.rewardCoin)==null?void 0:I.decimals)).mul(60*60).toString(),preApr:((tt=i==null?void 0:i.rewardCoin)==null?void 0:tt.is_trusted)===!1&&y(A).lte(0)?"--":y(A).div(n==null?void 0:n.tvl).mul(100).toString()}}),y(P(i==null?void 0:i.releaseRate)??"0").gt(0)){const T=y(P(i==null?void 0:i.releaseRate)).mul(y(10).pow((z=i==null?void 0:i.rewardCoin)==null?void 0:z.decimals)).toString(),A=b==null?void 0:b.map(K=>({...K,emissions_per_second:y(K==null?void 0:K.emissions_per_second).plus(T).toString()}));E&&(E==null?void 0:E.length)>0&&(E=E==null?void 0:E.map((K,q)=>{var tt,it,Q,p,N,x;const I=l((tt=i==null?void 0:i.rewardCoin)==null?void 0:tt.coin_type,y((it=A[q])==null?void 0:it.emissions_per_second).div(y(10).pow((Q=i==null?void 0:i.rewardCoin)==null?void 0:Q.decimals)).mul(31536e3).toString()||"0");return{...K,"After Update":y((p=A[q])==null?void 0:p.emissions_per_second).div(y(10).pow((N=i==null?void 0:i.rewardCoin)==null?void 0:N.decimals)).mul(60*60).toString(),afterApr:((x=i==null?void 0:i.rewardCoin)==null?void 0:x.is_trusted)===!1&&y(I).lte(0)?"--":y(I).div(n==null?void 0:n.tvl).mul(100).toString()}}))}E&&r(E)}else{const F=[],b=y(P(i==null?void 0:i.releaseRate)).toString();for(let T=d;T<=w;T+=$)F.push({time:T.toString(),emissions_per_hour:y(b).mul(60*60).toString(),visualized_time:new Date(T*1e3).toLocaleString()});(F==null?void 0:F.length)>0&&(E=F==null?void 0:F.map(T=>{var K,q;const A=l((K=i==null?void 0:i.rewardCoin)==null?void 0:K.coin_type,y(T==null?void 0:T.emissions_per_hour).mul(8760).toString()||"0");return{date:gt(y(T==null?void 0:T.time).mul(1e3).toNumber()).format("MM/DD"),time:T==null?void 0:T.time,visualized_time:T==null?void 0:T.visualized_time,"After Update":T==null?void 0:T.emissions_per_hour,afterApr:((q=i==null?void 0:i.rewardCoin)==null?void 0:q.is_trusted)===!1&&y(A).lte(0)?"--":y(A).div(n==null?void 0:n.tvl).mul(100).toString()}}),r(E))}}},R=o==null?void 0:o.some(u=>(u==null?void 0:u.Current)&&y(u==null?void 0:u.Current).gt(0)),j=B.useMemo(()=>{if(o.length){const u=y(at.min(...o.map(W=>(W==null?void 0:W.Current)??(W==null?void 0:W["After Update"])??0))).mul(.95).toString(),i=y(at.max(...o.map(W=>(W==null?void 0:W["After Update"])??0))).mul(1.05).toString(),S=y(i),U=y(u),m=S.sub(U).div(3);return Array.from({length:4},(W,z)=>U.add(m.mul(z)).toNumber())}return[]},[o]),a=B.useMemo(()=>{const u=o.filter(i=>(i==null?void 0:i.preApr)!=="--"&&(i==null?void 0:i.afterApr)!=="--");if(u.length){const i=y(at.min(...u==null?void 0:u.map(z=>(z==null?void 0:z.preApr)??(z==null?void 0:z.afterApr)??0))).mul(.95).toString(),S=y(at.max(...u==null?void 0:u.map(z=>(z==null?void 0:z.afterApr)??0))).mul(1.05).toString(),U=y(S),m=y(i),W=U.sub(m).div(3);return Array.from({length:4},(z,V)=>m.add(W.mul(V)).toNumber())}return[]},[o]);bt(document==null?void 0:document.querySelector(".recharts-tooltip-wrapper"));const D=B.useRef(null);return bt(D),(o==null?void 0:o.length)>0&&s.jsxs(O,{gap:"0px",w:"100%",align:"flex-start",p:"0 16px 12px",children:[s.jsx(_,{lineHeight:"20px",w:"100%",color:"text_caption",fontWeight:"500",m:"0px 0px 16px",borderTop:"1px dotted",borderColor:"border",pt:"16px",children:"Rewards Preview"}),s.jsx(Ds,{width:"100%",height:145,ref:D,children:s.jsxs(Ms,{data:o,margin:{top:0,left:0,right:0,bottom:0},children:[s.jsx("defs",{children:s.jsx("pattern",{id:"diagonalHatch",patternUnits:"userSpaceOnUse",width:"6",height:"6",patternTransform:"rotate(45)",children:s.jsx("line",{x1:"0",y1:"0",x2:"0",y2:"6",stroke:"#00D8B6",strokeWidth:"1.5"})})}),s.jsx(As,{dataKey:"date",fontSize:12,axisLine:!1,tickLine:!1,interval:o==null?void 0:o.length,tick:u=>s.jsx(Xs,{...u,length:o==null?void 0:o.length,label:lt(t==null?void 0:t.startTime,t==null?void 0:t.endTime)||"--"})}),s.jsx(rt,{width:40,yAxisId:"left",dataKey:"After Update",stroke:"#909CA4",fontSize:12,axisLine:!1,tickLine:!1,ticks:j,domain:[j[0],j[j.length-1]],tickFormatter:u=>Ys(u)}),s.jsx(rt,{yAxisId:"right",orientation:"right",dataKey:"afterApr",fontSize:12,width:58,ticks:a,domain:[a[0],a[a.length-1]],axisLine:!1,tickLine:!1,stroke:"#909CA4",tickFormatter:u=>u==="--"?"":Qs(u)+"%"}),s.jsx(zs,{offset:4,allowEscapeViewBox:{y:!0},wrapperStyle:{zIndex:100},content:s.jsx(Js,{rewardInfo:t})}),s.jsx(Bs,{wrapperStyle:{fontSize:12,color:"#909CA4",top:-33,right:-10},verticalAlign:"top",align:"right"}),s.jsx(_t,{yAxisId:"left",type:"monotone",dataKey:"After Update",stroke:"#00D8B6",fill:"url(#diagonalHatch)"}),R&&s.jsx(_t,{yAxisId:"left",type:"monotone",dataKey:"Current",stroke:"#4A9AEF",fillOpacity:1,fill:"#0F0F0F"})]})})]})},Ys=t=>y(t).gt(1e8)?">100M":y(t).gt(1)&&y(t).lt(1e3)?Math.floor(Number(t))+"":y(t).gt(.01)&&y(t).lt(1)?f(t,2):y(t).gte(1e3)?Dt(t,0):y(t).gt(0)&&y(t).lt(.01)?"<0.01":"0",Qs=t=>y(t).gt(1e8)?">100M":y(t).gt(1)&&y(t).lt(1e3)?Math.floor(Number(t))+"":y(t).gt(.01)&&y(t).lt(1)?f(t,2):y(t).gte(1e3)?Dt(t,0):y(t).gt(0)&&y(t).lt(.01)?"<0.01":"0",Xs=({x:t,y:e,width:n,height:c,payload:l,label:o,length:r,...h})=>{var j;const R=(j=o==null?void 0:o.split(" "))==null?void 0:j.length;return s.jsx("g",{transform:`translate(${t},${e})`,children:s.jsx("text",{x:t+(R>2?48:70),y:8,fill:"#909CA4",fontSize:12,fontFamily:"Inter",children:o})})},Js=({payload:t,rewardInfo:e})=>{var n,c;return t&&t.length&&s.jsx(mt,{borderRadius:"12px",p:"8px",children:s.jsxs(O,{alignItems:"left",children:[s.jsx(_,{fontSize:"12px",children:ot(Number((c=(n=t[0])==null?void 0:n.payload)==null?void 0:c.time)*1e3)+" (UTC)"}),t==null?void 0:t.map(l=>{var o,r,h,R,j,a,D,u;return s.jsxs(O,{align:"flex-start",bg:"#1B1D21",borderRadius:"8px",p:"8px",children:[s.jsx(_,{fontSize:"12px",color:l.color,children:l==null?void 0:l.dataKey}),s.jsxs(H,{w:"100%",gap:"16px",justify:"space-between",children:[s.jsxs(O,{align:"flex-start",children:[s.jsx(_,{fontSize:"12px",children:"Emission Rate"}),s.jsxs(_,{fontSize:"12px",children:[Z((o=e==null?void 0:e.rewardCoin)==null?void 0:o.symbol,10)||""," Reward APR"]})]}),s.jsxs(O,{align:"flex-end",children:[s.jsxs(_,{fontSize:"12px",color:"text_caption",as:"span",textAlign:"right",children:[f(l==null?void 0:l.payload[l==null?void 0:l.dataKey],2),s.jsxs(_,{fontSize:"12px",as:"span",ml:"4px",textAlign:"right",children:[Z((r=e==null?void 0:e.rewardCoin)==null?void 0:r.symbol,10)||""," per hour"]})]}),s.jsx(_,{fontSize:"12px",color:"text_caption",children:(l==null?void 0:l.name)==="After Update"?((h=l==null?void 0:l.payload)==null?void 0:h.afterApr)==="Infinity"||((R=l==null?void 0:l.payload)==null?void 0:R.afterApr)==="--"?"--":jt((j=l==null?void 0:l.payload)==null?void 0:j.afterApr):((a=l==null?void 0:l.payload)==null?void 0:a.preApr)==="Infinity"||((D=l==null?void 0:l.payload)==null?void 0:D.preApr)==="--"?"--":jt((u=l==null?void 0:l.payload)==null?void 0:u.preApr)})]})]})]},l==null?void 0:l.dataKey)})]})})};function Zs({rewardList:t}){return s.jsxs(O,{gap:"16px",w:"100%",maxW:"460px",align:"flex-start",bg:"#1B1D21",borderRadius:"16px",p:{base:"16px 8px",lg:"32px"},children:[s.jsx(_,{color:"text_caption",fontSize:"16px",fontWeight:"500",children:"Release Info"}),s.jsx(O,{w:"100%",children:(t==null?void 0:t.length)>0&&(t==null?void 0:t.map((e,n)=>{var c;return s.jsx(zt,{rewardInfo:e},((c=e==null?void 0:e.rewardCoin)==null?void 0:c.coin_type)||n)}))})]})}const zt=({rewardInfo:t})=>{var j,a,D,u,i,S,U,m;const{getTokenAmountValue:e,fetchTokenPrices:n}=yt(),{incentiveApiPoolInfo:c}=L();B.useEffect(()=>{var W,z;((W=t==null?void 0:t.rewardCoin)==null?void 0:W.is_trusted)===!1&&n([(z=t==null?void 0:t.rewardCoin)==null?void 0:z.coin_type])},[(j=t==null?void 0:t.rewardCoin)==null?void 0:j.coin_type]);const l=e((a=t==null?void 0:t.rewardCoin)==null?void 0:a.coin_type,(t==null?void 0:t.rewardNum)||0),o=t!=null&&t.releaseRate?k(P((t==null?void 0:t.releaseRate)+"")).mul(24*60*60).toString():"--",r=t!=null&&t.startTime&&(t!=null&&t.endTime)?Number(lt(t.startTime,t.endTime,"day")):0,h=t!=null&&t.rewardNum&&r>0&&k((c==null?void 0:c.tvl)??0).gt(0)&&k(l).gt(0)?jt(k(l).div((c==null?void 0:c.tvl)??0).mul(k(365).div(r)).mul(100).toString()):"--";return(t==null?void 0:t.startTime)&&(t==null?void 0:t.endTime)&&(t==null?void 0:t.rewardNum)&&(t==null?void 0:t.releaseRate)&&et(t==null?void 0:t.rewardCoin)&&k(P((t==null?void 0:t.releaseRate)+"")).gte(k(1).div(k(10).pow((D=t==null?void 0:t.rewardCoin)==null?void 0:D.decimals)))?s.jsxs(mt,{borderRadius:"12px",p:"0",children:[s.jsxs(O,{p:"16px",w:"100%",gap:"12px",children:[s.jsx(H,{w:"100%",justify:"space-between",gap:"12px",children:s.jsx(Nt,{haveName:!1,token:t==null?void 0:t.rewardCoin})}),s.jsx(xt,{label:"Vesting Period",isLoading:!1,labelStyle:{fontSize:"14px",lineHeight:"20px",whiteSpace:"nowrap"},value:lt(t==null?void 0:t.startTime,t==null?void 0:t.endTime)||"--",valueStyle:{fontSize:"14px",lineHeight:"20px"}}),s.jsxs(H,{w:"100%",justify:"space-between",lineHeight:"18px",gap:"12px",children:[s.jsx(_,{whiteSpace:"nowrap",children:"Total allocation"}),s.jsxs(H,{gap:"2px",justify:"flex-end",flexWrap:"wrap",children:[s.jsx(_,{color:"text_caption",whiteSpace:"nowrap",children:t!=null&&t.rewardNum?f(t==null?void 0:t.rewardNum,(u=t==null?void 0:t.rewardCoin)==null?void 0:u.decimal):"--"}),s.jsx(_,{whiteSpace:"nowrap",children:Z((i=t==null?void 0:t.rewardCoin)==null?void 0:i.symbol,10)||""})]})]}),s.jsxs(H,{w:"100%",justify:"space-between",lineHeight:"18px",gap:"12px",children:[s.jsxs(H,{gap:"4px",children:[s.jsx(_,{whiteSpace:"nowrap",children:"Emission Rate"}),s.jsx(ht,{tooltipCon:"Rewards emitted to the pool per day"})]}),s.jsxs(H,{gap:"2px",justify:"flex-end",flexWrap:"wrap",children:[s.jsx(_,{color:"text_caption",whiteSpace:"nowrap",children:o?f(o,(S=t==null?void 0:t.rewardCoin)==null?void 0:S.decimal):"--"}),s.jsxs(_,{whiteSpace:"nowrap",children:[Z((U=t==null?void 0:t.rewardCoin)==null?void 0:U.symbol,10)||""," per day"]})]})]}),s.jsxs(H,{w:"100%",justify:"space-between",children:[s.jsxs(H,{gap:"4px",children:[s.jsxs(_,{children:[Z((m=t==null?void 0:t.rewardCoin)==null?void 0:m.symbol,10)||""," Reward APR"]}),s.jsx(ht,{tooltipCon:"Estimated APR increase from this incentive"})]}),s.jsx(_,{color:"text_caption",as:"span",textAlign:"right",children:h})]})]}),s.jsx(qs,{rewardInfo:t})]}):null};function Ps(){const{setPoolWhiteTokenList:t,setGlobalConfig:e}=L(),n=Tt("dlmm");return{getDlmmWhiteTokenList:async()=>{try{const l=await n.Config.getDlmmGlobalConfig();console.log("ðŸš€ ~ getDlmmWhiteTokenList ~ res:",l),e(l),t(l==null?void 0:l.reward_white_list)}catch(l){console.error("getDlmmContractPoolInfo error:",l)}finally{}}}}function Ls(){const t=Tt("dlmm"),{formatDlmmApiPoolByContractPool:e}=Hs(),{getDlmmPools:n}=Ws(),{setIncentiveApiPoolInfo:c,setIncentiveContractPoolInfo:l}=L(),o=async h=>{var j;if(!h)return;let R;try{const a=await n({pools:[h],display_all_pools:!0});R=(j=a==null?void 0:a.list)==null?void 0:j[0],R&&c(R)}catch(a){console.error("getIncentivePoolInfo error:",a)}await r(h,R)},r=async(h,R)=>{if(h)try{const j=await t.Pool.getPool(h),a={...j,...us(j),poolAddress:j==null?void 0:j.id};if(console.log("ðŸš€ ~ fetchContractPoolInfo ~ contractPool:",h,R,a),a&&(l(a),!(R!=null&&R.displayTokenA))){const D=await e(a);D&&c(D)}}catch(j){console.error("fetchContractPoolInfo error:",j)}};return{getIncentivePoolInfo:o}}function de(){const{poolAddress:t}=gs(),{getIncentivePoolInfo:e}=Ls(),{getDlmmWhiteTokenList:n}=Ps(),[c,l]=B.useState([{}]),{setIncentiveApiPoolInfo:o,setIncentiveContractPoolInfo:r}=L(),{isApp:h}=pt(),R=Gt();B.useEffect(()=>{console.log("ðŸš€ ~ Incentive ~ poolAddress:",t),t&&e(t)},[t]),At(()=>{n()},60*1e3);const j=c==null?void 0:c.some(a=>{var D;return(a==null?void 0:a.startTime)&&(a==null?void 0:a.endTime)&&(a==null?void 0:a.rewardNum)&&(a==null?void 0:a.releaseRate)&&et(a==null?void 0:a.rewardCoin)&&k(P((a==null?void 0:a.releaseRate)+"")).gte(k(1).div(k(10).pow((D=a==null?void 0:a.rewardCoin)==null?void 0:D.decimals)))});return B.useEffect(()=>()=>{o(void 0),r(void 0)},[]),s.jsxs(O,{w:{base:"100%",lg:j?"1016px":"540px"},align:"flex-start",mt:"20px",gap:"16px",children:[s.jsx(vs,{onClick:()=>R(`/dlmm?poolId=${t}`)}),s.jsxs(H,{flexDirection:{base:"column",lg:"row"},w:"100%",align:"flex-start",justify:j?"space-between":"center",children:[s.jsxs(O,{w:"100%",flex:{base:"0 0 1",lg:"0 0 540px"},children:[s.jsx(Us,{}),s.jsx(Gs,{rewardList:c,changeRewardList:a=>{l(a)}})]}),j&&!h&&s.jsx(nt,{flex:"0 0 460px",children:s.jsx(Zs,{rewardList:c})})]})]})}export{de as default};
//# sourceMappingURL=Incentive-xqHYZIVJ.js.map
