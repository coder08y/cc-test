{"version":3,"file":"useSwapHelper-CDwInMwe.js","sources":["../../src/types/swap.ts","../../src/store/swap/swapConfig.ts","../../src/hooks/common/useGetPoolListByCoinType.ts","../../src/hooks/swap/useSwapHelper.ts"],"sourcesContent":["import { Token } from '@cetus/types/src/common-types'\nimport { RouterData } from '@cetusprotocol/aggregator-sdk'\n\nexport enum AggregatorProvider {\n  CETUS = 'CETUS',\n  // DEEPBOOK = 'DEEPBOOK',\n  KRIYA = 'KRIYA',\n  KRIYAV3 = 'KRIYAV3',\n  FLOWX = 'FLOWX',\n  FLOWXV3 = 'FLOWXV3',\n  AFTERMATH = 'AFTERMATH',\n  METASTABLE = 'METASTABLE',\n  HAEDAL = 'HAEDAL',\n  VOLO = 'VOLO',\n  AFSUI = 'AFSUI',\n  DEEPBOOKV3 = 'DEEPBOOKV3',\n  SCALLOP = 'SCALLOP',\n  BLUEMOVE = 'BLUEMOVE',\n  TURBOS = 'TURBOS',\n  SPRINGSUI = 'SPRINGSUI',\n  BLUEFIN = 'BLUEFIN',\n  HAEDALPMM = 'HAEDALPMM',\n  ALPHAFI = 'ALPHAFI',\n  STEAMM = 'STEAMM',\n  STEAMM_OMM_V2 = 'STEAMM_OMM_V2',\n  OBRIC = 'OBRIC',\n  HAWAL = 'HAWAL',\n  MOMENTUM = 'MOMENTUM',\n  MAGMA = 'MAGMA',\n  SEVENK = 'SEVENK',\n  HAEDALHMMV2 = 'HAEDALHMMV2',\n  FULLSAIL = 'FULLSAIL',\n  CETUSDLMM = 'CETUSDLMM',\n  FERRACLMM = 'FERRACLMM',\n  FERRADLMM = 'FERRADLMM'\n}\n\nexport type AggregatorDex = {\n  name: string\n  id: AggregatorProvider | string\n  logo: string\n  type: string\n  sort: number\n  groupId?: string\n  subItems?: AggregatorDex[]\n}\n\nexport type SwapRouterData = {\n  routerData?: RouterData\n  fromAmountUi?: string\n  toAmountUi?: string\n  byAmountIn: boolean\n  isDegrade: boolean //是否是降级\n  uuid: string\n  errorCode?: AggregatorServerErrorCode\n}\n\nexport type SwapRfqData = {\n  rfqQuote: RfqQuote\n  fromAmountUi: string\n  toAmountUi: string\n  uuid: string\n  price: string\n}\n\nexport type SwapRouterFormat = {\n  router_summery: string\n  providers: AggregatorProvider[]\n  routers: {\n    percentage: string\n    paths: {\n      from_type: string\n      to_type: string\n      fee_rate: string\n      pool_address: string\n      provider: AggregatorProvider\n    }[]\n  }[]\n}\n\nexport enum AggregatorServerErrorCode {\n  CalculateError = 1000,\n  NumberTooLarge = 1001,\n  NoRouter = 1005,\n  InsufficientLiquidity = 1002,\n  HoneyPot = 1003\n}\n\nexport enum SwapWidgetStep {\n  TradeInputPage = 'TradeInput',\n  TradeStatus = 'TradeStatus',\n  SelectTokenPage = 'SelectToken',\n  TradeConfirmPage = 'TradeConfirm',\n  RoutePage = 'Route',\n  TradeSetting = 'TradeSetting',\n  SlippageSetting = 'SlippageSetting'\n}\n\nexport type TransactionMode = 'Default' | 'Fast Mode'\n\nexport interface RfqQuoteWidgetProps {\n  rfqData?: SwapRfqData\n  toCoin?: Token\n  fromCoin?: Token\n  isShowRfqWidget: boolean\n  findRouterLoading: boolean\n  rftCountdownFlagRef: React.MutableRefObject<number | undefined>\n  onTrade: (data: SwapRfqData) => void\n}\n\nexport type RfqQuote = {\n  id: string\n  from: string\n  target: string\n  mm: string\n  amount_in: string\n  amount_out: string\n  fee_amount: string\n  expired_at: string\n  total_countdown: number\n}\n\nexport type QuoteMode = 'rfq' | 'router'\n\nexport type RfqConfigs = {\n  enable: boolean\n  quote_limit: {\n    min: string\n    max: string\n  }\n  allow_paths: {\n    from: string\n    target: string\n  }[]\n}\n","import { AggregatorProvider, RfqConfigs } from '@/types/swap'\nimport { create, StateCreator } from 'zustand'\nimport { persist } from 'zustand/middleware'\n\ninterface SwapConfigState {\n  providersSwitchStates: Partial<Record<AggregatorProvider, boolean>>\n  setProvidersSwitchStates: (provider: Partial<Record<AggregatorProvider, boolean>>) => void\n  supportOrderSplit: boolean\n  setSupportOrderSplit: (value: boolean) => void\n\n  // RFQ 开关是否打开（用户选择）\n  isOpenRfqSwitch: boolean\n  setIsOpenRfqSwitch: (value: boolean) => void\n\n  // RFQ 配置\n  rfqConfigs?: RfqConfigs\n  setRfqConfigs: (value: RfqConfigs) => void\n}\n\nconst store: StateCreator<SwapConfigState> = (set, get) => ({\n  providersSwitchStates: {\n    [AggregatorProvider.CETUS]: true\n  },\n  setProvidersSwitchStates: (provider: Partial<Record<AggregatorProvider, boolean>>) => {\n    const providersSwitchStates = get().providersSwitchStates\n    set(() => ({\n      providersSwitchStates: { ...providersSwitchStates, ...provider }\n    }))\n  },\n  supportOrderSplit: true,\n  setSupportOrderSplit: (value: boolean) => {\n    set(() => ({\n      supportOrderSplit: value\n    }))\n  },\n  isOpenRfqSwitch: true,\n  setIsOpenRfqSwitch: (value: boolean) => {\n    set(() => ({\n      isOpenRfqSwitch: value\n    }))\n  },\n  rfqConfigs: undefined,\n  setRfqConfigs: (value: RfqConfigs) => {\n    set(() => ({\n      rfqConfigs: value\n    }))\n  }\n})\n\nconst useSwapConfigStore = create(persist(store, { name: 'useSwapConfigStore' }))\nexport default useSwapConfigStore\n","import useGlobalStore from '@/store/common/global'\nimport { GetPoolListParams } from '../pool/type'\nimport useGetPoolList from '../pool/useGetPoolList'\n\nexport function useGetPoolListByCoinType(useLocal: boolean = true) {\n  const { poolApiMap, setPoolApiMap } = useGlobalStore()\n  const { getPoolList, getLocalJsonPoolList, getLocalJsonPoolAddress } = useGetPoolList()\n\n  const getPoolListByCoinType = async (fromCoin: string, toCoin: string) => {\n    if (fromCoin && toCoin) {\n      const sortedTypes = [fromCoin, toCoin].sort()\n      const cacheKey = `${sortedTypes[0]}_${sortedTypes[1]}`\n      const cacheValue = poolApiMap[cacheKey]\n      if (cacheValue) {\n        return cacheValue\n      }\n      const params: GetPoolListParams = {\n        coin_type: `${fromCoin},${toCoin}`,\n        display_all_pools: true,\n        offset: 0,\n        limit: 100,\n        order_by: '-tvl',\n        no_incentives: true,\n        has_farming: true,\n        has_mining: true\n      }\n\n      let res = useLocal ? await getLocalJsonPoolList(params) : undefined\n\n      if (res === undefined || res.list.length === 0) {\n        res = await getPoolList(params)\n      }\n      const poolApiList = res.list\n      if (poolApiList.length > 0) {\n        poolApiMap[cacheKey] = poolApiList\n        setPoolApiMap(cacheKey, poolApiList)\n        return poolApiList\n      }\n    }\n\n    return []\n  }\n\n  const getPoolAddressByCoinType = async (fromCoin: string, toCoin: string) => {\n    if (fromCoin && toCoin) {\n      const sortedTypes = [fromCoin, toCoin].sort()\n      const cacheKey = `${sortedTypes[0]}_${sortedTypes[1]}`\n      if (useLocal) {\n        const localList = await getLocalJsonPoolAddress(fromCoin, toCoin)\n\n        if (!localList || localList.length === 0) {\n          const cacheValue = poolApiMap[cacheKey]\n          if (cacheValue) {\n            return cacheValue.map(pool => pool.poolAddress)\n          }\n        } else {\n          return localList\n        }\n      }\n\n      const params: GetPoolListParams = {\n        coin_type: `${fromCoin},${toCoin}`,\n        display_all_pools: true,\n        offset: 0,\n        limit: 100,\n        order_by: '-tvl',\n        no_incentives: true,\n        has_farming: true,\n        has_mining: true\n      }\n\n      const res = await getPoolList(params)\n      if (res) {\n        const poolApiList = res.list\n        if (poolApiList.length > 0) {\n          poolApiMap[cacheKey] = poolApiList\n          setPoolApiMap(cacheKey, poolApiList)\n          return poolApiList.map(pool => pool.poolAddress)\n        }\n      }\n    }\n\n    return []\n  }\n\n  return {\n    getPoolListByCoinType,\n    getPoolAddressByCoinType\n  }\n}\n","import useSwapConfigStore from '@/store/swap/swapConfig'\nimport { AggregatorProvider, SwapRfqData, SwapRouterData, SwapRouterFormat } from '@/types/swap'\nimport { useGetToken } from '@cetus/hooks/src/useToken'\nimport { CoinType, Token } from '@cetus/types'\nimport { d, extractStructTagFromType } from '@cetusprotocol/common-sdk'\nimport { useEffect, useMemo, useState } from 'react'\nimport { useGetPoolListByCoinType } from '../common/useGetPoolListByCoinType'\n\n/**\n * 获取展示PriceAccept RouterData\n * @param originData\n * @returns\n */\nexport function useGetPriceAcceptRouterData(originData?: SwapRouterData, newData?: SwapRouterData) {\n  const priceAcceptRouterData = useMemo(() => {\n    if (newData && originData) {\n      if (originData.byAmountIn) {\n        if (!d(originData.toAmountUi).eq(newData.toAmountUi || '0')) {\n          return newData\n        }\n      } else {\n        if (!d(originData.fromAmountUi).eq(newData.fromAmountUi || '0')) {\n          return newData\n        }\n      }\n\n      return undefined\n    }\n    return undefined\n  }, [newData, originData])\n\n  return { priceAcceptRouterData }\n}\n\n/**\n * 计算交易的amountLimit\n * @param slippage\n * @param routerData\n * @returns\n */\nexport function useGetAmountLimit(slippage: string | number, routerData?: SwapRouterData) {\n  const amountLimit = useMemo(() => {\n    if (routerData && routerData.routerData) {\n      const { byAmountIn, fromAmountUi, toAmountUi } = routerData\n      if (byAmountIn) {\n        return d(toAmountUi)\n          .mul(d(1).sub(d(slippage)))\n          .toString()\n      } else {\n        return d(fromAmountUi)\n          .mul(d(1).add(d(slippage)))\n          .toString()\n      }\n    }\n\n    return undefined\n  }, [slippage, routerData])\n\n  return { amountLimit }\n}\n\n/**\n * 对RouterData 进行格式化处理\n * @returns\n */\n\n// 20250812 hmmv2和hmm不需要在ui上做区分\nconst pathProviderMap: any = {\n  [AggregatorProvider.HAEDALHMMV2]: AggregatorProvider.HAEDALPMM\n}\nexport function useFormatSwapRouter(routerData?: SwapRouterData) {\n  const { fetchTokenInfo } = useGetToken()\n  const [formatSwapRouter, setFormatSwapRouter] = useState<any>({})\n  const toFormatSwapRouter = async () => {\n    if (routerData && routerData.routerData) {\n      const providers: string[] = []\n      const totalAmount = routerData.byAmountIn ? routerData.routerData.amountIn.toString() : routerData.routerData.amountOut.toString()\n      const routers: any[] = []\n      const notFoundList: string[] = []\n      let totalPercentage = d(0)\n      // routerData.routerData.routes.forEach((route, index) => {\n      const list = routerData?.routerData?.routes || []\n      for (let index = 0; index < list.length; index++) {\n        const route = list[index]\n        const routeF: any = {}\n        const amount = routerData.byAmountIn ? route.amountIn.toString() : route.amountOut.toString()\n        if (index === routerData!.routerData!.routes.length - 1) {\n          routeF.percentage = d(1).sub(totalPercentage).toFixed(2)\n        } else {\n          routeF.percentage = d(amount).div(totalAmount).toFixed(2)\n        }\n        totalPercentage = d(totalPercentage).add(routeF.percentage)\n        const pathsF: any[] = []\n        // route.path.forEach(path => {\n        for (let j = 0; j < route?.path?.length; j++) {\n          const path = route?.path?.[j]\n          const provider = pathProviderMap[path.provider as AggregatorProvider] || path.provider\n          if (!providers.includes(provider)) {\n            providers.push(provider)\n          }\n          const from_type = extractStructTagFromType(path.from).full_address\n          const to_type = extractStructTagFromType(path.target).full_address\n          const tokenMap = await fetchTokenInfo<string[]>([from_type, to_type])\n          const fromCoinInfo = tokenMap?.get(from_type)\n          const toCoinInfo = tokenMap?.get(to_type)\n          if (!fromCoinInfo) {\n            if (notFoundList.includes(from_type)) {\n              notFoundList.push(from_type)\n            }\n          }\n          if (!toCoinInfo) {\n            if (notFoundList.includes(to_type)) {\n              notFoundList.push(to_type)\n            }\n          }\n          const notShowPoolAddress =\n            path.provider === AggregatorProvider.SCALLOP || path.provider === AggregatorProvider.FLOWX || path.provider === AggregatorProvider.FLOWXV3\n          pathsF.push({\n            from_type,\n            to_type,\n            pool_address: notShowPoolAddress ? '' : path.id,\n            fee_rate: path.feeRate,\n            provider: path.provider as AggregatorProvider\n          })\n        }\n        routeF.paths = pathsF\n        routers.push(routeF)\n      }\n      if (notFoundList.length > 0) {\n        const coinTypeList = notFoundList?.map(item => item)\n        await fetchTokenInfo<CoinType[]>(coinTypeList as CoinType[])\n      }\n      const info: SwapRouterFormat = {\n        // router_summery: `${routerData.routerData.routes.length} Streams`,\n        router_summery: '',\n        providers: providers as AggregatorProvider[],\n        routers\n      }\n      setFormatSwapRouter(info)\n      return\n    }\n\n    setFormatSwapRouter(undefined)\n  }\n\n  useEffect(() => {\n    toFormatSwapRouter()\n  }, [routerData])\n  // const formatSwapRouter = useMemo(() => {\n  //   if (routerData && routerData.routerData) {\n  //     const providers: string[] = []\n  //     const totalAmount = routerData.byAmountIn ? routerData.routerData.amountIn.toString() : routerData.routerData.amountOut.toString()\n  //     const routers: any[] = []\n\n  //     const notFoundList: string[] = []\n\n  //     let totalPercentage = d(0)\n  //     routerData.routerData.routes.forEach((route, index) => {\n  //       const routeF: any = {}\n  //       const amount = routerData.byAmountIn ? route.amountIn.toString() : route.amountOut.toString()\n\n  //       if (index === routerData!.routerData!.routes.length - 1) {\n  //         routeF.percentage = d(1).sub(totalPercentage).toFixed(2)\n  //       } else {\n  //         routeF.percentage = d(amount).div(totalAmount).toFixed(2)\n  //       }\n\n  //       totalPercentage = d(totalPercentage).add(routeF.percentage)\n\n  //       const pathsF: any[] = []\n\n  //       route.path.forEach(path => {\n  //         if (!providers.includes(path.provider)) {\n  //           providers.push(path.provider)\n  //         }\n\n  //         const from_type = extractStructTagFromType(path.from).full_address\n  //         const to_type = extractStructTagFromType(path.target).full_address\n\n  //         const fromCoinInfo = getTokenInfo(from_type)\n  //         const toCoinInfo = getTokenInfo(to_type)\n\n  //         if (!fromCoinInfo) {\n  //           if (notFoundList.includes(from_type)) {\n  //             notFoundList.push(from_type)\n  //           }\n  //         }\n\n  //         if (!toCoinInfo) {\n  //           if (notFoundList.includes(to_type)) {\n  //             notFoundList.push(to_type)\n  //           }\n  //         }\n\n  //         const notShowPoolAddress =\n  //           path.provider === AggregatorProvider.SCALLOP || path.provider === AggregatorProvider.FLOWX || path.provider === AggregatorProvider.FLOWXV3\n\n  //         pathsF.push({\n  //           from_type,\n  //           to_type,\n  //           pool_address: notShowPoolAddress ? '' : path.id,\n  //           fee_rate: path.feeRate,\n  //           provider: path.provider as AggregatorProvider\n  //         })\n  //       })\n\n  //       routeF.paths = pathsF\n  //       routers.push(routeF)\n  //     })\n\n  //     if (notFoundList.length > 0) {\n  //       for (const info in notFoundList) {\n  //         fetchTokenInfo(info)\n  //       }\n  //     }\n\n  //     const info: SwapRouterFormat = {\n  //       router_summery: `${routerData.routerData.routes.length} Streams`,\n  //       providers: providers as AggregatorProvider[],\n  //       routers\n  //     }\n\n  //     return info\n  //   }\n  //   return undefined\n  // }, [routerData])\n\n  return { formatSwapRouter }\n}\n\n/**\n * 得到 swap 降级 池子地址列表\n * @returns\n */\nexport function useGetSwapPoolAddressList() {\n  const { getPoolAddressByCoinType } = useGetPoolListByCoinType(true)\n\n  const getSwapPoolAddress = async (from?: Token, to?: Token) => {\n    if (from && to) {\n      const list = await getPoolAddressByCoinType(from.coin_type, to.coin_type)\n      console.log('🚀 ~ getSwapPoolAddress ~ list:', list)\n\n      return list\n    }\n\n    return []\n  }\n\n  return {\n    getSwapPoolAddress\n  }\n}\n\n/**\n * 计算swap 价格ß\n * @param fromAmount\n * @param toAmount\n */\nexport function useGetSwapPrice(fromAmount?: string, toAmount?: string) {\n  return useMemo(() => {\n    if (fromAmount && toAmount && +fromAmount && +toAmount) {\n      return d(toAmount).div(fromAmount).toString()\n    }\n    return '0'\n  }, [fromAmount, toAmount])\n}\n\nexport function useGetRfqData(rfqData?: SwapRfqData, swapData?: SwapRouterData) {\n  const { isOpenRfqSwitch } = useSwapConfigStore()\n\n  return useMemo(() => {\n    if (!isOpenRfqSwitch) {\n      return undefined\n    }\n\n    if (rfqData && swapData && rfqData.uuid === swapData.uuid) {\n      return d(rfqData.toAmountUi || 0).gt(swapData.toAmountUi || 0) ? rfqData : undefined\n    }\n    return undefined\n  }, [rfqData, swapData])\n}\n"],"names":["AggregatorProvider","AggregatorServerErrorCode","SwapWidgetStep","store","set","get","provider","providersSwitchStates","value","useSwapConfigStore","create","persist","useGetPoolListByCoinType","useLocal","poolApiMap","setPoolApiMap","useGlobalStore","getPoolList","getLocalJsonPoolList","getLocalJsonPoolAddress","useGetPoolList","fromCoin","toCoin","sortedTypes","cacheKey","cacheValue","params","res","poolApiList","localList","pool","useGetPriceAcceptRouterData","originData","newData","useMemo","d","useGetAmountLimit","slippage","routerData","byAmountIn","fromAmountUi","toAmountUi","pathProviderMap","useFormatSwapRouter","fetchTokenInfo","useGetToken","formatSwapRouter","setFormatSwapRouter","useState","toFormatSwapRouter","providers","totalAmount","routers","notFoundList","totalPercentage","list","_a","index","route","routeF","amount","pathsF","j","_b","path","_c","from_type","extractStructTagFromType","to_type","tokenMap","fromCoinInfo","toCoinInfo","notShowPoolAddress","coinTypeList","item","useEffect","useGetSwapPoolAddressList","getPoolAddressByCoinType","from","to","useGetSwapPrice","fromAmount","toAmount","useGetRfqData","rfqData","swapData","isOpenRfqSwitch"],"mappings":"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"}