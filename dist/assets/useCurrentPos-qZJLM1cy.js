import{F as L}from"./useWrapPoolData-CzWcfmSl.js";import{a as I,b as H,c as S,d as B,e as q}from"./usePositionList-5SlPZsY2.js";import{u as F}from"./detail-BpvHUFYz.js";import{f as _}from"./index-ihcskjKt.js";function x(){const i=_("clmm"),{posBaseList:l,setCurrentPosBaseInfo:f,setCurrentPosBaseInfoLoading:p}=I(),{setCurPosHistoryList:d,setIsPosHistoryLoading:u}=F(),{buildPosBaseInfo:y}=H(),{getPosRelatedData:m}=S(),{getVestingList:C}=B(),{getPositionInfoList:h}=q(),w=async(r,e,n=!1)=>{console.log("ðŸš€ ~ getCurrentPosBaseInfo ~ id:",e),p(!0);const s=l.find(t=>t.id===e);let o;s&&!n?o=s:o=await g(r,e),console.log("getCurrentPosBaseInfo ~ posInfo:",l,o),o&&(o.isFrozen=L.includes(o.clmmPool)),f(o),o&&m([o])},g=async(r,e)=>{const n=await i.FullClient.getOwnedObjectsByPage(r,{options:{showType:!0,showContent:!0,showOwner:!0},filter:{ObjectId:e}});if(n&&n.data&&n.data.length>0){let s=await y(n.data[0]);if(s!=null&&s.posId){const o=await C([s]);if(console.log("ðŸš€ ~ getCurrentPosByPosId ~ vestingList:",o),(o==null?void 0:o.length)>0){const t=await h([s],o);console.log("ðŸš€ ~ getCurrentPosByPosId ~ list:",t),(t==null?void 0:t.length)>0&&(s=t[0])}}return console.log("ðŸš€ ~ getCurrentPosByPosId ~ posRes:",s),s}return null},P=async(r,e)=>{var s;const n=["https://mainnet.suiet.app:443","https://rpc-mainnet.suiscan.xyz:443"];for(const o of n)try{const t=await i.Position.getPositionTransactionList({pos_id:r,full_rpc_url:o,origin_pos_id:e,order:"descending"});if(console.log("ðŸš€ ~ getCurrentPosHistory ~ response?.data:",t==null?void 0:t.data,o),((s=t==null?void 0:t.data)==null?void 0:s.length)>0)return t.data}catch(t){console.error(`Error fetching data from ${o}:`,t)}return[]};return{getCurrentPosBaseInfo:w,getCurrentPosHistory:async(r,e)=>{console.log("ðŸš€ ~ getCurrentPosHistory ~ posId:",r,e),u(!0);const n=await P(r,e),s=r.toLowerCase()!==e.toLowerCase()?await P(e,e):[];console.log("ðŸš€ ~ getCurrentPosHistory ~ clmmHistory:",n,s,[...n,...s]);const t=[...n,...s].sort((a,c)=>(c==null?void 0:c.timestampMs)-(a==null?void 0:a.timestampMs));d(t),u(!1),console.log("ðŸš€ ~ getCurrentPosHistory ~ result:",t)},getCurrentPosByPosId:g,getPoolLiquiditySnapshot:async r=>{const e=await i.Pool.getPoolLiquiditySnapshot(r.clmmPool);console.log("getPoolLiquiditySnapshot poolSnaps: ",e);const n=await i.Pool.getPositionSnapshot(e.snapshots.id,[r.posId]);console.log("getPoolLiquiditySnapshot posSnap: ",n)}}}export{x as u};
//# sourceMappingURL=useCurrentPos-qZJLM1cy.js.map
