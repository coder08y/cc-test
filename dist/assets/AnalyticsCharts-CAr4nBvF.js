import{r as n,j as a,V as L,B as j,H as B,T as f,C as V,Z as O}from"./vendor-CBmAETR3.js";import{T as G}from"./TvlChart-CBoLRZaM.js";import{u as N,a as Q,b as U,V as Z}from"./VolumeChart-CgtIPmnL.js";import{C as J}from"./CoinPairInfo-BH5hoU3X.js";import{u as K}from"./index-C7OfScvw.js";import{aq as X,l as v,u as Y,a as A,w as S,a5 as E,d as D,ai as H,I as P}from"./index-BpSfzecM.js";var w=(e=>(e.volume="Volume",e.tvl="TVL",e.fees="Fees",e))(w||{}),R=(e=>(e.volume="vol",e.tvl="tvl",e.fees="fee",e))(R||{}),M=(e=>(e.d="D",e.w="W",e.m="M",e))(M||{}),_=(e=>(e.d="day",e.w="wek",e.m="mon",e))(_||{});const I={D:40,W:30,M:20};function ee(e){const[c,p]=n.useState("Volume"),[u,x]=n.useState("D"),[y,o]=n.useState([]),{dlmmApiPoolInfo:b}=K(),[m,r]=n.useState(!0),[i,d]=n.useState(null),{getDlmmHistogramData:h}=N(),{poolId:g}=X(),{getHoverTime:C,time:T}=Q(),l=n.useMemo(()=>v(e)?e==null?void 0:e.poolId:g,[g,e]),t=n.useMemo(()=>v(e)?e:b,[b,e]);n.useLayoutEffect(()=>{o([]),p("Volume"),x("D"),d(null)},[l]);const k=async()=>{if(l)try{r(!0);const s=await h({date_type:_[u.toLowerCase()],type:R[c.toLowerCase()],limit:I[u],address:l});s&&s.length&&o(s)}catch(s){throw console.error(s,"res-fetchAnalyticsData"),s}finally{r(!1)}};n.useEffect(()=>{k()},[l,c,u]),n.useEffect(()=>{i!=null&&i.date&&C(i==null?void 0:i.date,u)},[i==null?void 0:i.date,u]);const q=s=>{p(s.label),s.label!==c&&o([])},z=s=>{x(s.label),s.label!==u&&o([])},F=n.useMemo(()=>{if(c==="Volume")return{value:t==null?void 0:t.volume24Display,title:"Volume (24H)"};if(c==="TVL")return{value:t==null?void 0:t.tvlDisplay,title:"TVL"};if(c==="Fees")return{value:t==null?void 0:t.fees24Display,title:"Fees (24H)"}},[c,t==null?void 0:t.volume24Display,t==null?void 0:t.tvlDisplay,t==null?void 0:t.fees24Display]),W=Object.values(w).map(s=>({label:s})),$=Object.values(M).map(s=>({label:s}));return{handleChartTabChange:q,handleDateTabChange:z,defaultDisplay:F,chartsTabs:W,dateTypes:$,chartLoading:m,analyticsData:y,hoverData:i,setHoverData:d,currentChartTab:c,currentDateType:u,time:T}}function ne({poolInfo:e}){const{isApp:c}=Y(),{handleChartTabChange:p,handleDateTabChange:u,defaultDisplay:x,chartsTabs:y,dateTypes:o,chartLoading:b,analyticsData:m,hoverData:r,setHoverData:i,currentChartTab:d,currentDateType:h,time:g}=ee(e),{setBackUrl:C}=A(),{goDlmmLiquidity:T}=U(),l=n.useMemo(()=>v(e),[e]);return a.jsxs(L,{align:"flex-start",flex:"1",border:"1px solid",borderColor:"border",borderRadius:"16px",p:{base:"8px",lg:"20px"},bg:"bg_secondary",gap:"20px",children:[l&&a.jsx(j,{m:{base:"0 0 -12px 0",lg:"-12px 0"},children:a.jsx(J,{poolInfo:e,symbolFontSize:"16px"})}),a.jsxs(B,{w:"100%",justify:{base:"center",lg:"space-between"},children:[a.jsx(S,{type:"outlineTab",tabList:y,currentTab:d,handleChangeTab:p,wrapStyle:{h:"32px",p:"3px",borderRadius:"8px",flex:{base:"1",lg:"0 0 308px"}},itemStyle:{fontSize:"12px",flex:1,borderRadius:"6px"}}),!c&&a.jsx(S,{type:"outlineTab",tabList:o,currentTab:h,handleChangeTab:u,wrapStyle:{h:"32px",p:"3px",borderRadius:"8px",flex:"0 0 128px"},itemStyle:{fontSize:"12px",flex:1,borderRadius:"6px"}})]}),a.jsxs(L,{w:"100%",align:"flex-start",children:[a.jsx(f,{color:"text_caption",fontSize:"24px",children:(r==null?void 0:r.num)!==void 0&&r!==null?D(H(r.num)).gte("0.01")||D(H(r.num)).equals("0")?`$${E(r==null?void 0:r.num,2)}`:"<$0.01":x==null?void 0:x.value}),a.jsx(f,{children:r!=null&&r.date?g:x==null?void 0:x.title}),c&&a.jsx(S,{type:"outlineTab",tabList:o,currentTab:h,handleChangeTab:u,wrapStyle:{mt:"8px",h:"32px",p:"3px",borderRadius:"8px",w:"128px"},itemStyle:{fontSize:"12px",flex:1,borderRadius:"6px"}})]}),a.jsx(V,{w:"100%",h:l?"240px":{base:"290px",lg:"428px"},mt:l?"0px":"20px",p:l?"8px":"0px",bg:l?"rgba(255,255,255,0.05)":"none",borderRadius:"8px",children:a.jsx(j,{w:"100%",h:"100%",position:"relative",children:b?a.jsx(j,{position:"absolute",top:l?"50%":"30%",left:"50%",transform:"translate(-50%,-50%)",children:a.jsx(O,{})}):d===w.tvl?a.jsx(G,{data:m,onChangeValue:t=>i(t)}):a.jsx(Z,{data:m,onChangeValue:t=>i(t),pageFrom:"pools"})})}),l&&a.jsx(V,{cursor:"pointer",w:"100%",mb:{base:"12px",lg:"0"},children:a.jsxs(f,{display:"flex",align:"center",lineHeight:"18px",sx:{_hover:{color:"text_caption",svg:{fill:"text_caption !important"}}},fontWeight:"500",borderRadius:"8px",onClick:()=>{C("/pools?tab=dlmm_pools"),T(`/dlmm?tab=analytics&poolId=${e==null?void 0:e.poolId}`,e)},children:["More details",a.jsx(P,{xlinkHref:"#icon-icon_ascending_nor",transform:"rotate(90deg)"})]})})]})}export{ne as A};
