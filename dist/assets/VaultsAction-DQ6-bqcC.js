import{r as i,ao as pa,K as fa,j as t,w as Ue,H as me,T as ae,V as X,M as Ot,o as At,p as Mt,$ as Lt,q as zt,t as Wt,n as Zt,a0 as xa,B as Kt,P as ba,x as ha,a8 as It,y as ga,A as Sa,m as vt,D as _a,az as Yt,E as Ca,G as wa,J as ja}from"./vendor-CBmAETR3.js";import{j as Vt,c as Ae,h as va,g as ya,d as Ia,f as Ra,k as Xt,a as ft,l as Da,e as Oa,u as Aa,b as kt}from"./VaultsAprBlock-Bvb3Su6d.js";import{u as xt,a as Pt,c as Ma,b as Et,d as ea}from"./useGetPythTokenPrice-Co4DlB3j.js";import{i as ta,z as w,bU as bt,f as Ut,Q as rt,M as Me,l as Ft,Z as at,a as lt,c8 as Bt,B as ke,I as aa,w as ht,d0 as La,d as we,as as it,S as za,bq as Xe,E as Re,T as st,bo as Wa,d4 as Ea,aT as mt,G as qe,R as Rt,O as ve,dT as pt,K as Ua,u as $t,C as Fa,a8 as Ba,ae as $a,v as yt,bn as qt,p as Ta}from"./index-BpSfzecM.js";import{B as Ha}from"./BackButton-DoozH78n.js";import{T as ot}from"./cross-DJ28FxNa.js";import{S as sa}from"./Slippage-8fJCLOYr.js";import{a as Na}from"./RemoveBlock-C31WZQk2.js";import{H as Ge}from"./HTextLabelBox-D0r99Smv.js";import{R as oa}from"./RefreshButton-bgRHxGzR.js";import{T as Tt}from"./TradeInputGroup-C0B6uidS.js";import{M as nt}from"./msafe-BzcjPV-e.js";import{f as De,a as Dt}from"./index-gw6wWhzj.js";import{u as Ht}from"./useTransaction-uEos3ZjK.js";import{T as Ga}from"./TooltipIcon-DVhxXZmh.js";import{T as Ya}from"./TradeConfirmAmountInfo-C8pVFbTE.js";import{P as qa}from"./PoolTag-DVhitHGR.js";import{T as Qa}from"./TotalAmount-B2jkoq59.js";import{u as na}from"./useAccountBalance-DV0qM_Vy.js";import{u as Qt}from"./useTokenBalance-c3RAkCCY.js";import{v as Qe}from"./v4-C6aID195.js";import{E as Ja}from"./ErrorTips-lJshH5MT.js";import{C as Jt}from"./CheckBox-eomO844M.js";import{P as Za}from"./RemoveBlock-CGdGO_rZ.js";import{u as Ka}from"./useFindBestRouting-CX4IIQLi.js";const Va=(o,a)=>({amountInputA:"",isProfileOpenVaultModal:!1,setIsProfileOpenVaultModal:e=>{o(()=>({isProfileOpenVaultModal:e}))},profilePoolInfo:{},setProfilePoolInfo:e=>{o(()=>({profilePoolInfo:e}))},amountInputB:"",setAmountInputA:e=>{o(()=>({amountInputA:e}))},profileActionTab:"Deposit",setProfileActionTab:e=>{o(()=>({profileActionTab:e}))},setAmountInputB:e=>{o(()=>({amountInputB:e}))},fromToken:{},toToken:{},setFromToken:e=>o({fromToken:e}),setToToken:e=>o({toToken:e}),calculateResult:{amount_a:"",amount_b:"",ft_amount:""},setCalculateResult:e=>o({calculateResult:e}),clearVaultsActionData:()=>o({amountInputA:"",amountInputB:"",calculateResult:{amount_a:"",amount_b:"",ft_amount:""}}),isCheckedZAP:!1,setIsCheckedZAP:e=>{o({isCheckedZAP:e})},assetAction:"both",setAssetAction:e=>{o({assetAction:e})},currTab:"Deposit",setCurrTab:e=>{o({currTab:e})}}),Te=ta(Va);function la(o,a,e,l){let n={isDisabled:!1,btnText:""};return(!a||w(a).lte(0))&&(n.isDisabled=!0),w(a||"0").gt(w(o||"0"))&&(n.isDisabled=!0,n.btnText=l?`Insufficient  ${e.coinDetail.symbol} balance`:"Invalid Amount"),n}function Nt(){const{setCurrentVaultPosition:o,vaultsPositionObj:a,setCurrentVaultPositionLoading:e,setVaultsPositionObj:l}=xt(),{vaultClmmPoolContractInfoObj:n,setLstVaultContractInfoObj:r,setHaedalVaultContractInfoObj:x,vaultDlmmPoolContractInfoObj:s}=Vt(),{setVaultsFarmingStakeLoading:p}=Ae(),{volatileVaultsSdk:S}=bt(),h=Ut("vaults"),{vaultsList:g}=Pt(),{getVaultPoolList:f}=Ma(),{getVaultPosition:c}=va(),{getVaultsContractInfo:C}=ya(),{getPythLastPrice:u}=Ia(),{fetchTokenPrices:d}=rt(),{setFromToken:I,setToToken:A}=Te(),{getVaultsLpTokenList:F}=Ra(),{currentAccount:L}=Me(),R=i.useRef(L==null?void 0:L.address);i.useEffect(()=>{R.current=L==null?void 0:L.address},[L==null?void 0:L.address]);const{vaultId:B}=pa(),{pathname:se}=fa(),_=i.useRef(B);i.useEffect(()=>{_.current=B},[B]);const Z=(Y,D=!1)=>{if(!(_.current!==Y&&se.indexOf("/vaults-detail")>-1))if(Ft(a)&&a[Y]&&!D){const T=a[Y];if(T.ownerAddress==R.current&&R.current){const{displayTokenA:q,displayTokenB:ne}=T;I(q),A(ne),o(T),e(!1)}else pe(Y,D)}else pe(Y,D)},P=async Y=>{const{poolList:D}=await f(),T=await F(D),q=D.filter(G=>G.vaultId==Y)[0],{displayTokenA:ne,displayTokenB:le}=q;I(ne),A(le),q.category=="haedal"||q.category=="cetus-dlmm"?u([at(q.displayTokenA.coin_type,!1),at(q.displayTokenB.coin_type,!1)]):d([at(q.displayTokenA.coin_type,!1),at(q.displayTokenB.coin_type,!1)]);const{lstVaultContractInfoObj:K,haedalVaultContractInfoObj:Se,allClmmPoolContractInfoObj:ie,dlmmVaultContractInfoObj:he,allDlmmPoolContractInfoObj:N}=await C([q]);console.log("🚀🚀🚀 ~ useCurrentVaultDetail.ts:93 ~ getCurrentVaultContractInfo ~ dlmmVaultContractInfoObj:",he);const re=ie[q.clmmPoolAddress],be=N[q.dlmmPoolAddress];return{vaultContractInfo:q.category=="cetus"?K[q.vaultId]:q.category=="cetus-dlmm"?he[q.vaultId]:Se[q.vaultId],clmmContractInfo:re,dlmmContractInfo:be,vault:q,lpTokenInfoObj:T,category:q.category}},pe=async(Y,D=!1)=>{try{R.current&&!D&&e(!0);const{vaultContractInfo:T,clmmContractInfo:q,vault:ne,lpTokenInfoObj:le,dlmmContractInfo:K,category:Se}=await P(Y);console.log("🚀🚀🚀 ~ useCurrentVaultDetail.ts:114 ~ getCurrentVaultByVaultId ~ vault:",ne),console.log("🚀🚀🚀 ~ useCurrentVaultDetail.ts:109 ~ getCurrentVaultByVaultId ~ dlmmContractInfo:",K);let ie={};(Se=="cetus-dlmm"?K:q)&&T&&R.current?(ie=await c(ne,Se=="cetus-dlmm"?K:q,T,!1,{},R.current,le),console.log("🚀🚀🚀 ~ useCurrentVaultDetail.ts:128 ~ getCurrentVaultByVaultId ~ currentVaultPosition:",ie),console.log("🚀🚀🚀 ~ useCurrentVaultDetail.ts:130 ~ getCurrentVaultByVaultId ~ currentVaultPosition[vault.vaultId]:",ie,ne.vaultId,ie[ne.vaultId].ownerAddress),ie[ne.vaultId].ownerAddress==R.current&&R.current&&(o(ie[ne.vaultId]),e(!1))):(e(!1),p(!1))}catch{e(!1)}};return{getCurrentVaultDetail:Z,getCurrentVaultContractInfo:P,getCurrentVaultByVaultId:pe,updateCurrentVaultById:async Y=>{const D=g.filter(K=>K.vaultId==Y)[0],T=n[D.clmmPoolAddress],q=s[D.dlmmPoolAddress],ne=D.category;let le;if(D.category=="cetus"?le=await h.Vaults.getVault(D.vaultId):D.category=="haedal"?le=await S.Vaults.getPool(D.vaultId):D.category=="cetus-dlmm"&&(le=await S.VaultsV2.getPool(D.vaultId)),D.category=="cetus"?r({[D.vaultId]:le}):x({[D.vaultId]:le}),(ne=="cetus-dlmm"?q:T)&&le){console.log("🚀🚀🚀 ~ useCurrentVaultDetail.ts:152 ~ updateCurrentVaultById ~ 获取当前vault详情:");const K=await c(D,ne=="cetus-dlmm"?q:T,le);console.log("🚀🚀🚀 ~ useCurrentVaultDetail.ts:173 ~ updateCurrentVaultById ~ currentVaultPosition:",K),K[D.vaultId].ownerAddress==R.current&&R.current&&(o(K[D.vaultId]),l(K))}}}}function Gt(o,a,e){const[l,n]=i.useState(""),{haedalFarmSdk:r}=bt(),{signAndExecuteTransaction:x,transactionRejected:s}=Ht(),{mevProtect:p,maxCapForGas:S,transactionMode:h,customGasPrice:g}=lt(),[f,c]=i.useState(!1),{updateCurrentVaultById:C}=Nt(),{getVaultsFarmingStaked:u}=Xt();return{farmStakeAction:async()=>{c(!0);const L={getShowInfo:(B,se)=>{var P;const _="Stake "+De(l,(P=a==null?void 0:a.coinDetail)==null?void 0:P.symbol);return{modalDescriptionText:_,toastTitleText:_}}},R={poolId:a.poolId,stakeCoinType:a.stakeCoinType,amount:Number(l),decimals:Number(a.coinDetail.decimals),stakeObjectId:e.stakeObjectId};console.log("🚀🚀🚀 ~ useVaultFarmingPage.ts:42 ~ farmStakeAction ~ stakeParams.currentVaultsFarming:",a),console.log("🚀🚀🚀 ~ useVaultFarmStake.ts:31 ~ farmStakeAction ~ stakeParams:",JSON.stringify(R));try{await x(async()=>{const _=new ot;return _.setSender(r.senderAddress),await r.Farms.buildStakePayload(R,_),console.log("🚀🚀🚀 ~ useVaultFarmStake.ts:50 ~ txb ~ tx:",_),_},L,{useMev:p,txAction:"signTransactionBlock",useFastMode:h==="Fast Mode",maxCapForGas:S,customGasPrice:g,msafeParams:{action:nt.VaultsFarmingStake,txbParams:R}})?(c(!1),n(""),C(o),u({stakeCoinType:a.stakeCoinType,poolId:a.poolId},o)):c(!1)}catch(B){console.log("🚀 ~ doAddAction ~ error:",B),s(L),c(!1)}},isLoading:f,handleChangeStakeValue:L=>{n(L)},stakeAmount:l,farmUnStakeAction:async()=>{c(!0);const L={getShowInfo:(B,se)=>{var P;const _="Unstake "+De(l,(P=a==null?void 0:a.coinDetail)==null?void 0:P.symbol);return{modalDescriptionText:_,toastTitleText:_}}},R={poolId:a.poolId,stakeCoinType:a.stakeCoinType,stakeObjectId:e.stakeObjectId,amount:w(l).mul(10**a.coinDetail.decimals).toString(),claimReward:!0,rewardConfigs:e.rewardConfigs};console.log("🚀🚀🚀 ~ useVaultFarmingPage.ts:42 ~ farmStakeAction ~ stakeParams.currentVaultsFarming:",a),console.log("🚀🚀🚀 ~ useVaultFarmStake.ts:31 ~ farmStakeAction ~ stakeParams:",R);try{await x(async()=>{const _=new ot;return _.setSender(r.senderAddress),await r.Farms.buildUnstakePayload(R,_),console.log("🚀🚀🚀 ~ useVaultFarmStake.ts:50 ~ txb ~ tx:",_),_},L,{useMev:p,txAction:"signTransactionBlock",useFastMode:h==="Fast Mode",maxCapForGas:S,customGasPrice:g,msafeParams:{action:nt.VaultsFarmingUnStake,txbParams:R}})?(c(!1),n(""),C(o),u({stakeCoinType:a.stakeCoinType,poolId:a.poolId},o)):c(!1)}catch(B){console.log("🚀 ~ doAddAction ~ error:",B),s(L),c(!1)}},farmClaimAction:async()=>{c(!0);const L={getShowInfo:(B,se)=>{const _="Claim Farming Rewards";return{modalDescriptionText:_,toastTitleText:_}}};console.log("🚀🚀🚀 ~ useVaultFarmingPage.ts:42 ~ farmStakeAction ~ stakeParams.currentVaultsFarming:",a);let R;try{await x(async()=>{var Z,P,pe;const _=new ot;_.setSender(r.senderAddress);for(let oe=0;oe<((Z=e.rewardConfigs)==null?void 0:Z.length);oe++)R={poolId:a.poolId,stakeCoinType:a.stakeCoinType,stakeObjectId:e.stakeObjectId,rewardCoinType:(P=e.rewardConfigs[oe])==null?void 0:P.rewardCoinType,rewardBank:(pe=e.rewardConfigs[oe])==null?void 0:pe.bank},console.log("🚀🚀🚀 ~ useVaultFarmStake.ts:31 ~ farmStakeAction ~ stakeParams:",R),await r.Farms.buildHarvestPayload(R,_);return console.log("🚀🚀🚀 ~ useVaultFarmStake.ts:50 ~ txb ~ tx:",_),_},L,{useMev:p,txAction:"signTransactionBlock",useFastMode:h==="Fast Mode",maxCapForGas:S,customGasPrice:g,msafeParams:{action:nt.VaultsFarmingClaim,txbParams:R}})?(c(!1),n(""),u({stakeCoinType:a.stakeCoinType,poolId:a.poolId},o)):c(!1)}catch(B){console.log("🚀 ~ doAddAction ~ error:",B),s(L),c(!1)}}}}function Xa({currentVaultPosition:o,currentVaultsFarming:a}){const{vaultsFarmingStaked:e}=Ae(),l=i.useMemo(()=>e[o.vaultId],[e,o.vaultId]),{handleChangeStakeValue:n,stakeAmount:r,farmStakeAction:x,isLoading:s}=Gt(o==null?void 0:o.vaultId,a,l),{isDisabled:p,btnText:S}=la(o==null?void 0:o.vaultBalanceFormat,r,a,!0);return t.jsxs(t.Fragment,{children:[t.jsx(Bt,{value:r,onChange:n,token:a==null?void 0:a.coinDetail,placeholder:"",balance:o==null?void 0:o.vaultBalanceFormat,wrapStyle:{height:"110px"}}),t.jsx(Ue,{w:"100%",h:"52px",fontWeight:"600",onClick:x,isDisabled:p,isLoading:s,children:S||"Stake"})]})}function ka(){const[o,a]=i.useState(25),[e,l]=i.useState("USDC+SUI"),n=[{label:"USDC+SUI",value:"USDC+SUI"},{label:"USDC",value:"USDC"},{label:"SUI",value:"SUI"}];return t.jsxs(t.Fragment,{children:[t.jsxs(me,{w:"100%",justifyContent:"space-between",gap:"8px",children:[t.jsx(ae,{fontSize:"16px",color:"text_caption",children:"Unstake"}),t.jsxs(me,{w:"100%",justifyContent:"flex-end",children:[t.jsx(sa,{slippageType:"vaults",compact:!0}),t.jsx(oa,{handleRefresh:()=>{},w:"28px",h:"28px",minW:"28px",minH:"28px",innerStyle:{w:"28px",h:"28px",borderRadius:"8px",bg:"bg_secondary"}})]})]}),t.jsxs(X,{w:"100%",children:[t.jsx(Bt,{value:"1",onChange:()=>{},placeholder:"0",balance:"100",wrapStyle:{position:"relative",zIndex:5,height:"110px"}}),t.jsx(ke,{borderRadius:"0 0 20px 20px",p:"20px 14px 8px",mt:"-20px",children:t.jsx(Na,{percentage:o,onChange:r=>a(r),wrapStyle:{justifyContent:"space-between"},selectTabStyle:{w:{base:"220px",lg:"276px"},h:"32px",p:"3px",borderRadius:"8px"},selectTabItemStyle:{flex:"1",fontSize:"12px",margin:"0px"},textFontSize:"20px"})}),t.jsx(aa,{xlinkHref:"#icon-a-icon_trade",svgW:"12px",svgH:"12px",isActive:!0,activeColor:"text_caption",m:"8px 0 0px"})]}),t.jsxs(X,{w:"100%",children:[t.jsx(ae,{w:"100%",fontSize:"16px",color:"text_caption",textAlign:"left",mt:"4px",children:"Receive"}),t.jsx(ht,{type:"outlineTab",wrapStyle:{w:{base:"100%"},h:"42px",padding:"4px"},itemStyle:{w:"50%",fontSize:"14px",borderRadius:"8px"},tabList:n,currentTab:e,handleChangeTab:r=>{l(r.value)}}),t.jsx(Tt,{from:{wrapStyle:{height:"110px"}},to:{wrapStyle:{height:"110px"}}}),t.jsx(Ue,{w:"100%",h:"52px",children:"Deposit"}),t.jsxs(X,{w:"100%",gap:"20px",mt:"8px",children:[t.jsx(Ge,{label:"Total Withdraw",labelStyle:{fontSize:"14px"},value:"11",valueStyle:{fontSize:"14px"},isLoading:!1}),t.jsx(Ge,{label:"LP Burn Amount",value:"11",labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},isLoading:!1})]})]})]})}function Pa(o){const{currentVaultsFarming:a,currentVaultPosition:e}=o,{vaultsFarmingStaked:l}=Ae(),n=i.useMemo(()=>l[e.vaultId],[l,e.vaultId]),{handleChangeStakeValue:r,stakeAmount:x,farmUnStakeAction:s,isLoading:p}=Gt(e==null?void 0:e.vaultId,a,n),{isDisabled:S,btnText:h}=la(n==null?void 0:n.stakedBalanceFormat,x,a,!1);return t.jsxs(t.Fragment,{children:[t.jsx(Bt,{token:a==null?void 0:a.coinDetail,value:x,onChange:r,placeholder:"0",balance:n==null?void 0:n.stakedBalanceFormat,wrapStyle:{height:"110px"}}),t.jsx(Ue,{w:"100%",h:"52px",fontWeight:"600",mt:"8px",isDisabled:S,onClick:s,isLoading:p,children:h||"Unstake"})]})}function es(o){const[a,e]=i.useState("Unstake LP");return t.jsxs(X,{w:"100%",children:[a==="Unstake LP"&&t.jsx(Pa,{...o}),a==="Unstake and Withdraw"&&t.jsx(ka,{}),t.jsx(ae,{w:"100%",p:"12px",textAlign:"center",fontSize:"12px",color:"primary",bg:"primary_opacity.10",borderRadius:"12px",mt:a=="Unstake LP"?"4px":"8px",children:"Haedal farming rewards will be claimed when unstaking."})]})}function Qs({isOpen:o,onClose:a,setIsOpen:e,setIsOpenPre:l,farmingModalAction:n,vaultsId:r,isDetail:x}){const[s,p]=i.useState(n||"Stake"),{currentVaultPosition:S}=xt(),{currentVaultsFarm:h}=ft(r),g=[{label:"Stake",value:"Stake"},{label:"Unstake",value:"Unstake"}];return t.jsxs(Ot,{isCentered:!0,isOpen:o,onClose:()=>{e(!1)},children:[t.jsx(At,{}),t.jsxs(Mt,{width:{base:"100%",lg:"420px"},children:[t.jsxs(Lt,{children:[x&&"Haedal Farms",!x&&t.jsx(Ha,{w:"100%",border:"none",bg:"none",justifyContent:"start",text:"Haedal Farms",ml:"-6px",customTextStyle:{color:"text_caption"},onClick:()=>{e(!1),l(!0)}})]}),t.jsx(zt,{}),t.jsxs(Wt,{p:"0 16px 8px",children:[t.jsx(ht,{type:"borderTab",wrapStyle:{w:"100%",h:"38px",border:"none",bg:"none"},itemStyle:{fontSize:"16px",mr:"28px",fontWeight:"500"},tabList:g,currentTab:s,handleChangeTab:f=>{p(f.value)}}),t.jsxs(X,{gap:"16px",mt:"16px",pb:"8px",children:[s==="Stake"&&t.jsx(Xa,{currentVaultPosition:S,currentVaultsFarming:h}),s==="Unstake"&&t.jsx(es,{currentVaultPosition:S,currentVaultsFarming:h})]})]})]})]})}function ts(o){const{getTokenAmountValue:a}=rt(),{setVaultsFarmingRewardsLoading:e,vaultsFarmingRewardsLoading:l}=Ae(),[n,r]=i.useState("0"),[x,s]=i.useState("0"),{currentAccount:p}=Me();return i.useEffect(()=>{(async()=>{if(!(p!=null&&p.address)){r("--"),e(!1);return}if(!o||o.length===0){r("0");return}if(!o.some(h=>h.ownerAddress!=(p==null?void 0:p.address))){e(!0);try{let h=w(0),g=w(0);for(const f of o){const c=a(f.rewardCoinType,f.rewardAmountDisplay);h=h.add(c),g=g.add(f.rewardAmountDisplay)}r(h.toString()),s(g.toString())}catch(h){console.error("Error calculating vault farming reward USD:",h),r("0")}finally{e(!1)}}})()},[o,a,p==null?void 0:p.address]),{vaultFarmingRewardAmountUSD:n,vaultsFarmingRewardsLoading:l,setVaultsFarmingRewardsLoading:e,vaultFarmingRewardAmount:x}}function as(o,a,e,l){const{getTokenAmountValue:n}=rt(),[r,x]=i.useState(""),[s,p]=i.useState(!0),{currentAccount:S}=Me();return i.useEffect(()=>{(async()=>{if(!(S!=null&&S.address)){x("--"),p(!1);return}if(!o||!a||!Ft(e)||!l){x("");return}p(!0);try{const{coin_type_a:g,coin_type_b:f}=a,{tokenA:c,tokenB:C}=l,u=La("",e.stakedBalance,o,a),d=w(u.amount_a).div(10**((c==null?void 0:c.decimals)??0)).toString(),I=w(u.amount_b).div(10**((C==null?void 0:C.decimals)??0)).toString(),A=n(g,d),F=n(f,I),L=w(A).add(F);x(L.toString()),p(!1)}catch(g){console.error("Failed to calculate stakeVaultFarmingTvl:",g),x("0")}})()},[o,a,e,l,n]),{stakeVaultFarmingTvl:r,stakeVaultFarmingTvlLoading:s,setStakeVaultFarmingTvlLoading:p}}function ss(o){const{currentAccount:a}=Me(),{currentVaults:e}=Da(o),{currentVaultsFarm:l}=ft(o),{vaultsFarmingStaked:n,vaultsFarmingRewards:r,vaultsFarmingStakeLoading:x,vaultsFarmingRewardsLoading:s,clearVaultsFarmingInfo:p}=Ae(),S=i.useMemo(()=>n[e==null?void 0:e.vaultId],[n,e==null?void 0:e.vaultId]),h=i.useMemo(()=>r[e==null?void 0:e.vaultId],[r,e==null?void 0:e.vaultId]),{haedalVaultContractInfoObj:g,vaultClmmPoolContractInfoObj:f}=Vt(),{currentVaultPosition:c,currentVaultPositionLoading:C}=xt(),{vaultsFarmObj:u}=Ae(),d=i.useMemo(()=>g[e==null?void 0:e.vaultId],[e==null?void 0:e.vaultId,g]),I=i.useMemo(()=>f[e==null?void 0:e.clmmPoolAddress],[e==null?void 0:e.clmmPoolAddress,f]),{vaultFarmingAprDisplay:A,farmingTvlDisplay:F,vaultFarmingApr:L,farmingTvl:R,vaultFarmingLoading:B}=Oa(l),{stakeVaultFarmingTvl:se,stakeVaultFarmingTvlLoading:_}=as(d,I,S,e),{vaultFarmingRewardAmountUSD:Z,vaultFarmingRewardAmount:P}=ts(h),pe=i.useMemo(()=>c,[c,e==null?void 0:e.vaultId]),{holdingAmountDisplay:oe,holdCoinAValue:Y,holdCoinBValue:D,holdingVaultAmountDisplay:T}=Aa(c==null?void 0:c.displayAmountA,c==null?void 0:c.displayAmountB,c==null?void 0:c.displayCoinTypeA,c==null?void 0:c.displayCoinTypeB,c==null?void 0:c.displayVaultAmountA,c==null?void 0:c.displayVaultAmountB,e==null?void 0:e.category),q=i.useMemo(()=>u[e==null?void 0:e.vaultId],[u,e==null?void 0:e.vaultId]),{farmClaimAction:ne,isLoading:le}=Gt(c==null?void 0:c.vaultId,q,S),K=i.useMemo(()=>we((c==null?void 0:c.vaultBalance)||"0").lte(0),[c]),Se=i.useMemo(()=>{const he=h&&(h==null?void 0:h.filter(N=>we((N==null?void 0:N.rewardAmount)||"0").gt(0)))||[];return he&&he.length<=0},[h]),ie=i.useMemo(()=>we((S==null?void 0:S.stakedBalance)||"0").lte(0),[n]);return i.useEffect(()=>{a!=null&&a.address||p()},[a==null?void 0:a.address]),{vaultFarmingApr:L,vaultFarmingAprDisplay:A,vaultFarmingLoading:B,farmingTvl:R,farmingTvlDisplay:F,stakeVaultFarmingTvl:se,stakeVaultFarmingTvlLoading:_,vaultFarmingRewardAmountUSD:Z,vaultFarmingRewardLoading:s,holdingAmountDisplay:oe,holdCoinAValue:Y,holdCoinBValue:D,farmClaimAction:ne,farmClaimLoading:le,vaultsFarmingStakeLoading:x,vaultsFarmingStaked:S,currentVaultPositionLoading:C,currentVaultPositionInfo:pe,vaultsFarmingRewards:h,vaultsFarmingRewardsLoading:s,stakeButtonDisabled:K,claimButtonDisabled:Se,unStakeButtonDisabled:ie,holdingVaultAmountDisplay:T,vaultFarmingRewardAmount:P,currentVaultsFarm:l,currentVaultsFarmingStaked:S}}function os({rewardInfo:o}){var a,e;return console.log("🚀🚀🚀 ~ FarmingIncentives.tsx:18 ~ RewardItem ~ rewardInfo:",o),t.jsx(X,{borderRadius:"12px",children:t.jsxs(me,{p:"0",w:"100%",justifyContent:"space-between",children:[t.jsx(me,{children:t.jsx(Zt,{src:(a=o==null?void 0:o.coinDetail)==null?void 0:a.logo_url,w:"20px",h:"20px"})}),t.jsxs(me,{gap:"4px",children:[t.jsx(ae,{fontSize:"12px",color:"text_caption",children:o==null?void 0:o.rewardAmountDisplay}),t.jsx(ae,{fontSize:"12px",children:(e=o==null?void 0:o.coinDetail)==null?void 0:e.symbol})]})]})})}function ns(o){var d;const{setIsOpenPre:a,setIsOpenFarmingModal:e,setFarmingModalAction:l,apiVaultInfo:n}=o,[r,x]=i.useState(!1),{stakeVaultFarmingTvl:s,vaultFarmingRewardAmountUSD:p,farmClaimAction:S,vaultsFarmingStakeLoading:h,vaultsFarmingStaked:g,vaultsFarmingRewards:f,stakeButtonDisabled:c,claimButtonDisabled:C,unStakeButtonDisabled:u}=ss(n==null?void 0:n.vaultId);return t.jsxs(X,{border:"1px solid",borderColor:"border",gap:"12px",w:"100%",borderRadius:"8px",children:[t.jsxs(me,{w:"100%",p:"16px 12px",borderRadius:"7px",bg:"primary_opacity.10",justifyContent:"space-between",onClick:()=>x(!r),cursor:"pointer",children:[t.jsxs(me,{gap:"4px",cursor:"pointer",userSelect:"none",children:[t.jsx(ae,{color:"text_caption",userSelect:"none",children:"Farm Overview"}),t.jsx(Ga,{tooltipCon:"Powered by Haedal"})]}),t.jsx(aa,{fontSize:"12px",xlinkHref:"#icon-icon_arrow",transition:"transform 0.5s",transform:r?"rotate(180deg)":"rotate(0deg)"})]}),r&&t.jsxs(X,{w:"100%",padding:"0 12px 12px",gap:"8px",children:[t.jsx(X,{w:"100%",gap:"4px",children:t.jsx(Ge,{isLoading:h&&!(g!=null&&g.stakedBalanceDisplay),label:"Your Staked",value:t.jsxs(X,{alignItems:"flex-end",children:[t.jsxs(ae,{fontSize:"14px",color:"text_caption",children:[g==null?void 0:g.stakedBalanceDisplay," LP"]}),t.jsx(ae,{fontSize:"12px",children:it(s)})]}),skeletonStyle:{subValueH:"20px"},valueStyle:{color:"text_caption"}})}),t.jsx(X,{w:"100%",children:t.jsx(Ge,{label:"Your Rewards",isLoading:h&&!f,rightValueTip:f==null?void 0:f.map(I=>t.jsx(X,{borderRadius:"12px",children:t.jsx(os,{rewardInfo:I})})),value:t.jsxs(me,{position:"relative",children:[t.jsx(ae,{color:"text_caption",children:it(p)}),(d=g==null?void 0:g.rewardConfigs)==null?void 0:d.map(I=>{var A,F;return t.jsx(za,{imageUrl:(A=I==null?void 0:I.coinDetail)==null?void 0:A.logo_url,w:"20px",h:"20px",coinType:I==null?void 0:I.coin_type,showTag:!1},((F=I==null?void 0:I.coinDetail)==null?void 0:F.name)+"Icon")})]}),valueStyle:{textDecoration:"none"},wrapStyle:{mt:"4px"}})}),t.jsx(Ue,{w:"100%",mt:"12px",height:"32px",borderRadius:"8px",fontSize:"12px",isDisabled:c,onClick:()=>{a(!1),l("Stake"),e(!0)},children:"Stake"}),t.jsxs(me,{w:"100%",justifyContent:"space-between",children:[t.jsx(Ue,{w:"50%",height:"32px",variant:"outline",borderRadius:"8px",fontSize:"12px",bg:"none",isDisabled:u,onClick:()=>{a(!1),l("Unstake"),e(!0)},children:"Unstake"}),t.jsx(Ue,{w:"50%",height:"32px",variant:"outline",borderRadius:"8px",fontSize:"12px",bg:"none",onClick:S,isDisabled:C,children:"Claim"})]})]})]})}function ia(o){const{poolName:a,amountLimit:e,lpRate:l,inputTotalValue:n,preCalculateLoading:r,labelColor:x,lpDecimals:s,calculateLpLoading:p}=o;return t.jsxs(X,{w:"100%",gap:"16px",children:[t.jsx(Qa,{labelStyle:{color:x},totalAmount:n,loading:r}),t.jsx(Ge,{label:"Share of Pool",labelStyle:{fontSize:"14px",color:x},value:l,isLoading:p,valueStyle:{fontSize:"14px",h:"14px"},skeletonStyle:{valueH:"14px"}}),t.jsx(Ge,{label:"Est. Received LP",labelStyle:{fontSize:"14px",color:x},value:`${Xe(Re(st(e||"0",s||9)).toString(),9)} ${a}`,valueStyle:{fontSize:"14px",h:"14px"},skeletonStyle:{valueH:"14px"},isLoading:p})]})}function ls(o){const{isOpen:a,onClose:e,data:l,onSubmitClick:n,calculateLpLoading:r}=o,{feeTier:x,displayTokenA:s,displayTokenB:p,displayAmountA:S,displayAmountB:h,totalAmountValue:g,sharePool:f,lpAmountLimit:c,lpDecimals:C,category:u,binStep:d}=l;return t.jsxs(Ot,{autoFocus:!1,returnFocusOnClose:!1,isOpen:a,onClose:e,isCentered:!0,children:[t.jsx(At,{}),t.jsxs(Mt,{children:[t.jsx(Lt,{children:t.jsx(xa,{fontWeight:"500",fontSize:"16px",children:"Deposit"})}),t.jsx(zt,{}),t.jsx(Wt,{textAlign:"center",p:"0px",children:t.jsxs(X,{w:"100%",gap:"20px",p:"16px",pb:"0px",pos:"relative",children:[t.jsxs(me,{w:"100%",justifyContent:"space-between",children:[t.jsxs(me,{children:[t.jsx(Wa,{coinAIconUrl:s==null?void 0:s.logo_url,coinBIconUrl:p==null?void 0:p.logo_url,imageStyle:{w:"40px",h:"40px"},imgBoxStyle:{w:"40px",h:"40px"}}),t.jsx(ae,{fontSize:"16px",color:"text_caption",children:`${s==null?void 0:s.symbol} - ${p==null?void 0:p.symbol}`})]}),t.jsx(qa,{poolType:u==="cetus-dlmm"?"dlmm":"clmm",binStep:Number(d),displayFee:x})]}),t.jsx(Ya,{coinA:{amount:S,...s},iconParams:{xlinkHref:"#icon-icon_add",svgFill:"text_caption"},coinB:{amount:h,...p}}),t.jsx(ia,{amountLimit:c,inputTotalValue:g,preCalculateLoading:!1,calculateLpLoading:r,lpRate:f,lpDecimals:C,poolName:`${s==null?void 0:s.symbol} - ${p==null?void 0:p.symbol}`}),t.jsx(Kt,{h:"52px"}),t.jsx(Ue,{pos:"absolute",bottom:"0px",mt:"4px",w:"100%",h:"52px",borderRadius:"12px",fontSize:"16px",fontWeight:"500",onClick:()=>{n()},children:"Deposit"})]})})]})]})}function is(o){const{getTokenAmountValueByPyth:a,getTokenPriceByPyth:e}=Et();return i.useMemo(()=>{if(o){const{hardCap:l,quoteCoinType:n,displayCoinTypeA:r,displayCoinTypeB:x,displayAmountA:s,displayAmountB:p,quoteCoin:S,baseCoin:h,baseCoinType:g}=o,f=a(n,l);if(!f)return{};const c=it(f),C=a(r,s),u=a(x,p),d=we(C).add(we(u)).toString(),I=we(d).div(we(f)).mul(100).toString(),A=it(I,"%"),F=e(n),L=e(g),R=we(f).sub(we(d)).gt(0)?we(f).sub(we(d)).toString():"0";let B,se;return R!=="0"?(B=we(R).div(F||"0").toString(),se=we(R).div(L||"0").toString()):(B="0",se="0"),console.log("useVaultAvaiableCapacity: ",{hardCap:l,hardCapUSD:f,vaultTvl:d,displayHardCapUSD:c,depositRatio:I,displayDepositRatio:A,baseCoin:h,quoteCoin:S,availableCapacityWithQuoteCoin:B,availableCapacityWithBaseCoin:se,availableCapacityUSD:R}),{hardCap:l,hardCapUSD:f,vaultTvl:d,displayHardCapUSD:c,depositRatio:I,displayDepositRatio:A,baseCoin:h,quoteCoin:S,availableCapacityWithQuoteCoin:B,availableCapacityWithBaseCoin:se,availableCapacityUSD:R}}return{}},[o])}function rs(o,a){return{lpRate:i.useMemo(()=>o&&a?we(a).eq(0)?"100%":`${Ea(we(o).div(we(o).add(a)).mul(100).toString(),2,6)}%`:"0%",[o,a])}}function ra(o,a,e=!1){return{amountLimit:i.useMemo(()=>{if(a)return we(a).mul(e?1+o:1-o).toString()},[a,o,e])}}function ca(o){return{stakeProtocolName:i.useMemo(()=>{if(o){if(o.includes("HASUI"))return"Haedal";if(o.includes("AFSUI"))return"Aftermath";if(o.includes("CERT"))return"Volo"}},[o])}}function cs(o,a,e,l,n,r,x,s,p,S,h,g){const{balanceInfo:f}=Qt(e),{balanceInfo:c}=Qt(l),{amountInputA:C,amountInputB:u,setAmountInputA:d,setAmountInputB:I,setCalculateResult:A,calculateResult:F}=Te(),{getTokenAmountValueByPyth:L}=Et(),{getTokenAmountValue:R}=rt(),{volatileVaultsSdk:B,haedalFarmSdk:se}=bt(),_=Ut("vaults"),{vaultsSlippage:Z}=lt(),{updateCurrentVaultById:P}=Nt(),{fetchAccountBalance:pe}=na(),[oe,Y]=i.useState(!1),{currentAccount:D}=Me(),{pythPriceMap:T}=ea(),{mevProtect:q,transactionMode:ne,maxCapForGas:le,customGasPrice:K}=lt(),{getVaultsFarmingStaked:Se}=Xt(),{vaultsFarmObj:ie,autoClaimStakeFarming:he}=Ae(),N=i.useMemo(()=>ie[o],[ie,o]),[re,be]=i.useState(0),ye=i.useRef(0);i.useEffect(()=>{ye.current=re},[re]);const G=i.useMemo(()=>a=="cetus"?R(e==null?void 0:e.coin_type,C):x&&oe&&r==(e==null?void 0:e.coin_type)?w(p||"0").mul(re).div(100).toString():L(e==null?void 0:e.coin_type,C),[e==null?void 0:e.coin_type,C,T,a,x,oe,re]),ge=i.useMemo(()=>a=="cetus"?R(l==null?void 0:l.coin_type,u):x&&oe&&r==(l==null?void 0:l.coin_type)?w(p||"0").mul(re).div(100).toString():L(l==null?void 0:l.coin_type,u),[e==null?void 0:e.coin_type,u,T,a,x,oe,re]),M=i.useMemo(()=>n?l:e,[n,e,l]),z=i.useMemo(()=>n?e:l,[n,e,l]),[_e,de]=i.useState(""),H=i.useRef("");i.useEffect(()=>{console.log("🚀🚀🚀 ~ useVaultsAdd.ts:122 ~ useVaultsAdd ~ uuid:",_e),H.current=_e},[_e]);const[fe,Pe]=i.useState(!1),Oe=i.useRef(!1);i.useEffect(()=>{Oe.current=fe},[fe]);const[Le,et]=i.useState(!1),[Je,ze]=i.useState(!1),[Ze,te]=i.useState(!1),xe=i.useRef(""),ce=i.useRef("");i.useEffect(()=>{xe.current=C},[C]),i.useEffect(()=>{ce.current=u},[u]);const V=i.useMemo(()=>x?r=="both"?"FlexibleBoth":r==(M==null?void 0:M.coin_type)?"OnlyCoinA":"OnlyCoinB":(a=="cetus-dlmm","FixedOneSide"),[x,r,M,a]),Fe=(b,m,O=!1)=>{if(console.log("🚀🚀🚀 ~ useVaultsAdd.ts:141 ~ wrapRes ~ res:",b),b)if(a=="haedal"||a=="cetus-dlmm"){const W=w(b.deposit_amount_a).div(10**M.decimals).toString();console.log("🚀🚀🚀 ~ useVaultsAdd.ts:162 ~ wrapRes ~ amountA:",W);const Q=w(b.deposit_amount_b).div(10**z.decimals).toString();O?((r=="both"||r==(e==null?void 0:e.coin_type))&&d(n?Q:W),(r=="both"||r==(l==null?void 0:l.coin_type))&&I(n?W:Q)):m?I(n?W:Q):d(n?Q:W)}else{const W=w(b.amount_a).div(10**M.decimals).toString(),Q=w(b.amount_b).div(10**z.decimals).toString();m?I(n?W:Q):d(n?Q:W)}},Ke=async(b,m,O,W)=>{try{te(!0);const Q=(n?!m:m)?M:z,ee=(n?!m:m)?z:M,ue=ve(b,Q.decimals),k=ve(O||0,ee.decimals),J=n?!m:m;et(J),a=="haedal"?je(W,ue,m,k,J):a=="cetus-dlmm"?je(W,ue,m,k,J,!0):$e(W,ue,m,J)}catch{te(!1)}},[Be,Ie]=i.useState(void 0),je=async(b,m,O,W,Q,ee=!1)=>{let ue={uuid:b,mode:"FixedOneSide",fixed_amount:"0",fixed_coin_a:Q,pool_id:o};x?(V==="OnlyCoinA"&&(ue={uuid:b,mode:V,pool_id:o,coin_amount_a:m}),V==="OnlyCoinB"&&(ue={uuid:b,mode:V,pool_id:o,coin_amount_b:m}),V=="FlexibleBoth"&&(ue={uuid:b,mode:V,pool_id:o,coin_amount_a:Q?m:W,coin_amount_b:Q?W:m})):ue={uuid:b,mode:"FixedOneSide",fixed_amount:m,fixed_coin_a:Q,pool_id:o};let k;if(console.log("🚀🚀🚀 ~ useVaultsAdd.ts:273 ~ haedalPreCalculate ~ isDlmm:",ee),ee)try{Ie(void 0),k=await B.VaultsV2.preCalculateDepositAmount(ue,{onSuccess:J=>{console.log("🚀🚀🚀 ~ useVaultsAdd.ts:lb ~ haedalPreCalculate ~ receive_lp_amount:",J,V,b,H.current,xe.current,ce.current);const Ce=V=="FixedOneSide"||V=="OnlyCoinA"||V=="OnlyCoinB"?xe.current||ce.current:xe.current&&ce.current;if(!Ce){A(void 0),te(!1);return}b==H.current&&Ce&&(J=="0"?A(void 0):(A({amount_a:n?k.deposit_amount_b:k.deposit_amount_a,amount_b:n?k.deposit_amount_a:k.deposit_amount_b,ft_amount:J}),$(k)),setTimeout(()=>{te(!1)},500))},onError:(J,Ce)=>{console.log("🚀🚀🚀 ~ useVaultsAdd.ts:lb ~ haedalPreCalculate ~ error:",J),Ce===H.current&&(te(!1),A(void 0))}})}catch(J){b===H.current&&(A(void 0),Ie(void 0),te(!1)),console.log("🚀🚀🚀 ~ useVaultsAdd.ts:302 ~ haedalPreCalculate ~ error:",J),String(J).includes("is less than 1")&&Ie("amountTooSmall")}else k=await B.Vaults.preCalculateDepositAmount(ue,{onSuccess:J=>{console.log("🚀🚀🚀 ~ useVaultsAdd.ts:301 ~ haedalPreCalculate ~ receive_lp_amount:",J),b==H.current&&(V=="FixedOneSide"||V=="OnlyCoinA"||V=="OnlyCoinB"?xe.current||ce.current:xe.current&&ce.current)?(A({amount_a:n?k.deposit_amount_b:k.deposit_amount_a,amount_b:n?k.deposit_amount_a:k.deposit_amount_b,ft_amount:J}),te(!1),$(k)):(te(!1),A(void 0))},onError:(J,Ce)=>{console.log("🚀🚀🚀 ~ useVaultsAdd.ts:321 ~ haedalPreCalculate ~ error:",J),te(!1)}});console.log("🚀🚀🚀 ~ useVaultsAdd.ts:279 ~ res:",k,V),console.log("🚀🚀🚀 ~ useVaultsAdd.ts:327 ~ haedalPreCalculate ~ uuidRef.current:",H==null?void 0:H.current,b,V),H.current===b&&V=="FixedOneSide"&&b==H.current&&Fe(k,O)},$e=async(b,m,O,W)=>{if(M&&z&&o)try{te(!0);const Q={vault_id:o,fix_amount_a:W,input_amount:m,slippage:Number(Z),request_id:b,side:r==="both"?pt.Both:pt.OneSide},ee=await _.Vaults.calculateDepositAmount(Q,!0,!0);console.log("🚀🚀🚀 ~ useVaultsAdd.ts:204 ~ lstPreCalculate ~ res:",ee),H.current===b&&(x||Fe(ee,O),A(ee),te(!1))}catch{A(void 0)}finally{te(!1)}},Ye=mt(Ke,500),ct=async(b,m,O)=>{if(te(!1),m?d(b):I(b),p=="0"&&(a=="haedal"||a=="cetus-dlmm"))return;if(Pe(m),!b&&!O){We();return}if(r=="both"&&x&&(!+b||!+O)){te(!1),A(void 0),be(0);return}const W=a=="haedal"?L(m?e.coin_type:l.coin_type,b):R(m?e.coin_type:l.coin_type,b),Q=a=="haedal"?L(m?l.coin_type:e.coin_type,O):R(m?l.coin_type:e.coin_type,O),ee=w(W).add(w(Q));if(x&&(ee.gt(1e4)||ee.gt(0)&&ee.lt(1e-4))){be(0);return}if(console.log("🚀🚀🚀 ~ useVaultsAdd.ts:436 ~ handleAmountInputChange ~ +amount:",+b),+b){const ue=Qe();de(ue),H.current=ue,Ye(b,m,O,ue)}else!x&&(!b||+b==0)&&Dt(b)?We():(m?I(""):d(""),A(void 0))},We=()=>{d(""),I(""),be(0),de(""),H.current="",A(void 0),te(!1)},Ee=i.useMemo(()=>w(G||"0").add(ge||"0").toString(),[G,ge]),gt=i.useMemo(()=>x?w(Ee).gt(w(1e4)):!1,[Ee,x]),St=i.useMemo(()=>x?w(Ee).gt(0)&&w(Ee).lt(w(1e-4)):!1,[Ee,x]),{stakeProtocolName:_t}=ca(Le?z==null?void 0:z.coin_type:M==null?void 0:M.coin_type),Ct=i.useMemo(()=>{if(a!="haedal"&&r!=="both"&&M&&z&&(+C||+u)){const b=Le?C:u,m=Le?M:z,O=Le?z:M;if(F&&F.swap_result){const W=qe(F.swap_result.swap_in_amount,m.decimals),Q=qe(w(F.swap_result.swap_out_amount).mul(1-Number(Z)).toString(),O.decimals);return Rt.isSuiCoin(m.coin_type)?`By depositing ${Xe(Re(b,9).toString(),9)} SUI, ${Xe(Re(W,9).toString(),9)} SUI will be converted to ${O==null?void 0:O.symbol} via ${_t} liquid staking and added to the pool together.`:`By depositing ${Xe(Re(b,9).toString(),9)} ${m==null?void 0:m.symbol}, ${Xe(Re(W,9).toString(),9)} ${m==null?void 0:m.symbol} will be traded for ${Xe(Re(Q,9).toString(),9)} ${O==null?void 0:O.symbol} and then added to the pool together.`}else if(!Rt.isSuiCoin(r)){const W=R(r,b);if(w(W).gt(1e4))return"Single-asset deposit can't be higher than $10,000 at a time."}}},[r,F,C,u,a]);i.useEffect(()=>{a!=="cetus-dlmm"&&Ie(void 0)},[a]);const{signAndExecuteTransaction:tt,transactionConfirmation:wt,transactionRejected:jt}=Ht(),Ve=()=>{if(console.log("🚀🚀🚀 ~ useVaultsAdd.ts:492 ~ reCalculateResult ~ availableCapacityUSD:",p,a),p=="0"&&a=="haedal"){d(""),I(""),be(0),te(!1),A(void 0);return}if(!(r=="both"&&(!+C||!+u)))if(oe)E(ye.current,S,s,_e);else{const b=Oe.current?xe.current:ce.current,m=fe?ce.current:xe.current;if(+b){const O=Qe();de(O),H.current=O,Ye(b,fe,m,O)}else Ie(void 0),te(!1)}};i.useEffect(()=>{F&&Ie(void 0)},[F]);const E=mt(async(b,m,O,W)=>{var ee;console.log("🚀🚀🚀 ~ useVaultsAdd.ts:520 ~ preCalculateDepositValue ~ coin:",O);const Q=(ee=T[at((O==null?void 0:O.coin_type)||(O==null?void 0:O.coinType),!1)])==null?void 0:ee.price;if(M&&z&&o){const ue=w(m).mul(b).div(100).mul(Q).toString();if(ue=="0"){A(void 0),d(""),I(""),be(0),te(!1);return}w(m).mul(b).div(100).toString(),te(!0);const k={mode:V==="FixedOneSide"?"FlexibleBoth":V,pool_id:o,amount_usd:ue,uuid:W};console.log("🚀🚀🚀 ~ useVaultsAdd.ts:472 ~ preCalculateDepositValue ~ params:",JSON.stringify(k));let J;if(a=="cetus-dlmm"?J=await B.VaultsV2.preCalculateDepositValue(k,{onSuccess:(Ce,He)=>{He==H.current&&(V=="FixedOneSide"||V=="OnlyCoinA"||V=="OnlyCoinB"?xe.current||ce.current:xe.current&&ce.current)?(A({amount_a:n?J.deposit_amount_b:J.deposit_amount_a,amount_b:n?J.deposit_amount_a:J.deposit_amount_b,ft_amount:Ce}),te(!1)):(te(!1),A(void 0))},onError:(Ce,He)=>{console.log("🚀 ~ preCalculate ~ error:",Ce)}}):J=await B.Vaults.preCalculateDepositValue(k,{onSuccess:(Ce,He)=>{He==H.current&&(V=="FixedOneSide"||V=="OnlyCoinA"||V=="OnlyCoinB"?xe.current||ce.current:xe.current&&ce.current)?(A({amount_a:n?J.deposit_amount_b:J.deposit_amount_a,amount_b:n?J.deposit_amount_a:J.deposit_amount_b,ft_amount:Ce}),te(!1)):(te(!1),A(void 0))},onError:(Ce,He)=>{console.log("🚀 ~ preCalculate ~ error:",Ce)}}),W!==H.current)return;console.log("🚀🚀🚀 ~ useVaultsAdd.ts:492 ~ preCalculateDepositValue ~ res:",J),Fe(J,!0,!0)}},500),y=(b,m,O,W)=>{if(console.log("🚀🚀🚀 ~ useVaultsAdd.ts:536 ~ handlePercentInputChange ~ percent:",b),w(b).lte(0)){A(void 0),Ie(void 0),d(""),I(""),te(!1);return}E(b,m,O,W)},$=async b=>{if(console.log("🚀🚀🚀 ~ useVaultsAdd.ts:503 ~ calculateDepositRatioWithAvailableCapacity ~ wrapRes:",b),M&&z){const m=st(b.deposit_amount_a,M==null?void 0:M.decimals),O=st(b.deposit_amount_b,z==null?void 0:z.decimals),W=L(M==null?void 0:M.coin_type,String(m)),Q=L(z==null?void 0:z.coin_type,String(O)),ee=w(W).add(w(Q)).toString(),ue=w(ee).div(w(p)).mul(100);if(console.log("🚀🚀🚀 ~ useVaultsAdd.ts:624 ~ calculateDepositRatioWithAvailableCapacity ~ availableCapacityUSD:",p),p=="0"){be(0),d(""),I(""),A(void 0),te(!1);return}if(ue.gt(100)){const k=Qe();de(k),H.current=k,be(100),E(100,S,s,k)}else if(console.log("🚀🚀🚀 ~ useVaultsAdd.ts:678 ~ calculateDepositRatioWithAvailableCapacity ~ uui:",_e,H.current),xe.current||ce.current){const k=Re(ue.toString(),2);be(Number(k))}}},j=async()=>{var b;if(o){let m;a=="haedal"||a=="cetus-dlmm"?m={pool_id:o,amount_a:String(n?ve(u||0,String(M==null?void 0:M.decimals)):ve(C||0,String(M==null?void 0:M.decimals))),amount_b:String(n?ve(C||0,String(z==null?void 0:z.decimals)):ve(u||0,String(z==null?void 0:z.decimals)))}:m={vault_id:o,slippage:Number(Z),deposit_result:F},console.log("🚀🚀🚀 ~ useVaultsAdd.ts:261 ~ doAddAction ~ depositParams:",F);const O={getShowInfo:(W,Q,ee)=>{console.log("🚀🚀🚀 ~ useVaultsAdd.ts:306 ~ doAddAction ~ res:",ee);const ue="Deposit "+[De(C,n?z==null?void 0:z.symbol:M==null?void 0:M.symbol),De(u,n?M==null?void 0:M.symbol:z==null?void 0:z.symbol)].filter(Boolean).join(" and "),k={modalDescriptionText:ue,toastTitleText:ue};if(W==="success"){let J=C,Ce=u;ee&&ee.events.forEach(ut=>{(ut.type.indexOf("::pool::DepositEvent")>-1||ut.type.indexOf("::vault::DepositEvent")>-1)&&M&&z&&(J=String(st(ut.parsedJson.amount_a,M.decimals)),Ce=String(st(ut.parsedJson.amount_b,z.decimals)))});const He="Deposit "+[De(n?Ce:J,n?z==null?void 0:z.symbol:M==null?void 0:M.symbol),De(n?J:Ce,n?M==null?void 0:M.symbol:z==null?void 0:z.symbol)].filter(Boolean).join(" and ");k.toastDescriptionContent=He,k.modalDescriptionText=He,k.toastTitleText="Deposit successful"}return k}};wt(O),console.log("🚀🚀🚀 ~ useVaultsAdd.ts:662 ~ doAddAction ~ vaultsFarmingStaked:",{vaultsFarmingStaked:g,currentVaultsFarmsReward:h}),N!=null&&N.isVaultsFarming&&he&&(m.return_lp_coin=!0);try{const W=new ot;if(W.setSender(D.address),a=="haedal"){const ee=await B.Vaults.buildDepositPayload(m,W);N!=null&&N.isVaultsFarming&&he&&await se.Farms.buildStakePayload({poolId:N==null?void 0:N.poolId,stakeCoinType:N==null?void 0:N.stakeCoinType,stakeObjectId:g==null?void 0:g.stakeObjectId,lpCoin:ee,decimals:(b=N==null?void 0:N.coinDetail)==null?void 0:b.decimals},W)}else if(a=="cetus-dlmm"){const ee=await B.VaultsV2.buildDepositPayload(m,W)}else console.log("🚀🚀🚀 ~ useVaultsAdd.ts:447 ~ doAddAction ~ vaultsSdk:",_,m),await _.Vaults.deposit(m,W);console.log("🚀 ~ doAddAction ~ depositParams11111:",m),await tt(W,O,{useMev:q,txAction:"signTransactionBlock",useFastMode:ne==="Fast Mode",maxCapForGas:le,customGasPrice:K,msafeParams:{action:nt.AddVaultsPosition,txbParams:m}})?(We(),setTimeout(()=>{pe(),P(o)},2e3),N!=null&&N.isVaultsFarming&&(Se({stakeCoinType:g.stakeCoinType,poolId:g.poolId},o),console.log("🚀🚀🚀 ~ useVaultsAdd.ts:714 ~ doAddAction ~ vaultsFarmingStaked:",g))):Ve()}catch(W){console.log("🚀🚀🚀 ~ useVaultsAdd.ts:418 ~ doAddAction ~ error:",W),jt(O)}}},U=i.useMemo(()=>r==(s==null?void 0:s.coin_type)||r=="both",[r,s]);return i.useEffect(()=>()=>{H.current=""},[]),{balanceInfoA:f,balanceInfoB:c,amountValueA:G,amountValueB:ge,handleAmountInputChange:ct,amountInputA:C,amountInputB:u,setAmountInputA:d,setAmountInputB:I,resetInputAmount:We,preCalculateLoading:Je,isFixedDisplayTokenA:fe,zapNumGtError:gt,zapNumLtError:St,calculateLpLoading:Ze,inputTotalValue:Ee,showOnlySideTips:Ct,doAddAction:j,reCalculateResult:Ve,percentage:re,setPercentage:be,isSlider:oe,setIsSlider:Y,handlePercentInputChange:y,isQuoteCoin:U,setUuid:de,uuidRef:H,preCalcError:Be}}function ua(o,a,e,l,n,r,x,s,p,S,h,g){const{currentAccount:f}=Me(),{calculateResult:c}=Te(),C=i.useMemo(()=>{const u={text:void 0,disabled:!1};if(!(f!=null&&f.address))return u.text="Connect Wallet",u.disabled=!1,u;if(!n||!r)return u.disabled=!0,u;if(x==="both"){if(!+o&&!+a||g&&(!+o||!+a))return u.text="Enter an amount",u.disabled=!0,u}else{if(x==(n==null?void 0:n.coin_type)&&!+o||x==(r==null?void 0:r.coin_type)&&!+a)return u.text="Enter an amount",u.disabled=!0,u;if(h=="cetus"&&s){const d=Rt.isSuiCoin(x);if(d&&x===(n==null?void 0:n.coin_type)&&w(o).lt(3)||d&&x===(r==null?void 0:r.coin_type)&&w(a).lt(3))return u.text="Minimum deposit 3 SUI",u.disabled=!0,u}}if(x=="both"){if(w(o||"0").gt(e||"0"))return u.disabled=!0,u.text=s?`Insufficient ${n==null?void 0:n.symbol} Balance`:"Invalid Amount",u;if(w(a||"0").gt(l||"0"))return u.disabled=!0,u.text=s?`Insufficient ${r==null?void 0:r.symbol} Balance`:"Invalid Amount",u}if(x!=="both"){if(w(o||"0").gt(e||"0"))return u.disabled=!0,u.text=s?`Insufficient ${n==null?void 0:n.symbol} Balance`:"Invalid Amount",u;if(w(a||"0").gt(l||"0"))return u.disabled=!0,u.text=s?`Insufficient ${r==null?void 0:r.symbol} Balance`:"Invalid Amount",u}return s&&p||s&&S?(u.text="Enter an amount",u.disabled=!0,u):((c&&c.ft_amount=="0"||c&&c.burn_ft_amount=="0"||!c)&&(u.disabled=!0,u.text="Enter an amount"),u)},[o,a,e,l,n,r,x,p,S,h,f==null?void 0:f.address,c]);return{btnText:C.text,btnDisabled:C.disabled}}const us=(o,a)=>({isCheckedAcceptWalletObj:{},setIsCheckedAcceptWalletObj:e=>o(()=>({isCheckedAcceptWalletObj:{...a().isCheckedAcceptWalletObj,...e}})),isCheckedDontRemindWalletObj:{},setIsCheckedDontRemindWalletObj:e=>o(()=>({isCheckedDontRemindWalletObj:{...a().isCheckedDontRemindWalletObj,...e}}))}),da=ta(Ua(us,{name:"useVaultsRiskStore",partialize:o=>{const{isCheckedAcceptWalletObj:a,isCheckedDontRemindWalletObj:e}=o;return{isCheckedAcceptWalletObj:a,isCheckedDontRemindWalletObj:e}}})),ds={customDeposit:"Through Zap-In, you can deposit your liquidity in single token or with customized token ratio. Tokens will be auto converted to match the required ratio. ",deposit:"Through Zap-In, you can deposit your liquidity in single token. Tokens will be auto converted to match the required ratio.",withdraw:"Through Zap-Out, you can withdraw your liquidity in one token. The liquidity will be auto converted to one token you selected."};function ms(o){const{isCheckedZAP:a,zapText:e,tooltipType:l,zapSwitchChange:n}=o,{isApp:r}=$t();return t.jsx(ke,{bg:"none",border:"none",padding:"6px 0px",borderRadius:"8px",width:"unset",children:t.jsxs(ba,{isLazy:!0,trigger:r?"click":"hover",placement:"top",autoFocus:!1,returnFocusOnClose:!1,children:[t.jsx(ha,{children:t.jsxs(me,{h:"14px",cursor:"pointer",as:"button",children:[t.jsx(ae,{fontSize:"14px",color:a?"primary":"",fontWeight:"500",children:e}),t.jsx(It,{isChecked:a,onChange:()=>n(!a)})]})}),t.jsx(ga,{minW:"fit-content",w:"fit-content",children:t.jsx(Sa,{p:"12px",lineHeight:"20px",fontSize:"12px",maxWidth:"320px",children:ds[l]})})]})})}const ps="You can also choose to deposit in only one asset type. In that case, the vault will convert your asset to the required propositions using Cetus. Please note that trading fees & slippage will be applied. When slippage is involved, a certain amount of post-swap dust (no loss of funds) will be returned to you.",fs=(o,a)=>`When you deposit in only SUI tokens, a part of your SUI amount will be converted to ${a} via ${o} liquid staking services to match required liquidity compositions of the liquidity pool on Cetus. A certain amount of dust (no loss of funds) will be returned to you if slippage is involved.`,Ne={Deposit:"Deposit"};function ma(o){const{displayTokenA:a,displayTokenB:e,onSelectAssetTab:l,label:n="Deposit Amounts",isCheckedZAP:r,setIsCheckedZAP:x,assetAction:s,setAssetAction:p,category:S,currentActionTab:h}=o,{stakeProtocolName:g}=ca(a==null?void 0:a.coin_type),f=i.useMemo(()=>S==="haedal"||S==="cetus-dlmm",[S]),c=()=>{if(!a||!e)return[];const I=[{label:`${a.symbol} only`,action:a.coin_type,afterIcon:r&&h===Ne.Deposit&&!f?{xlinkHref:"#icon-icon_tips"}:void 0,tooltip:f?h===Ne.Deposit?`You can add liquidity in this pool with only ${a.symbol}.`:"":ps},{label:`${e.symbol} only`,action:e.coin_type,afterIcon:r&&h===Ne.Deposit&&!f?{xlinkHref:"#icon-icon_tips"}:void 0,tooltip:f?h===Ne.Deposit?`You can add liquidity in this pool with only ${e.symbol}.`:"":fs(g,a==null?void 0:a.symbol)}];return f&&h===Ne.Deposit&&I.splice(1,0,{label:`${a.symbol}+${e.symbol}`,action:"both",tooltip:"You can add any value you want from both assets."}),I},C=i.useMemo(c,[a,e,r,g,f,h]),u=i.useMemo(()=>{var I,A,F;if(C.length!==0)return s===(a==null?void 0:a.coin_type)?C[0].label:s===(e==null?void 0:e.coin_type)?f&&h===Ne.Deposit?(I=C[2])==null?void 0:I.label:(A=C[1])==null?void 0:A.label:(F=C[1])==null?void 0:F.label},[s,C,f,h,a==null?void 0:a.coin_type,e==null?void 0:e.coin_type]),d=i.useMemo(()=>h===Ne.Deposit?f?"customDeposit":"deposit":"withdraw",[h,f]);return t.jsxs(X,{w:"100%",gap:"16px",children:[t.jsxs(me,{w:"100%",justifyContent:"space-between",children:[t.jsx(ae,{fontWeight:"500",children:n}),t.jsx(ms,{isCheckedZAP:r,zapText:h===Ne.Deposit?"Zap In":"Zap Out",tooltipType:d,zapSwitchChange:I=>{x(!r),p(I?(a==null?void 0:a.coin_type)??"":"both")}})]}),r&&C.length>0&&t.jsx(ht,{wrapStyle:{w:"100%",h:"48px",borderRadius:"12px",p:"3px"},itemStyle:{w:"50%",fontSize:"14px",borderRadius:"8px",fontWeight:"500"},type:"outlineTab",currentTab:u,tabList:C,handleChangeTab:I=>{p(I.action),l(I.action)}})]})}const dt=({children:o})=>t.jsx(ae,{lineHeight:"20px",color:"text_caption",fontSize:"12px",position:"relative",pl:"10px",_before:{content:'""',display:"inline-block",w:"4px",h:"4px",borderRadius:"50%",bg:"primary",position:"absolute",left:"0",top:"8px"},children:o});function xs(o){const{isOpen:a,setIsOpen:e,continueFunc:l}=o,[n,r]=i.useState(!1),[x,s]=i.useState(!1),{setIsCheckedAcceptWalletObj:p,setIsCheckedDontRemindWalletObj:S}=da(),{currentAccount:h}=Me(),g=()=>{const c={[h==null?void 0:h.address]:n};p(c);const C={[h==null?void 0:h.address]:x};S(C),l()},{isApp:f}=$t();return t.jsxs(Ot,{isCentered:!0,isOpen:a,onClose:()=>{e(!1)},children:[t.jsx(At,{}),t.jsxs(Mt,{width:{base:"100%",lg:"480px"},children:[t.jsx(Lt,{children:t.jsx(ae,{fontSize:f?"14px":"16px",fontWeight:"500",color:"caption",lineHeight:f?"20px":"40px",children:"Risk Acknowledgement"})}),t.jsx(zt,{m:f?"":"12px 2px 0 0"}),t.jsxs(Wt,{p:"0 16px",children:[t.jsxs(X,{bg:"menu_item_bg",borderRadius:"8px",border:"1px solid",borderColor:"border",p:"16px 12px",gap:f?"12px":"16px",children:[t.jsx(ae,{w:"100%",textAlign:"left",fontSize:"12px",children:"Before you provide liquidity via this vault:"}),t.jsxs(X,{gap:f?"12px":"16px",children:[t.jsx(dt,{children:"You acknowledge that this vault strategy is provided by a third party. Cetus integrates it at the UI level for user convenience but does not operate this product or take responsibility for third-party risks."}),t.jsx(dt,{children:"You acknowledge that the displayed APR and APY are based on historical data and not a guaranteed return."}),t.jsx(dt,{children:"You understand that APR and APY figures reflect past trading fees and rewards only, excluding impermanent loss and price volatility."}),t.jsx(dt,{children:"You recognize the risks associated with automated liquidity strategies, including market fluctuations and third-party operational risks."}),t.jsx(ae,{fontSize:"12px",color:"text_paragraph",lineHeight:"20px",children:"Please assess these risks carefully and proceed only if you fully understand and accept them."})]})]}),t.jsxs(X,{bg:"menu_item_bg",borderRadius:"8px",border:"1px solid",borderColor:"border",p:f?"12px 16px":"16px",justifyContent:"flex-start",alignItems:"flex-start",m:"16px 0",userSelect:"none",gap:f?"8px":"12px",children:[t.jsxs(me,{children:[t.jsx(Jt,{checked:n,onClick:()=>r(!n)}),t.jsx(ae,{fontWeight:"500",color:"text_caption",children:"I acknowledge and accept all the risks."})]}),t.jsxs(me,{children:[t.jsx(Jt,{checked:x,onClick:()=>s(!x)}),t.jsx(ae,{fontSize:"12px",color:"text_paragraph",children:"Don't remind me again."})]})]}),t.jsx(Ue,{w:"calc(100% + 32px)",h:"52px",bg:"primary",borderRadius:"12px",fontWeight:"600",ml:"-16px",isDisabled:!n,onClick:g,children:"Continue"})]})]})]})}function bs({percentage:o,onChange:a,quoteCoin:e,availableCapacityWithQuoteCoin:l,availableCapacityUSD:n}){const r=i.useMemo(()=>!n,[n]),x={fontSize:"sm",position:"absolute",ml:"-5px",top:"50%",transform:"translateY(-50%)",zIndex:"100",borderRadius:"50%"},s=[0,25,50,75,100];return t.jsx(t.Fragment,{children:r?t.jsxs(X,{width:"100%",maxHeight:"164px",justifyContent:"space-between",children:[t.jsx(vt,{width:"100%"}),t.jsx(vt,{width:"100%"}),t.jsx(vt,{width:"100%"})]}):t.jsxs(X,{width:"100%",alignItems:"start",gap:"0px",children:[t.jsx(ae,{textAlign:"left",children:"Available Capacity"}),t.jsxs(me,{w:"100%",alignItems:"center",justifyContent:"space-between",mt:"12px",children:[t.jsx(Fa,{tooltip:t.jsxs(me,{children:[t.jsx(Zt,{src:e==null?void 0:e.logo_url,w:"20px",h:"20px"},e==null?void 0:e.coin_type),t.jsx(ae,{color:"text_caption",children:Re(l,2)}),t.jsx(ae,{color:"text_caption",children:e==null?void 0:e.symbol})]}),children:t.jsx(me,{w:"100%",alignItems:"center",justifyContent:"space-between",children:t.jsx(ae,{color:"text_caption",height:"14px",textAlign:"left",fontSize:"16px",textDecoration:"underline dotted",children:it(n,"$")})})}),t.jsxs(_a,{"aria-label":"slider-ex-6",min:0,max:100,focusThumbOnChange:!1,value:o=="--"?0:Number(o),onChange:p=>a(p),w:{base:"165px",lg:"210px"},isDisabled:Number(n)<=0,children:[s.filter(p=>p!==Number(o)).map((p,S)=>t.jsx(Yt,{...x,value:p,w:"8px",h:"8px",bg:Number(o)>=p?"primary":"#384651",onClick:()=>a(p)},S)),t.jsx(Yt,{value:Number(o),textAlign:"center",bg:"primary_opacity.10",p:"2px 4px",borderRadius:"4px",fontSize:"12px",color:"primary",mt:"-28px",ml:"-15px",children:Ba(o,2)}),t.jsx(Ca,{bg:"#384651",height:"2px",borderRadius:"4px",children:t.jsx(wa,{height:"2px",bg:"primary",borderRadius:"2px"})}),t.jsx(ja,{p:"1px",w:"10px",h:"10px",border:"1px solid primary",position:"relative",zIndex:"100",borderRadius:"50%",_before:{content:'""',w:"6px",h:"6px",borderRadius:"50%",border:"1px solid #2b2e32"}})]})]}),!r&&n==0?t.jsx(X,{w:"100%",alignItems:"start",mt:"16px",children:t.jsx(ae,{color:"primary_yellow",fontSize:"12px",textAlign:"left",w:"100%",bg:"primary_yellow_opacity.10",p:"12px",borderRadius:"8px",lineHeight:"20px",children:"The vault has reached its current capacity. New deposits are not accepted at this time."})}):null]})})}function hs(o){const{currentAccount:a,onWalletModal:e}=Me(),{assetAction:l,setAssetAction:n,isCheckedZAP:r,setIsCheckedZAP:x}=Te(),{category:s,isReverse:p,vaultId:S,currentActionTab:h,totalSupply:g,lpTokenInfo:f,feeTier:c,isModal:C,isAutoRefresh:u,currentVaultsFarm:d,vaultsFarmingStaked:I,binStep:A}=o,{fromToken:F,toToken:L,calculateResult:R}=Te(),{vaultsPoolObj:B}=kt(),se=i.useMemo(()=>B[S],[B,S]);console.log("🚀🚀🚀 ~ VaultsAdd.tsx:63 ~ VaultsAdd ~ currentVaultPool:",se);const _=is(se);console.log("🚀🚀🚀 ~ VaultsAdd.tsx:65 ~ VaultsAdd ~ avaiableCapacityInfo:",_);const{balanceInfoA:Z,balanceInfoB:P,amountValueA:pe,amountValueB:oe,handleAmountInputChange:Y,amountInputA:D,amountInputB:T,resetInputAmount:q,preCalculateLoading:ne,zapNumGtError:le,zapNumLtError:K,calculateLpLoading:Se,inputTotalValue:ie,showOnlySideTips:he,doAddAction:N,reCalculateResult:re,percentage:be,setPercentage:ye,setIsSlider:G,preCalcError:ge,handlePercentInputChange:M,isQuoteCoin:z,setUuid:_e,uuidRef:de}=cs(S,s,F,L,p,l,r,_==null?void 0:_.quoteCoin,_==null?void 0:_.availableCapacityUSD,_==null?void 0:_.availableCapacityWithQuoteCoin,d,I);i.useEffect(()=>{q()},[r,l,S]);const[H,fe]=i.useState(!1),{isApp:Pe}=$t(),{btnText:Oe,btnDisabled:Le}=ua(D,T,(Z==null?void 0:Z.balanceFormat)||"",(P==null?void 0:P.balanceFormat)||"",F,L,l,!0,le,K,s,r),{vaultsSlippage:et}=lt(),{lpRate:Je}=rs(R==null?void 0:R.ft_amount,g),{amountLimit:ze}=ra(Number(et),R==null?void 0:R.ft_amount,!1),[Ze,te]=i.useState(null),xe=()=>({feeTier:c||"",displayTokenA:F,displayTokenB:L,displayAmountA:D,displayAmountB:T,totalAmountValue:ie,sharePool:Je,lpAmountLimit:ze||"0",lpDecimals:f==null?void 0:f.decimals,category:s,binStep:A}),{pythPriceMap:ce}=ea(),V=i.useRef(!1);i.useEffect(()=>{V.current=!0},[]),i.useEffect(()=>{V.current&&re()},[u]);const{isCheckedDontRemindWalletObj:Fe}=da(),[Ke,Be]=i.useState(!1),Ie=i.useMemo(()=>!Fe[a==null?void 0:a.address],[Fe,a==null?void 0:a.address]);return i.useEffect(()=>()=>{de.current=""},[]),t.jsxs(X,{gap:C?"8px":"12px",w:"100%",align:"flex-start",children:[t.jsxs(ke,{bg:C?"transparent":"none",border:"none",borderRadius:"12px",p:{base:"0px 0px 8px",lg:C?"0":"0px"},w:"100%",children:[t.jsx(ma,{displayTokenA:F,displayTokenB:L,onSelectAssetTab:je=>{n(je)},setIsCheckedZAP:()=>x(!r),setAssetAction:n,assetAction:l,isCheckedZAP:r,category:s,currentActionTab:h,handleRefreshClick:()=>{console.log("🚀🚀🚀 ~ vaultsAdd.tsx:174 ~ VaultsAdd ~ handleRefreshClick:"),re()}}),t.jsx(X,{mt:C?"8px":"12px",position:"relative",children:t.jsx(Tt,{from:{wrapStyle:{h:"unset",p:{base:"20px 8px",lg:"20px 16px"}},hideSelf:l!=="both"&&l!==(F==null?void 0:F.coin_type),balance:(Z==null?void 0:Z.balanceFormat)||"",value:D,amountValue:D&&pe,loading:!1,onChange:je=>{s=="haedal"&&G(!1),Y(je,!0,T)},selectable:!1,placeholder:"0.0",token:F},to:{wrapStyle:{h:"unset",p:{base:"20px 8px",lg:"20px 16px"}},hideSelf:l!=="both"&&l!==(L==null?void 0:L.coin_type),balance:(P==null?void 0:P.balanceFormat)||"",value:T,amountValue:T&&oe,loading:!1,onChange:je=>{s=="haedal"&&G(!1),Y(je,!1,D)},selectable:!1,placeholder:"0.0",token:L},iconParams:{xlinkHref:"#icon-icon_add",svgFill:"text_caption",iconCursor:"default"},iconHover:!1})})]}),s=="haedal"||s=="cetus-dlmm"&&Ft(ce)&&t.jsx(ke,{bg:"primary_opacity.10",border:"none",borderRadius:"16px",p:"16px",children:t.jsx(bs,{depositRatio:_.depositRatio||"",percentage:be,hardCapUSD:_.hardCapUSD||"",vaultTvl:_.vaultTvl||"",availableCapacityUSD:_.availableCapacityUSD||"",quoteCoin:_.quoteCoin,maxCapNum:_.hardCap||"",availableCapacityWithQuoteCoin:_.availableCapacityWithQuoteCoin||"",onChange:je=>{G(!0),ye(je);const $e=Qe();_e($e),M(je,z?_==null?void 0:_.availableCapacityWithQuoteCoin:_==null?void 0:_.availableCapacityWithBaseCoin,z?_.quoteCoin:_.baseCoin,$e)}})},S),t.jsxs(X,{w:"100%",gap:"16px",children:[t.jsx(Ue,{m:"-1px",isLoading:Se||H,w:"100%",borderRadius:"12px",h:"52px",fontSize:"18px",fontWeight:"500",isDisabled:Le||H||Se,onClick:()=>{a?Ie&&s!=="cetus"?Be(!0):(fe(!0),te(xe())):e(!0)},children:Oe||(r?"Zap In":"Deposit")}),ge&&!ne&&s=="cetus-dlmm"&&t.jsx(Ja,{tips:"Amount too small to allocate across bins. Please increase the amount.",type:"warning"}),le&&(D||T)&&t.jsx(X,{w:"100%",alignItems:"start",gap:"20px",children:t.jsx(ae,{color:"primary_yellow",fontSize:"12px",textAlign:"left",w:"100%",bg:"primary_yellow_opacity.10",p:"12px",borderRadius:"8px",lineHeight:"20px",children:"Single-asset deposit can't be higher than $10,000 at a time."})}),K&&(D||T)&&t.jsx(X,{w:"100%",alignItems:"start",children:t.jsx(ae,{color:"primary_red",fontSize:"12px",textAlign:"left",w:"100%",bg:"primary_red_opacity.10",p:"12px",borderRadius:"8px",lineHeight:"20px",children:"The input is too small. Zap mode is not available."})}),(R||he)&&(D||T)&&t.jsxs(X,{w:"100%",alignItems:"start",gap:"0",mb:C?"12px":"0px",children:[l!=="both"&&he&&t.jsx(ae,{color:"text_paragraph",fontSize:"12px",lineHeight:"1.8",pb:R?"20px":"0",children:he}),R&&t.jsx(ia,{amountLimit:ze,inputTotalValue:ie,preCalculateLoading:ne,calculateLpLoading:Se,lpRate:Je,lpDecimals:f==null?void 0:f.decimals,poolName:`${F==null?void 0:F.symbol} - ${L==null?void 0:L.symbol}`,labelColor:"primary_gray"})]})]}),Ke&&t.jsx(xs,{isOpen:Ke,setIsOpen:Be,continueFunc:()=>{Be(!1),te(xe()),fe(!0)}}),H&&Ze&&t.jsx(ls,{data:Ze,isOpen:H,onClose:()=>{fe(!1)},onSubmitClick:()=>{fe(!1),N()}})]})}function gs(o,a,e,l,n,r,x,s,p){const{autoClaimFarmingReward:S}=Ae(),{currentVaultsFarm:h}=ft(o),{amountInputA:g,amountInputB:f,calculateResult:c,setAmountInputA:C,setAmountInputB:u,setCalculateResult:d}=Te(),{findBestRouters:I}=Ka(),{vaultsSlippage:A,mevProtect:F,maxCapForGas:L,transactionMode:R,customGasPrice:B}=lt(),{getTokenAmountValue:se}=rt(),{volatileVaultsSdk:_,haedalFarmSdk:Z}=bt(),P=Ut("vaults"),{getTokenAmountValueByPyth:pe}=Et(),[oe,Y]=i.useState(!1),[D,T]=i.useState(!1),{fetchAccountBalance:q}=na(),{updateCurrentVaultById:ne}=Nt(),{providers:le}=$a(),K=i.useRef(D);i.useEffect(()=>{K.current=D},[D]);const[Se,ie]=i.useState(!1),[he,N]=i.useState(""),re=i.useRef(he);i.useEffect(()=>{re.current=he},[he]);const be=i.useRef(g),ye=i.useRef(f);i.useEffect(()=>{be.current=g},[g]),i.useEffect(()=>{ye.current=f},[f]);const G=i.useMemo(()=>n?l:e,[n,e,l]),ge=i.useMemo(()=>n?e:l,[n,e,l]),M=a=="haedal"?pe(e==null?void 0:e.coin_type,g||"0"):se(e==null?void 0:e.coin_type,g||"0"),z=a=="haedal"?pe(l==null?void 0:l.coin_type,f||"0"):se(l==null?void 0:l.coin_type,f||"0"),[_e,de]=i.useState(n?s==null?void 0:s.amountB:s==null?void 0:s.amountA),[H,fe]=i.useState(n?s==null?void 0:s.amountA:s==null?void 0:s.amountB),[Pe,Oe]=i.useState(!1),Le=async()=>{const{amountA:v,amountB:E}=s;if(Oe(!1),r==="both"){de(n?E:v),fe(n?v:E);return}const y=r===(G==null?void 0:G.coin_type),$=y?E:v,j=y?v:E;a=="haedal"||a==="cetus-dlmm"?et($,j,y):Je($,j,y)},et=async(v,E,y)=>{if(w(v).gt(0)){Oe(!0);const $={pool_id:o,mode:We,burn_lp_amount:s==null?void 0:s.balance,available_lp_amount:s==null?void 0:s.balance};try{const j=a==="cetus-dlmm"?await _.VaultsV2.preCalculateWithdrawAmount($):await _.Vaults.preCalculateWithdrawAmount($);if(console.log("🚀🚀🚀 ~ useVaultsRemove.ts:127 ~ haedalCalculateAvailableAmount ~ res:",j),We=="OnlyCoinA"){const U=qe(j.receive_amount_a,G==null?void 0:G.decimals);n?fe(U):de(U)}else{const U=qe(j.receive_amount_b,ge==null?void 0:ge.decimals);n?de(U):fe(U)}Oe(!1)}catch(j){console.log("🚀🚀🚀 ~ useVaultsRemove.ts:145 ~ calculateAvailableAmount ~ error:",j)}}else y?de(E):fe(E);Oe(!1)},Je=async(v,E,y)=>{if(w(v).gt(0)){Oe(!0);const $=y?ge:G;I({fromToken:$,toToken:y?G:ge,amount:ve(v,$.decimals).toString(),providersKeys:le,by_amount_in:!0,uuid:Qe()}).then(U=>{U.toAmountUi&&(E=w(E).add(U.toAmountUi).toString()),y?de(E):fe(E)}).finally(()=>{Oe(!1)})}else y?de(E):fe(E)},ze=i.useMemo(()=>w(M||"0").add(z||"0").toString(),[M,z]),Ze=i.useMemo(()=>x?w(ze).gt(w(1e4)):!1,[ze,x]),te=i.useMemo(()=>x?w(ze).gt(0)&&w(ze).lt(w(1e-4)):!1,[ze,x]),[xe,ce]=i.useState(0),V=()=>{C(""),u(""),ce(0),Y(!1),d(void 0),N("")},Fe=(v,E,y,$)=>{var j;if(console.log("🚀🚀🚀 ~ useVaultsRemove.ts:96 ~ wrapRes ~ res:",v,y,$),v){const U=w(a=="haedal"||a=="cetus-dlmm"?v.receive_amount_a:v.amount_a).div(10**G.decimals).toString(),b=w(a=="haedal"||a=="cetus-dlmm"?v.receive_amount_b:v.amount_b).div(10**ge.decimals).toString(),m=w(((j=v.swap_result)==null?void 0:j.swap_out_amount)||"0").div(10**(E?e.decimals:l.decimals)).toString();if(console.log("🚀🚀🚀 ~ useVaultsRemove.ts:239 ~ wrapRes ~ swapOutAmount:",m,U,b),y)if(r=="both")C(n?b:U),u(n?U:b);else if(r==(e==null?void 0:e.coin_type)){const O=w(_e).mul($).div(100).toString();console.log("🚀🚀🚀 ~ useVaultsRemove.ts:264 ~ wrapRes ~ amount:",O),C(O)}else{const O=w(H).mul($).div(100).toString();u(O)}else{if(r!=="both")return;E?u(n?U:b):C(n?b:U)}}},Ke=async(v,E,y,$,j)=>{if(G&&ge&&o){if(!j){if(y){if(w(v).gt(_e)){N(""),u(""),ce(0),d(void 0),Y(!1);return}}else if(w(v).gt(H)){N(""),C(""),d(void 0),Y(!1),ce(0);return}}(+be.current||+ye.current||j)&&Y(!0);const U=(n?!y:y)?G:ge,b=ve(v,U.decimals),m=y?ve(_e,U.decimals):ve(H,U.decimals),O=n?!y:y,W=w(b).div(w(m)),Q=yt(W.mul(s==null?void 0:s.balance).toString(),0,!0),ee=Number(yt(W.mul(100).toString(),2));console.log("🚀🚀🚀 ~ useVaultsRemove.ts:324 ~ preCalculate ~ fixedCoinA:",O),T(O),a==="haedal"?Be(Q,y,$,ee,!1):a=="cetus-dlmm"?Be(Q,y,$,ee,!1,!0):Ie(Q,y,O,$,ee,!1)}},Be=async(v,E,y,$,j,U=!1)=>{let b;if(r=="both"){if($===100){C(_e),u(H),Y(!1),d({receive_amount_a:ve(_e,G.decimals),receive_amount_b:ve(H,ge.decimals),burn_ft_amount:s.balance,mode:"FixedOneSide"});return}b={pool_id:o,mode:"FixedOneSide",burn_lp_amount:String(v)}}else{const m=r==(G==null?void 0:G.coin_type)?"OnlyCoinA":"OnlyCoinB";b={pool_id:o,mode:m,burn_lp_amount:String(v)}}try{let m;if(U?m=await _.VaultsV2.preCalculateWithdrawAmount(b):m=await _.Vaults.preCalculateWithdrawAmount(b),console.log("🚀🚀🚀 ~ useVaultsRemove.ts:386 ~ haedalPreCalculate ~ res:",m,y,re.current),m.burn_lp_amount=="0"){Y(!1),d(void 0);return}if(re.current!==y)return;Fe(m,E,j,$),d({...m,burn_ft_amount:m.burn_lp_amount}),ce($)}catch(m){console.log("🚀🚀🚀 ~ useVaultsRemove.ts:388 ~ haedalPreCalculate ~ error:",m),d(void 0)}finally{Y(!1)}},Ie=async(v,E,y,$,j,U)=>{const b={vault_id:o,fix_amount_a:y,input_amount:v,slippage:Number(A),request_id:$,side:r==="both"?pt.Both:pt.OneSide,is_ft_input:!0,max_ft_amount:s==null?void 0:s.balance};console.log("🚀🚀🚀 ~ useVaultsRemove.ts:275 ~ lstPreCalculate ~ params:",b);try{const m=await P.Vaults.calculateWithdrawAmount(b);if(console.log("🚀🚀🚀 ~ useVaultsRemove.ts:386 ~ res:",m,j),console.log("🚀🚀🚀 ~ useVaultsRemove.ts:215 ~ haedalPreCalculate ~ uuidRef.current:",re.current,$),m.burn_ft_amount=="0"){Y(!1),d(void 0);return}if(re.current!==$)return;Fe(m,E,U,j),d(m),ce(j)}catch{d(void 0)}finally{Y(!1)}},je=mt(Ke,500),$e=mt(a=="cetus"?Ie:Be,500),Ye=(v,E)=>{if(v==0){V();return}console.log("🚀🚀🚀 ~ useVaultsRemove.ts:218 ~ handlePercentInputChange ~ value:",v,a),ie(!0),Y(!0),ce(v);const y=Qe();console.log("🚀🚀🚀 ~ useVaultsRemove.ts:225 ~ handlePercentInputChange ~ uuid:",y),N(y);const $=yt(w(s==null?void 0:s.balance).mul(v/100).toString(),0,!0);console.log("🚀🚀🚀 ~ useVaultsRemove.ts:459 ~ handlePercentInputChange ~ removeLpAmount:",$,s==null?void 0:s.balance);const j=n?!E:E;T(j),a==="haedal"?$e($,E,y,v,!0):a=="cetus-dlmm"?$e($,E,y,v,!0,!0):$e($,E,j,y,v,!0)},ct=(v,E,y,$)=>{if(($||y)&&r!=="both"&&(E?C(v):u(v)),y){Ye(100,E);return}if($){Ye(50,E);return}if(ie(!1),E?C(v):u(v),+v){const j=Qe();N(j),console.log("🚀🚀🚀 ~ useVaultsRemove.ts:515 ~ handleAmountInputChange ~ amount:",v),je(v,!1,E,j)}else console.log("🚀🚀🚀 ~ useVaultsRemove.ts:516 ~ handleAmountInputChange ~ amount:",v,!v&&Dt(v)),!v&&Dt(v)?V():(console.log("🚀🚀🚀 ~ useVaultsRemove.ts:522 ~ handleAmountInputChange ~ isFixedDisplayTokenA:",E),E?u(""):C(""),ce(0),d(void 0),N(""))},We=i.useMemo(()=>x?r=="both"?"FixedOneSide":r==(G==null?void 0:G.coin_type)?"OnlyCoinA":"OnlyCoinB":"FixedOneSide",[x,r,G]),Ee=()=>{const v=n?!K.current:K.current;if(Se)Ye(xe,v);else{const E=K.current?n?ye.current:be.current:n?be.current:ye.current;ct(E,v)}},{signAndExecuteTransaction:gt,transactionConfirmation:St,transactionRejected:_t}=Ht(),[Ct,tt]=i.useState(!1),wt=async()=>{var v,E;if(o&&c&&(s!=null&&s.balance)){tt(!0);let y;if(a=="haedal"||a==="cetus-dlmm")y={pool_id:o,burn_lp_amount:xe==100?s==null?void 0:s.balance:c.burn_ft_amount,mode:We,slippage:Number(A)};else if(r==="both")y={vault_id:o,ft_amount:c==null?void 0:c.burn_ft_amount,slippage:Number(A)};else{const j=r===(G==null?void 0:G.coin_type);if(xe===100)y={vault_id:o,is_ft_input:!0,input_amount:s==null?void 0:s.balance,slippage:Number(A),max_ft_amount:s==null?void 0:s.balance,fix_amount_a:j};else{const U=ve(D?g:f,9);y={vault_id:o,is_ft_input:!1,input_amount:U.toString(),slippage:Number(A),max_ft_amount:s==null?void 0:s.balance,fix_amount_a:j}}}console.log("🚀 ~ doRemoveAction ~ params:",y);const $={getShowInfo:(j,U)=>{const b="Withdraw "+[De(g,e.symbol),De(f,l.symbol)].filter(Boolean).join(" and "),m={modalDescriptionText:b,toastDescriptionContent:b};if(j==="success"){let O=g||"0",W=f||"0";console.log("🚀🚀🚀 ~ useVaultsRemove.ts:582 ~ doRemoveAction ~ balanceChanges:",U,g,f),U&&(O=w(g||"0").gt(0)?qt(U,e)||g:"",W=w(f||"0").gt(0)?qt(U,l)||f:"");const Q=[De(O,e.symbol),De(W,l.symbol)].filter(Boolean),ee=(Q&&Q.length>1?"Removed ":"Withdraw ")+[De(O,e==null?void 0:e.symbol),De(W,l==null?void 0:l.symbol)].filter(Boolean).join(" and ");m.toastDescriptionContent=ee,m.modalDescriptionText=ee}return m}};St($);try{let j=new ot,U;if(a=="haedal")w(c.burn_ft_amount).gt(s==null?void 0:s.vaultBalance)?(U=await Z.Farms.buildRawWithdrawPayload({poolId:h.poolId,stakeCoinType:h.stakeCoinType,stakeObjectId:p.stakeObjectId,amount:w(c.burn_ft_amount).sub(s==null?void 0:s.vaultBalance).toString(),claimReward:S,rewardConfigs:S?h.rewardConfigs:void 0},j),console.log("🚀🚀🚀 ~ useVaultsRemove.ts:672 ~ doRemoveAction ~ lpCoin:",U)):h!=null&&h.poolId&&S&&w((p==null?void 0:p.stakedBalance)||"0").gt(0)&&await Z.Farms.buildHarvestPayload({poolId:h.poolId,stakeCoinType:h.stakeCoinType,stakeObjectId:p.stakeObjectId,rewardCoinType:(v=p.rewardConfigs[0])==null?void 0:v.rewardCoinType,rewardBank:(E=p.rewardConfigs[0])==null?void 0:E.bank},j),await _.Vaults.buildWithdrawPayload({...y,burn_lp_amount:w(c.burn_ft_amount).gt(s==null?void 0:s.vaultBalance)?s==null?void 0:s.vaultBalance:c.burn_ft_amount,extra_burn:U?{lp_burn_coin:U,burn_lp_amount:w(c.burn_ft_amount).sub(s==null?void 0:s.vaultBalance).toString()}:void 0},j);else if(a=="cetus-dlmm"){console.log("🚀🚀🚀 ~ useVaultsRemove.ts:726 ~ doRemoveAction ~ param:",y);const m={...y,pool_id:o,burn_lp_amount:w(c.burn_ft_amount).gt(s==null?void 0:s.vaultBalance)?s==null?void 0:s.vaultBalance:c.burn_ft_amount,mode:We};console.log("🚀🚀🚀 ~ useVaultsRemove.ts:733 ~ doRemoveAction ~ result:",m),await _.VaultsV2.buildWithdrawPayload({...y,pool_id:o,burn_lp_amount:w(c.burn_ft_amount).gt(s==null?void 0:s.vaultBalance)?s==null?void 0:s.vaultBalance:c.burn_ft_amount,mode:We},j)}else await P.Vaults.withdraw(y,j);await gt(j,$,{useMev:F,txAction:"signTransactionBlock",useFastMode:R==="Fast Mode",maxCapForGas:L,customGasPrice:B,msafeParams:{action:nt.AddVaultsPosition,txbParams:y}})?(V(),setTimeout(()=>{q(),ne(o)},2e3)):Ee(),tt(!1)}catch(j){console.log("🚀🚀🚀 ~ useVaultsRemove.ts:675 ~ doRemoveAction ~ error:",j),tt(!1),_t($)}}},jt=i.useMemo(()=>{if(c&&(c.swap_result||c.swap)&&r!=="both"&&G&&ge){let v=a=="cetus"?c.swap_result.swap_in_amount:c.swap.swap_amount_in,E=a=="cetus"?c.swap_result.swap_out_amount:c.swap.swap_amount_out;const y=a=="cetus"?D:n?!D:D,$=y?g:f,j=y?e:l,U=y?l:e,b=qe(v,U.decimals),m=qe(w(E).mul(1-Number(A)).toString(),j.decimals);return`To withdraw ${Re($,j==null?void 0:j.decimals)} ${j==null?void 0:j.symbol}, ${Re(b,U==null?void 0:U.decimals)} ${U==null?void 0:U.symbol} in the pool will be traded for ${Re(m,j==null?void 0:j.decimals)} ${j==null?void 0:j.symbol}`}},[r,c,g,f,D,a]);i.useEffect(()=>{Ee()},[_e,H]);const{currentAccount:Ve}=Me();return i.useEffect(()=>{V(),setTimeout(()=>{s!=null&&s.amountA&&(s!=null&&s.amountB)&&Le()},200)},[x,r,Ve==null?void 0:Ve.address]),i.useEffect(()=>{Le()},[s==null?void 0:s.amountA,s==null?void 0:s.amountB]),{calculateAvailableLoading:Pe,availableAmountA:_e,availableAmountB:H,amountInputA:g,amountInputB:f,amountValueA:M,amountValueB:z,zapNumGtError:Ze,zapNumLtError:te,handleAmountInputChange:ct,handlePercentInputChange:Ye,debouncedPercentInputChange:$e,removePercent:xe,showOnlySideTips:jt,preCalculateLoading:oe,doRemoveAction:wt,inputTotalValue:ze,calculateResult:c,setIsSlider:ie,resetInputAmount:V,calculateAvailableAmount:Le,submitLoading:Ct,isSlider:Se,fixAmountA:D,reCalculateResult:Ee}}function Ss(o){const{currentAccount:a,onWalletModal:e}=Me(),{fromToken:l,toToken:n,calculateResult:r}=Te(),{currentVaultPosition:x}=xt(),{assetAction:s,setAssetAction:p,isCheckedZAP:S,setIsCheckedZAP:h}=Te(),{category:g,isReverse:f,vaultId:c,currentActionTab:C,lpTokenInfo:u,isModal:d,isAutoRefresh:I}=o,{vaultsFarmingStaked:A}=Ae(),F=i.useMemo(()=>A[c],[A,c]),L=i.useMemo(()=>x,[x]),{amountInputA:R,amountInputB:B,amountValueA:se,amountValueB:_,calculateAvailableLoading:Z,availableAmountA:P,availableAmountB:pe,zapNumGtError:oe,zapNumLtError:Y,handleAmountInputChange:D,removePercent:T,handlePercentInputChange:q,doRemoveAction:ne,showOnlySideTips:le,preCalculateLoading:K,inputTotalValue:Se,setIsSlider:ie,resetInputAmount:he,isSlider:N,fixAmountA:re}=gs(c,g,l,n,f,s,S,L,F),{btnText:be,btnDisabled:ye}=ua(R,B,P||"",pe||"",l,n,s,!1,oe,Y,g,S),{amountLimit:G}=ra(0,r==null?void 0:r.burn_ft_amount,!1),ge=i.useMemo(()=>Re(qe(G||"0",u==null?void 0:u.decimals),u==null?void 0:u.decimals),[G,u]);i.useEffect(()=>{he()},[S,s]);const M=i.useMemo(()=>K?N?!0:f?re:!re:!1,[K,N]),z=i.useMemo(()=>K?N?!0:f?!re:re:!1,[K,N]),_e=i.useRef(!1);return i.useEffect(()=>{_e.current=!0},[]),t.jsxs(X,{gap:d?"8px":"12px",w:"100%",align:"flex-start",children:[t.jsxs(ke,{bg:d?"transparent":"none",border:"none",borderRadius:"12px",p:{base:"16px 8px 8px",lg:d?"0":"0px"},w:"100%",children:[t.jsx(ma,{label:"Remove Amounts",displayTokenA:l,displayTokenB:n,onSelectAssetTab:de=>{p(de)},isCheckedZAP:S,setIsCheckedZAP:h,assetAction:s,setAssetAction:p,currentActionTab:C,category:g}),t.jsx(Kt,{w:"100%",position:"relative",mt:d?"8px":"12px",children:t.jsx(Tt,{borderRadius:"12px",from:{wrapStyle:{borderRadius:"12px",h:"unset",p:{base:"20px 8px",lg:"20px 16px"}},calculateAvailableLoading:Z,hideSelf:s!=="both"&&s!==(l==null?void 0:l.coin_type),balance:P||"",value:R,amountValue:se&&!M?se:"",loading:M,onChange:(de,H,fe)=>{a!=null&&a.address&&!Z&&(ie(!1),D(de,!0,H,fe))},needRemainBalance:!1,selectable:!1,placeholder:"0.0",token:l,balanceLabel:"Available"},to:{wrapStyle:{borderRadius:"12px",h:"unset",p:{base:"20px 8px",lg:"20px 16px"}},balanceLabel:"Available",calculateAvailableLoading:Z,needRemainBalance:!1,hideSelf:s!=="both"&&s!==(n==null?void 0:n.coin_type),balance:pe||"",value:B,amountValue:_&&!z?_:"",loading:z,onChange:(de,H,fe)=>{a!=null&&a.address&&!Z&&(ie(!1),D(de,!1,H,fe))},selectable:!1,placeholder:"0.0",token:n},iconParams:{xlinkHref:"#icon-icon_add",svgFill:"text_caption",iconCursor:"default"},iconHover:!1})})]}),!d&&t.jsx(ke,{bg:"none",border:"none",borderRadius:"12px",p:{base:"16px 8px",lg:"0px"},children:t.jsx(Za,{textFontSize:"20px",sliderTrackHeight:"8px",sliderBg:"bg_secondary",percentage:T,onChange:de=>{Z||(console.log("🚀🚀🚀 ~ VaultsRemove.tsx:213 ~ VaultsRemove ~ assetAction:",s),console.log("🚀🚀🚀 ~ VaultsRemove.tsx:214 ~ VaultsRemove ~ fromToken.address:",l.address),q(Number(de.toString().replace("%","")),s=="both"?!0:s==l.coin_type))}})}),t.jsxs(X,{w:"100%",gap:"12px",children:[t.jsx(Ue,{m:"-1px",isLoading:K,w:"100%",borderRadius:"12px",h:"52px",fontSize:"18px",fontWeight:"500",isDisabled:ye||K,onClick:()=>{a?ne():e(!0)},children:be||(S?"Zap Out":"Withdraw")}),oe&&t.jsx(X,{w:"100%",alignItems:"start",children:t.jsx(ae,{color:"primary_yellow",fontSize:"12px",textAlign:"left",w:"100%",bg:"primary_yellow_opacity.10",p:"12px",borderRadius:"8px",lineHeight:"20px",children:"Single-asset withdraw can't be higher than $10,000 at a time."})}),r&&!oe&&(R||B)&&t.jsxs(X,{w:"100%",gap:"0px",mt:s!=="both"&&le?"0px":"6px",children:[s!=="both"&&le&&t.jsx(ae,{color:"text_paragraph",width:"100%",fontSize:"12px",lineHeight:"1.8",pb:"20px",children:le}),t.jsxs(X,{w:"100%",gap:"20px",children:[t.jsx(Ge,{label:"Total Withdraw",labelStyle:{fontSize:"14px"},value:Ta(Se,2),valueStyle:{fontSize:"14px"},skeletonStyle:{valueH:"14px"},isLoading:K}),t.jsx(Ge,{label:"LP Burn Amount",value:`${ge} ${`${l==null?void 0:l.symbol} - ${n==null?void 0:n.symbol}`}`,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueH:"14px"},isLoading:K})]})]})]})]})}const _s=[{label:"Deposit",value:"Deposit"},{label:"Withdraw",value:"Withdraw"}];function Js({vaultId:o,autoRefresh:a,isRefresh:e,isModal:l,setIsOpenFarmingModal:n,setIsOpenPre:r,setFarmingModalAction:x}){const{setAmountInputA:s,setAmountInputB:p,currTab:S,setCurrTab:h,setIsCheckedZAP:g,setAssetAction:f}=Te(),{vaultListObj:c,lpTokenInfoObj:C}=Pt(),{vaultsPoolObj:u}=kt(),d=i.useMemo(()=>c[o],[c,o]),I=i.useMemo(()=>u[o],[u]),A=i.useMemo(()=>C[d==null?void 0:d.lpTokenType],[C,d==null?void 0:d.lpTokenType]),[F,L]=i.useState(!1),R=()=>{a(),L(T=>!T)},{autoClaimStakeFarming:B,setAutoClaimStakeFarming:se}=Ae(),{currentVaultsFarm:_,isVaultsFarming:Z}=ft(d==null?void 0:d.vaultId),{vaultsFarmingStaked:P,autoClaimFarmingReward:pe,setAutoCliamFarmingReward:oe}=Ae(),{currentAccount:Y}=Me(),D=i.useMemo(()=>P[d==null?void 0:d.vaultId],[P,d==null?void 0:d.vaultId]);return i.useEffect(()=>()=>{h("Deposit"),g(!1),f("both")},[]),t.jsxs(X,{w:{base:"100%",lg:"100%"},justifyContent:"start",gap:l?"8px":"12px",children:[t.jsxs(me,{w:"100%",children:[t.jsx(ht,{type:"borderTab",wrapStyle:{w:"100%",h:l?"54px":"60px",border:"none",bg:"transparent"},itemStyle:{fontSize:l?"14px":"16px",mr:"28px"},tabList:_s,currentTab:S,handleChangeTab:T=>{s(""),p(""),h(T==null?void 0:T.value),f("both"),g(!1),T.value=="Withdraw",oe(!0)}}),t.jsxs(me,{children:[(S!=="Deposit"||(d==null?void 0:d.category)==="cetus")&&t.jsx(sa,{slippageType:"vaults",compact:!0}),l&&t.jsx(oa,{handleRefresh:()=>R(),isAutoRefresh:!0,refreshInterval:20,innerStyle:{bg:"bg_secondary"},w:"28px",h:"28px",borderRadius:"8px",bg:"bg_secondary"})]})]}),S==="Deposit"&&t.jsx(hs,{category:d==null?void 0:d.category,isReverse:d==null?void 0:d.isReverse,vaultId:d==null?void 0:d.vaultId,currentActionTab:"Deposit",totalSupply:I==null?void 0:I.totalSupply,lpTokenInfo:A,feeTier:d==null?void 0:d.feeDisplay,isModal:l,binStep:d==null?void 0:d.binStep,isAutoRefresh:l?F:e,currentVaultsFarm:_,vaultsFarmingStaked:D}),S==="Withdraw"&&t.jsx(Ss,{category:d==null?void 0:d.category,isReverse:d==null?void 0:d.isReverse,vaultId:d==null?void 0:d.vaultId,currentActionTab:"Withdraw",lpTokenInfo:A,isModal:l}),S==="Deposit"&&Z&&t.jsxs(me,{p:"8px 12px",bg:"primary_opacity.10",borderRadius:"8px",children:[t.jsx(ae,{w:"100%",fontSize:"12px",lineHeight:"16px",color:"primary",children:"Automatically stake your LP token into the 3rd party farm to enjoy higher yield."}),t.jsx(It,{isChecked:B,onChange:()=>se(!B)})]}),S==="Withdraw"&&Z&&(D==null?void 0:D.stakedBalance)>0&&t.jsxs(me,{w:"100%",p:"8px 12px",bg:"primary_opacity.10",borderRadius:"8px",fontSize:"12px",color:"primary",justifyContent:"space-between",children:[t.jsx(ae,{fontSize:"12px",children:" Automatically claim pending farming rewards."}),t.jsx(It,{isChecked:pe,onChange:()=>oe(!pe)})]}),l&&Z&&(Y==null?void 0:Y.address)&&t.jsx(ns,{apiVaultInfo:d,setIsOpenFarmingModal:n,setIsOpenPre:r,setFarmingModalAction:x})]})}export{Qs as F,os as R,Js as V,Te as a,ss as b,is as c,Nt as u};
