{"version":3,"file":"useFavoriteDlmmPool-Kbo6eRe5.js","sources":["../../src/store/pool/useDlmmPoolStore.ts","../../src/hooks/pool/useFavoriteDlmmPool.ts"],"sourcesContent":["import { DlmmApiPoolGroupItem } from '@/types/dlmm'\nimport { Token } from '@cetus/types'\nimport {\n  DLMM_POOL_FAVORITE_LIST,\n  IS_DLMM_ALL_POOLS,\n  IS_DLMM_INCENTIVIZED_ONLY,\n  IS_DLMM_WATCH_LIST,\n  POOL_SELECT_COIN_LIST,\n  VariousTokensTable\n} from '@cetus/utils'\nimport { create, StateCreator } from 'zustand'\n\ninterface poolsState {\n  dlmmPoolRefreshStatus: string\n  setDlmmPoolRefreshStatus: (data: string) => void\n  isDlmmWatchList: boolean | undefined\n  setIsDlmmWatchList: (isDlmmWatchList: boolean) => void\n  isDlmmAllPools: boolean\n  setIsDlmmAllPools: (isDlmmAllPools: boolean) => void\n  isDlmmIncentivizedOnly: boolean\n  setIsDlmmIncentivizedOnly: (isDlmmIncentivizedOnly: boolean) => void\n  dlmmPoolFavoriteIds: string[]\n  setDlmmPoolFavoriteId: (id: string) => void\n  setDlmmPoolFavoriteIds: (ids: string[]) => void\n  dlmmPoolFavoriteIdsChange: boolean\n  setDlmmPoolFavoriteIdsChange: (data: boolean) => void\n  selectCoinList: Token[]\n  setSelectCoinList: (list: Token[]) => void\n  dlmmPoolList: DlmmApiPoolGroupItem[]\n  setDlmmPoolList: (list: DlmmApiPoolGroupItem[]) => void\n  dlmmPoolListLength: string\n  setDlmmPoolListLength: (data: string) => void\n  dlmmPoolListIsLoading: boolean\n  setDlmmPoolListIsLoading: (data: boolean) => void\n  tutorialOpen: boolean\n  setTutorialOpen: (value: boolean) => void\n  resetPoolFilterParams: () => void\n}\n\nconst store: StateCreator<poolsState> = (set, get) => ({\n  dlmmPoolRefreshStatus: 'pending', // 'pending'|'success'|'error'|'timeout' ËØ∑Ê±ÇÊ±†Â≠êÂàóË°®Êó∂ÁöÑÁä∂ÊÄÅ\n  setDlmmPoolRefreshStatus: (data: string) => {\n    set(() => ({\n      dlmmPoolRefreshStatus: data\n    }))\n  },\n  isDlmmWatchList: undefined,\n  setIsDlmmWatchList: (isDlmmWatchList: boolean) => {\n    set(() => ({\n      isDlmmWatchList\n    }))\n    VariousTokensTable.setItem(IS_DLMM_WATCH_LIST, isDlmmWatchList)\n  },\n  isDlmmAllPools: false,\n  setIsDlmmAllPools: (isDlmmAllPools: boolean) => {\n    set(() => ({\n      isDlmmAllPools\n    }))\n    VariousTokensTable.setItem(IS_DLMM_ALL_POOLS, isDlmmAllPools)\n  },\n  isDlmmIncentivizedOnly: false,\n  setIsDlmmIncentivizedOnly: (isDlmmIncentivizedOnly: boolean) => {\n    set(() => ({\n      isDlmmIncentivizedOnly\n    }))\n    VariousTokensTable.setItem(IS_DLMM_INCENTIVIZED_ONLY, isDlmmIncentivizedOnly)\n  },\n  dlmmPoolFavoriteIds: [],\n  setDlmmPoolFavoriteId: (id: string) => {\n    const newPoolFavoriteIds = [...get().dlmmPoolFavoriteIds, id]\n    set(() => ({\n      dlmmPoolFavoriteIds: newPoolFavoriteIds\n    }))\n    VariousTokensTable.setItem(DLMM_POOL_FAVORITE_LIST, newPoolFavoriteIds)\n  },\n  setDlmmPoolFavoriteIds: (ids: string[]) => {\n    set(() => ({\n      dlmmPoolFavoriteIds: ids\n    }))\n    VariousTokensTable.setItem(DLMM_POOL_FAVORITE_LIST, ids)\n  },\n  dlmmPoolFavoriteIdsChange: false,\n  setDlmmPoolFavoriteIdsChange: (data: boolean) => {\n    set(() => ({\n      dlmmPoolFavoriteIdsChange: data\n    }))\n  },\n  dlmmPoolListIsLoading: true,\n  setDlmmPoolListIsLoading: (value: boolean) => {\n    set(() => ({\n      dlmmPoolListIsLoading: value\n    }))\n  },\n  selectCoinList: [],\n  setSelectCoinList: (selectCoinList: Token[]) => {\n    set(() => ({\n      selectCoinList\n    }))\n    VariousTokensTable.setItem(POOL_SELECT_COIN_LIST, selectCoinList)\n  },\n  // toDo: Âè™ÊòØstoreÈáåÂä†‰∫ÜÔºåÁ≠âÂêéÈù¢ÂØπÊé•apiÊï∞ÊçÆÂêéÂÜçÊ†πÊçÆfilterÊÉÖÂÜµËÆæÁΩÆ\n  dlmmPoolList: [],\n  setDlmmPoolList: (list: DlmmApiPoolGroupItem[]) => {\n    set(() => ({\n      dlmmPoolList: list\n    }))\n  },\n  dlmmPoolListLength: '',\n  setDlmmPoolListLength: (value: string) => {\n    set(() => ({\n      dlmmPoolListLength: value\n    }))\n  },\n  tutorialOpen: false,\n  setTutorialOpen: (value: boolean) => {\n    set(() => ({\n      tutorialOpen: value\n    }))\n  },\n  resetPoolFilterParams: () => {\n    set(() => ({\n      isDlmmWatchList: undefined,\n      isDlmmAllPools: false,\n      isDlmmIncentivizedOnly: false\n    }))\n  }\n})\n\nconst useDlmmPoolsStore = create(store)\nexport default useDlmmPoolsStore\n\nVariousTokensTable.getItem<any>(DLMM_POOL_FAVORITE_LIST).then(savedPoolFavoriteList => {\n  console.log('üöÄ ~ file: store/pool/index.ts.ts ~ savedPoolFavoriteList:', savedPoolFavoriteList)\n  if (savedPoolFavoriteList?.length > 0) {\n    useDlmmPoolsStore.getState().setDlmmPoolFavoriteIds(savedPoolFavoriteList?.filter(Boolean))\n  }\n})\n\nVariousTokensTable.getItem<any>(IS_DLMM_WATCH_LIST).then(isWatchList => {\n  console.log('üöÄ ~ VariousTokensTable isWatchList:', isWatchList)\n  if (typeof isWatchList === 'boolean') {\n    useDlmmPoolsStore.getState().setIsDlmmWatchList(isWatchList)\n  } else {\n    useDlmmPoolsStore.getState().setIsDlmmWatchList(false)\n  }\n})\n\nVariousTokensTable.getItem<any>(IS_DLMM_ALL_POOLS).then(isAllPools => {\n  console.log('üöÄ ~ VariousTokensTable isAllPools:', isAllPools)\n  if (typeof isAllPools === 'boolean') {\n    useDlmmPoolsStore.getState().setIsDlmmAllPools(isAllPools)\n  }\n})\n\nVariousTokensTable.getItem<any>(IS_DLMM_INCENTIVIZED_ONLY).then(isIncentivizedOnly => {\n  console.log('üöÄ ~ VariousTokensTable isIncentivizedOnly:', isIncentivizedOnly)\n  if (typeof isIncentivizedOnly === 'boolean') {\n    useDlmmPoolsStore.getState().setIsDlmmIncentivizedOnly(isIncentivizedOnly)\n  }\n})\n// ‰ªé localForage Âä†ËΩΩÊï∞ÊçÆ\nVariousTokensTable.getItem<any>(POOL_SELECT_COIN_LIST).then(poolSelectCoinList => {\n  console.log('üöÄ ~ VariousTokensTable poolSelectCoinList:', poolSelectCoinList)\n  if (poolSelectCoinList && poolSelectCoinList.length > 0) {\n    useDlmmPoolsStore.getState().setSelectCoinList(poolSelectCoinList)\n  }\n})\n","import { DLMMStatsPoolsPath } from '@/apis/path'\nimport useDlmmPoolsStore from '@/store/pool/useDlmmPoolStore'\nimport { useGlobalToast } from '@cetus/design'\nimport { useFetch } from '@cetus/hooks'\nimport { useSdk } from '@cetus/sdk-factory'\nimport { CommonTypeInfo, ToastType } from '@cetus/types'\nimport { GetPoolListParams } from './type'\nimport useGetDlmmPoolList from './useGetDlmmPoolList'\nimport useWrapDlmmPoolData from './useWrapDlmmPoolData'\nimport useWrapPoolData from './useWrapPoolData'\nimport { wrapGetDlmmPoolParams } from './utils'\n\nexport interface GetFavoriteDlmmPoolListProps extends GetPoolListParams {\n  pools?: string[]\n  needLocalData?: boolean\n}\nexport default function useFavoriteDlmmPool() {\n  const { fetchByApi } = useFetch()\n  const dlmmSdk = useSdk('dlmm')\n  const { getLocalJsonPoolList } = useGetDlmmPoolList()\n  const { wrapDLmmPoolData } = useWrapPoolData()\n  const { wrapDlmmGroupedPoolData } = useWrapDlmmPoolData()\n  const { dlmmPoolFavoriteIds, setDlmmPoolFavoriteId, setDlmmPoolFavoriteIds, setDlmmPoolFavoriteIdsChange } = useDlmmPoolsStore()\n  const { successTsToast, failedTsToast } = useGlobalToast()\n  const addFavorites = (id: string) => {\n    const info: ToastType = {\n      linkLabel: '',\n      getShowInfo: () => {\n        const info: CommonTypeInfo = {\n          toastTitleText: dlmmPoolFavoriteIds.length >= 100 ? 'Watchlist exceeds the maximum limit' : 'Added to Watchlist'\n        }\n        return info\n      }\n    }\n    if (dlmmPoolFavoriteIds.length >= 100) {\n      failedTsToast(info)\n    } else {\n      setDlmmPoolFavoriteId(id)\n      setDlmmPoolFavoriteIdsChange(true)\n      successTsToast(info)\n    }\n  }\n\n  const removeFavorites = (id: string) => {\n    const newList = dlmmPoolFavoriteIds?.filter((item: string) => item !== id)\n    setDlmmPoolFavoriteIds(newList)\n    setDlmmPoolFavoriteIdsChange(true)\n    const info: ToastType = {\n      linkLabel: '',\n      getShowInfo: () => {\n        const info: CommonTypeInfo = {\n          toastTitleText: 'Removed from Watchlist'\n        }\n        return info\n      }\n    }\n    successTsToast(info)\n  }\n  const getFavoritePoolList = async (params: any) => {\n    // toDo: ËØ∑Ê±ÇÂêéÁ´ØÊñ∞Êé•Âè£Ôºå‰º†ÂÖ•Êî∂ËóèÂàóË°®ÔºåËøîÂõûÊ±†Â≠êÂàóË°®, ÊúÄÁªàÊï∞ÊçÆË¶ÅÂåÖË£ÖÁöÑÂíåpoolList‰∏ÄÊ†∑\n    const { needLocalData = true } = params\n    const pools = params?.pools || []\n    const wrapApiParams = wrapGetDlmmPoolParams(params)\n\n    if (pools.length > 0) {\n      try {\n        const res = await fetchByApi(DLMMStatsPoolsPath, 'POST', wrapApiParams)\n        if (res?.data?.list) {\n          const poolList = res?.data?.list?.map(item => wrapDLmmPoolData(item))\n          return {\n            list: poolList?.map(item => ({\n              ...item,\n              showTokenName: true\n            })),\n            total: res?.data?.total\n          }\n        }\n      } catch (error) {\n        if (needLocalData) {\n          const res = await getLocalJsonPoolList(params, false)\n          console.log('üöÄ ~ getFavoritePoolList ~ localList:', res)\n          return {\n            list: res.list,\n            total: res.total\n          }\n        }\n      }\n    }\n\n    return {\n      list: [],\n      total: 0\n    }\n  }\n  return {\n    addFavorites,\n    removeFavorites,\n    getFavoritePoolList\n  }\n}\n"],"names":["store","set","get","data","isDlmmWatchList","VariousTokensTable","IS_DLMM_WATCH_LIST","isDlmmAllPools","IS_DLMM_ALL_POOLS","isDlmmIncentivizedOnly","IS_DLMM_INCENTIVIZED_ONLY","id","newPoolFavoriteIds","DLMM_POOL_FAVORITE_LIST","ids","value","selectCoinList","POOL_SELECT_COIN_LIST","list","useDlmmPoolsStore","create","savedPoolFavoriteList","isWatchList","isAllPools","isIncentivizedOnly","poolSelectCoinList","useFavoriteDlmmPool","fetchByApi","useFetch","useSdk","getLocalJsonPoolList","useGetDlmmPoolList","wrapDLmmPoolData","useWrapPoolData","dlmmPoolFavoriteIds","setDlmmPoolFavoriteId","setDlmmPoolFavoriteIds","setDlmmPoolFavoriteIdsChange","successTsToast","failedTsToast","useGlobalToast","info","newList","item","params","needLocalData","pools","wrapApiParams","wrapGetDlmmPoolParams","res","DLMMStatsPoolsPath","_a","poolList","_c","_b","_d"],"mappings":"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"}