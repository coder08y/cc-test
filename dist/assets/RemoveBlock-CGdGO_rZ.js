import{r as c,j as s,B as Ze,V as we,w as Je,H as I,T as Y,m as Ke,Y as Ut,l as St,i as Gt,n as Ot,P as Xt,x as Jt,a8 as Dt,y as Yt,A as Kt,D as Qt,E as zt,G as Bt,J as It}from"./vendor-CBmAETR3.js";import{w as ft,a as tt,Q as st,g as ct,d as _,c8 as Pt,M as it,f as Tt,t as jt,aT as rt,aV as gt,v as ve,bn as De,s as qe,u as pt,q as Rt,I as Pe,a5 as ht,S as es,e as ts,z as Ce,h as ss,E as bt,l as is,ad as Ie,B as vt,C as os}from"./index-BpSfzecM.js";import{B as kt}from"./cross-DJ28FxNa.js";import{u as Qe,a as Ct}from"./addLiquidity-DNM9DGI2.js";import{u as ns}from"./useTokenBalance-c3RAkCCY.js";import{d as ls,u as as}from"./usePosRemove-04piisVo.js";import{v as et}from"./v4-C6aID195.js";import{D as cs}from"./DepositRatio-D2zurS6C.js";import{F as rs}from"./FreshProgressV2-DfCij7Ow.js";import{u as ds}from"./usePriceImpact-DTCbq_0I.js";import{c as ps,d as us,b as ms}from"./utils-CMHkC_9A.js";import{E as yt}from"./ErrorTips-lJshH5MT.js";import{M as xs}from"./MarketSource-Zu8s3YB-.js";import{S as gs}from"./Slippage-8fJCLOYr.js";import{u as hs}from"./useTransaction-uEos3ZjK.js";import{k as bs,a as ut,j as dt,h as ys}from"./usePositionList-heG2hQcx.js";import{u as ot}from"./detail-Cbbl8wNo.js";import{f as _t}from"./index-gw6wWhzj.js";import{u as _s}from"./useAccountBalance-DV0qM_Vy.js";import{u as ws}from"./useTransactionModal-DL7w_I3R.js";import{F as As}from"./useWrapPoolData-CMGMCXwG.js";import{u as qt}from"./index-CqgM3rES.js";import{u as Ft}from"./useCurrentPos-C5suLYji.js";import{u as Ss}from"./usePosAdd-DG3IUn6t.js";import{T as fs}from"./TradeInputGroup-C0B6uidS.js";import{A as Ts}from"./AutoClaimCheckBox-lw6rJPdV.js";import{u as js,R as wt}from"./ExpendItem-BR-Au2GE.js";function Rs({tokens:i,current:t,onSelect:r}){const e=c.useMemo(()=>i==null?void 0:i.map(l=>({label:l==null?void 0:l.symbol,value:l==null?void 0:l.coin_type})),[i]),u=c.useMemo(()=>{var l;return(l=e==null?void 0:e.filter(o=>(o==null?void 0:o.value)===(t==null?void 0:t.coin_type)))==null?void 0:l[0]},[e,t==null?void 0:t.coin_type]),d=l=>{var T;const o=(T=i==null?void 0:i.filter(L=>(L==null?void 0:L.coin_type)===(l==null?void 0:l.value)))==null?void 0:T[0];r(o)};return s.jsx(Ze,{w:"100%",mb:"8px",children:s.jsx(ft,{wrapStyle:{w:"100%",h:"48px",borderRadius:"12px",p:"3px"},itemStyle:{w:"50%",fontSize:"14px",borderRadius:"8px",fontWeight:"500"},type:"outlineTab",currentTab:u==null?void 0:u.label,tabList:e,handleChangeTab:d})})}function vs(i,t,r,e,u,d,l,o,T,L){const{currentTokens:oe,setCurrentTokens:te,zapAmount:E,setZapAmount:k,currentZapToken:a,setCurrentZapToken:m,zapAmountRate:h,setZapAmountRate:ae,setZapTokenBalance:Q,zapTokenBalance:M,setPreDepositeData:f,setIsPreLoading:ce,setZapApiPool:ue,lower:C,upper:K,setLower:q,setUpper:re,setZapCurrPriceData:z,resetZapData:w,setLiquidity:me,setZapSlideValue:Ae,setPosOriginAmounts:p}=Qe(),{zapSlippage:y}=tt(),{balanceInfo:W}=ns(a),{getTokenAmountValue:N}=st(),[U,de]=c.useState("");c.useEffect(()=>{q(e)},[e]),c.useEffect(()=>{re(u)},[u]),c.useEffect(()=>{me(o||"")},[o]),c.useEffect(()=>{Ae(T||0)},[T]),c.useEffect(()=>{p({coinAmountA:L==null?void 0:L.coinAmountA,coinAmountB:L==null?void 0:L.coinAmountB})},[L]),c.useEffect(()=>{var V,Se;if(t!=null&&t.poolAddress&&r){const Le=(V=t==null?void 0:t.tokenA)==null?void 0:V.decimals,Ne=(Se=t==null?void 0:t.tokenB)==null?void 0:Se.decimals,Ve=ct.sqrtPriceX64ToPrice(new kt(r),Le,Ne).toString();z({currentPrice:Ve,currentSqrtPrice:r})}},[r,t==null?void 0:t.poolAddress]),c.useEffect(()=>{let V=[];t!=null&&t.poolAddress&&(V=[t==null?void 0:t.displayTokenA,t==null?void 0:t.displayTokenB],m(t==null?void 0:t.displayTokenA)),te(V),ue(t)},[t==null?void 0:t.poolAddress]);const ne=V=>{k(V)},ye=V=>{m(V),k("")};return c.useEffect(()=>{let V;E&&(a!=null&&a.coin_type)&&(V=N(a==null?void 0:a.coin_type,E)),ae(V||"")},[E,a==null?void 0:a.coin_type]),c.useEffect(()=>{var V;if(i==="Deposit")Q(W);else{const Se=(a==null?void 0:a.coin_type)===((V=t==null?void 0:t.tokenA)==null?void 0:V.coin_type);Q(Se?{balanceFormat:d}:{balanceFormat:l})}},[i,W,d,l,a==null?void 0:a.coin_type,t==null?void 0:t.poolAddress]),c.useEffect(()=>()=>{w()},[]),{currentTokens:oe,zapAmount:E,zapAmountRate:h,handleChangeAmount:ne,currentZapToken:a,handleChangeZapToken:ye,zapTokenBalance:M,zapSlippage:y}}function ks({action:i,apiPoolInfo:t,currentSqrtPrice:r,lowerTick:e,upperTick:u,onlyAmountA:d,onlyAmountB:l,liquidity:o,slideValue:T,currentPosLiquidityData:L}){const{currentTokens:oe,currentZapToken:te,handleChangeZapToken:E,zapAmount:k,zapAmountRate:a,handleChangeAmount:m,zapTokenBalance:h}=vs(i,t,r,e,u,d,l,o,T,L);return c.useEffect(()=>{i==="Withdraw"&&_(k).gt((h==null?void 0:h.balanceFormat)||"0")&&m(h==null?void 0:h.balanceFormat)},[k,i,h==null?void 0:h.balanceFormat]),s.jsxs(we,{w:"100%",children:[s.jsx(Rs,{tokens:oe,current:te,onSelect:E}),s.jsx(Pt,{wrapStyle:{h:"108px"},placeholder:"0.0",value:k,onChange:m,balance:(h==null?void 0:h.balanceFormat)||"",amountValue:a,token:te,needRemainBalance:i!=="Withdraw",balanceLabel:i==="Withdraw"?"Available":void 0})]})}function Zt(i="Deposit"){var P,se;const{zapAmount:t,currentZapToken:r,zapAmountRate:e,zapTokenBalance:u,isPreLoading:d,preDepositeData:l,zapApiPool:o,setIsPreLoading:T,lower:L,upper:oe,liquidity:te,zapCurrPriceData:E,setPreDepositeData:k,zapSlideValue:a}=Qe(),{currentAccount:m,onWalletModal:h}=it(),{setConfirmModalOpen:ae}=Ct(),Q=Tt("zap"),{zapSlippage:M,slippage:f}=tt(),[ce,ue]=c.useState(""),[C,K]=c.useState(!1),{getTokenPrice:q}=st(),re=q((P=o==null?void 0:o.tokenA)==null?void 0:P.coin_type),z=q((se=o==null?void 0:o.tokenB)==null?void 0:se.coin_type),w=c.useMemo(()=>{if(re&&z)return _(re.price).div(z.price).toString()},[re==null?void 0:re.price,z==null?void 0:z.price]),me=c.useMemo(()=>{const b={text:i==="Withdraw"?"Zap Out":"Zap In",disabled:!1};return m!=null&&m.address?!t||t&&!+t?(b.text="Enter an amount",b.disabled=!0,b):_(t).gt((u==null?void 0:u.balanceFormat)||0)?(b.disabled=!0,b.text=`Insufficient ${jt(u==null?void 0:u.symbol,10)} Balance`,b):((_(e).gt(1e4)||_(e).gt(0)&&_(e).lt(1e-4))&&(b.disabled=!0),b):(b.text="Connect Wallet",b.disabled=!1,b)},[m==null?void 0:m.address,t,r==null?void 0:r.coin_type,d,i,u==null?void 0:u.balanceFormat]),Ae=ls(()=>{m?ae(!0):h(!0)},300,{leading:!0,trailing:!1}),p=()=>{const b=l==null?void 0:l.amount_a,x=l==null?void 0:l.amount_b,n=o==null?void 0:o.tokenA,A=o==null?void 0:o.tokenB,G=o==null?void 0:o.displayTokenA,$=o==null?void 0:o.displayTokenB,j=qe(o!=null&&o.isReverse?x:b,o!=null&&o.isReverse?A==null?void 0:A.decimals:n==null?void 0:n.decimals),R=qe(o!=null&&o.isReverse?b:x,o!=null&&o.isReverse?n==null?void 0:n.decimals:A==null?void 0:A.decimals);return{amountA:b,amountB:x,tokenA:n,tokenB:A,displayTokenA:G,displayTokenB:$,dispalyAmountA:j,dispalyAmountB:R}},y=()=>{const{displayTokenA:b,displayTokenB:x,dispalyAmountA:n,dispalyAmountB:A}=p();return{getShowInfo:($,j)=>{const R=!n&&!A?`Add ${n} ${b==null?void 0:b.symbol} and ${A} ${x==null?void 0:x.symbol}`:n?A?"Add Liquidity":`Add ${A} ${x==null?void 0:x.symbol}`:`Add ${n} ${b==null?void 0:b.symbol}`,F={modalDescriptionText:R,toastTitleText:R};if($==="success"){let pe=n,ee=A;j&&(pe=De(j,b)||n,ee=De(j,x)||A);const ie=!n&&!A?`Add ${pe} ${b==null?void 0:b.symbol} and ${ee} ${x==null?void 0:x.symbol}`:!n&&A?`Add ${pe} ${b==null?void 0:b.symbol}`:!A&&n?`Add ${ee} ${x==null?void 0:x.symbol}`:"Add Liquidity";F.toastDescriptionContent=ie,F.modalDescriptionText=ie,F.toastTitleText="Supplied Successful"}return F}}},W=async(b,x,n,A)=>{console.log("ðŸš€ ~ getZapDepositTx ~ isFarm:",n);const{tokenA:G,tokenB:$}=p(),j={deposit_obj:l,pool_id:o==null?void 0:o.poolAddress,coin_type_a:G==null?void 0:G.coin_type,coin_type_b:$==null?void 0:$.coin_type,tick_lower:b,tick_upper:x,slippage:Number(f),swap_slippage:Number(M)};A&&(j.pos_obj=A),n&&(j.farms_pool_id=o==null?void 0:o.farmsPoolAddress),console.log("getZapTx buildDepositPayload params: ",j);const R=await Q.Zap.buildDepositPayload(j);return console.log("ðŸš€ ~ getZapTx ~ tx:",R),R},N=(b,x)=>{const{displayTokenA:n,displayTokenB:A,dispalyAmountA:G,dispalyAmountB:$}=p();return{getShowInfo:(R,F)=>{const pe=`Withdraw ${ve(t,r==null?void 0:r.decimals)} ${r==null?void 0:r.symbol}`,ee={modalDescriptionText:pe,toastTitleText:pe};return R==="success"&&(F&&(De(F,n),De(F,A)),ee.toastDescriptionContent="",ee.modalDescriptionText="",ee.toastTitleText="Remove Liquidity Successful"),ee}}},U=async(b,x,n,A,G,$,j,R)=>{const{tokenA:F,tokenB:pe}=p(),ee=(l==null?void 0:l.burn_liquidity)===x,ie={withdraw_obj:l,pool_id:o==null?void 0:o.poolAddress,pos_id:b,close_pos:!!(!j&&ee),collect_farms_rewarder:!!(R||ee),collect_fee:R||ee,collect_rewarder_types:R||ee?G:[],coin_type_a:F==null?void 0:F.coin_type,coin_type_b:pe==null?void 0:pe.coin_type,tick_lower:n,tick_upper:A,slippage:Number(f),swap_slippage:Number(M)};return $&&(ie.farms_pool_id=o==null?void 0:o.farmsPoolAddress),console.log("ðŸš€ ~ useZapSubmit ~ getZapWithdrawTx params:",ie),{tx:await Q.Zap.buildWithdrawPayload(ie),isClose:(l==null?void 0:l.burn_liquidity)===x}},de=c.useRef({}),ne=c.useRef(null),ye=c.useRef("");c.useEffect(()=>{de.current={currentZapToken:r,zapApiPool:o,zapAmount:t,currentSqrtPrice:E==null?void 0:E.currentSqrtPrice,lower:L,upper:oe,liquidity:te,zapSlippage:M,zapAmountRate:e,marketPrice:w}},[r==null?void 0:r.coin_type,o==null?void 0:o.poolAddress,t,E==null?void 0:E.currentSqrtPrice,L,oe,te,M,e,w]);const V=c.useMemo(()=>!!(r!=null&&r.decimals&&_(t).mul(Math.pow(10,r==null?void 0:r.decimals)).eq(1)),[r==null?void 0:r.decimals,t]),Se=async b=>{var Te,v,O,X,H;console.log("ðŸš€ ~ preZapIn ~ preZapIn:",Se);const{currentZapToken:x,zapApiPool:n,zapAmount:A,currentSqrtPrice:G,lower:$,upper:j,liquidity:R,zapSlippage:F,marketPrice:pe}=de.current;T(!0);const ie=(x==null?void 0:x.coin_type)===((Te=n==null?void 0:n.tokenA)==null?void 0:Te.coin_type)?"OnlyCoinA":"OnlyCoinB",he=gt(_(A).mul(Math.pow(10,x==null?void 0:x.decimals)).toString(),0);console.log("ðŸš€ ~ preZapIn ~ options.zapSlippage:",f,F);const ke={pool_id:n==null?void 0:n.poolAddress,tick_lower:$,tick_upper:j,current_sqrt_price:G,slippage:Number(f),swap_slippage:Number(F),mark_price:pe};console.log("ðŸš€ ~ preZapIn ~ options123:",ke);const _e={mode:ie,coin_amount:he,coin_type_a:(v=n==null?void 0:n.tokenA)==null?void 0:v.coin_type,coin_type_b:(O=n==null?void 0:n.tokenB)==null?void 0:O.coin_type,coin_decimal_a:(X=n==null?void 0:n.tokenA)==null?void 0:X.decimals,coin_decimal_b:(H=n==null?void 0:n.tokenB)==null?void 0:H.decimals,max_remain_rate:.01};console.log("ðŸš€ ~ preZapIn ~ modeOptions:",_e);let fe;try{fe=await Q.Zap.preCalculateDepositAmount(ke,_e),console.log("ðŸš€ ~ preZapIn ~ res:",fe)}catch(Fe){console.log("ðŸš€ ~ preZapIn ~ error:",Fe),K(!0)}b===ye.current&&k(fe),T(!1)},Le=async b=>{var ke,_e,fe,Te,v;T(!0);const{currentZapToken:x,zapApiPool:n,zapAmount:A,currentSqrtPrice:G,lower:$,upper:j,liquidity:R,zapSlippage:F}=de.current,ee=(x==null?void 0:x.coin_type)===((ke=n==null?void 0:n.tokenA)==null?void 0:ke.coin_type)?"OnlyCoinA":"OnlyCoinB";_(A).mul(Math.pow(10,x==null?void 0:x.decimals)).toString();const ie={mode:ee,pool_id:n==null?void 0:n.poolAddress,tick_lower:$,tick_upper:j,current_sqrt_price:G,coin_type_a:(_e=n==null?void 0:n.tokenA)==null?void 0:_e.coin_type,coin_type_b:(fe=n==null?void 0:n.tokenB)==null?void 0:fe.coin_type,coin_decimal_a:(Te=n==null?void 0:n.tokenA)==null?void 0:Te.decimals,coin_decimal_b:(v=n==null?void 0:n.tokenB)==null?void 0:v.decimals};_(A).gte(u==null?void 0:u.balanceFormat)?ie.burn_liquidity=R:ie.burn_liquidity=gt(_(R).mul(_(a).div(100)).toString(),0),console.log("ðŸš€ ~ preZapInRemove ~ options:",ie);let he;try{he=await Q.Zap.preCalculateWithdrawAmount(ie),console.log("ðŸš€ ~ preZapInRemove ~ res:",he)}catch(O){console.log("ðŸš€ ~ preZapOut ~ error:",O),K(!0)}b===ye.current&&k(he),T(!1)},Ne=rt(Se,300),Ve=rt(Le,300);c.useEffect(()=>{le()},[t,r==null?void 0:r.coin_type,E==null?void 0:E.currentSqrtPrice,L,oe,a,e]);const B=()=>{var b;(b=ne.current)==null||b.reset()},le=()=>{K(!1);const{zapAmount:b,zapAmountRate:x}=de.current;if(console.log("ðŸš€ ~ reCalculateZapData ~ zapAmount:",b),console.log("ðŸš€ ~ reCalculateZapData ~ zapAmountRate:",x),console.log("ðŸš€ ~ reCalculateZapData ~ zapAmountRate:",x),!Number(b)||_(x).gt(1e4)||_(x).lt(1e-4)||V){const A=et();ye.current=A,k(void 0),T(!1);return}T(!0);const n=et();ye.current=n,i=="Deposit"?Ne(n):Ve(n)};return c.useEffect(()=>{B()},[t,o==null?void 0:o.poolAddress,i]),c.useEffect(()=>()=>{B(),de.current=null},[]),{btnText:me.text,btnDisabled:me.disabled,handleZapIn:Ae,isPreLoading:d,getZapDepositToastInfo:y,getZapDepositTx:W,getZapWithdrawToastInfo:N,getZapWithdrawTx:U,zapProgressRef:ne,handleResetZapProgress:B,reCalculateZapData:le,isMinimumPrecision:V,zapNotAvailable:C}}function Cs({action:i,onClick:t,hideAmountInfo:r,otherLoading:e,isReverse:u,inConfirmModal:d,hideDepositRatio:l,isPositionStyle:o}){const{currentAccount:T,onWalletModal:L}=it(),{btnDisabled:oe,btnText:te,handleZapIn:E,zapProgressRef:k,reCalculateZapData:a,isMinimumPrecision:m,zapNotAvailable:h}=Zt(i),ae=()=>{if(!T){L(!0);return}t?t():E()},[Q,M]=c.useState(!1),{zapSlippage:f}=tt(),{getTokenAmountValue:ce}=st(),{zapSlideValue:ue,preDepositeData:C,currentTokens:K,currentZapToken:q,zapAmount:re,isPreLoading:z,zapApiPool:w,lower:me,upper:Ae,zapCurrPriceData:p,posOriginAmounts:y,zapAmountRate:W}=Qe(),{fromCoin:N,toCoin:U}=c.useMemo(()=>{var X;const v=q,O=(X=K==null?void 0:K.filter(H=>(H==null?void 0:H.coin_type)!==(q==null?void 0:q.coin_type)))==null?void 0:X[0];return i==="Withdraw"?{fromCoin:O,toCoin:v}:{fromCoin:v,toCoin:O}},[q==null?void 0:q.coin_type,K,i]),{fromAmount:de,toAmount:ne}=c.useMemo(()=>{var X,H;let v,O;return C&&(N!=null&&N.coin_type)&&(U!=null&&U.coin_type)&&(v=qe((X=C==null?void 0:C.swap_result)==null?void 0:X.swap_in_amount,N==null?void 0:N.decimals),O=qe((H=C==null?void 0:C.swap_result)==null?void 0:H.swap_out_amount,U==null?void 0:U.decimals)),{fromAmount:v,toAmount:O}},[C,N==null?void 0:N.coin_type,U==null?void 0:U.coin_type]),{sources:ye,priceImpactTextInfo:V,showPriceImpactTips:Se}=ds(N,U,de,ne),[Le,Ne]=c.useState(!1),Ve=()=>{Ne(!Le)},B=c.useMemo(()=>ne?ve(_(ne).sub(_(ne).mul(f)).toString()):"--",[f,ne]),le=c.useMemo(()=>{var v;return(v=C==null?void 0:C.swap_result)==null?void 0:v.swap_price},[C]),P=()=>{console.log("ZapRoute handleRefresh"),a()},{tokenA:se,tokenB:b,coinAmountA:x,coinAmountB:n,displayCoinAmountA:A,displayCoinAmountB:G,displayTokenA:$,displayTokenB:j,displayAmountARate:R,displayAmountBRate:F,amountARate:pe,amountBRate:ee}=c.useMemo(()=>{let v,O,X,H,Fe,Ee;const We=w==null?void 0:w.isReverse;return C&&(w!=null&&w.poolAddress)&&(X=w==null?void 0:w.tokenA,H=w==null?void 0:w.tokenB,v=qe(C==null?void 0:C.amount_a,X==null?void 0:X.decimals),O=qe(C==null?void 0:C.amount_b,H==null?void 0:H.decimals),Fe=ce(X==null?void 0:X.coin_type,v),Ee=ce(H==null?void 0:H.coin_type,O)),{displayCoinAmountA:We?O:v,displayCoinAmountB:We?v:O,displayTokenA:We?H:X,displayTokenB:We?X:H,displayAmountARate:We?Ee:Fe,displayAmountBRate:We?Fe:Ee,tokenA:X,tokenB:H,coinAmountA:v,coinAmountB:O,amountARate:Fe,amountBRate:Ee}},[C,w==null?void 0:w.poolAddress]),{originPosAmountA:ie,originPosAmountB:he}=c.useMemo(()=>{let v="",O="";if(w!=null&&w.poolAddress&&(y!=null&&y.coinAmountA||y!=null&&y.coinAmountB)){const X=w==null?void 0:w.tokenA,H=w==null?void 0:w.tokenB;v=qe(y==null?void 0:y.coinAmountA,X==null?void 0:X.decimals),O=qe(y==null?void 0:y.coinAmountB,H==null?void 0:H.decimals)}return{originPosAmountA:v,originPosAmountB:O}},[y,w==null?void 0:w.poolAddress]),[ke,_e]=c.useState({});c.useEffect(()=>{if(x||n){const v=ps(me,Ae),O=us(x||0,n||0,p==null?void 0:p.currentPrice,v);_e(O)}},[x,n,p==null?void 0:p.currentPrice]);const{isApp:fe}=pt(),Te=c.useMemo(()=>_(W).gt(5e4)?"In Zap mode, each request should be within $50,000.":_(W).gt(0)&&(_(W).lt(1e-4)||m)?"The input is too small. Zap mode is not available.":h?"Zap mode is not available.":"",[W,i,m,h]);return s.jsx(s.Fragment,{children:s.jsxs(we,{gap:"0px",w:"100%",borderRadius:"16px",border:o?"none":"1px solid",borderColor:d?"rgba(0,0,0,0)":"border",bg:d||o?"none":"bg_six",p:{base:d||o?"0px":"0px 8px",lg:d||o?"0px":"0px 16px"},children:[!d&&s.jsx(Je,{w:{base:o?"100%":"calc(100% + 16px)",lg:o?"100%":"calc(100% + 34px)"},h:"52px",margin:"-1px -1px 0px",fontSize:"18px",fontWeight:"500",borderRadius:"12px",isDisabled:(z||oe||e||Se||!!Te)&&(T==null?void 0:T.address),isLoading:z||e,onClick:ae,children:te}),!!Number(re)&&s.jsx(we,{w:"100%",gap:"0px",children:Te?s.jsx(Ze,{w:"100%",p:o?"12px 0px 0px":"12px 0px",children:s.jsx(yt,{tips:Te})}):s.jsxs(s.Fragment,{children:[Se&&s.jsx(Ze,{w:"100%",pt:"12px",children:s.jsx(yt,{tips:"High price difference. Be cautious before submitting your order."})}),d&&s.jsxs(I,{w:"100%",justify:"space-between",children:[s.jsx(Y,{fontSize:"14px",color:"text_paragraph",children:"Zap Amount"}),s.jsx(Y,{fontSize:"14px",color:"text_caption",children:Rt(W,2)})]}),Number(re)>0&&Number(de)>0&&s.jsxs(we,{w:"100%",gap:"12px",pt:"16px",pb:d||o?"0px":"16px",children:[s.jsx(I,{w:"100%",justify:"space-between",children:s.jsx(Y,{fontSize:"14px",color:"text_paragraph",children:"Zap Route"})}),s.jsxs(we,{w:"100%",bg:d?"bg_secondary":"none",borderRadius:"12px",p:d?"0px 12px":"0px",gap:d?"4px":"12px",border:"1px solid",borderColor:d?"border":"rgba(0,0,0,0)",flexDirection:i==="Withdraw"?"column-reverse":"column",children:[s.jsxs(we,{w:"100%",align:"flex-start",bg:d?"none":"button_outline_hov_bg",p:d?"16px 0px":"16px 12px",borderRadius:d?"0px":"12px",borderBottom:"1px solid",borderColor:d?"border":"rgba(0,0,0,0)",children:[s.jsx(I,{w:"100%",align:"center",children:s.jsxs(we,{w:"100%",align:"flex-start",onClick:()=>{M(!Q)},children:[s.jsx(I,{w:"100%",justify:"flex-start",children:z?s.jsx(Ke,{w:"100%",h:"16px"}):s.jsxs(Y,{w:"100%",fontSize:"12px",color:"text_caption",textAlign:"left",children:["Swap ",ve(de)," ",N==null?void 0:N.symbol," for ",B," ",U==null?void 0:U.symbol]})}),z?s.jsx(Ke,{w:"150px",h:"16px"}):s.jsxs(I,{w:"100%",justify:"space-between",align:{base:"flex-start",lg:"center"},flexDirection:{base:"column",lg:"row"},children:[s.jsxs(I,{gap:"4px",justify:"space-between",w:{base:"100%",lg:"unset"},children:[s.jsxs(I,{gap:"4px",children:[s.jsx(rs,{callbackInterval:20,ref:k,min:0,max:20,size:"14px",noBg:!0,thickness:"16px",onClick:P}),s.jsxs(I,{flexWrap:"wrap",children:[s.jsx(Y,{fontSize:"12px",color:"text_paragraph",children:"Price Difference"}),s.jsx(Y,{color:V==null?void 0:V.textColor,fontSize:"12px",children:V==null?void 0:V.priceImpactText}),!ye.includes("cetus")&&(ye==null?void 0:ye.map(v=>s.jsx(xs,{market:v},v)))]})]}),fe&&s.jsx(Pe,{xlinkHref:"#icon-icon_arrow",svgW:"12px",svgH:"12px",transform:Q?"rotate(180deg)":"rotate(0deg)"})]}),s.jsxs(I,{align:"center",gap:"2px",children:[d?s.jsxs(I,{gap:"4px",children:[s.jsx(Y,{fontSize:"12px",color:"text_paragraph",children:"Slippage"}),s.jsxs(Y,{fontSize:"12px",color:"text_caption",children:[_(f).mul(100).toString(),"%"]})]}):s.jsx(gs,{slippageType:"zap",toolTipText:"Slippage Tolerance"}),!fe&&s.jsx(Pe,{xlinkHref:"#icon-icon_arrow",svgW:"12px",svgH:"12px",transform:Q?"rotate(180deg)":"rotate(0deg)"})]})]})]})}),Q&&s.jsxs(I,{w:"100%",justify:"space-between",bg:"bg_fifth",h:"52px",borderRadius:"12px",p:"0px 8px",children:[s.jsx(Y,{fontSize:"12px",color:"text_paragraph",children:"Swap Rate"}),z?s.jsx(Ke,{w:"150px",h:"16px"}):s.jsxs(I,{children:[Le?s.jsxs(Y,{fontSize:"12px",color:"text_caption",children:["1 ",U==null?void 0:U.symbol," = ",ht(1/le)," ",N==null?void 0:N.symbol]}):s.jsxs(Y,{fontSize:"12px",color:"text_caption",children:["1 ",N==null?void 0:N.symbol," = ",ht(le)," ",U==null?void 0:U.symbol]}),s.jsx(Pe,{xlinkHref:"#icon-icon_swap1",svgW:"16px",svgH:"16px",onClick:Ve})]})]})]}),s.jsxs(we,{w:"100%",p:d?"16px 0px":"16px 12px",bg:d?"none":"button_outline_hov_bg",borderRadius:"12px",gap:"12px",children:[l?s.jsx(Y,{w:"100%",textAlign:"left",fontSize:"12px",color:"text_caption",children:i==="Withdraw"?"Expected Amounts of Remove":"Expected Amounts to Add"}):s.jsx(cs,{tokenA:se,tokenB:b,percentMap:ke,type:"zap",isLoading:z,isReverse:u,label:"Expected Amounts to Add"}),s.jsxs(I,{bg:"text_highlight_opacity.10",p:"12px",w:"100%",h:"52px",justify:"space-between",align:"center",borderRadius:"12px",children:[s.jsx(At,{isPositionStyle:o,token:u?b:se,amount:u?ve(ue==100?he:n):ve(ue==100?ie:x),rate:u?ee:pe,loading:z}),s.jsx(Ze,{bg:"bg_fifth",w:"1px",h:"100%"}),s.jsx(At,{isPositionStyle:o,token:u?se:b,amount:u?ve(ue==100?ie:x):ve(ue==100?he:n),loading:z,rate:u?pe:ee,align:"right"})]})]})]})]})]})})]})})}function At({token:i,amount:t,rate:r,loading:e,align:u="left",isPositionStyle:d}){return s.jsxs(I,{flex:"1",gap:"8px",p:d?"0":"12px",justify:"flex-start",flexDirection:u==="left"?"row":"row-reverse",children:[e?s.jsx(Ut,{size:"20px"}):s.jsx(es,{imageUrl:i==null?void 0:i.logo_url,w:"20px",h:"20px"}),s.jsxs(we,{align:`flex-${u==="left"?"start":"end"}`,gap:"4px",children:[e?s.jsx(Ke,{w:"50px",h:"14px"}):s.jsxs(Y,{fontSize:"12px",color:"text_caption",textAlign:`${u==="left"?"left":"right"}`,children:[t," ",jt(i==null?void 0:i.symbol,10)]}),e?s.jsx(Ke,{w:{base:"70px",lg:"100px"},h:"12px"}):s.jsx(Y,{fontSize:"12px",color:"text_paragraph",children:Rt(r,2)})]})]})}function qs(i,t){return{currentApiPoolInfo:c.useMemo(()=>{if(i!=null&&i.clmmPool)return t==null?void 0:t[i==null?void 0:i.clmmPool]},[i==null?void 0:i.clmmPool,t])}}function Fs(){const{setCurrentPriceData:i}=qt();return{getCurrentPrice:(r,e,u)=>{if(e.tokenA&&e.tokenB){const d=e.tokenA.decimals,l=e.tokenB.decimals,o=u!==void 0?ct.tickIndexToPrice(u,d,l).toString():ct.sqrtPriceX64ToPrice(new kt(r),d,l).toString(),T=_(1).div(o).toString(),L={currentPrice:o,reverseCurrentPrice:T,currentSqrtPrice:r,pool:e.poolAddress};i(L)}}}}function Zs(){const i=Tt("clmm"),{fetchTokenInfo:t}=ts(),{contractPoolInfo:r,setContractPoolInfo:e,setContractPoolInfoLoading:u,apiPoolInfo:d,setApiPoolInfo:l,setApiPoolInfoLoading:o}=qt(),{setFromToken:T,setToToken:L}=Ct(),{getCurrentPrice:oe}=Fs(),te=async k=>{u(!0);let a=null;try{const m=await i.Pool.getPool(k);if(a={...m,coinAmountA:String(m.coin_amount_a),coinAmountB:String(m.coin_amount_b),coinTypeA:m.coin_type_a,coinTypeB:m.coin_type_b,poolAddress:m.id,poolType:m.pool_type,tickSpacing:Number(m.tick_spacing),current_sqrt_price:String(m.current_sqrt_price),fee_growth_global_a:String(m.fee_growth_global_a),fee_growth_global_b:String(m.fee_growth_global_b),fee_protocol_coin_a:String(m.fee_protocol_coin_a),fee_protocol_coin_b:String(m.fee_protocol_coin_b),fee_rate:String(m.fee_rate),liquidity:String(m.liquidity),rewarder_infos:m.rewarder_infos.map(h=>({coinAddress:h.coin_type,emissionsEveryDay:h.emissions_per_second,emissions_per_second:String(h.emissions_per_second),growth_global:String(h.growth_global)}))},console.log(k,a,"poolAddress"),console.log("ðŸš€ ~ getContractPoolInfo ~ poolInfo:",{poolInfo:a,apiPoolInfo:d}),(d==null?void 0:d.displayTokenA)===void 0){const h=await E(a);console.log("ðŸš€ðŸš€ðŸš€ ~ useGetContractPoolInfo.ts:59 ~ getContractPoolInfo ~ apiPool:",h),h&&(l(h),o(!1),oe(a==null?void 0:a.current_sqrt_price,h,a==null?void 0:a.current_tick_index),T(h==null?void 0:h.displayTokenA),L(h==null?void 0:h.displayTokenB))}}catch(m){console.log("getContractPoolInfo ~ error:",m)}finally{u(!1)}return r?a?(e(a),a):r:(e(a||null),a)};async function E(k){const a=await t(k.coinTypeA),m=await t(k.coinTypeB);if(a&&m){const h=`${a==null?void 0:a.symbol} - ${m==null?void 0:m.symbol}`,ae=Ce(k.fee_rate).div(100).toString(),Q=Ce(k.fee_rate).div(1e4).toString(),M=Ce(ae).div(100).toString()+"%",f=!ms(k.coinTypeA,k.coinTypeB),ce=As.includes(k.poolAddress);return{poolAddress:k.poolAddress,name:h,isReverse:f,tokenA:a,tokenB:m,displayTokenA:f?m:a,displayTokenB:f?a:m,haveMining:!1,miningRewardList:null,miningAprList:null,haveFarming:!1,farmsRewarderList:null,farmsApr:"",farmingAprDisplay:"",feeApr:"",feeAprDisplay:"",miningAprTotal:"",feeAndMiningAprDisplay:"",totalAprDisplay:"",fee:Q,feeRate:ae,feeDisplay:M,tvlDisplay:"0",volume24Display:"0",fees24Display:"0",isVaults:!1,tickSpacing:k.tickSpacing.toString(),isFrozen:ce}}}return{getContractPoolInfo:te}}function Ls(){const{transactionConfirmation:i}=ws(),{getTokenAmountValue:t}=st(),{getCoinAmountFromLiquidity:r}=bs(),{currentPosBaseInfo:e,posLiquidityData:u,posRewardsData:d,setPosBaseList:l,posApiPoolData:o}=ut(),{getCurrentPosBaseInfo:T}=Ft(),{preAdd:L}=Ss(),{getRemoveTsPayload:oe,getCloseTsPayload:te}=as(),{getTokenALock:E,getTokenBLock:k}=dt(),{setTokenAmountAfterA:a,setTokenAmountAfterB:m,currentPosPoolInfo:h,currentPoolSqrtPrice:ae,setIsFixedDisplayTokenA:Q,slideValue:M,setSlideValue:f,isFixedDisplayTokenA:ce,isPosDetailRefresh:ue,currentPosDetailTab:C,useZapIn:K,curPosContractPoolInfo:q,isAutoClaim:re,setIsAutoClaim:z}=ot(),{getZapWithdrawToastInfo:w,getZapWithdrawTx:me,reCalculateZapData:Ae}=Zt("Withdraw"),{getContractPoolInfo:p}=Zs(),{preDepositeData:y,currentZapToken:W,setZapAmount:N,zapAmount:U}=Qe(),{currentApiPoolInfo:de}=qs(e,o),ne=d[e==null?void 0:e.posId],{mevProtect:ye,maxCapForGas:V,transactionMode:Se,customGasPrice:Le,slippage:Ne,zapSlippage:Ve}=tt(),[B,le]=c.useState(""),[P,se]=c.useState(""),[b,x]=c.useState(!1),[n,A]=c.useState(""),G=e==null?void 0:e.displayTokenA,$=e==null?void 0:e.displayTokenB,j=u[e==null?void 0:e.posId],R=ve(j==null?void 0:j.displayCoinAmountA,void 0,!0),F=ve(j==null?void 0:j.displayCoinAmountB,void 0,!0),pe=t(G==null?void 0:G.coin_type,B),ee=t($==null?void 0:$.coin_type,P);c.useEffect(()=>{if(+B||+P){const g=+B,Z=+P,D=_(+R).sub(g),S=_(F).sub(Z);console.log("ðŸš€ ~ useEffect ~ numA.gt(0):",D.toString(),S.toString()),a(D.gt(0)?D.toString():"0"),m(S.gt(0)?S.toString():"0")}else a(""),m("")},[B,P]);const[ie,he]=c.useState(""),ke=c.useRef("");c.useEffect(()=>{console.log("ðŸš€ ~ usePosRemovePage ~ uuid:",ie),ke.current=ie},[ie]);const _e=()=>{le(""),se(""),x(!1),he(""),f("--")},fe=c.useMemo(()=>E(e,q==null?void 0:q.current_sqrt_price),[q==null?void 0:q.current_tick_index,e]),Te=c.useMemo(()=>k(e,q==null?void 0:q.current_sqrt_price),[q==null?void 0:q.current_tick_index,e]),v=e!=null&&e.isReverse?Te:fe,O=e!=null&&e.isReverse?fe:Te;c.useEffect(()=>{_e()},[v,O]);const X=rt((g,Z,D)=>{var Me,ze;console.log("ðŸš€ ~ debouncedPreCalculate ~ params:",g);const S=Z?(Me=e==null?void 0:e.displayTokenA)==null?void 0:Me.decimals:(ze=e==null?void 0:e.displayTokenB)==null?void 0:ze.decimals,xe=ss(g,S),Re=e==null?void 0:e.tokenA,Oe=e==null?void 0:e.tokenB,He=e==null?void 0:e.lowerTick,Xe=e==null?void 0:e.upperTick,J=e==null?void 0:e.isReverse,je={amount:xe,tokenA:Re,tokenB:Oe,isTokenA:J?!Z:Z,lowerTick:He,upperTick:Xe,curSqrtPrice:ae,isReverse:J,roundUp:!1};console.log("ðŸš€ ~ debouncedPreCalculate ~ params:",je);const{displayCoinAmountA:Ue,displayCoinAmountB:Ye,liquidityAmount:be}=L(je);if(console.log("ðŸš€ ~ debouncedPreCalculate:",Ue,Ye,je,Z,D),ke.current===D){A(be),console.log("ðŸš€ ~ debouncedPreCalculate ~ liquidityAmount:",n,be);const Ge=bt(_(be).div(e==null?void 0:e.liquidity).mul(100).toNumber(),2,!0);_(Ge).gt(100)||_(Ge).eq(100)?(f(100),le(R),se(F)):(f(Ge),Z?se(Ye||""):le(Ue||""))}else _e();x(!1)},500),[H,Fe]=c.useState(!1),Ee=()=>{if((B||P)&&is(e)){if(console.log("ðŸš€ ~ reCalculateResult ~ isFixedDisplayTokenA:",H,M),M==="--")return;if(H||Number(M)==100)mt(Number(M));else{console.log("ðŸš€ ~ reCalculateResult ~ currentPosBaseInfo:",e);const g=ce?B:P;if(+g){const Z=et();he(Z),X(g,ce,Z)}}}};c.useEffect(()=>{C=="remove"&&(console.log("ðŸš€ ~ usePosRemovePage ~ tokenABalance, tokenBBalance:",ue,R,F),Ee())},[R,F]);const We=(g,Z)=>{if(console.log("ðŸš€ ~ h111andleAmountChange ~ amount:",g),Fe(!1),A(""),!g){_e();return}if(x(!0),Q(Z),Z){if(le(g),_(g).eq(R)){se(F),f(100),he(""),x(!1);return}}else if(se(g),_(g).eq(F)){le(R),f(100),he(""),x(!1);return}if(console.log("ðŸš€ ~ handleAmountChange ~ amount:",g,+g),+g){const D=et();he(D),console.log("ðŸš€ ~ handleAmountChange ~ params:",g),X(g,Z,D)}else x(!1),Z?se(""):le(""),f("--")},mt=g=>{var Z;if(Fe(!0),console.log("ðŸš€ ~ changeSlideFun ~ changeSlideFun:",R,F,g),K){const S=((Z=de==null?void 0:de.tokenA)==null?void 0:Z.coin_type)===(W==null?void 0:W.coin_type)?lt:at;if(g===100)N(S);else{const xe=_(S).mul(_(g).div(100)).toString();N(xe)}}else if(g==100)le(R),se(F);else{const D=e==null?void 0:e.tokenA,S=e==null?void 0:e.tokenB,xe=ve(_(e==null?void 0:e.liquidity).mul(g).div(100).toString()||"0",0,!0);console.log("ðŸš€ ~ changeSlideFun ~ liquidity1111111:",e==null?void 0:e.liquidity,xe);const Re=e==null?void 0:e.lowerTick,Oe=e==null?void 0:e.upperTick,He=e==null?void 0:e.isReverse,Xe={tokenA:D,tokenB:S,liquidity:xe,currentSqrtPrice:ae,lowerTick:Re,upperTick:Oe,roundUp:!1};try{const{amountA:J,amountB:ge}=r(Xe);A(xe);const je=He?ge:J,Ue=He?J:ge;console.log("ðŸš€ ~ changeSlideFun ~  coinAmountA, coinAmountB:",J,ge),le(_(je).gt(0)?je:""),se(_(Ue).gt(0)?Ue:"")}catch(J){console.log("ðŸš€ ~ changeSlideFun ~ error:",J),le(""),se("")}}},{currentAccount:$e}=it(),Lt=c.useMemo(()=>{const g={text:"Remove",disabled:!1};return $e!=null&&$e.address?!+B&&!+P?(g.text="Enter an amount",g.disabled=!0,g):!v&&B&&_(B).gt(R||0)||!O&&P&&_(P).gt(F||0)?(g.disabled=!0,g.text="Invalid Amount",g):((e==null?void 0:e.posType)=="burn"&&(g.disabled=!0),g):(g.text="Connect Wallet",g.disabled=!1,g)},[B,P,R,F,$e==null?void 0:$e.address]),{signAndExecuteTransaction:Et}=hs(),{fetchAccountBalance:Wt}=_s(),[Mt,nt]=c.useState(!1),Nt=St(),Vt=async()=>{var Oe,He,Xe;nt(!0);const g=!!(e!=null&&e.vestData);console.log("ðŸš€ ~ toRemove ~ isVestingPos:",g);let Z=M==100&&!g;const D=g&&M===100;console.log("ðŸš€ ~ toRemove ~ isClosed:",Z),console.log("ðŸš€ ~ toRemove ~ currentPosRewardsData:",ne),console.log("ðŸš€ ~ toRemove ~ currentPosBaseInfo:",e),console.log("ðŸš€ ~ toRemove ~ currentPosPoolInfo?.miningRewardList:",h==null?void 0:h.miningRewardList);let S=[];q&&q.rewarder_infos.map(J=>{S.push(J.coinAddress)}),console.log("ðŸš€ ~ toRemove ~ rewarderCoinTypes1:",S),S.length===0&&(S=Z?!ne||(ne==null?void 0:ne.length)==0?(Oe=(h==null?void 0:h.miningRewardList)||[])==null?void 0:Oe.reduce((J,ge)=>(J.push(ge.coinType),J),[]):(He=ne||[])==null?void 0:He.reduce((J,ge)=>(J.push(ge.coin_address),J),[]):(Xe=ne||[])==null?void 0:Xe.reduce((J,ge)=>(_(ge==null?void 0:ge.amount_owed).gt(0)&&J.push(ge.coin_address),J),[])),console.log("ðŸš€ ~ toRemove ~ rewarderCoinTypes2:",S);let xe,Re;try{let J,ge,je;if(K){const be=(e==null?void 0:e.posType)=="farms"?e==null?void 0:e.id:e==null?void 0:e.posId;je=w(v,O),i(je);const Me=await me(be,e.liquidity,e.lowerTick,e.upperTick,S,(e==null?void 0:e.posType)=="farms",g,re);J=Me.tx,Me.isClose&&(Z=!0)}else{xe=e!=null&&e.isReverse?_(P).mul(Ie.pow(10,$.decimals)).toString():_(B).mul(Ie.pow(10,G.decimals)).toString(),Re=e!=null&&e.isReverse?_(B).mul(Ie.pow(10,G.decimals)).toString():_(P).mul(Ie.pow(10,$.decimals)).toString(),console.log("ðŸš€ ~ toAdd ~ rewarderCoinTypes:",h,ne,S);const be={posId:(e==null?void 0:e.posType)=="farms"?e==null?void 0:e.id:e==null?void 0:e.posId,poolAddress:e==null?void 0:e.clmmPool,coinTypeA:e==null?void 0:e.coinTypeA,coinTypeB:e==null?void 0:e.coinTypeB,amountA:xe,amountB:Re,liquidity:n,lowerTick:e==null?void 0:e.lowerTick,upperTick:e==null?void 0:e.upperTick,posType:e==null?void 0:e.posType,rewarderCoinTypes:S,isAutoClaim:re};(e==null?void 0:e.posType)=="farms"&&(be.farmsPoolId=e==null?void 0:e.farmsPool,be.farmsPosId=e==null?void 0:e.id),D&&(be.liquidity=e.liquidity),je={getShowInfo:(ze,Ge)=>{const xt="Remove "+[_t(B,G==null?void 0:G.symbol),_t(P,$==null?void 0:$.symbol)].filter(Boolean).join(" and "),Be={modalDescriptionText:xt,toastTitleText:xt};if(ze==="success"){let $t=B,Ht=P;Ge&&($t=De(Ge,G)||B,Ht=De(Ge,$)||P),Be.toastDescriptionContent="",Be.modalDescriptionText="",Be.toastTitleText="Remove Liquidity Successful"}return Be}},i(je),console.log("ðŸš€ ~ toAdd ~ params:",n,Z,M,be);const Me=Z?await te(be):await oe(be,D);J=Me.tx,ge=Me.msafeParams}const Ue={posId:(e==null?void 0:e.posType)=="farms"?e==null?void 0:e.id:e==null?void 0:e.posId,poolAddress:e==null?void 0:e.clmmPool,coinTypeA:e==null?void 0:e.coinTypeA,coinTypeB:e==null?void 0:e.coinTypeB,amountA:xe,amountB:Re,liquidity:n,lowerTick:e==null?void 0:e.lowerTick,upperTick:e==null?void 0:e.upperTick,posType:e==null?void 0:e.posType,rewarderCoinType1:S==null?void 0:S[0],rewarderCoinType2:S==null?void 0:S[1],rewarderCoinType3:S==null?void 0:S[2],farmsPoolId:(e==null?void 0:e.posType)=="farms"?e==null?void 0:e.farmsPool:void 0,slippage:Ne,zapSlippage:Ve,txAction:K?"removeLiquidity-zap":"removeLiquidity"},Ye=await Et(J,je,{useMev:ye,useFastMode:Se==="Fast Mode",maxCapForGas:V,customGasPrice:Le,msafeParams:ge,trackData:Ue});console.log("ðŸš€ ~ toClaim ~ res:",Ye),Ye?(Wt(),_e(),N(""),Z||D?(l([]),Nt("/pools?tab=positions")):T($e.address,e.id,!0)):e!=null&&e.clmmPool&&p(e==null?void 0:e.clmmPool).then(be=>{console.log("ðŸš€ ~ toClaim ~ res:",be),K?Ae():Ee()}),nt(!1)}catch(J){Ee(),nt(!1),console.log("ðŸš€ ~ toClaim ~ error:",J)}};c.useMemo(()=>{if(e!=null&&e.posId){const g=e==null?void 0:e.tokenA,Z=e==null?void 0:e.tokenB,D=e==null?void 0:e.liquidity,S=e==null?void 0:e.lowerTick,xe=e==null?void 0:e.upperTick;r({tokenA:g,tokenB:Z,liquidity:D,currentSqrtPrice:ae,lowerTick:S,upperTick:xe,roundUp:!1})}},[e==null?void 0:e.posId,ae]);const{onlyAmountA:lt,onlyAmountB:at}=c.useMemo(()=>({onlyAmountA:j==null?void 0:j.onlyAmountA,onlyAmountB:j==null?void 0:j.onlyAmountB}),[j]);return c.useEffect(()=>{var g;if(K)if(U){const D=((g=de==null?void 0:de.tokenA)==null?void 0:g.coin_type)===(W==null?void 0:W.coin_type)?lt:at;if(D){const S=bt(_(U).div(D).mul(100).toString(),2,!0);f(S)}else f("--")}else f("--");else f("--")},[K,U]),c.useEffect(()=>{if(C!=="increase"&&K){if(console.log("ðŸš€ ~ usePosRemovePage111 ~ preDepositeData:",y),y!=null&&y.amount_a||y!=null&&y.amount_b){const g=e==null?void 0:e.tokenA,Z=e==null?void 0:e.tokenB,D=qe(y==null?void 0:y.amount_a,g==null?void 0:g.decimals),S=qe(y==null?void 0:y.amount_b,Z==null?void 0:Z.decimals);if(M==100)le(String(R)),se(String(F));else{const xe=e!=null&&e.isReverse?S:D,Re=e!=null&&e.isReverse?D:S;le(_(xe).gt(R)?String(R):xe),se(_(Re).gt(F)?String(F):Re)}return}le(""),se("")}},[K,y,M]),c.useEffect(()=>{le(""),se("")},[]),c.useEffect(()=>{+M&&_(M).eq(100)&&z(!0)},[M]),{tokenAmountA:B,tokenAmountB:P,resetInputAmount:_e,showDisplayTokenALock:v,showDisplayTokenBLock:O,currentPosLiquidityData:j,tokenABalance:R,tokenBBalance:F,displayTokenA:G,displayTokenB:$,tokenAmountValueA:pe,tokenAmountValueB:ee,preRemoveLoading:b,handleAmountChange:We,btnStatusText:Lt,changeSlideFun:mt,toRemove:Vt,isRemoveLoading:Mt,onlyAmountA:lt,onlyAmountB:at,currentApiPoolInfo:de,currentPoolSqrtPrice:ae}}function Es({haveFarming:i}){pt();const{currentPosBaseInfo:t,farmsPosRewardsData:r,posPoolsRelatedData:e,posBaseListLoading:u,posPoolsOriginalData:d}=ut(),{currentPosPoolInfo:l}=ot(),{currentAccount:o}=it(),{getCurrentPosBaseInfo:T}=Ft(),{getFarmsRewardsData:L}=ys(),{getClmmPosName:oe}=dt(),te=c.useMemo(()=>{var p;if(t!=null&&t.tokenName)return t==null?void 0:t.tokenName;{const y=(p=d==null?void 0:d[t==null?void 0:t.clmmPool])==null?void 0:p.index;return oe(t==null?void 0:t.index,y)||""}},[t==null?void 0:t.tokenName,t==null?void 0:t.index,t==null?void 0:t.clmmPool,d]);e[t==null?void 0:t.posId];const{getPosIsActive:E}=dt(),k=c.useMemo(()=>{var p;return E(t,(p=d==null?void 0:d[(t==null?void 0:t.clmmPool)||""])==null?void 0:p.current_sqrt_price)},[t,d]),a=r[t==null?void 0:t.id],m=(l==null?void 0:l.farmsRewarderList)||[],h=a==null?void 0:a.reduce((p,y)=>Ce(p).add(y.display_amount_owed).toString(),0),{toStakePos:ae,toUnStakePos:Q,toClaimPos:M,unstakeLoading:f,claimLoading:ce}=js(),ue=St(),C=p=>{ue(`/position-detail/${p[0].parsedJson.wrapped_position_id}`,{replace:!0}),setTimeout(()=>{T(o==null?void 0:o.address,p[0].parsedJson.wrapped_position_id,!0)},2e3)},K=async()=>{ae(t,l==null?void 0:l.farmsPoolAddress,te,C)},q=()=>{ue(`/position-detail/${t==null?void 0:t.posId}`,{replace:!0}),setTimeout(()=>{T(o==null?void 0:o.address,t==null?void 0:t.posId,!0)},2e3)},re=async()=>{Q(t==null?void 0:t.id,t==null?void 0:t.farmsPool,te,q)},z=()=>{setTimeout(()=>{L([t])},2e3)},w=async()=>{M(t==null?void 0:t.id,t==null?void 0:t.farmsPool,z)},me=c.useMemo(()=>(a==null?void 0:a.length)>0?a.reduce((p,y)=>Ce(p).plus(y==null?void 0:y.display_amount_owed).toString(),"0"):"0",[a,o==null?void 0:o.address,ce,f]),Ae=c.useMemo(()=>t&&l?t.posType=="clmm"&&l.haveFarming===!0:!1,[t==null?void 0:t.posType,l==null?void 0:l.haveFarming]);return!i&&Ce(h).eq(0)?null:s.jsx(s.Fragment,{children:((l==null?void 0:l.farmsPoolAddress)||Ce(me).gt(0))&&s.jsxs(we,{position:"relative",w:"100%",borderRadius:"16px",bg:"linear-gradient( 180deg, #003125 0%, #111111 100%)",children:[i&&s.jsxs(I,{position:"relative",zIndex:1,w:"100%",p:{base:"12px 8px",lg:"12px 16px"},justify:"space-between",children:[s.jsxs(we,{align:"flex-start",children:[s.jsx(Y,{color:"text_caption",children:"Farming"}),s.jsx(Y,{color:"primary_gray",fontSize:"12px",children:"Stake Position to Earn"})]}),s.jsxs(I,{gap:"4px",p:"12px 16px",children:[s.jsx(Y,{color:"primary",fontSize:"12px",fontWeight:"500",children:"APR"}),s.jsx(Y,{color:"primary",fontSize:"12px",fontWeight:"500",children:l==null?void 0:l.farmingAprDisplay}),s.jsx(I,{gap:"4px",cursor:"pointer",onClick:()=>ue("/farms"),sx:{_hover:{p:{color:"text_caption"},svg:{fill:"text_caption"}}},children:s.jsx(Pe,{boxW:"14px",boxH:"14px",xlinkHref:"#icon-icon_list_token"})})]})]}),s.jsxs(vt,{position:"relative",zIndex:1,mt:i?"-20px":"0px",bg:"none",p:{base:"16px 8px 12px",lg:"20px 16px 16px"},borderRadius:i?"0 0 12px 12px":"12px",border:"none",children:[s.jsx(Y,{fontSize:"12px",color:"primary_gray",children:"Farming Rewards"}),s.jsx(I,{w:"100%",flexWrap:"wrap",children:(a==null?void 0:a.length)>0&&Ce(me).gt(0)?a==null?void 0:a.map(p=>{var y;return s.jsx(Gt.Fragment,{children:Ce(p==null?void 0:p.display_amount_owed).gt(0)&&s.jsx(wt,{coinType:(y=p==null?void 0:p.token)==null?void 0:y.coin_type,amount:p==null?void 0:p.display_amount_owed,tokenInfo:p==null?void 0:p.token,boxStyle:{mt:"16px",w:"calc(50% - 4px) "},textAlign:"left"},p==null?void 0:p.coinType)},p==null?void 0:p.rewarder_type)}):(m==null?void 0:m.length)>0?m==null?void 0:m.map(p=>s.jsx(wt,{coinType:p==null?void 0:p.coinType,amount:"0",boxStyle:{mt:"16px",w:"calc(50% - 4px) "},textAlign:"left"},p==null?void 0:p.coinType)):s.jsx(Y,{textColor:"text_caption",textAlign:"right",mt:"8px",children:"--"})}),s.jsxs(I,{w:"100%",justify:"space-between",mt:"16px",children:[(t==null?void 0:t.posType)=="farms"&&s.jsx(Je,{isDisabled:ce||f,isLoading:f,variant:"outline",h:"32px",borderRadius:"8px",w:"50%",fontSize:"14px",bg:"none",onClick:re,children:"Unstake"}),Ae&&!k&&s.jsx(Ze,{w:"50%",sx:{">button":{w:"100%"}},children:s.jsx(os,{placement:"top",tooltip:s.jsx(Y,{fontSize:"12px",lineHeight:"20px",w:"200px",children:"Farming rewards are only available for active positions."}),children:s.jsx(Ze,{w:"100%",children:s.jsx(Je,{bg:"none",isDisabled:!0,h:"32px",borderRadius:"8px",w:"100%",fontSize:"14px",children:"Stake"})})})}),Ae&&k&&s.jsx(Je,{isDisabled:ce||f,isLoading:f,h:"32px",borderRadius:"8px",w:"50%",fontSize:"14px",onClick:K,children:"Stake"}),s.jsx(Je,{isDisabled:ce||f||Ce(h).eq(0),isLoading:ce,variant:"outline",h:"32px",borderRadius:"8px",w:"50%",bg:"none",fontSize:"14px",onClick:w,children:"Claim rewards"})]})]}),s.jsx(Ot,{src:"/images/img_farming@2x.png",w:i?"169px":"128px",h:i?"169px":"128px",position:"absolute",right:"20px",top:"50%",transform:"translateY(-50%)",opacity:"0.1"})]})})}function Ws(i){const{value:t,action:r,onChange:e}=i,{isApp:u}=pt();return s.jsx(vt,{bg:"none",border:"none",padding:"6px 0px",borderRadius:"8px",width:"unset",children:s.jsxs(Xt,{isLazy:!0,trigger:u?"click":"hover",placement:"top",autoFocus:!1,returnFocusOnClose:!1,children:[s.jsx(Jt,{children:s.jsxs(I,{h:"14px",cursor:"pointer",children:[s.jsxs(Y,{whiteSpace:"nowrap",fontSize:"14px",color:t?"primary":"",fontWeight:"500",children:["Zap ",r==="Deposit"?"In":"Out"]}),s.jsx(Dt,{isChecked:t,onChange:()=>{e()}})]})}),s.jsx(Yt,{children:s.jsx(Kt,{p:"12px",lineHeight:"20px",fontSize:"12px",children:r=="Deposit"?"Through Zap-In, you can deposit your liquidity in single token or with customized token ratio. Tokens will be auto converted to match the required ratio. ":"Through Zap-Out, you can withdraw your liquidity in one token. The liquidity will be auto converted to one token you selected."})})]})})}function Ms({action:i,haveZap:t,resetInputAmount:r}){const{useZapIn:e,setUseZapIn:u}=ot(),{setZapAmount:d,setPreDepositeData:l}=Qe(),o=()=>{r==null||r(),u(!e),d("")};return c.useEffect(()=>{u(!1),l(void 0)},[i]),s.jsxs(I,{w:"100%",justify:"space-between",align:"center",mb:"16px",children:[s.jsx(Y,{color:"primary_gray",fontSize:"14px",children:i==="Withdraw"?"Remove Amounts":"Deposit Amounts"}),s.jsx(Ws,{action:i,value:e,onChange:o})]})}function ui(){const{currentPosBaseInfo:i,posPoolsRelatedData:t}=ut(),{isFixedDisplayTokenA:r,slideValue:e,setSlideValue:u,curPosContractPoolInfo:d,useZapIn:l,currentPosPoolInfo:o,isAutoClaim:T,setIsAutoClaim:L}=ot(),{tokenAmountA:oe,tokenAmountB:te,tokenABalance:E,tokenBBalance:k,displayTokenA:a,displayTokenB:m,tokenAmountValueA:h,tokenAmountValueB:ae,preRemoveLoading:Q,handleAmountChange:M,changeSlideFun:f,btnStatusText:ce,toRemove:ue,isRemoveLoading:C,showDisplayTokenALock:K,showDisplayTokenBLock:q,resetInputAmount:re,onlyAmountA:z,onlyAmountB:w,currentApiPoolInfo:me,currentPoolSqrtPrice:Ae,currentPosLiquidityData:p}=Ls();c.useEffect(()=>()=>{re()},[]);const y=W=>{console.log("ðŸš€ ~ changeSlideValue ~ value:",W),W=="MAX"||W==100?(u(100),f(100)):(u(Number((W+"").split("%")[0])),f(Number((W+"").split("%")[0])))};return c.useEffect(()=>u("--"),[]),t[i==null?void 0:i.posId],s.jsxs(we,{w:"100%",gap:"16px",children:[s.jsxs(we,{w:"100%",position:"relative",gap:"16px",p:"0 16px 16px",bg:"card_bg",borderRadius:"0px 0px 16px 16px",children:[s.jsxs(Ze,{w:"100%",children:[(me==null?void 0:me.haveZap)&&(i==null?void 0:i.posType)!=="burn"&&!K&&!q&&s.jsx(Ms,{action:"Withdraw",resetInputAmount:re}),l?s.jsx(ks,{action:"Withdraw",apiPoolInfo:me,currentSqrtPrice:Ae,onlyAmountA:z,onlyAmountB:w,liquidity:i==null?void 0:i.liquidity,lowerTick:i==null?void 0:i.lowerTick,upperTick:i==null?void 0:i.upperTick,slideValue:String(e),currentPosLiquidityData:p,changeSlideValue:y}):s.jsx(s.Fragment,{children:s.jsx(fs,{from:{rightJustify:"space-around",wrapStyle:{h:"108px",borderRadius:"12px"},balance:E||"",value:oe,amountValue:h,loading:!r&&Q,onChange:W=>{M(W,!0)},needRemainBalance:!1,placeholder:"0.0",balanceLabel:"Available",token:a,half:!1,lock:{isLock:i&&d&&K,style:{borderRadius:"12px"}}},to:{rightJustify:"space-around",wrapStyle:{h:"108px",borderRadius:"12px"},balance:k||"",value:te,amountValue:ae,loading:r&&Q,onChange:W=>{M(W,!1)},needRemainBalance:!1,placeholder:"0.0",balanceLabel:"Available",token:m,half:!1,lock:{isLock:i&&d&&q,style:{borderRadius:"12px"}}},lock:{isLock:!i||!d||i&&(i==null?void 0:i.posType)=="burn",text:i&&(i==null?void 0:i.posType)=="burn"?"Your liquidity has been permanently locked":void 0,style:{h:"224px",borderRadius:"12px"}}})})]}),(i==null?void 0:i.posType)!=="burn"&&s.jsx(Vs,{sliderBg:"bg_secondary",percentage:e,onChange:W=>y(W),textFontSize:"20px",sliderTrackHeight:"8px"}),s.jsx(Ts,{checked:T,isDisabled:+e?_(e).eq(100):!1,onChange:()=>{L(!T)}}),l?s.jsx(Cs,{action:"Withdraw",onClick:ue,hideDepositRatio:!0,isPositionStyle:!0,otherLoading:C,isReverse:i==null?void 0:i.isReverse}):s.jsx(Je,{isLoading:C,onClick:ue,disabled:ce.disabled||C||(i==null?void 0:i.isFrozen),w:"100%",h:"56px",fontSize:"20px",fontWeight:"500",children:ce.text})]}),(i==null?void 0:i.posType)!=="burn"&&s.jsx(Es,{haveFarming:o==null?void 0:o.haveFarming})]})}function Ns(i){const{percentage:t,onChange:r,wrapStyle:e,textFontSize:u,selectTabStyle:d,selectTabItemStyle:l,selectTabItemTextStyle:o,isShowPercentageText:T=!0,percentageTextMinW:L="62px"}=i,oe=[{label:"25%"},{label:"50%"},{label:"75%"},{label:"MAX"}],te=c.useMemo(()=>t==="--"||Number(t)!==100?`${t}%`:"MAX",[t]);return s.jsxs(I,{w:"100%",...e,children:[T&&s.jsxs(Y,{minW:L,fontSize:u,color:"text_caption",children:[t=="--"?"--":_(t).gt(0)&&Number(t)<.01?"<0.01":ve(t,2),"%"]}),s.jsx(ft,{type:"outlineTab",tabList:oe,currentTab:te,handleChangeTab:E=>{E.label==="MAX"?r(100):r(E.label.replace("%",""))},wrapStyle:d,itemStyle:l,selectTabItemTextStyle:o})]})}function Vs(i){const{percentage:t,onChange:r,percentageTextMinW:e,textFontSize:u="24px",sliderBg:d="bg_four",sliderTrackHeight:l="4px"}=i;return s.jsxs(Ze,{w:"100%",children:[s.jsx(Ns,{percentage:t,onChange:r,percentageTextMinW:e,wrapStyle:{justifyContent:"space-between"},selectTabStyle:{w:{base:"220px",lg:"310px"},h:"32px",p:"3px",borderRadius:"8px"},selectTabItemStyle:{flex:"1",fontSize:"14px",margin:"0px"},textFontSize:u}),s.jsx(Ze,{mt:"10px",w:"100%",children:s.jsxs(Qt,{"aria-label":"slider-ex-1",min:0,max:100,focusThumbOnChange:!1,value:t=="--"?0:Number(t),onChange:o=>r(o+"%"),children:[s.jsx(zt,{bg:d,h:l,children:s.jsx(Bt,{h:"4px"})}),s.jsx(It,{})]})})]})}export{Es as F,Vs as P,ui as R,Ms as T,ks as Z,Zs as a,qs as b,Cs as c,Fs as d,Ws as e,Zt as u};
