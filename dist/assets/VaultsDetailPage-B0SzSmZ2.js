import{r as l,j as e,F as V,H as S,V as T,T as u,m as O,C as he,B as L,n as it,Z as oe,w as ee,S as ae,ad as at,ac as nt,l as He,O as ot,Q as lt,U as pt,ab as xt,ao as ct}from"./vendor-CBmAETR3.js";import{f as gt,c as me,V as ue,a as Me,e as dt,b as ht,u as Ce,d as mt,i as ut,j as ft}from"./VaultsAprBlock-CTnUP5Xj.js";import{b as bt,R as yt,F as jt,a as Be,u as Fe,c as St,V as wt}from"./VaultsAction-DseJMuJm.js";import{u as vt}from"./swapWidget-CJlZQO6g.js";import{u as Tt,a as _t}from"./useGetPythTokenPrice-ZvbDQKwq.js";import{u as W,d as D,dp as ge,E as P,ad as de,M as Ae,S as Dt,as as ne,C as We,n as ye,bB as je,dq as zt,dr as Ct,ds as Se,e as Ft,B as G,dt as kt,du as Pt,w as te,dv as Rt,dw as Lt,p as Z,A as Y,t as E,z as fe,bo as Ht,I as Mt,av as Bt,aO as At,bU as ke,aG as Wt,l as re,j as Pe,d3 as Ot,aW as Re}from"./index-Lo8eQgA0.js";import{B as Et}from"./BackButton-D2-OxVyR.js";import{N as Oe}from"./NoData-BFX9XpKb.js";import{R as $t}from"./RefreshButton-BEUAg1WA.js";import{u as Nt}from"./useAccountBalance-Bp-GiNHM.js";import"./cross-J9VCREIf.js";import{H as $}from"./HTextLabelBox-0wWY3DfK.js";import{V as N}from"./VTextLabelBox-BsJ2fzM-.js";import{d as Ut,e as Yt,A as Gt,p as we,f as Kt}from"./EmptyTooltip-DmUbGVUK.js";import{R as Ee,X as $e,Y as be}from"./YAxis-BKUOtGTb.js";import{C as Xt}from"./ComposedChart-CWikL62K.js";import{T as Ne,p as Ue,B as qt}from"./generateCategoricalChart-C4prEJcQ.js";import{L as ie}from"./Line-mopvTbgP.js";import{L as Zt}from"./LineChart-4eXBYul_.js";import{d as Qt}from"./useWrapPoolData-tzYpVDlL.js";import{T as Jt}from"./TvlChart-CvwfzX_q.js";import{A as It,C as Vt}from"./VaultsRewardsBlock-BNnrWEeQ.js";import{T as es}from"./TooltipIcon-Bqqgb7rr.js";import{P as ts,C as ss}from"./CoinPairInfo-BkYX588i.js";import{P as rs}from"./PoolTag-DVhitHGR.js";import{T as Le}from"./Table-N6ht64Bc.js";import{V as is}from"./VaultsTab-CmPrP9I9.js";import"./utils-BTUfT3hi.js";import"./en_US-KAK2ZBDO-KTAiToGz.js";import"./Slippage-jToMHVh_.js";import"./index-D39Sw25C.js";import"./useTokenBalance-B8pbbpGD.js";import"./RemoveBlock-x9J5h6fx.js";import"./addLiquidity-C-aVf2Dw.js";import"./FreshProgressV2-D8JIZ9Mf.js";import"./index-CgYRIMgB.js";import"./index-Dq_SzPY7.js";import"./useSwapHelper-BDfKH-rI.js";import"./useGetPoolList-Bo7JxsYj.js";import"./useTransaction-C3m_5TTr.js";import"./useTrack-T_4vPqTb.js";import"./v4-C6aID195.js";import"./useSigner-Dol5aKH6.js";import"./useTransactionModal-Bz8Bofje.js";import"./usePositionList-Bupy7RnX.js";import"./dlmm-DZG9_A9Y.js";import"./useFavoritePool-D0G8SNHz.js";import"./detail-Bk2dr4YI.js";import"./index-WISx45d8.js";import"./TradeInputGroup-DzPgsb9a.js";import"./_baseClone-BEKueZbq.js";import"./_getAllKeysIn-Doplhvy3.js";import"./_defineProperty-DWWEPMFy.js";import"./last-CUqZBUsg.js";import"./msafe-BzcjPV-e.js";import"./TradeConfirmAmountInfo-DwLYGD8Z.js";import"./TotalAmount-CzDtdgBR.js";import"./ErrorTips-BLWaROlb.js";import"./CheckBox-BfyJMUfq.js";import"./RemoveBlock-Dth90jy8.js";import"./usePosRemove-Bz1I4f1O.js";import"./DepositRatio-DMAf6Evu.js";import"./WithTooltipInfo-Bxztcmo8.js";import"./usePriceImpact-d6OtzSL1.js";import"./MarketSource-Do5c0CXX.js";import"./useCurrentPos-CawdmvuM.js";import"./usePosAdd-DQqGRC2k.js";import"./AutoClaimCheckBox-Cvfu7P3A.js";import"./ExpendItem-DrEG4ZJp.js";import"./LiquidityValueBlock-BFN5N1z7.js";import"./PositionPriceRangeBar-Df3DgWEY.js";import"./RangeValue-D-wFxWdA.js";import"./useTokenRank-CM-9-tXe.js";import"./useFindBestRouting-CPdS9aqM.js";import"./useFavoriteDlmmPool-D6iYqQiL.js";import"./useGetDlmmPoolList-B5IuL-hD.js";import"./Area-ClgLzAri.js";import"./debounce-MPJy35Ge.js";import"./AreaChart-DBS-UphW.js";import"./config-DTm0VBgZ.js";const as="/images/icon_vault_currentprice@2x.png";function ns(r){const{displayMaxPrice:t,displayMinPrice:a,displayPrice:n,isLoading:s}=r,{isApp:p}=W(),g=p?200:366,[d,c]=l.useState(0),f=l.useRef(null),m=d||g,h=l.useMemo(()=>!(a&&t&&n),[t,a,n]);l.useEffect(()=>{const y=()=>{f.current&&c(f.current.offsetWidth)};y();const x=new ResizeObserver(y);return f.current&&x.observe(f.current),()=>{f.current&&x.unobserve(f.current)}},[h]);const j=l.useMemo(()=>t==="âˆž"?!0:!(n&&a&&t&&(D(n).greaterThanOrEqualTo(t)||D(a).greaterThanOrEqualTo(n))),[n,a,t]),b=l.useMemo(()=>{if(D(m).gt(0))return t==="âˆž"?`calc(50% - ${m/2}px)`:n&&a&&t&&D(n).lessThanOrEqualTo(t)&&D(n).greaterThanOrEqualTo(a)?`calc(${D(n).sub(a).div(D(t).sub(D(a))).mul(100)}% - ${m/2}px)`:`calc(50% - ${m/2}px)`},[n,a,t,m]);return e.jsx(e.Fragment,{children:h?e.jsx(V,{h:"120px",width:"100%",align:"center",position:"relative",children:e.jsx(L,{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)",children:e.jsx(oe,{})})}):e.jsx(V,{w:"100%",h:"120px",position:"relative",children:e.jsxs(S,{w:"100%",alignItems:"center",justify:"center",position:"absolute",left:"0",top:"50%",children:[e.jsxs(T,{align:"flex-end",gap:"6px",maxW:{md:"48%",lg:"auto"},zIndex:"9999",children:[e.jsx(u,{fontSize:"12px",children:"Min Price"}),s?e.jsx(V,{h:"18px",align:"center",children:e.jsx(O,{})}):e.jsx(u,{fontSize:"14px",fontWeight:"500",color:"text_caption",children:e.jsx(ge,{value:P(a,6,!0,de.ROUND_DOWN)})})]}),e.jsxs(he,{zIndex:"99",position:"relative",h:"40px",w:"366px",children:[e.jsx(he,{w:"100%",h:"100%",borderRadius:"8px",bg:j?"linear-gradient( 270deg, #003F68 0%, #006E51 100%)":"primary_opacity.10"}),e.jsxs(T,{gap:"8px",mt:"-48px",ref:f,ml:j?"-2px":"0px",position:"absolute",left:b,zIndex:"999",transition:"left 0.3s ease",children:[e.jsxs(T,{p:"6px 0px",borderRadius:"8px",gap:"4px",transition:"all 0.3s ease",children:[e.jsx(u,{fontSize:"xs",h:"14px",whiteSpace:"nowrap",children:"Current Price"}),s?e.jsx(V,{h:"18px",align:"center",children:e.jsx(O,{})}):e.jsx(S,{children:e.jsx(u,{fontSize:"16px",color:"text_highlight",whiteSpace:"nowrap",children:e.jsx(ge,{value:P(n,6,!0,de.ROUND_DOWN)})})})]}),e.jsxs(T,{zIndex:"100",children:[e.jsx(L,{w:"2px",h:"42px",bg:j&&t!=="âˆž"?"#fff":"transparent"}),j&&t!=="âˆž"&&e.jsx(it,{src:as,w:"10px",h:"6px",mt:"-6px"})]})]})]}),e.jsxs(T,{align:"flex-start",gap:"6px",maxW:{md:"48%",lg:"auto"},children:[e.jsx(u,{fontSize:"12px",children:"Max Price"}),s?e.jsx(V,{h:"18px",align:"center",children:e.jsx(O,{})}):e.jsx(u,{fontSize:"14px",fontWeight:"500",color:"text_caption",children:e.jsx(ge,{value:P(t,6,!0,de.ROUND_DOWN)})})]})]})})})}function os({vaultId:r}){var K;const[t,a]=l.useState(!1),[n,s]=l.useState("Stake"),{vaultFarmingAprDisplay:p,vaultFarmingLoading:g,farmingTvlDisplay:d,stakeVaultFarmingTvl:c,vaultFarmingRewardAmountUSD:f,vaultFarmingRewardLoading:m,farmClaimAction:h,farmClaimLoading:j,vaultsFarmingStaked:b,currentVaultPositionLoading:y,currentVaultPositionInfo:x,stakeButtonDisabled:w,claimButtonDisabled:k,unStakeButtonDisabled:z,holdingVaultAmountDisplay:R,vaultsFarmingRewards:H,currentVaultsFarm:M,vaultsFarmingStakeLoading:C,currentVaultsFarmingStaked:i}=bt(r),{currentAccount:F}=Ae(),B=l.useMemo(()=>C&&(i&&(i==null?void 0:i.ownerAddress)!=(F==null?void 0:F.address)||!i),[C,F==null?void 0:F.address,i==null?void 0:i.ownerAddress]);return console.log("ðŸš€ðŸš€ðŸš€ ~ FarmingOverview.tsx:46 ~ FarmingOverview ~ stakeLoading:",B),e.jsxs(T,{width:"100%",bg:"bg_six",p:"16px",borderRadius:"16px",background:"linear-gradient( 180deg, #003125 0%, #111111 100%);",position:"relative",children:[e.jsx(L,{backgroundImage:"url(/images/img_farming_bg_2@2x.png)",backgroundSize:"100% 100%",opacity:"0.1",w:"169px",h:"169px",position:"absolute",top:"12px",right:"16px"}),e.jsxs(T,{w:"100%",alignItems:"flex-start",position:"relative",zIndex:"5",children:[e.jsxs(S,{w:"100%",justifyContent:"space-between",children:[e.jsx(N,{title:"haeVault Farming",titleStyle:{color:"text_caption"},value:"Stake your LP tokens to Earn",valueStyle:{fontSize:"12px",color:"primary_gray"},wrapStyle:{gap:"8px"}}),e.jsx($,{label:"APR",value:p,wrapStyle:{w:"auto",gap:"4px"},labelStyle:{fontSize:"14px",color:"text_caption"},valueStyle:{fontSize:"14px",color:"primary"}})]}),e.jsxs(S,{justifyContent:"center",w:"100%",gap:"90px",mt:"6px",alignItems:"center",backgroundImage:"url('/images/img_farming_bg@2x.png')",backgroundSize:"100% 100%",backgroundRepeat:"no-repeat",padding:"12px 0",children:[e.jsx(N,{wrapStyle:{textAlign:"center",alignItems:"center",gap:"8px"},skeletonStyle:{valueH:"20px"},title:"TVL",isLoading:g,value:d}),e.jsx(N,{wrapStyle:{textAlign:"center",alignItems:"center",gap:"8px"},titleStyle:{color:"primary_gray"},title:"Farming Rewards",isLoading:g,skeletonStyle:{valueH:"20px"},value:e.jsx(S,{children:(K=M==null?void 0:M.rewardList)==null?void 0:K.map(v=>{var o,X,U;return e.jsxs(S,{children:[e.jsx(Dt,{imageUrl:(o=v==null?void 0:v.coinDetail)==null?void 0:o.logo_url,w:"20px",h:"20px",coinType:v==null?void 0:v.coin_type,showTag:!1},((X=v==null?void 0:v.coinDetail)==null?void 0:X.name)+"Icon"),e.jsxs(u,{color:"text_caption",children:[v.rewardItemRateDisplay," ",(U=v==null?void 0:v.coinDetail)==null?void 0:U.symbol,"/day"]})]})})})})]})]}),e.jsxs(T,{gap:"16px",w:"100%",mt:"8px",position:"relative",zIndex:"5",children:[e.jsx($,{label:"Available to Stake",isLoading:y,skeletonStyle:{valueH:"24px"},value:e.jsxs(S,{gap:"8px",children:[e.jsxs(T,{gap:"4px",alignItems:"flex-end",children:[e.jsxs(u,{fontSize:"14px",color:"text_caption",children:[F!=null&&F.address?x==null?void 0:x.vaultBalanceDisplay:"--"," LP"]}),e.jsx(u,{fontSize:"12px",children:R})]}),e.jsx(ee,{w:"80px",h:"24px",bg:"none",borderRadius:"8px",fontSize:"12px",variant:"outline",onClick:()=>{s("Stake"),a(!0)},isDisabled:w,children:"Stake"})]}),labelStyle:{color:"primary_gray",fontSize:"14px"}}),e.jsx($,{label:"Your Staked",isLoading:B||y,skeletonStyle:{valueH:"24px"},value:e.jsxs(S,{gap:"8px",children:[e.jsxs(T,{gap:"4px",alignItems:"flex-end",children:[e.jsxs(u,{fontSize:"14px",color:"text_caption",children:[F!=null&&F.address?b==null?void 0:b.stakedBalanceDisplay:"--"," LP"]}),e.jsx(u,{fontSize:"12px",children:ne(c)})]}),e.jsx(ee,{variant:"outline",w:"80px",h:"24px",bg:"none",borderRadius:"8px",fontSize:"12px",isDisabled:z,onClick:()=>{s("Unstake"),a(!0)},children:"Unstake"})]}),labelStyle:{color:"primary_gray",fontSize:"14px"}}),e.jsx($,{label:"Your Rewards",isLoading:m||y,skeletonStyle:{valueH:"24px"},value:e.jsxs(S,{gap:"8px",children:[e.jsx(We,{tooltip:e.jsx(T,{children:H==null?void 0:H.map(v=>e.jsx(yt,{rewardInfo:v},v.rewardCoinType))}),children:e.jsx(u,{textDecoration:"underline dotted",textDecorationColor:"text_paragraph",color:"text_caption",children:ne(f)})}),e.jsx(ee,{variant:"outline",w:"80px",h:"24px",bg:"none",borderRadius:"8px",fontSize:"12px",onClick:h,isLoading:j,isDisabled:k,children:"Claim"})]}),labelStyle:{color:"primary_gray",fontSize:"14px"}})]}),t&&e.jsx(jt,{isOpen:t,setIsOpen:a,setIsOpenPre:a,onClose:()=>a(!1),farmingModalAction:n,vaultsId:r,isDetail:!0})]})}function ls({data:r=[],dateType:t,quoteCoin:a,category:n}){const[s,p]=l.useState({apy:!1,lp_fee:!1}),g=[{value:"Cumulative Yields",type:"line",id:"lp_fee",color:"#07EBAD"},{value:"APY",type:"line",id:"apy",color:"#75C8FF"}],d=l.useMemo(()=>{if(r.length){const h=Math.min(...r.map(w=>w.apy)),j=Math.max(...r.map(w=>w.apy)),b=n=="haedal"?D(j).mul(1.05):D(j).mul(1.05),y=D(h),x=b.sub(y).div(4);return Array.from({length:5},(w,k)=>y.add(x.mul(k)).toNumber())}return[]},[r]),c=l.useMemo(()=>{if(r.length){const h=Math.min(...r.map(w=>w.lp_fee)),j=Math.max(...r.map(w=>w.lp_fee)),b=n=="haedal"?D(j).mul(1.05):D(j).mul(1.0001),y=D(h),x=b.sub(y).div(4);return Array.from({length:5},(w,k)=>y.add(x.mul(k)).toNumber())}return[]},[r]),f=(h,j)=>{const b=new Date(j*1e3),y=b.getUTCHours(),x=b.getUTCMinutes(),w=b.getUTCDate(),k=b.getUTCMonth()+1;if(h<24||t==="24H"){const z=y>=12?"PM":"AM",R=y%12||12;return`${String(R).padStart(2,"0")}:${String(x).padStart(2,"0")} ${z}`}return`${k}/${w}`},{isApp:m}=W();return e.jsx(Ee,{width:"100%",height:"100%",children:e.jsxs(Xt,{data:r,margin:{top:0,left:10,right:28,bottom:5},children:[e.jsx($e,{dataKey:"date",fontSize:"12px",axisLine:!1,tickLine:!1,tick:{fill:"#909CA4"},dy:16,tickFormatter:h=>f(r.length,h),minTickGap:(r==null?void 0:r.length)>8?36:void 0,interval:(r==null?void 0:r.length)<=8?0:void 0}),e.jsx(be,{yAxisId:"bar",xAxisId:"x",fontSize:"12px",orientation:"left",width:50,tickLine:!1,position:"insideRight",ticks:d,domain:[d[0],d[d.length-1]],tickFormatter:h=>P(h,2),tick:e.jsx(Ut,{})}),e.jsx(be,{yAxisId:"line",orientation:"right",fontSize:"12px",tickLine:!1,ticks:c,domain:[c[0],c[c.length-1]],tick:e.jsx(Yt,{isRight:!0,isApp:m,symbol:a==null?void 0:a.symbol,category:n})}),e.jsx(Ne,{content:e.jsx(Gt,{symbol:a==null?void 0:a.symbol})}),e.jsx(Ue,{align:"right",verticalAlign:"top",layout:"horizontal",wrapperStyle:{top:-32,right:0,fontSize:12},payload:g}),e.jsx(qt,{yAxisId:"bar",barSize:1,dataKey:"apy",fill:"#75C8FF",isAnimationActive:!1,hide:s.apy}),e.jsx(ie,{yAxisId:"line",type:"monotone",dataKey:"lp_fee",stroke:"#07EBAD",activeDot:{r:4,stroke:"#07EBAD"},dot:!1,isAnimationActive:!1,hide:s.lp_fee})]})})}function ps(r){const{fetchByApi:t}=ye();return{getVaultApyAndFeesHistogram:async n=>{console.log("ðŸš€ ~ getVaultHistogram ~ params:",n);const s={...n};s.dateType="hour";try{const p=we(s,je),g=await t(r=="haedal"?zt:Ct,"GET",p);return console.log("ðŸš€ ~ getVaultApyAndFeesHistogram ~ res:",g),g!=null&&g.list?{list:g==null?void 0:g.list.map((c,f)=>{const m=c.Timestamp*1e3,h=new Date(m),j=Number(h.toISOString().slice(5,7));return{apy:+c.value.apy*100,lp_fee:+c.value.lp_fee,date:c.Timestamp,tooltipTime:Se(m)}}),quote_type:g==null?void 0:g.quote_type}:[]}catch(p){return console.error("ðŸš€ ~ useGetHistogramData ~ getHistogramData Error:",p),[]}}}}function xs({isRefresh:r,vaultsId:t,category:a}){const[n,s]=l.useState(!1),[p,g]=l.useState(),[d,c]=l.useState(),{isApp:f}=W(),{getTokenInfo:m}=Ft(),h=async y=>{if(y)try{const x=await m(y);console.log("ðŸš€ ~ fetchToken ~ coinInfo:",y,x),x&&c(x)}catch(x){console.error("Error fetching token info:",x)}},{getVaultApyAndFeesHistogram:j}=ps(a),b=async()=>{s(!0);const y=Date.now(),x=86400,w=f?2*x:7*x,k=String(Math.floor(y/1e3-w)),{list:z,quote_type:R}=await j({vaultID:t,beginTimestamp:k,endTimestamp:String(Math.floor(y/1e3))});h(R),g(z),console.log("ðŸš€ ~ fetchPricerangeHistogram ~ tvl_res:",R,z),s(!1)};return l.useEffect(()=>{t&&b()},[t]),l.useEffect(()=>{r&&b()},[r]),e.jsxs(G,{border:"none",padding:f?"12px":"20px 8px 20px 20px",children:[e.jsx(S,{justify:"space-between",children:e.jsx(S,{pr:"12px",w:"100%",justify:"space-between",gap:"4px",children:e.jsx(u,{fontWeight:"500",fontSize:"14px",children:"APY & Yields"})})}),e.jsx(L,{w:"100%",h:"260px",mt:"20px",children:e.jsxs(L,{w:"100%",h:"260px",position:"relative",children:[n&&e.jsx(L,{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)",children:e.jsx(oe,{})}),e.jsx(ls,{data:p,dateType:"",quoteCoin:d,category:a})]})})]})}function cs({payload:r,label:t}){var s,p;const a=((s=r==null?void 0:r[0])==null?void 0:s.payload)&&P(D(r[0].payload.lower).div(r[0].payload.real).sub(1).mul(100).toString(),2),n=((p=r==null?void 0:r[0])==null?void 0:p.payload)&&P(D(r[0].payload.upper).div(r[0].payload.real).sub(1).mul(100).toString(),2);return r&&r.length&&e.jsxs(T,{padding:"16px",bg:"bg_secondary",borderRadius:"12px",border:"1px",borderStyle:"solid",borderColor:"border",justifyContent:"flex-start",alignItems:"left",children:[e.jsx(u,{fontSize:"12px",children:r[0].payload.tooltipTime}),e.jsxs(S,{textAlign:"left",children:[e.jsx(u,{color:"#68FFD8",fontSize:"12px",children:"Pool Price"}),e.jsx(u,{color:"#68FFD8",fontSize:"12px",children:P(r[0].payload.real)})]}),e.jsxs(S,{alignItems:"flex-start",children:[e.jsx(u,{color:"#6FBCF0",fontSize:"12px",children:"Price Range"}),e.jsxs(S,{gap:"2px",children:[e.jsxs(T,{gap:"4px",bg:"primary_opacity.10",p:"4px",borderRadius:"4px",children:[e.jsx(u,{color:"#6FBCF0",fontSize:"12px",children:P(r[0].payload.lower)}),e.jsxs(u,{fontSize:"12px",transform:"scale(0.9)",children:["(",a,"%)"]})]}),e.jsx(u,{color:"#6FBCF0",fontSize:"12px",children:"-"}),e.jsxs(T,{gap:"4px",bg:"primary_opacity.10",p:"4px",borderRadius:"4px",children:[e.jsx(u,{color:"#6FBCF0",fontSize:"12px",children:P(r[0].payload.upper)}),e.jsxs(u,{fontSize:"12px",transform:"scale(0.9)",children:["(",n,"%)"]})]})]})]})]})}function gs({data:r=[],dateType:t,isTabLoading:a,category:n}){const s=l.useMemo(()=>r,[r]),[p,g]=l.useState({lower:!1,upper:!1,real:!1}),d=l.useMemo(()=>{if(s.length){const m=Math.min(...s.map(x=>x.lower)),h=Math.max(...s.map(x=>x.upper)),j=n=="haedal"?D(h).mul(1.1):D(h).mul(1.001),b=n=="haedal"?D(m).mul(.9):D(m).mul(.999),y=j.sub(b).div(4);return Array.from({length:5},(x,w)=>b.add(y.mul(w)).toNumber())}return[]},[s]);console.log("ðŸš€ðŸš€ðŸš€ ~ PriceRangeChart.tsx:30 ~ ticks ~ ticks:",d);const c=(m,h)=>{const j=new Date(h*1e3),b=j.getUTCHours(),y=j.getUTCMinutes(),x=j.getUTCDate(),w=j.getUTCMonth()+1;if(m<24||t==="24H"){const k=b>=12?"PM":"AM",z=b%12||12;return`${String(z).padStart(2,"0")}:${String(y).padStart(2,"0")} ${k}`}return`${w}/${x}`},{isApp:f}=W();return e.jsx(Ee,{width:"100%",height:"100%",children:e.jsxs(Zt,{data:s,margin:{top:0,left:10,right:28,bottom:5},children:[e.jsx($e,{dataKey:"date",fontSize:"12px",axisLine:!1,tickLine:!1,tick:{fill:"#909CA4"},dy:16,tickFormatter:m=>a?"":c(s.length,m),minTickGap:(s==null?void 0:s.length)>8?36:void 0,interval:(s==null?void 0:s.length)<=8?0:void 0}),e.jsx(be,{fontSize:"12px",ticks:d,domain:[d[0],d[d.length-1]],axisLine:!1,tickLine:!1,tickFormatter:m=>P(m,4),tick:e.jsx(Kt,{category:n})}),e.jsx(Ne,{content:e.jsx(cs,{})}),e.jsx(Ue,{align:"right",verticalAlign:"top",layout:"horizontal",wrapperStyle:{top:f?-8:-41,right:f?4:100,fontSize:12},formatter:m=>({lower:"Price Range",upper:"Price Range",real:"Pool Price"})[m]||m}),e.jsx(ie,{type:"monotone",dataKey:"real",stroke:"#07EBAD",activeDot:{r:4,stroke:"#07EBAD"},hide:p.real,dot:!1,isAnimationActive:!1}),e.jsx(ie,{type:"monotone",dataKey:"lower",stroke:"#6FBCF0",activeDot:{r:4,stroke:"#6FBCF0"},dot:!1,hide:p.lower,isAnimationActive:!1}),e.jsx(ie,{type:"monotone",dataKey:"upper",stroke:"#6FBCF0",activeDot:{r:4,stroke:"#6FBCF0"},legendType:"none",dot:!1,hide:p.upper,isAnimationActive:!1})]})})}function ds(r){const{fetchByApi:t}=ye();return{getPriceRangeData:async n=>{try{const s=we(n,je),p=await t(r=="haedal"?kt:Pt,"GET",s);return p!=null&&p.list?p.list.map(g=>{const d=g.Timestamp*1e3,c=new Date(d);return{lower:g.value.lower,upper:g.value.upper,real:g.value.real,date:g.Timestamp,xAxis:Qt(c.toISOString().slice(0,10)),tooltipTime:Se(d),hour:c.getHours()}}):[]}catch(s){return console.error("ðŸš€ ~ useGetPriceRangeData ~ getPriceRangeData Error:",s),[]}}}}function hs({isRefresh:r,vaultsId:t,isReverse:a,category:n}){const[s,p]=l.useState(!1),{getPriceRangeData:g}=ds(n),[d,c]=l.useState(),f=[{label:"24H"},{label:"1W"}],[m,h]=l.useState("1W"),[j,b]=l.useState(!1),y=async w=>{const k=Date.now(),R=String(Math.floor(k/1e3-86400));try{p(!0);const M=(await g({vaultID:t,dateType:w=="24H"?"min":"hour",beginTimestamp:w=="24H"?R:"",endTimestamp:D(new Date().getTime()).toFixed(0)})).map(C=>{const i=a?D(1).div(D(C.upper)).toString():C.lower,F=a?D(1).div(D(C.lower)).toString():C.upper,B=a?D(1).div(C.real).toString():C.real;return{...C,lower:i,upper:F,real:B}});c(M),b(!1),p(!1)}catch(H){p(!1),b(!1),console.log("ðŸš€ðŸš€ðŸš€ ~ PriceRangeChartPageBlock.tsx:40 ~ fetchPricerangeHistogram ~ error:",H)}};l.useEffect(()=>{t&&y(m)},[t,m]),l.useEffect(()=>{r&&y(m)},[r]);const{isApp:x}=W();return e.jsxs(G,{border:"none",padding:x?"12px":"20px 8px 20px 20px",children:[e.jsx(S,{justify:"space-between",children:e.jsxs(S,{pr:"12px",w:"100%",justify:"space-between",gap:"4px",children:[e.jsx(u,{fontWeight:"500",fontSize:"14px",children:"Historical Ranges"}),e.jsx(te,{type:"outlineTab",tabList:f,currentTab:m,handleChangeTab:w=>{b(!0),h(w.label)},wrapStyle:{w:"80px",h:"28px",p:"3px",borderRadius:"8px"},itemStyle:{flex:"1",fontSize:"12px",margin:"0px"}})]})}),e.jsx(L,{w:"100%",h:"260px",mt:"20px",children:e.jsxs(L,{w:"100%",h:"260px",position:"relative",children:[s&&e.jsx(L,{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)",children:e.jsx(oe,{})}),e.jsx(gs,{data:d,dateType:m,isTabLoading:j,category:n})]})})]})}function ms(r){const{fetchByApi:t}=ye(),a=async s=>{console.log("ðŸš€ ~ getVaultHistogram ~ params:",s);const p={...s};p.dateType=s.type=="day"||s.type=="week"?"hour":"day",delete p.type;try{const g=we(p,je),d=await t(r=="haedal"?Rt:Lt,"GET",g);return d!=null&&d.list?d==null?void 0:d.list.map((c,f)=>{var y;const m=c.Timestamp*1e3,h=new Date(m),j=Number(h.toISOString().slice(5,7)),b=n((y=d==null?void 0:d.list)==null?void 0:y.length,h,s==null?void 0:s.type,f);return{num:+c.value,date:c.Timestamp,xAxis:b,tooltipTime:Se(m)}}):[]}catch(g){return console.error("ðŸš€ ~ useGetHistogramData ~ getHistogramData Error:",g),[]}},n=(s,p,g="D",d)=>{const c=g=="D"||g=="day"?"D":g=="W"||g=="week"?"W":"M";console.log("ðŸš€ ~ getXData ~ type:",g);const f=p,m=f.getUTCHours();let h=f.getUTCHours();const j=f.getUTCMinutes(),b=f.getUTCDate(),y=f.getUTCMonth()+1,x=h>=12?"PM":"AM";if(h=h%12||12,c=="D")return`${String(h).padStart(2,"0")}:${String(j).padStart(2,"0")} ${x}`;if(c=="M")return`${y}/${b}`;if(console.log("ðŸš€ ~ getXData ~ noShowHours:",m),s<24){const w=Math.floor(s/2);if(console.log("ðŸš€ ~ getXData ~ step:",s,d,d%w===0,w),d%w===0)return`${y}/${b}`}return s>=24&&s<120&&(m===0||m===12)?`${y}/${b}`:s>=120&&m===0&&j===0?`${y}/${b}`:""};return{getVaultHistogram:a}}function us({isRefresh:r,vaultsId:t,category:a}){const n=[{label:"24H"},{label:"1W"},{label:"1M"}],[s,p]=l.useState(!0),[g,d]=l.useState("24H"),{getVaultHistogram:c}=ms(a),[f,m]=l.useState([]),[h,j]=l.useState(),[b,y]=l.useState(),x=async()=>{var i,F;p(!0);const z=Date.now(),R=86400,H=g=="24H"?1*R:g=="1W"?7*R:30*R,M=String(Math.floor(z/1e3-H)),C=await c({type:g=="24H"?"day":g=="1W"?"week":"month",vaultID:t,beginTimestamp:M,endTimestamp:String(Math.floor(z/1e3))});y((i=C[C.length-1])==null?void 0:i.num),j((F=C[C.length-1])==null?void 0:F.num),console.log("ðŸš€ ~ file: TestData.tsx:78 ~ handleGetHistogramData ~ res:",C),m(C),p(!1)},w=z=>{console.log("ðŸš€ ~ file: TestData.tsx:88 ~ handleChangePureTvl ~ data:",z),j(z?z.num:b)};l.useEffect(()=>{t&&x()},[g,t]),l.useEffect(()=>{r&&x()},[r]);const{isApp:k}=W();return e.jsxs(G,{border:"none",padding:k?"12px":"20px",children:[e.jsxs(S,{justify:"space-between",children:[h?e.jsxs(T,{align:"flex-start",gap:"4px",children:[e.jsx(u,{fontWeight:"500",fontSize:"12px",children:"TVL"}),e.jsx(u,{fontSize:"16px",color:"text_caption",mt:"8px",children:Z(h,2)})]}):e.jsx(T,{align:"flex-start",gap:"4px"}),e.jsx(te,{type:"outlineTab",tabList:n,currentTab:g,handleChangeTab:z=>d(z.label),wrapStyle:{w:"120px",h:"28px",p:"3px",borderRadius:"8px"},itemStyle:{flex:"1",fontSize:"12px",margin:"0px"}})]}),e.jsx(L,{w:"100%",h:"260px",mt:"20px",children:e.jsxs(L,{w:"100%",h:"260px",position:"relative",children:[s&&e.jsx(L,{position:"absolute",top:"38%",left:"50%",transform:"translate(-50%,-50%)",children:e.jsx(oe,{})}),f.length>0&&e.jsx(Jt,{data:f,onChangeValue:w,isShowYAxis:!0,toolTipsType:"tvl"}),!s&&f.length===0&&e.jsx(Oe,{type:"nodata"})]})})]})}function fs({balanceDisplay:r,holdCoinAmounts:t,lpTokenInfo:a,displayTokenA:n,displayTokenB:s,sharePoolRate:p,totalHolding:g,holdCoinAValue:d,holdCoinBValue:c}){const{isApp:f}=W();return e.jsx(G,{border:"none",p:{base:"20px 8px",lg:"20px 16px 48px"},children:e.jsxs(T,{w:"100%",gap:{base:"24px",lg:"8px"},children:[e.jsxs(S,{w:"100%",justifyContent:"space-between",children:[e.jsx(S,{children:e.jsx(u,{textAlign:"start",fontSize:"16px",color:"text_caption",children:"Your Holdings"})}),e.jsxs(S,{gap:"8px",children:[e.jsx(u,{whiteSpace:"nowrap",children:"Your share of pool"}),e.jsx(u,{color:"text_highlight",fontWeight:"500",children:p?`${p}`:"-"})]})]}),f?e.jsxs(T,{w:"100%",gap:"16px",children:[e.jsx($,{label:"LP Token Balance",labelStyle:{fontSize:"13px"},value:e.jsxs(S,{children:[e.jsx(Y,{token:a,haveName:!1,haveSymbol:!1,symbolFontSize:"12px",warningIcon:{isNeedShow:!1},imgBoxStyle:{w:"28px",h:"28px"},haveTooltip:!0}),e.jsxs(u,{color:"text_caption",ml:"4px",fontWeight:"500",fontSize:"13px",children:[r||"-"," LP"]})]}),subValue:e.jsx(u,{children:r?g:"-"}),subValueStyle:{fontSize:"13px"}}),e.jsx($,{label:E(n==null?void 0:n.symbol,10),labelStyle:{fontSize:"13px"},value:e.jsxs(S,{children:[e.jsx(Y,{token:n,haveName:!1,haveSymbol:!1,symbolFontSize:"12px",warningIcon:{iconW:"14px",iconH:"14px"},imgBoxStyle:{w:"20px",h:"20px"},haveTooltip:!0}),t!=null&&t.displayCoinA?e.jsx(u,{fontSize:"13px",color:"text_caption",fontWeight:"500",children:`${t!=null&&t.displayCoinA?t==null?void 0:t.displayCoinA:"-"} ${E(n==null?void 0:n.symbol,10)}`}):e.jsx(O,{w:"100px",h:"14px"})]}),subValue:d?Z(d,2):e.jsx(O,{w:"80px",h:"14px"}),subValueStyle:{fontSize:"13px"}}),e.jsx($,{label:E(s==null?void 0:s.symbol,10),labelStyle:{fontSize:"13px"},value:e.jsxs(S,{children:[e.jsx(Y,{token:s,haveName:!1,haveSymbol:!1,symbolFontSize:"12px",warningIcon:{iconW:"14px",iconH:"14px"},imgBoxStyle:{w:"20px",h:"20px"},haveTooltip:!0}),t!=null&&t.displayCoinB?e.jsx(u,{fontSize:"13px",color:"text_caption",fontWeight:"500",children:`${t!=null&&t.displayCoinB?t==null?void 0:t.displayCoinB:"-"} ${E(s==null?void 0:s.symbol,10)}`}):e.jsx(O,{w:"100px",h:"14px"})]}),subValue:c?Z(c,2):e.jsx(O,{w:"80px",h:"14px"}),subValueStyle:{fontSize:"13px"}})]}):e.jsxs(e.Fragment,{children:[e.jsxs(ae,{flexDir:{base:"column",lg:"row"},mt:"16px",gap:{base:"8px",lg:"4px"},align:"center",children:[e.jsx(u,{children:"LP Token Balance"}),e.jsxs(u,{color:"text_caption",ml:"4px",fontWeight:"500",children:[r||"-"," LP"]}),e.jsx(u,{children:r?g:"-"})]}),e.jsxs(S,{w:{base:"100%",lg:"90%"},mt:"16px",h:"68px",justifyContent:"space-between",pos:"relative",background:"url(/images/vaultLpBg.png)",backgroundSize:"100% auto",borderRadius:"69px",gap:"0",children:[e.jsxs(S,{flex:"1",justifyContent:"center",alignItems:"start",children:[e.jsx(Y,{token:n,haveName:!1,haveSymbol:!1,symbolFontSize:"12px",warningIcon:{iconW:"14px",iconH:"14px"},imgBoxStyle:{w:"32px",h:"32px"},haveTooltip:!0}),e.jsx(N,{wrapStyle:{gap:"4px",w:"calc(100% - 60px)"},title:`${t==null?void 0:t.displayCoinA} ${E(n==null?void 0:n.symbol,10)}`,isTitleLoading:!(t!=null&&t.displayCoinA),titleStyle:{fontSize:{base:"12px",lg:"14px"},color:"text_caption",whiteSpace:"wrap",lineHeight:{base:"16px",lg:"14px"},wordBreak:"break-all"},value:t!=null&&t.displayCoinA?Z(d||0,2):e.jsx(O,{w:"80px",h:"14px"}),valueStyle:{fontSize:{base:"12px",lg:"12px"},color:"text_paragraph",whiteSpace:"wrap",lineHeight:{base:"16px",lg:"12px"},wordBreak:"break-all",fontWeight:500}})]}),e.jsxs(S,{flex:"1",justifyContent:"center",alignItems:"end",children:[e.jsx(N,{wrapStyle:{gap:"4px",alignItems:"flex-end",w:"calc(100% - 60px)"},title:t!=null&&t.displayCoinB?`${t==null?void 0:t.displayCoinB} ${E(s==null?void 0:s.symbol,10)}`:e.jsx(O,{w:"100px",h:"14px"}),titleStyle:{fontSize:{base:"12px",lg:"14px"},color:"text_caption",whiteSpace:"wrap",lineHeight:{base:"16px",lg:"14px"},wordBreak:"break-all"},value:t!=null&&t.displayCoinB?Z(c||0,2):e.jsx(O,{w:"80px",h:"14px"}),valueStyle:{fontSize:{base:"12px",lg:"12px"},color:"text_paragraph",whiteSpace:"wrap",lineHeight:{base:"16px",lg:"12px"},wordBreak:"break-all",fontWeight:500}}),e.jsx(Y,{token:s,haveName:!1,haveSymbol:!1,symbolFontSize:"12px",warningIcon:{iconW:"14px",iconH:"14px"},imgBoxStyle:{w:"32px",h:"32px"},haveTooltip:!0})]}),e.jsx(G,{border:"none",pos:"absolute",left:"calc(50% - 52px)",w:"100px",h:"100px",borderRadius:"70px",p:"8px 0px",children:e.jsxs(T,{justify:"center",gap:"4px",pt:"12px",children:[e.jsx(Y,{token:a,haveName:!1,haveSymbol:!1,symbolFontSize:"12px",warningIcon:{isNeedShow:!1},imgBoxStyle:{w:"60px",h:"60px"},haveTooltip:!0}),e.jsx(u,{color:"#8BAABE",fontSize:"12px",mt:"12px",children:"Pooled Assets"})]})})]})]})]})})}function bs(r){const{price:t,changeSide:a}=r;return{displayPrice:l.useMemo(()=>{if(t)return a?P(fe(1).div(t).toString(),10,!0).toString():t},[t,a])}}function ys(r){const{minPrice:t,maxPrice:a,changeSide:n}=r,s=l.useMemo(()=>{if(t&&a)return n?t==="0"||t==="âˆž"?"0":P(fe(1).div(a).toString(),10,!0).toString():t},[t,a,n]),p=l.useMemo(()=>{if(t&&a)return n?a==="0"||a==="âˆž"?"âˆž":P(fe(1).div(t).toString(),10,!0).toString():a},[t,a,n]);return{displayMinPrice:s,displayMaxPrice:p}}function js({currentPrice:r,minPrice:t,maxPrice:a,displayTokenA:n,displayTokenB:s}){const[p,g]=l.useState(!1),{displayPrice:d}=bs({price:r,changeSide:p}),{displayMaxPrice:c,displayMinPrice:f}=ys({minPrice:t,maxPrice:a,changeSide:p});console.log("ðŸš€ðŸš€ðŸš€ ~ PositionRange.tsx:27 ~ PositionRange ~ changeSide:",p);const m=l.useMemo(()=>p?s:n,[n,s,p]),h=l.useMemo(()=>n&&s?(console.log("ðŸš€ ~ rangeTabList ~ rangeTabList:",n),[n,s].filter(Boolean).map(x=>({label:x==null?void 0:x.symbol,key:x==null?void 0:x.coin_type,isToken:!0,imgInfo:{src:x==null?void 0:x.logo_url,w:"16px",h:"16px",coinType:x?x==null?void 0:x.coin_type:"",showTagWidth:"8px",showTagHeight:"8px"}}))):[],[n==null?void 0:n.coin_type,s==null?void 0:s.coin_type]),[j,b]=l.useState(),y=x=>{var w;g(!p),x&&(x!=null&&x.coin_type)?b(x==null?void 0:x.coin_type):b((w=h==null?void 0:h.find(k=>k.key!==j))==null?void 0:w.key)};return l.useEffect(()=>{m&&b(m==null?void 0:m.coin_type)},[m]),e.jsx(G,{border:"none",mt:{base:"12px",lg:"0"},p:{base:"16px 8px",lg:"15px 16px 16px"},position:"relative",height:"190px",children:e.jsxs(T,{w:"100%",children:[e.jsxs(S,{w:"100%",justifyContent:"space-between",children:[e.jsx(u,{fontSize:"16px",color:"text_caption",children:"Position Range"}),e.jsx(S,{gap:"0px",children:(h==null?void 0:h.length)>0&&e.jsx(te,{type:"outlineTab",tabList:h,currentTab:j,handleChangeTab:x=>y(x),wrapStyle:{h:"32px",p:"3px",border:"1px solid",borderColor:"border",borderRadius:"8px",gap:"4px",zIndex:"99"},itemStyle:{h:"24px",p:"4px 8px",borderRadius:"4px",gap:"4px"}})})]}),e.jsx(ns,{displayPrice:d,displayMaxPrice:c,displayMinPrice:f})]})})}function Ss({displayAmountA:r,displayAmountB:t,displayPercentA:a,displayPercentB:n,displayTokenA:s,displayTokenB:p,vaultsCoinAValue:g,vaultsCoinBValue:d,depositRatio:c,hardCapUSD:f,vaultTvl:m}){const{isApp:h}=W();return e.jsx(G,{border:"none",p:{base:"16px 8px",lg:"20px 16px 28px"},children:e.jsxs(T,{w:"100%",gap:"0px",children:[e.jsxs(S,{w:"100%",justifyContent:"space-between",children:[e.jsx(u,{w:"100%",textAlign:"start",fontSize:"16px",color:"text_caption",children:"Vault Composition"}),f&&e.jsx(It,{depositRatio:c,hardCapUSD:f,vaultTvl:m,label:"Capacity",value:ne(f,"$"),haveCircleProgress:!0,labelStyle:{fontSize:"14px"},textStyle:{fontSize:"14px"}})]}),e.jsxs(S,{w:{base:"100%",lg:"90%"},justifyContent:"space-between",mt:"28px",children:[e.jsxs(S,{children:[e.jsx(Y,{token:s,haveName:!1,haveSymbol:!1,symbolFontSize:"12px",warningIcon:{iconW:"16px",iconH:"16px"},imgBoxStyle:{w:"32px",h:"32px"},haveTooltip:!h}),e.jsx(N,{wrapStyle:{gap:"4px"},title:E(s==null?void 0:s.symbol,10)||"",titleStyle:{fontSize:"14px",color:"text_caption"},value:`${a}%`,isLoading:!a,valueStyle:{fontSize:"12px",color:"primary",fontWeight:"500"}})]}),e.jsx(at,{ml:"16px",mr:"16px",flex:"1",h:"4px",value:Number(a),bg:Number(a)==0&&Number(n)==0?"process_bg_gray":"quote_green",sx:{'div[role="progressbar"]':{bg:"primary"}}}),e.jsxs(S,{children:[e.jsx(N,{wrapStyle:{gap:"4px",alignItems:"flex-end"},title:E(p==null?void 0:p.symbol,10)||"",titleStyle:{fontSize:"14px",color:"text_caption"},value:`${n}%`,isLoading:!n,valueStyle:{fontSize:"12px",color:"primary_green",fontWeight:"500"}}),e.jsx(Y,{token:p,haveName:!1,haveSymbol:!1,symbolFontSize:"12px",warningIcon:{iconW:"16px",iconH:"16px"},imgBoxStyle:{w:"32px",h:"32px"},haveTooltip:!0})]})]}),e.jsxs(S,{w:{base:"100%",lg:"90%"},justifyContent:"space-between",mt:"16px",children:[e.jsx(N,{wrapStyle:{gap:{base:"8px",lg:"4px"}},title:`${P(r,6)} ${E(s==null?void 0:s.symbol,10)}`,isTitleLoading:!r,titleStyle:{fontSize:{base:"12px",lg:"14px"},color:"text_caption"},value:Z(g,2),isLoading:!g,valueStyle:{color:"text_paragraph",fontSize:{base:"12px",lg:"12px"},fontWeight:"500"}}),e.jsx(N,{wrapStyle:{gap:{base:"8px",lg:"4px"},alignItems:"flex-end"},title:`${P(t,6)} ${E(p==null?void 0:p.symbol,10)}`,isTitleLoading:!t,titleStyle:{fontSize:{base:"12px",lg:"14px"},color:"text_caption"},value:Z(d,2),isLoading:!d,valueStyle:{color:"text_paragraph",fontSize:{base:"12px",lg:"12px"},fontWeight:"500"}})]})]})})}function ws(r){var B,K,v,o,X,U;const{apiVaultInfo:t,vaultsList:a,setVaultCurrTab:n}=r,s=nt(),[p,g]=l.useState({label:"All",value:"all"}),d=He(),{vaultPageList:c,filterVaultList:f,setVaultPageList:m}=gt(),{vaultsFarmObj:h}=me(),{isApp:j}=W(),{setAssetAction:b,setIsCheckedZAP:y,setCurrTab:x,setFromToken:w,setToToken:k}=Be(),{setVaultsFarmingStakeLoading:z,setVaultsFarmingRewardsLoading:R}=me(),[H,M]=l.useState(!1);l.useEffect(()=>{(a==null?void 0:a.length)>0&&m(a.sort((_,q)=>q.vaultsTvl-_.vaultsTvl))},[a==null?void 0:a.length,m]);const C=_=>{g(_),f({sortOptions:{sortRule:"desc",sortType:"tvl"},currentTab:_.value,isYourHoldings:!1,selectCoinList:[]})},i=l.useMemo(()=>[{title:e.jsx(u,{color:"primary_gray",fontSize:"13px",pl:{base:"12px",lg:"16px"},children:"Vault"}),key:"#",thConfig:{w:"70%"}},!j&&{title:e.jsx(u,{color:"primary_gray",fontSize:"13px",pl:{base:"12px",lg:"16px"},children:"TVL"}),key:"tvl",thConfig:{w:"15%"}},{title:e.jsx(u,{color:"primary_gray",fontSize:"13px",pr:{base:"12px",lg:"16px"},children:"APY"}),key:"apr",thConfig:{w:"15%"}}],[j]),F=()=>[{title:"",key:"#",thConfig:{w:"70%"},render:_=>{var q;return e.jsx(S,{w:"100%",justify:{base:"flex-start",lg:"flex-start"},pl:{base:"12px",lg:"16px"},children:e.jsx(ss,{versionBlockPosition:"right",type:"column",poolInfo:{..._,poolAddress:_==null?void 0:_.vaultId,poolType:(_==null?void 0:_.category)==="cetus-dlmm"?"dlmm":"clmm"},symbolFontSize:"15px",coinPairInfoWrapStyle:{gap:"4px",p:"4px 0"},isShowVaultsFarmIcon:(q=h[_.vaultId])==null?void 0:q.isVaultsFarming,zIndex:"-1",needPortal:!1,placement:(c==null?void 0:c.length)==1?"bottom-start":"top-start",showPoolTypeTag:!0})})}},!j&&{title:"",key:"tvl",thConfig:{w:"15%"},render:_=>e.jsx(S,{w:"100%",justify:{base:"flex-end",lg:"flex-start"},children:e.jsx(u,{color:"text_caption",children:_.vaultsTvlDisplay})})},{title:"",key:"apy",thConfig:{w:"15%"},render:_=>e.jsx(S,{pr:{base:"12px",lg:"16px"},justifyContent:"flex-end",children:e.jsx(ue,{vaultId:_.vaultId,wrapStyle:{alignItems:"flex-end"},farmingTextStyle:{p:"4px"}})})}];return e.jsx(S,{w:{base:"100%",lg:"unset"},position:"relative",zIndex:"99999",cursor:"pointer",onMouseEnter:()=>M(!0),onMouseLeave:()=>M(!1),children:e.jsxs(ot,{isOpen:s.isOpen,onClose:s.onClose,children:[e.jsx(lt,{as:ee,bg:"none",_hover:{bg:"none"},_active:{bg:"none"},p:"0",onClick:s.onOpen,w:{base:"100%",lg:"auto"},h:"62px",children:e.jsxs(S,{bg:"bg_secondary",p:"8px 16px 8px 12px",borderRadius:"12px",border:"1px solid",borderColor:"border",w:{base:"100%",lg:"unset"},justifyContent:"space-between",h:"62px",children:[e.jsxs(S,{children:[e.jsx(Ht,{coinACoinType:(B=t==null?void 0:t.displayTokenA)==null?void 0:B.coin_type,coinBCoinType:(K=t==null?void 0:t.displayTokenB)==null?void 0:K.coin_type,coinAIconUrl:(v=t==null?void 0:t.displayTokenA)==null?void 0:v.logo_url,coinBIconUrl:(o=t==null?void 0:t.displayTokenB)==null?void 0:o.logo_url}),e.jsxs(T,{alignItems:"start",flexDirection:(t==null?void 0:t.category)==="haedal"||(t==null?void 0:t.category)==="cetus-dlmm"?"column":"row",gap:"2px",children:[e.jsxs(S,{children:[e.jsx(u,{fontSize:"18px",color:"text_caption",fontWeight:"500",children:`${((X=t==null?void 0:t.displayTokenA)==null?void 0:X.symbol)||""} - ${((U=t==null?void 0:t.displayTokenB)==null?void 0:U.symbol)||""}`}),e.jsx(rs,{poolType:(t==null?void 0:t.category)==="cetus-dlmm"?"dlmm":"clmm",binStep:t==null?void 0:t.binStep,displayFee:t==null?void 0:t.feeDisplay})]}),((t==null?void 0:t.category)==="haedal"||(t==null?void 0:t.category)==="cetus-dlmm")&&e.jsx(ts,{category:"haedal",mt:"0px"})]})]}),e.jsx(Mt,{fontSize:"12px",xlinkHref:"#icon-icon_arrow",transition:"transform 0.5s",transform:s.isOpen?"rotate(180deg)":"rotate(0deg)",svgFill:H?"text_caption":"text_paragraph"})]})}),e.jsx(pt,{w:{base:"calc(100vw - 24px)",lg:"unset"},p:"0",mt:"0",children:e.jsx(xt,{closeOnSelect:!1,p:"0",w:"100%",children:e.jsxs(T,{w:{base:"100%",lg:"540px"},p:"16px 0px 0px",gap:{base:"12px",lg:"16px"},children:[e.jsx(S,{w:"100%",p:{base:"0 12px",lg:"0 16px"},children:e.jsx(is,{currentTab:p,onClickVaultsTab:C,vaultsTabWrapStyle:{flexWrap:{base:"wrap"},gap:{base:"8px",lg:"8px"}},vaultsTabItemStyle:{width:{base:"auto",lg:""},p:{base:"6px 10px",lg:"10px 12px"},border:"1px solid",borderColor:"border"}})}),e.jsx(L,{p:"0",h:"32px",bg:"bg_secondary",w:"100%",zIndex:"9999",children:e.jsx(Le,{rowKey:"vaults1",columns:i,dataSource:null,skeletonLength:3,loading:!1,isFlexStart:!0,trPadding:"0px"})}),e.jsx(L,{w:"100%",maxH:"475px",overflowY:"auto",p:"0 4px 4px",mt:"-30px",children:e.jsx(Le,{rowKey:"vaults",columns:F(),dataSource:c,skeletonLength:3,loading:!1,isFlexStart:!0,trPadding:"0px",tableContainerWrapStyle:{minH:"200px"},onRowClick:_=>{s.onClose(),x("Deposit"),b("both"),y(!1),n("Overview"),w(_.displayTokenA),k(_.displayTokenB),z(!0),R(!0),d(`/vaults-detail/${_.vaultId}/${_.category}`)},rowStyle:{h:"70px",cursor:"pointer",_hover:{bg:"primary_opacity.10)"}}})})]})})})]})})}function vs({apiVaultInfo:r,vaultTvl:t,performanceFee:a,vaultTabList:n,vaultCurrTab:s,setVaultCurrTab:p,vaultsList:g}){const{isApp:d}=W(),{getExplorerUrl:c}=Bt(),{currentVaultsFarm:f,isVaultsFarming:m}=Me(r==null?void 0:r.vaultId);return dt(f),e.jsxs(ae,{mb:"16px",flexDir:{base:"column",lg:"row"},w:"100%",alignItems:"flex-end",justifyContent:"space-between",gap:{base:"12px",lg:"8px"},children:[e.jsxs(T,{w:{base:"100%",lg:"unset"},gap:"4px",align:"flex-start",children:[e.jsx(ws,{isVaultsFarming:m,apiVaultInfo:r,vaultsList:g,setVaultCurrTab:p}),!d&&e.jsx(te,{type:"borderTab",wrapStyle:{w:"100%",h:"60px",bg:"none",border:"none"},itemStyle:{fontSize:"16px",mr:"28px"},tabList:n,currentTab:s,handleChangeTab:h=>{p(h==null?void 0:h.value)}})]}),e.jsxs(ae,{w:{base:"100%",lg:"unset"},flexDir:{base:"column",lg:"row"},gap:{base:"8px",lg:"28px"},children:[d&&e.jsx($,{label:"Vault Address",labelStyle:{fontSize:"14px"},value:e.jsx(At,{fontSize:"14px",color:"text_caption",address:(r==null?void 0:r.vaultId)||"",onClickLink:()=>{window.open(c(r==null?void 0:r.vaultId,"poolAddress"),"_blank")}})}),e.jsx(T,{w:{base:"100%",lg:"unset"},justify:"space-between",gap:"6px",flexDirection:{base:"row",lg:"column"},children:d?e.jsx($,{wrapStyle:{w:"100%",gap:"6px"},label:"APY",labelStyle:{fontSize:"14px",fontWeight:"500"},value:e.jsx(ue,{vaultId:r==null?void 0:r.vaultId,wrapStyle:{flexDirection:"row",alignItems:"center"},farmingTextStyle:{p:"0 6px"}}),valueStyle:{color:"text_highlight",h:"20px",lineHeight:"20px",fontSize:"14px",fontWeight:"500",textDecoration:"none"}}):e.jsxs(e.Fragment,{children:[e.jsx(u,{w:"100%",fontSize:{base:"14px",lg:"12px"},textAlign:d?"left":"right",children:"APY"}),e.jsx(ue,{vaultId:r==null?void 0:r.vaultId,wrapStyle:{flexDirection:"row",h:"20px"},farmingTextStyle:{p:"4px"}})]})}),e.jsxs(T,{w:{base:"100%",lg:"unset"},justify:"space-between",gap:"6px",flexDirection:{base:"row",lg:"column"},children:[e.jsx(u,{w:"100%",fontSize:{base:"14px",lg:"12px"},textAlign:d?"left":"right",children:"Earnings"}),e.jsx(We,{placement:"top",tooltip:e.jsx(u,{fontSize:"12px",lineHeight:"20px",maxW:"240px",children:"Rewards will be auto harvested and compounded to your position."}),children:e.jsx(he,{children:e.jsx(S,{justifyContent:"end",children:r==null?void 0:r.vaultsRewards.map(h=>e.jsx(Vt,{coinType:h},h))})})})]}),e.jsxs(T,{w:{base:"100%",lg:"unset"},justify:"space-between",gap:"6px",flexDirection:{base:"row",lg:"column"},children:[e.jsx(u,{w:"100%",fontSize:{base:"14px",lg:"12px"},textAlign:d?"left":"right",children:"TVL"}),e.jsx(u,{color:"text_caption",h:"20px",lineHeight:"20px",fontWeight:"500",children:((r==null?void 0:r.category)=="haedal"||(r==null?void 0:r.category)=="cetus-dlmm"?ne(t,"$"):r==null?void 0:r.vaultsTvlDisplay)||"-"})]}),((r==null?void 0:r.category)=="haedal"||(r==null?void 0:r.category)=="cetus-dlmm")&&e.jsxs(T,{w:{base:"100%",lg:"unset"},justify:"space-between",align:{base:"center",lg:"flex-end"},gap:"6px",flexDirection:{base:"row",lg:"column"},children:[e.jsxs(S,{gap:"4px",mt:"-4px",children:[e.jsx(u,{w:"100%",fontSize:{base:"14px",lg:"12px"},children:"Performance Fee"}),e.jsx(es,{maxW:"340px",tooltipCon:"Commission charged from earned fees and rewards"})]}),e.jsx(u,{color:"text_caption",h:"20px",lineHeight:"20px",fontWeight:"500",children:a||"-"})]})]})]})}function Qr(){const r=He(),{vaultId:t,category:a="cetus"}=ct(),{getCurrentVaultDetail:n}=Fe(),{currentAccount:s}=Ae(),{clearVaultsActionData:p,setFromToken:g,setToToken:d}=Be(),{currentVaultPosition:c,currentVaultPositionLoading:f,clearVaultsPositionObj:m,setCurrentVaultPosition:h}=Tt(),{vaultsPoolObj:j}=ht(),{vaultListObj:b,lpTokenInfoObj:y,vaultsList:x}=_t(),{haedalFarmSdk:w}=ke(),{fetchAccountBalance:k}=Nt(),{getCurrentVaultContractInfo:z}=Fe(),[R,H]=l.useState(!0),{setFromCoin:M,setToCoin:C}=vt(),i=l.useMemo(()=>j[t],[j,t]),{isInitialized:F}=Wt(),{vaultsFarmObj:B,clearVaultsFarmingInfo:K}=me(),v=l.useMemo(()=>c,[c,t]);l.useEffect(()=>{s!=null&&s.address||(m(),h({}))},[s==null?void 0:s.address]),l.useEffect(()=>{var A;if(t&&re(b)){const I=(A=Object.values(b))==null?void 0:A.filter(ce=>ce.vaultId==t);(I==null?void 0:I.length)>0?(console.log("ðŸš€ ~ res ~ res:",I),H(!0)):H(!1)}},[t,b]);const o=l.useMemo(()=>{if(re(b)&&t)return b[t]},[b,t]);l.useEffect(()=>{t&&F&&re(B)&&((s==null?void 0:s.address)==(w==null?void 0:w.senderAddress)||!(s!=null&&s.address))&&n(t,!1)},[s==null?void 0:s.address,t,F,B,w==null?void 0:w.senderAddress]);const X=l.useMemo(()=>y[o==null?void 0:o.lpTokenType],[o==null?void 0:o.lpTokenType,JSON.stringify(y)]),U=[{label:"Overview",value:"Overview"},{label:"Analytics",value:"Analytics"}],[_,q]=l.useState("Overview"),{holdingAmountDisplay:Ye,holdCoinAValue:Ge,holdCoinBValue:Ke}=Ce(c==null?void 0:c.displayAmountA,c==null?void 0:c.displayAmountB,c==null?void 0:c.displayCoinTypeA,c==null?void 0:c.displayCoinTypeB,void 0,void 0,a),{holdingAmount:ve,holdCoinAValue:Xe,holdCoinBValue:qe}=Ce(i==null?void 0:i.displayAmountA,i==null?void 0:i.displayAmountB,i==null?void 0:i.displayCoinTypeA,i==null?void 0:i.displayCoinTypeB,void 0,void 0,a),[le,Te]=l.useState(!1),{getPythLastPrice:Ze}=mt(),pe=l.useRef(!1);l.useEffect(()=>(pe.current=!0,p(),()=>{pe.current=!1,p(),g({}),d({}),h({})}),[]);const _e=()=>{s!=null&&s.address?(k(),n(t,!0)):z(t),pe.current&&(i!=null&&i.displayCoinTypeA)&&(i!=null&&i.displayCoinTypeB)&&(a=="haedal"||a=="cetus-dlmm")&&Ze([i==null?void 0:i.displayCoinTypeA,i==null?void 0:i.displayCoinTypeB]),_!=="Overview"&&(Te(!0),setTimeout(()=>{Te(!1)},1e3))},Q=St(i),{isApp:De}=W();l.useEffect(()=>(o&&(M(o==null?void 0:o.displayTokenA),C(o==null?void 0:o.displayTokenB)),()=>{M(Pe.clmm_swap.from_coin),C(Pe.clmm_swap.to_coin)}),[o==null?void 0:o.vaultsId,t]);const[Qe,Je]=l.useState(!1),Ie=()=>{_e(),Je(A=>!A)},{getHaedalFarmingList:Ve}=ut();l.useEffect(()=>{re(B)||Ve()},[B]);const{isVaultsFarming:et}=Me(t);l.useEffect(()=>{s!=null&&s.address||K()},[s==null?void 0:s.address]);const{volatileVaultsSdk:tt}=ke(),{dlmmVaultContractInfoObj:ze,vaultDlmmPoolContractInfoObj:xe}=ft(),se=l.useMemo(()=>ze[t],[ze,t]);console.log("ðŸš€ðŸš€ðŸš€ ~ VaultsDetailPage.tsx:233 ~ VaultsDetailPage ~ vaultContractInfo:",se);const J=l.useMemo(()=>(console.log("ðŸš€ðŸš€ðŸš€ ~ VaultsDetailPage.tsx:236 ~ VaultsDetailPage ~ vaultDlmmPoolContractInfoObj:",xe),console.log("ðŸš€ðŸš€ðŸš€ ~ VaultsDetailPage.tsx:238 ~ VaultsDetailPage ~ currentVaultPool:",i),xe[i==null?void 0:i.dlmmPoolAddress]),[xe,i==null?void 0:i.dlmmPoolAddress]);return console.log("ðŸš€ðŸš€ðŸš€ ~ VaultsDetailPage.tsx:233 ~ VaultsDetailPage ~ poolContractInfo:",J),l.useEffect(()=>{i&&se&&J&&Ot(tt,i.totalSupply,se,J,"").then(A=>{const{original_lower_bin_id:I,original_upper_bin_id:ce}=A,st=Re.getPricePerLamportFromBinId(I,J.bin_step),rt=Re.getPricePerLamportFromBinId(ce,J.bin_step);console.log("ðŸš€ðŸš€ðŸš€ ~ VaultsDetailPage.tsx:246 ~ VaultsDetailPage ~ res:",{...A,original_lower_bin_id_price:st,original_upper_bin_id_price:rt})})},[se,J,i]),e.jsx(L,{pt:"32px",w:{base:"100%",lg:"1160px"},children:R?e.jsxs(T,{gap:"0px",w:"100%",align:"flex-start",children:[e.jsxs(S,{w:"100%",justify:"space-between",mb:"20px",children:[e.jsx(Et,{borderColor:"border_secondary",onClick:()=>r("/vaults")}),e.jsx($t,{handleRefresh:()=>Ie(),isAutoRefresh:!0,refreshInterval:20,innerStyle:{bg:"bg_secondary"},w:"32px",h:"32px",borderRadius:"8px",bg:"bg_secondary"})]}),e.jsx(vs,{vaultTabList:U,vaultCurrTab:_,setVaultCurrTab:q,apiVaultInfo:o,vaultTvl:ve,performanceFee:i==null?void 0:i.disPlayProtocolFeeRate,vaultsList:x}),e.jsxs(ae,{flexDir:{base:"column-reverse",lg:"row"},w:"100%",justifyContent:"space-between",gap:{base:"0px",lg:"16px"},alignItems:"start",children:[e.jsxs(T,{width:"100%",flex:"1",gap:"12px",children:[De&&e.jsx(te,{type:"borderTab",wrapStyle:{w:"100%",h:"60px",bg:"none",border:"none"},itemStyle:{fontSize:"16px",mr:"28px"},tabList:U,currentTab:_,handleChangeTab:A=>{q(A==null?void 0:A.value)}}),_=="Overview"?e.jsxs(e.Fragment,{children:[e.jsx(js,{minPrice:i==null?void 0:i.minPrice,maxPrice:i==null?void 0:i.maxPrice,currentPrice:i==null?void 0:i.currentPrice,displayTokenA:o==null?void 0:o.displayTokenA,displayTokenB:o==null?void 0:o.displayTokenB}),e.jsx(Ss,{displayAmountA:i==null?void 0:i.displayAmountA,displayAmountB:i==null?void 0:i.displayAmountB,displayPercentA:i==null?void 0:i.displayPercentA,displayPercentB:i==null?void 0:i.displayPercentB,displayTokenB:o==null?void 0:o.displayTokenB,displayTokenA:o==null?void 0:o.displayTokenA,vaultsCoinAValue:i!=null&&i.displayAmountA?Xe:"",vaultsCoinBValue:i!=null&&i.displayAmountB?qe:"",depositRatio:Q==null?void 0:Q.depositRatio,hardCapUSD:Q==null?void 0:Q.hardCapUSD,vaultTvl:ve}),e.jsx(fs,{lpTokenInfo:X,sharePoolRate:f?"":(v==null?void 0:v.shartOfPoolDisplay)||0,balanceDisplay:f?"":(v==null?void 0:v.balanceDisplay)||0,totalHolding:f?"":Ye||"",displayTokenB:o==null?void 0:o.displayTokenB,displayTokenA:o==null?void 0:o.displayTokenA,holdCoinAmounts:{displayCoinA:f?"":P(v==null?void 0:v.displayAmountA,6)||"--",displayCoinB:f?"":P(v==null?void 0:v.displayAmountB,6)||"--"},holdCoinAValue:Ge,holdCoinBValue:Ke})]}):e.jsxs(e.Fragment,{children:[e.jsx(us,{isRefresh:le,vaultsId:o==null?void 0:o.vaultId,category:o==null?void 0:o.category}),e.jsx(xs,{isRefresh:le,vaultsId:o==null?void 0:o.vaultId,category:o==null?void 0:o.category}),e.jsx(hs,{isRefresh:le,vaultsId:o==null?void 0:o.vaultId,isReverse:o==null?void 0:o.isReverse,category:o==null?void 0:o.category})]})]}),e.jsxs(T,{w:De?"100%":"40%",gap:"12px",children:[e.jsx(G,{borderRadius:"16px",border:"none",p:{base:"0px 8px 16px",lg:"0 16px 20px"},bg:"card_bg",children:e.jsx(wt,{autoRefresh:_e,vaultId:t,isRefresh:Qe,isModal:!1})}),et&&e.jsx(os,{vaultId:o==null?void 0:o.vaultId})]})]})]}):e.jsx(Oe,{type:"custom",imgUrl:"/images/img_pool@2x.png",h:"480px",children:e.jsxs(T,{children:[e.jsx(u,{h:"20px",lineHeight:"20px",fontSize:"14px",color:"text_caption",children:"Pool address not found"}),e.jsx(ee,{mt:"12px",w:"120px",h:"32px",borderRadius:"8px",colorScheme:"blue",fontSize:"14px",fontWeight:"500",onClick:()=>{r("/vaults")},children:"Back to Vault"})]})})})}export{Qr as default};
