{"version":3,"file":"index-DLolFg2f.js","sources":["../../src/components/swap/AggregatorMode/index.tsx"],"sourcesContent":["import useCustomizeRouting from '@/hooks/swap/useCustomizeRouting'\nimport useGetRouterConfig from '@/hooks/swap/useGetRouterConfig'\nimport useSwapConfigStore from '@/store/swap/swapConfig'\nimport { Icon } from '@cetus/ui-kit'\nimport { Button, FormControl, FormLabel, HStack, Popover, PopoverBody, PopoverContent, PopoverTrigger, Skeleton, Switch } from '@chakra-ui/react'\nimport { useDeepCompareEffect } from 'ahooks'\nimport confetti from 'canvas-confetti'\nimport { useRef, useState } from 'react'\nimport AggregatorModeModal from './AggregatorModal'\n\ntype AggregatorModeProps = {\n  showRfqSwitch?: boolean\n}\n\nfunction AggregatorMode({ showRfqSwitch = true }: AggregatorModeProps) {\n  const { setIsOpenRfqSwitch } = useSwapConfigStore()\n  const [settingOpen, setSettingOpen] = useState(false)\n  const switchRef = useRef<any>(null)\n  const onClose = () => {\n    setSettingOpen(false)\n  }\n\n  const { providersLoading } = useGetRouterConfig()\n\n  const { handleSelectAllProviderClick, handleSaveClick, currProvidersSwitchStates, isOpenAggregatorMode } = useCustomizeRouting(showRfqSwitch)\n  const handleChange = () => {\n    if (!isOpenAggregatorMode) {\n      triggerConfettiAnimation()\n    }\n    handleSelectAllProviderClick(!isOpenAggregatorMode)\n\n    if (isOpenAggregatorMode) {\n      setIsOpenRfqSwitch(false)\n    }\n  }\n\n  useDeepCompareEffect(() => {\n    handleSaveClick()\n  }, [currProvidersSwitchStates])\n\n  const triggerConfettiAnimation = () => {\n    const viewportWidth = window.innerWidth\n    const viewportHeight = window.innerHeight\n    const rect = switchRef.current?.getBoundingClientRect()\n    const x: any = rect?.left\n    const y: any = rect?.top\n\n    const scalar = 2\n    const shape1 = confetti.shapeFromText({ text: 'ðŸŸ¢', scalar })\n    const shape2 = confetti.shapeFromText({ text: 'ðŸ”µ', scalar })\n    const shape3 = confetti.shapeFromText({ text: 'ðŸ’š', scalar })\n    const shape4 = confetti.shapeFromText({ text: 'ðŸ’™', scalar })\n    confetti({\n      particleCount: 40,\n      spread: 60,\n      // origin: { y: 0.6 },\n      shapes: [shape1, shape2, shape3, shape4],\n      scalar,\n      // origin: { y: 0.2 },\n      origin: { x: x / viewportWidth, y: (y * 1.2) / viewportHeight }\n    })\n  }\n\n  return (\n    <>\n      <Skeleton isLoaded={!providersLoading} w=\"178px\" h=\"28px\">\n        <HStack border=\"1px solid\" borderColor=\"border\" borderRadius=\"8px\" h=\"28px\" bg=\"bg_secondary\" gap=\"8px\">\n          <Popover isLazy trigger=\"hover\" autoFocus={false} returnFocusOnClose={false}>\n            <PopoverTrigger>\n              <FormControl display=\"flex\" alignItems=\"center\" pl=\"8px\">\n                <FormLabel\n                  htmlFor=\"aggregator-mode\"\n                  mb=\"0\"\n                  bg=\"plus_mode_color\"\n                  // textFillColor=\"transparent\"\n                  sx={{\n                    WebkitTextFillColor: 'transparent',\n                    backgroundClip: 'text'\n                  }}\n                  backgroundClip=\"text\"\n                  h=\"18px\"\n                  lineHeight=\"18px\"\n                  fontSize=\"12px\"\n                  fontWeight=\"500\"\n                  fontStyle=\"normal\"\n                  mr=\"8px\"\n                >\n                  Aggregator Mode\n                </FormLabel>\n                <Switch ref={switchRef} id=\"aggregator-mode\" isChecked={isOpenAggregatorMode} onChange={handleChange} />\n              </FormControl>\n            </PopoverTrigger>\n            <PopoverContent>\n              <PopoverBody p=\"12px\" lineHeight=\"20px\" fontSize=\"12px\">\n                The Aggregator Mode will aggregate external liquidity sources\n              </PopoverBody>\n            </PopoverContent>\n          </Popover>\n          <Button\n            variant=\"unstyled\"\n            mr=\"-1px\"\n            minW=\"20px\"\n            w=\"20px\"\n            p=\"7px 4px\"\n            h=\"28px\"\n            bg=\"border\"\n            borderRadius=\"0 8px 8px 0\"\n            onClick={() => setSettingOpen(!settingOpen)}\n            _hover={{\n              svg: {\n                fill: 'text_caption'\n              }\n            }}\n          >\n            <Icon xlinkHref=\"#icon-icon_list_token\" fontSize=\"12px\" />\n          </Button>\n        </HStack>\n      </Skeleton>\n\n      {settingOpen && <AggregatorModeModal isOpen={settingOpen} onClose={onClose} showRfqSwitch={showRfqSwitch} />}\n    </>\n  )\n}\n\nexport default AggregatorMode\n"],"names":["AggregatorMode","showRfqSwitch","setIsOpenRfqSwitch","useSwapConfigStore","settingOpen","setSettingOpen","useState","switchRef","useRef","onClose","providersLoading","useGetRouterConfig","handleSelectAllProviderClick","handleSaveClick","currProvidersSwitchStates","isOpenAggregatorMode","useCustomizeRouting","handleChange","triggerConfettiAnimation","useDeepCompareEffect","viewportWidth","viewportHeight","rect","_a","x","y","scalar","shape1","confetti","shape2","shape3","shape4","jsxs","Fragment","jsx","Skeleton","HStack","Popover","PopoverTrigger","FormControl","FormLabel","Switch","PopoverContent","PopoverBody","Button","Icon","AggregatorModeModal"],"mappings":"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"}