import{n as x,af as B,j as w,V as h,ag as j}from"./index-ihcskjKt.js";import{w as T,f as E}from"./utils-GUDa3Y46.js";import"./vendor-CBmAETR3.js";import"./cross-CbhIs7DK.js";import{u as O}from"./useWrapPoolData-CzWcfmSl.js";function F(){const{fetchByApi:A}=x(),{wrapPoolDataV2:y}=O(),S=async o=>{var d,s,L,P,f,i,r;try{const c={...o},e=E(o==null?void 0:o.coin_type);e&&(c.coin_type=e);const u=T(c),l=await A(B,"POST",u);if((!((d=l==null?void 0:l.data)!=null&&d.list)||((L=(s=l==null?void 0:l.data)==null?void 0:s.list)==null?void 0:L.length)===0)&&w.env==="testnet")throw Error("testnet no data");if((P=l==null?void 0:l.data)!=null&&P.list){const g=(i=(f=l==null?void 0:l.data)==null?void 0:f.list)==null?void 0:i.map(t=>y(t));return console.log("ðŸš€ ~ file: useGetPoolList.ts:42 ~ poolList ~ poolList:",g),{list:g,total:(r=l==null?void 0:l.data)==null?void 0:r.total}}}catch(c){return console.log("ðŸš€ ~ useGetPoolList ~ error:",c),await C(o)}return{list:[],total:0}},C=async o=>{var d,s,L,P,f,i;console.log("ðŸš€ðŸš€ðŸš€ ~ useGetPoolList.ts:136 ~ useGetPoolList ~ params:",o);try{console.log("ðŸš€ ~ useGetPoolList ~ envConfigs?.env:",(d=w)==null?void 0:d.env);const r=((s=w)==null?void 0:s.env)==="testnet"?"/data/pools-testnet.json":"/data/pools.json",c=await fetch(r,{cache:"no-cache"}).then(e=>e.json());if(console.log(c,"getLocalJsonPoolList"),(L=c==null?void 0:c.data)!=null&&L.list){const e=(P=c==null?void 0:c.data)==null?void 0:P.list;let u=e;if(o!=null&&o.pools&&(u=e==null?void 0:e.filter(t=>{var n;return(o==null?void 0:o.pools)&&((n=o==null?void 0:o.pools[0])==null?void 0:n.toLocaleLowerCase())==(t==null?void 0:t.pool.toLocaleLowerCase())})),o!=null&&o.pool&&(u=e==null?void 0:e.filter(t=>{var n;return(o==null?void 0:o.pool)&&((n=o==null?void 0:o.pool)==null?void 0:n.toLocaleLowerCase())==(t==null?void 0:t.pool.toLocaleLowerCase())})),console.log("ðŸš€ðŸš€ðŸš€ ~ useGetPoolList.ts:151 ~ useGetPoolList ~ list:",u),console.log("ðŸš€ðŸš€ðŸš€ ~ useGetPoolList.ts:151 ~ useGetPoolList ~ originList:",e),o!=null&&o.coin_type){const t=(i=(f=o==null?void 0:o.coin_type)==null?void 0:f.split(","))==null?void 0:i.map(n=>h(n).source_address);u=e==null?void 0:e.filter(n=>{var J,$;const G=h((J=n==null?void 0:n.coinA)==null?void 0:J.coinType).source_address,v=h(($=n==null?void 0:n.coinB)==null?void 0:$.coinType).source_address;return(t==null?void 0:t.length)>1&&t.includes(G)&&t.includes(v)?!0:!!((t==null?void 0:t.length)===1&&(t.includes(G)||t.includes(v)))})}o!=null&&o.is_vaults&&(u=e==null?void 0:e.filter(t=>t==null?void 0:t.is_vaults)),o!=null&&o.has_farming&&!(o!=null&&o.is_vaults)&&!(o!=null&&o.has_mining)&&!(o!=null&&o.no_incentives)&&(u=e==null?void 0:e.filter(t=>{var n;return(t==null?void 0:t.farmingRewarder)&&((n=t==null?void 0:t.farmingRewarder)==null?void 0:n.clmmPool)}));const l=JSON.parse(JSON.stringify(u)).splice(0,40);console.log("ðŸš€ ~ useGetPoolList ~ resultList:",l);const g=l==null?void 0:l.map(t=>y(t,!0));return console.log("getLocalJsonPoolList ðŸš€ ~ poolList ~ poolList:",g),{list:g,total:(u==null?void 0:u.length)||0,isLocal:!0}}}catch(r){console.error("getLocalJsonPoolList Error:",r)}return{list:[],total:0,isLocal:!1}},_=o=>j(o)==="0x2::sui::SUI"?"0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI":j(o);return{getPoolList:S,getLocalJsonPoolList:C,getLocalJsonPoolAddress:async(o,d)=>{try{const s=_(o),L=_(d),P=w.env==="testnet"?"/data/all-pools-testnet.json":"/data/all-pools.json",f=await fetch(P).then(i=>i.json());if(f){const i=f[`${s.toLocaleLowerCase()}-${L.toLocaleLowerCase()}`]||f[`${L.toLocaleLowerCase()}-${s.toLocaleLowerCase()}`];return console.log("ðŸš€ --------------------------------------------------ðŸš€"),console.log("ðŸš€ ~ getLocalJsonPoolAddress ~ poolList:",i,`${s.toLocaleLowerCase()}-${L.toLocaleLowerCase()}`,`${L.toLocaleLowerCase()}-${s.toLocaleLowerCase()}`),console.log("ðŸš€ --------------------------------------------------ðŸš€"),i}}catch(s){console.error("getLocalJsonPoolAddress Error:",s)}return[]},wrapGetPoolParams:T}}export{F as u};
//# sourceMappingURL=useGetPoolList-BxNmDN4c.js.map
