import{r as i,ao as pa,K as fa,j as t,w as Fe,H as me,T as ee,V as X,M as Ot,o as At,p as Lt,$ as Mt,q as zt,t as Wt,n as Zt,a0 as xa,B as Kt,P as ba,x as ha,a8 as It,y as ga,A as Sa,m as yt,D as _a,az as Yt,E as Ca,G as wa,J as ja}from"./vendor-CBmAETR3.js";import{j as Vt,c as Ae,h as ya,g as va,d as Ia,f as Ra,k as Xt,a as ft,l as Da,e as Oa,u as Aa,b as kt}from"./VaultsAprBlock-CTWozlz-.js";import{u as xt,a as Pt,c as La,b as Et,d as ea}from"./useGetPythTokenPrice-DxHNOitR.js";import{i as ta,z as C,bU as bt,f as Ut,Q as it,M as Le,l as Ft,Z as tt,a as nt,c8 as Bt,B as Ke,I as aa,w as ht,d0 as Ma,d as _e,as as lt,S as za,bq as Ze,E as Ie,T as at,bo as Wa,d4 as Ea,aT as mt,G as Ge,R as Rt,O as Oe,dS as pt,K as Ua,u as $t,C as Fa,a8 as Ba,ae as $a,v as vt,bn as qt,p as Ha}from"./index-ihcskjKt.js";import{B as Ta}from"./BackButton-B9dAauAl.js";import{T as st}from"./cross-CbhIs7DK.js";import{S as sa}from"./Slippage-C7lPdRZI.js";import{a as Na}from"./RemoveBlock-BSsuAUPi.js";import{H as Te}from"./HTextLabelBox-Cv1F2u1A.js";import{R as oa}from"./RefreshButton-DtwRJDvy.js";import{T as Ht}from"./TradeInputGroup-Cg8Otj2e.js";import{M as ot}from"./msafe-BzcjPV-e.js";import{f as Re,a as Dt}from"./index-78J_CBpj.js";import{u as Tt}from"./useTransaction-BEUdFaaa.js";import{T as Ga}from"./TooltipIcon-CBgjM1b2.js";import{T as Ya}from"./TradeConfirmAmountInfo-D6pugXWx.js";import{P as qa}from"./PoolTag-DVhitHGR.js";import{T as Qa}from"./TotalAmount-DPW4Igd_.js";import{u as na}from"./useAccountBalance-D7pkS3C9.js";import{u as Qt}from"./useTokenBalance-EOIPKTy-.js";import{v as Ye}from"./v4-C6aID195.js";import{E as Ja}from"./ErrorTips-D8Nv331n.js";import{C as Jt}from"./CheckBox-CkL01dAe.js";import{P as Za}from"./RemoveBlock-6_DpKj6X.js";import{u as Ka}from"./useFindBestRouting-BrNyL9M1.js";const Va=(o,a)=>({amountInputA:"",isProfileOpenVaultModal:!1,setIsProfileOpenVaultModal:e=>{o(()=>({isProfileOpenVaultModal:e}))},profilePoolInfo:{},setProfilePoolInfo:e=>{o(()=>({profilePoolInfo:e}))},amountInputB:"",setAmountInputA:e=>{o(()=>({amountInputA:e}))},profileActionTab:"Deposit",setProfileActionTab:e=>{o(()=>({profileActionTab:e}))},setAmountInputB:e=>{o(()=>({amountInputB:e}))},fromToken:{},toToken:{},setFromToken:e=>o({fromToken:e}),setToToken:e=>o({toToken:e}),calculateResult:{amount_a:"",amount_b:"",ft_amount:""},setCalculateResult:e=>o({calculateResult:e}),clearVaultsActionData:()=>o({amountInputA:"",amountInputB:"",calculateResult:{amount_a:"",amount_b:"",ft_amount:""}}),isCheckedZAP:!1,setIsCheckedZAP:e=>{o({isCheckedZAP:e})},assetAction:"both",setAssetAction:e=>{o({assetAction:e})},currTab:"Deposit",setCurrTab:e=>{o({currTab:e})}}),Be=ta(Va);function la(o,a,e,l){let n={isDisabled:!1,btnText:""};return(!a||C(a).lte(0))&&(n.isDisabled=!0),C(a||"0").gt(C(o||"0"))&&(n.isDisabled=!0,n.btnText=l?`Insufficient  ${e.coinDetail.symbol} balance`:"Invalid Amount"),n}function Nt(){const{setCurrentVaultPosition:o,vaultsPositionObj:a,setCurrentVaultPositionLoading:e,setVaultsPositionObj:l}=xt(),{vaultClmmPoolContractInfoObj:n,setLstVaultContractInfoObj:r,setHaedalVaultContractInfoObj:x,vaultDlmmPoolContractInfoObj:s}=Vt(),{setVaultsFarmingStakeLoading:m}=Ae(),{volatileVaultsSdk:_}=bt(),b=Ut("vaults"),{vaultsList:g}=Pt(),{getVaultPoolList:p}=La(),{getVaultPosition:c}=ya(),{getVaultsContractInfo:w}=va(),{getPythLastPrice:u}=Ia(),{fetchTokenPrices:d}=it(),{setFromToken:R,setToToken:L}=Be(),{getVaultsLpTokenList:B}=Ra(),{currentAccount:M}=Le(),D=i.useRef(M==null?void 0:M.address);i.useEffect(()=>{D.current=M==null?void 0:M.address},[M==null?void 0:M.address]);const{vaultId:$}=pa(),{pathname:ae}=fa(),S=i.useRef($);i.useEffect(()=>{S.current=$},[$]);const J=(Q,I=!1)=>{if(!(S.current!==Q&&ae.indexOf("/vaults-detail")>-1))if(Ft(a)&&a[Q]&&!I){const H=a[Q];if(H.ownerAddress==D.current&&D.current){const{displayTokenA:Y,displayTokenB:le}=H;R(Y),L(le),o(H),e(!1)}else pe(Q,I)}else pe(Q,I)},P=async Q=>{const{poolList:I}=await p(),H=await B(I),Y=I.filter(q=>q.vaultId==Q)[0],{displayTokenA:le,displayTokenB:ie}=Y;R(le),L(ie),Y.category=="haedal"||Y.category=="cetus-dlmm"?u([tt(Y.displayTokenA.coin_type,!1),tt(Y.displayTokenB.coin_type,!1)]):d([tt(Y.displayTokenA.coin_type,!1),tt(Y.displayTokenB.coin_type,!1)]);const{lstVaultContractInfoObj:Z,haedalVaultContractInfoObj:be,allClmmPoolContractInfoObj:ue,dlmmVaultContractInfoObj:he,allDlmmPoolContractInfoObj:N}=await w([Y]);console.log("🚀🚀🚀 ~ useCurrentVaultDetail.ts:93 ~ getCurrentVaultContractInfo ~ dlmmVaultContractInfoObj:",he);const re=ue[Y.clmmPoolAddress],xe=N[Y.dlmmPoolAddress];return{vaultContractInfo:Y.category=="cetus"?Z[Y.vaultId]:Y.category=="cetus-dlmm"?he[Y.vaultId]:be[Y.vaultId],clmmContractInfo:re,dlmmContractInfo:xe,vault:Y,lpTokenInfoObj:H,category:Y.category}},pe=async(Q,I=!1)=>{try{D.current&&!I&&e(!0);const{vaultContractInfo:H,clmmContractInfo:Y,vault:le,lpTokenInfoObj:ie,dlmmContractInfo:Z,category:be}=await P(Q);console.log("🚀🚀🚀 ~ useCurrentVaultDetail.ts:114 ~ getCurrentVaultByVaultId ~ vault:",le),console.log("🚀🚀🚀 ~ useCurrentVaultDetail.ts:109 ~ getCurrentVaultByVaultId ~ dlmmContractInfo:",Z);let ue={};(be=="cetus-dlmm"?Z:Y)&&H&&D.current?(ue=await c(le,be=="cetus-dlmm"?Z:Y,H,!1,{},D.current,ie),console.log("🚀🚀🚀 ~ useCurrentVaultDetail.ts:128 ~ getCurrentVaultByVaultId ~ currentVaultPosition:",ue),console.log("🚀🚀🚀 ~ useCurrentVaultDetail.ts:130 ~ getCurrentVaultByVaultId ~ currentVaultPosition[vault.vaultId]:",ue,le.vaultId,ue[le.vaultId].ownerAddress),ue[le.vaultId].ownerAddress==D.current&&D.current&&(o(ue[le.vaultId]),e(!1))):(e(!1),m(!1))}catch{e(!1)}};return{getCurrentVaultDetail:J,getCurrentVaultContractInfo:P,getCurrentVaultByVaultId:pe,updateCurrentVaultById:async Q=>{const I=g.filter(Z=>Z.vaultId==Q)[0],H=n[I.clmmPoolAddress],Y=s[I.dlmmPoolAddress],le=I.category;let ie;if(I.category=="cetus"?ie=await b.Vaults.getVault(I.vaultId):I.category=="haedal"?ie=await _.Vaults.getPool(I.vaultId):I.category=="cetus-dlmm"&&(ie=await _.VaultsV2.getPool(I.vaultId)),I.category=="cetus"?r({[I.vaultId]:ie}):x({[I.vaultId]:ie}),(le=="cetus-dlmm"?Y:H)&&ie){console.log("🚀🚀🚀 ~ useCurrentVaultDetail.ts:152 ~ updateCurrentVaultById ~ 获取当前vault详情:");const Z=await c(I,le=="cetus-dlmm"?Y:H,ie);console.log("🚀🚀🚀 ~ useCurrentVaultDetail.ts:173 ~ updateCurrentVaultById ~ currentVaultPosition:",Z),Z[I.vaultId].ownerAddress==D.current&&D.current&&(o(Z[I.vaultId]),l(Z))}}}}function Gt(o,a,e){const[l,n]=i.useState(""),{haedalFarmSdk:r}=bt(),{signAndExecuteTransaction:x,transactionRejected:s}=Tt(),{mevProtect:m,maxCapForGas:_,transactionMode:b,customGasPrice:g}=nt(),[p,c]=i.useState(!1),{updateCurrentVaultById:w}=Nt(),{getVaultsFarmingStaked:u}=Xt();return{farmStakeAction:async()=>{c(!0);const M={getShowInfo:($,ae)=>{var P;const S="Stake "+Re(l,(P=a==null?void 0:a.coinDetail)==null?void 0:P.symbol);return{modalDescriptionText:S,toastTitleText:S}}},D={poolId:a.poolId,stakeCoinType:a.stakeCoinType,amount:Number(l),decimals:Number(a.coinDetail.decimals),stakeObjectId:e.stakeObjectId};console.log("🚀🚀🚀 ~ useVaultFarmingPage.ts:42 ~ farmStakeAction ~ stakeParams.currentVaultsFarming:",a),console.log("🚀🚀🚀 ~ useVaultFarmStake.ts:31 ~ farmStakeAction ~ stakeParams:",JSON.stringify(D));try{await x(async()=>{const S=new st;return S.setSender(r.senderAddress),await r.Farms.buildStakePayload(D,S),console.log("🚀🚀🚀 ~ useVaultFarmStake.ts:50 ~ txb ~ tx:",S),S},M,{useMev:m,txAction:"signTransactionBlock",useFastMode:b==="Fast Mode",maxCapForGas:_,customGasPrice:g,msafeParams:{action:ot.VaultsFarmingStake,txbParams:D}})?(c(!1),n(""),w(o),u({stakeCoinType:a.stakeCoinType,poolId:a.poolId},o)):c(!1)}catch($){console.log("🚀 ~ doAddAction ~ error:",$),s(M),c(!1)}},isLoading:p,handleChangeStakeValue:M=>{n(M)},stakeAmount:l,farmUnStakeAction:async()=>{c(!0);const M={getShowInfo:($,ae)=>{var P;const S="Unstake "+Re(l,(P=a==null?void 0:a.coinDetail)==null?void 0:P.symbol);return{modalDescriptionText:S,toastTitleText:S}}},D={poolId:a.poolId,stakeCoinType:a.stakeCoinType,stakeObjectId:e.stakeObjectId,amount:C(l).mul(10**a.coinDetail.decimals).toString(),claimReward:!0,rewardConfigs:e.rewardConfigs};console.log("🚀🚀🚀 ~ useVaultFarmingPage.ts:42 ~ farmStakeAction ~ stakeParams.currentVaultsFarming:",a),console.log("🚀🚀🚀 ~ useVaultFarmStake.ts:31 ~ farmStakeAction ~ stakeParams:",D);try{await x(async()=>{const S=new st;return S.setSender(r.senderAddress),await r.Farms.buildUnstakePayload(D,S),console.log("🚀🚀🚀 ~ useVaultFarmStake.ts:50 ~ txb ~ tx:",S),S},M,{useMev:m,txAction:"signTransactionBlock",useFastMode:b==="Fast Mode",maxCapForGas:_,customGasPrice:g,msafeParams:{action:ot.VaultsFarmingUnStake,txbParams:D}})?(c(!1),n(""),w(o),u({stakeCoinType:a.stakeCoinType,poolId:a.poolId},o)):c(!1)}catch($){console.log("🚀 ~ doAddAction ~ error:",$),s(M),c(!1)}},farmClaimAction:async()=>{c(!0);const M={getShowInfo:($,ae)=>{const S="Claim Farming Rewards";return{modalDescriptionText:S,toastTitleText:S}}};console.log("🚀🚀🚀 ~ useVaultFarmingPage.ts:42 ~ farmStakeAction ~ stakeParams.currentVaultsFarming:",a);let D;try{await x(async()=>{var J,P,pe;const S=new st;S.setSender(r.senderAddress);for(let se=0;se<((J=e.rewardConfigs)==null?void 0:J.length);se++)D={poolId:a.poolId,stakeCoinType:a.stakeCoinType,stakeObjectId:e.stakeObjectId,rewardCoinType:(P=e.rewardConfigs[se])==null?void 0:P.rewardCoinType,rewardBank:(pe=e.rewardConfigs[se])==null?void 0:pe.bank},console.log("🚀🚀🚀 ~ useVaultFarmStake.ts:31 ~ farmStakeAction ~ stakeParams:",D),await r.Farms.buildHarvestPayload(D,S);return console.log("🚀🚀🚀 ~ useVaultFarmStake.ts:50 ~ txb ~ tx:",S),S},M,{useMev:m,txAction:"signTransactionBlock",useFastMode:b==="Fast Mode",maxCapForGas:_,customGasPrice:g,msafeParams:{action:ot.VaultsFarmingClaim,txbParams:D}})?(c(!1),n(""),u({stakeCoinType:a.stakeCoinType,poolId:a.poolId},o)):c(!1)}catch($){console.log("🚀 ~ doAddAction ~ error:",$),s(M),c(!1)}}}}function Xa({currentVaultPosition:o,currentVaultsFarming:a}){const{vaultsFarmingStaked:e}=Ae(),l=i.useMemo(()=>e[o.vaultId],[e,o.vaultId]),{handleChangeStakeValue:n,stakeAmount:r,farmStakeAction:x,isLoading:s}=Gt(o==null?void 0:o.vaultId,a,l),{isDisabled:m,btnText:_}=la(o==null?void 0:o.vaultBalanceFormat,r,a,!0);return t.jsxs(t.Fragment,{children:[t.jsx(Bt,{value:r,onChange:n,token:a==null?void 0:a.coinDetail,placeholder:"",balance:o==null?void 0:o.vaultBalanceFormat,wrapStyle:{height:"110px"}}),t.jsx(Fe,{w:"100%",h:"52px",fontWeight:"600",onClick:x,isDisabled:m,isLoading:s,children:_||"Stake"})]})}function ka(){const[o,a]=i.useState(25),[e,l]=i.useState("USDC+SUI"),n=[{label:"USDC+SUI",value:"USDC+SUI"},{label:"USDC",value:"USDC"},{label:"SUI",value:"SUI"}];return t.jsxs(t.Fragment,{children:[t.jsxs(me,{w:"100%",justifyContent:"space-between",gap:"8px",children:[t.jsx(ee,{fontSize:"16px",color:"text_caption",children:"Unstake"}),t.jsxs(me,{w:"100%",justifyContent:"flex-end",children:[t.jsx(sa,{slippageType:"vaults",compact:!0}),t.jsx(oa,{handleRefresh:()=>{},w:"28px",h:"28px",minW:"28px",minH:"28px",innerStyle:{w:"28px",h:"28px",borderRadius:"8px",bg:"bg_secondary"}})]})]}),t.jsxs(X,{w:"100%",children:[t.jsx(Bt,{value:"1",onChange:()=>{},placeholder:"0",balance:"100",wrapStyle:{position:"relative",zIndex:5,height:"110px"}}),t.jsx(Ke,{borderRadius:"0 0 20px 20px",p:"20px 14px 8px",mt:"-20px",children:t.jsx(Na,{percentage:o,onChange:r=>a(r),wrapStyle:{justifyContent:"space-between"},selectTabStyle:{w:{base:"220px",lg:"276px"},h:"32px",p:"3px",borderRadius:"8px"},selectTabItemStyle:{flex:"1",fontSize:"12px",margin:"0px"},textFontSize:"20px"})}),t.jsx(aa,{xlinkHref:"#icon-a-icon_trade",svgW:"12px",svgH:"12px",isActive:!0,activeColor:"text_caption",m:"8px 0 0px"})]}),t.jsxs(X,{w:"100%",children:[t.jsx(ee,{w:"100%",fontSize:"16px",color:"text_caption",textAlign:"left",mt:"4px",children:"Receive"}),t.jsx(ht,{type:"outlineTab",wrapStyle:{w:{base:"100%"},h:"42px",padding:"4px"},itemStyle:{w:"50%",fontSize:"14px",borderRadius:"8px"},tabList:n,currentTab:e,handleChangeTab:r=>{l(r.value)}}),t.jsx(Ht,{from:{wrapStyle:{height:"110px"}},to:{wrapStyle:{height:"110px"}}}),t.jsx(Fe,{w:"100%",h:"52px",children:"Deposit"}),t.jsxs(X,{w:"100%",gap:"20px",mt:"8px",children:[t.jsx(Te,{label:"Total Withdraw",labelStyle:{fontSize:"14px"},value:"11",valueStyle:{fontSize:"14px"},isLoading:!1}),t.jsx(Te,{label:"LP Burn Amount",value:"11",labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},isLoading:!1})]})]})]})}function Pa(o){const{currentVaultsFarming:a,currentVaultPosition:e}=o,{vaultsFarmingStaked:l}=Ae(),n=i.useMemo(()=>l[e.vaultId],[l,e.vaultId]),{handleChangeStakeValue:r,stakeAmount:x,farmUnStakeAction:s,isLoading:m}=Gt(e==null?void 0:e.vaultId,a,n),{isDisabled:_,btnText:b}=la(n==null?void 0:n.stakedBalanceFormat,x,a,!1);return t.jsxs(t.Fragment,{children:[t.jsx(Bt,{token:a==null?void 0:a.coinDetail,value:x,onChange:r,placeholder:"0",balance:n==null?void 0:n.stakedBalanceFormat,wrapStyle:{height:"110px"}}),t.jsx(Fe,{w:"100%",h:"52px",fontWeight:"600",mt:"8px",isDisabled:_,onClick:s,isLoading:m,children:b||"Unstake"})]})}function es(o){const[a,e]=i.useState("Unstake LP");return t.jsxs(X,{w:"100%",children:[a==="Unstake LP"&&t.jsx(Pa,{...o}),a==="Unstake and Withdraw"&&t.jsx(ka,{}),t.jsx(ee,{w:"100%",p:"12px",textAlign:"center",fontSize:"12px",color:"primary",bg:"primary_opacity.10",borderRadius:"12px",mt:a=="Unstake LP"?"4px":"8px",children:"Haedal farming rewards will be claimed when unstaking."})]})}function Qs({isOpen:o,onClose:a,setIsOpen:e,setIsOpenPre:l,farmingModalAction:n,vaultsId:r,isDetail:x}){const[s,m]=i.useState(n||"Stake"),{currentVaultPosition:_}=xt(),{currentVaultsFarm:b}=ft(r),g=[{label:"Stake",value:"Stake"},{label:"Unstake",value:"Unstake"}];return t.jsxs(Ot,{isCentered:!0,isOpen:o,onClose:()=>{e(!1)},children:[t.jsx(At,{}),t.jsxs(Lt,{width:{base:"100%",lg:"420px"},children:[t.jsxs(Mt,{children:[x&&"Haedal Farms",!x&&t.jsx(Ta,{w:"100%",border:"none",bg:"none",justifyContent:"start",text:"Haedal Farms",ml:"-6px",customTextStyle:{color:"text_caption"},onClick:()=>{e(!1),l(!0)}})]}),t.jsx(zt,{}),t.jsxs(Wt,{p:"0 16px 8px",children:[t.jsx(ht,{type:"borderTab",wrapStyle:{w:"100%",h:"38px",border:"none",bg:"none"},itemStyle:{fontSize:"16px",mr:"28px",fontWeight:"500"},tabList:g,currentTab:s,handleChangeTab:p=>{m(p.value)}}),t.jsxs(X,{gap:"16px",mt:"16px",pb:"8px",children:[s==="Stake"&&t.jsx(Xa,{currentVaultPosition:_,currentVaultsFarming:b}),s==="Unstake"&&t.jsx(es,{currentVaultPosition:_,currentVaultsFarming:b})]})]})]})]})}function ts(o){const{getTokenAmountValue:a}=it(),{setVaultsFarmingRewardsLoading:e,vaultsFarmingRewardsLoading:l}=Ae(),[n,r]=i.useState("0"),[x,s]=i.useState("0"),{currentAccount:m}=Le();return i.useEffect(()=>{(async()=>{if(!(m!=null&&m.address)){r("--"),e(!1);return}if(!o||o.length===0){r("0");return}if(!o.some(b=>b.ownerAddress!=(m==null?void 0:m.address))){e(!0);try{let b=C(0),g=C(0);for(const p of o){const c=a(p.rewardCoinType,p.rewardAmountDisplay);b=b.add(c),g=g.add(p.rewardAmountDisplay)}r(b.toString()),s(g.toString())}catch(b){console.error("Error calculating vault farming reward USD:",b),r("0")}finally{e(!1)}}})()},[o,a,m==null?void 0:m.address]),{vaultFarmingRewardAmountUSD:n,vaultsFarmingRewardsLoading:l,setVaultsFarmingRewardsLoading:e,vaultFarmingRewardAmount:x}}function as(o,a,e,l){const{getTokenAmountValue:n}=it(),[r,x]=i.useState(""),[s,m]=i.useState(!0),{currentAccount:_}=Le();return i.useEffect(()=>{(async()=>{if(!(_!=null&&_.address)){x("--"),m(!1);return}if(!o||!a||!Ft(e)||!l){x("");return}m(!0);try{const{coin_type_a:g,coin_type_b:p}=a,{tokenA:c,tokenB:w}=l,u=Ma("",e.stakedBalance,o,a),d=C(u.amount_a).div(10**((c==null?void 0:c.decimals)??0)).toString(),R=C(u.amount_b).div(10**((w==null?void 0:w.decimals)??0)).toString(),L=n(g,d),B=n(p,R),M=C(L).add(B);x(M.toString()),m(!1)}catch(g){console.error("Failed to calculate stakeVaultFarmingTvl:",g),x("0")}})()},[o,a,e,l,n]),{stakeVaultFarmingTvl:r,stakeVaultFarmingTvlLoading:s,setStakeVaultFarmingTvlLoading:m}}function ss(o){const{currentAccount:a}=Le(),{currentVaults:e}=Da(o),{currentVaultsFarm:l}=ft(o),{vaultsFarmingStaked:n,vaultsFarmingRewards:r,vaultsFarmingStakeLoading:x,vaultsFarmingRewardsLoading:s,clearVaultsFarmingInfo:m}=Ae(),_=i.useMemo(()=>n[e==null?void 0:e.vaultId],[n,e==null?void 0:e.vaultId]),b=i.useMemo(()=>r[e==null?void 0:e.vaultId],[r,e==null?void 0:e.vaultId]),{haedalVaultContractInfoObj:g,vaultClmmPoolContractInfoObj:p}=Vt(),{currentVaultPosition:c,currentVaultPositionLoading:w}=xt(),{vaultsFarmObj:u}=Ae(),d=i.useMemo(()=>g[e==null?void 0:e.vaultId],[e==null?void 0:e.vaultId,g]),R=i.useMemo(()=>p[e==null?void 0:e.clmmPoolAddress],[e==null?void 0:e.clmmPoolAddress,p]),{vaultFarmingAprDisplay:L,farmingTvlDisplay:B,vaultFarmingApr:M,farmingTvl:D,vaultFarmingLoading:$}=Oa(l),{stakeVaultFarmingTvl:ae,stakeVaultFarmingTvlLoading:S}=as(d,R,_,e),{vaultFarmingRewardAmountUSD:J,vaultFarmingRewardAmount:P}=ts(b),pe=i.useMemo(()=>c,[c,e==null?void 0:e.vaultId]),{holdingAmountDisplay:se,holdCoinAValue:Q,holdCoinBValue:I,holdingVaultAmountDisplay:H}=Aa(c==null?void 0:c.displayAmountA,c==null?void 0:c.displayAmountB,c==null?void 0:c.displayCoinTypeA,c==null?void 0:c.displayCoinTypeB,c==null?void 0:c.displayVaultAmountA,c==null?void 0:c.displayVaultAmountB,e==null?void 0:e.category),Y=i.useMemo(()=>u[e==null?void 0:e.vaultId],[u,e==null?void 0:e.vaultId]),{farmClaimAction:le,isLoading:ie}=Gt(c==null?void 0:c.vaultId,Y,_),Z=i.useMemo(()=>_e((c==null?void 0:c.vaultBalance)||"0").lte(0),[c]),be=i.useMemo(()=>{const he=b&&(b==null?void 0:b.filter(N=>_e((N==null?void 0:N.rewardAmount)||"0").gt(0)))||[];return he&&he.length<=0},[b]),ue=i.useMemo(()=>_e((_==null?void 0:_.stakedBalance)||"0").lte(0),[n]);return i.useEffect(()=>{a!=null&&a.address||m()},[a==null?void 0:a.address]),{vaultFarmingApr:M,vaultFarmingAprDisplay:L,vaultFarmingLoading:$,farmingTvl:D,farmingTvlDisplay:B,stakeVaultFarmingTvl:ae,stakeVaultFarmingTvlLoading:S,vaultFarmingRewardAmountUSD:J,vaultFarmingRewardLoading:s,holdingAmountDisplay:se,holdCoinAValue:Q,holdCoinBValue:I,farmClaimAction:le,farmClaimLoading:ie,vaultsFarmingStakeLoading:x,vaultsFarmingStaked:_,currentVaultPositionLoading:w,currentVaultPositionInfo:pe,vaultsFarmingRewards:b,vaultsFarmingRewardsLoading:s,stakeButtonDisabled:Z,claimButtonDisabled:be,unStakeButtonDisabled:ue,holdingVaultAmountDisplay:H,vaultFarmingRewardAmount:P,currentVaultsFarm:l,currentVaultsFarmingStaked:_}}function os({rewardInfo:o}){var a,e;return console.log("🚀🚀🚀 ~ FarmingIncentives.tsx:18 ~ RewardItem ~ rewardInfo:",o),t.jsx(X,{borderRadius:"12px",children:t.jsxs(me,{p:"0",w:"100%",justifyContent:"space-between",children:[t.jsx(me,{children:t.jsx(Zt,{src:(a=o==null?void 0:o.coinDetail)==null?void 0:a.logo_url,w:"20px",h:"20px"})}),t.jsxs(me,{gap:"4px",children:[t.jsx(ee,{fontSize:"12px",color:"text_caption",children:o==null?void 0:o.rewardAmountDisplay}),t.jsx(ee,{fontSize:"12px",children:(e=o==null?void 0:o.coinDetail)==null?void 0:e.symbol})]})]})})}function ns(o){var d;const{setIsOpenPre:a,setIsOpenFarmingModal:e,setFarmingModalAction:l,apiVaultInfo:n}=o,[r,x]=i.useState(!1),{stakeVaultFarmingTvl:s,vaultFarmingRewardAmountUSD:m,farmClaimAction:_,vaultsFarmingStakeLoading:b,vaultsFarmingStaked:g,vaultsFarmingRewards:p,stakeButtonDisabled:c,claimButtonDisabled:w,unStakeButtonDisabled:u}=ss(n==null?void 0:n.vaultId);return t.jsxs(X,{border:"1px solid",borderColor:"border",gap:"12px",w:"100%",borderRadius:"8px",children:[t.jsxs(me,{w:"100%",p:"16px 12px",borderRadius:"7px",bg:"primary_opacity.10",justifyContent:"space-between",onClick:()=>x(!r),cursor:"pointer",children:[t.jsxs(me,{gap:"4px",cursor:"pointer",userSelect:"none",children:[t.jsx(ee,{color:"text_caption",userSelect:"none",children:"Farm Overview"}),t.jsx(Ga,{tooltipCon:"Powered by Haedal"})]}),t.jsx(aa,{fontSize:"12px",xlinkHref:"#icon-icon_arrow",transition:"transform 0.5s",transform:r?"rotate(180deg)":"rotate(0deg)"})]}),r&&t.jsxs(X,{w:"100%",padding:"0 12px 12px",gap:"8px",children:[t.jsx(X,{w:"100%",gap:"4px",children:t.jsx(Te,{isLoading:b&&!(g!=null&&g.stakedBalanceDisplay),label:"Your Staked",value:t.jsxs(X,{alignItems:"flex-end",children:[t.jsxs(ee,{fontSize:"14px",color:"text_caption",children:[g==null?void 0:g.stakedBalanceDisplay," LP"]}),t.jsx(ee,{fontSize:"12px",children:lt(s)})]}),skeletonStyle:{subValueH:"20px"},valueStyle:{color:"text_caption"}})}),t.jsx(X,{w:"100%",children:t.jsx(Te,{label:"Your Rewards",isLoading:b&&!p,rightValueTip:p==null?void 0:p.map(R=>t.jsx(X,{borderRadius:"12px",children:t.jsx(os,{rewardInfo:R})})),value:t.jsxs(me,{position:"relative",children:[t.jsx(ee,{color:"text_caption",children:lt(m)}),(d=g==null?void 0:g.rewardConfigs)==null?void 0:d.map(R=>{var L,B;return t.jsx(za,{imageUrl:(L=R==null?void 0:R.coinDetail)==null?void 0:L.logo_url,w:"20px",h:"20px",coinType:R==null?void 0:R.coin_type,showTag:!1},((B=R==null?void 0:R.coinDetail)==null?void 0:B.name)+"Icon")})]}),valueStyle:{textDecoration:"none"},wrapStyle:{mt:"4px"}})}),t.jsx(Fe,{w:"100%",mt:"12px",height:"32px",borderRadius:"8px",fontSize:"12px",isDisabled:c,onClick:()=>{a(!1),l("Stake"),e(!0)},children:"Stake"}),t.jsxs(me,{w:"100%",justifyContent:"space-between",children:[t.jsx(Fe,{w:"50%",height:"32px",variant:"outline",borderRadius:"8px",fontSize:"12px",bg:"none",isDisabled:u,onClick:()=>{a(!1),l("Unstake"),e(!0)},children:"Unstake"}),t.jsx(Fe,{w:"50%",height:"32px",variant:"outline",borderRadius:"8px",fontSize:"12px",bg:"none",onClick:_,isDisabled:w,children:"Claim"})]})]})]})}function ia(o){const{poolName:a,amountLimit:e,lpRate:l,inputTotalValue:n,preCalculateLoading:r,labelColor:x,lpDecimals:s,calculateLpLoading:m}=o;return t.jsxs(X,{w:"100%",gap:"16px",children:[t.jsx(Qa,{labelStyle:{color:"primary_gray"},totalAmount:n,loading:r}),t.jsx(Te,{label:"Share of Pool",labelStyle:{fontSize:"14px",color:x},value:l,isLoading:m,valueStyle:{fontSize:"14px",h:"14px"},skeletonStyle:{valueH:"14px"}}),t.jsx(Te,{label:"Est. Received LP",labelStyle:{fontSize:"14px",color:x},value:`${Ze(Ie(at(e||"0",s||9)).toString(),9)} ${a}`,valueStyle:{fontSize:"14px",h:"14px"},skeletonStyle:{valueH:"14px"},isLoading:m})]})}function ls(o){const{isOpen:a,onClose:e,data:l,onSubmitClick:n,calculateLpLoading:r}=o,{feeTier:x,displayTokenA:s,displayTokenB:m,displayAmountA:_,displayAmountB:b,totalAmountValue:g,sharePool:p,lpAmountLimit:c,lpDecimals:w,category:u,binStep:d}=l;return t.jsxs(Ot,{autoFocus:!1,returnFocusOnClose:!1,isOpen:a,onClose:e,isCentered:!0,children:[t.jsx(At,{}),t.jsxs(Lt,{children:[t.jsx(Mt,{children:t.jsx(xa,{fontWeight:"500",fontSize:"16px",children:"Deposit"})}),t.jsx(zt,{}),t.jsx(Wt,{textAlign:"center",p:"0px",children:t.jsxs(X,{w:"100%",gap:"20px",p:"16px",pb:"0px",pos:"relative",children:[t.jsxs(me,{w:"100%",justifyContent:"space-between",children:[t.jsxs(me,{children:[t.jsx(Wa,{coinAIconUrl:s==null?void 0:s.logo_url,coinBIconUrl:m==null?void 0:m.logo_url,imageStyle:{w:"40px",h:"40px"},imgBoxStyle:{w:"40px",h:"40px"}}),t.jsx(ee,{fontSize:"16px",color:"text_caption",children:`${s==null?void 0:s.symbol} - ${m==null?void 0:m.symbol}`})]}),t.jsx(qa,{poolType:u==="cetus-dlmm"?"dlmm":"clmm",binStep:Number(d),displayFee:x})]}),t.jsx(Ya,{coinA:{amount:_,...s},iconParams:{xlinkHref:"#icon-icon_add",svgFill:"text_caption"},coinB:{amount:b,...m}}),t.jsx(ia,{amountLimit:c,inputTotalValue:g,preCalculateLoading:!1,calculateLpLoading:r,lpRate:p,lpDecimals:w,poolName:`${s==null?void 0:s.symbol} - ${m==null?void 0:m.symbol}`}),t.jsx(Kt,{h:"52px"}),t.jsx(Fe,{pos:"absolute",bottom:"0px",mt:"4px",w:"100%",h:"52px",borderRadius:"12px",fontSize:"16px",fontWeight:"500",onClick:()=>{n()},children:"Deposit"})]})})]})]})}function is(o){const{getTokenAmountValueByPyth:a,getTokenPriceByPyth:e}=Et();if(o){const{hardCap:l,quoteCoinType:n,displayCoinTypeA:r,displayCoinTypeB:x,displayAmountA:s,displayAmountB:m,quoteCoin:_,baseCoin:b,baseCoinType:g}=o,p=a(n,l);if(!p)return{};const c=lt(p),w=a(r,s),u=a(x,m),d=_e(w).add(_e(u)).toString(),R=_e(d).div(_e(p)).mul(100).toString(),L=lt(R,"%"),B=e(n),M=e(g),D=_e(p).sub(_e(d)).gt(0)?_e(p).sub(_e(d)).toString():"0";let $,ae;return D!=="0"?($=_e(D).div(B||"0").toString(),ae=_e(D).div(M||"0").toString()):($="0",ae="0"),{hardCap:l,hardCapUSD:p,vaultTvl:d,displayHardCapUSD:c,depositRatio:R,displayDepositRatio:L,baseCoin:b,quoteCoin:_,availableCapacityWithQuoteCoin:$,availableCapacityWithBaseCoin:ae,availableCapacityUSD:D}}return{}}function rs(o,a){return{lpRate:i.useMemo(()=>o&&a?_e(a).eq(0)?"100%":`${Ea(_e(o).div(_e(o).add(a)).mul(100).toString(),2,6)}%`:"0%",[o,a])}}function ra(o,a,e=!1){return{amountLimit:i.useMemo(()=>{if(a)return _e(a).mul(e?1+o:1-o).toString()},[a,o,e])}}function ca(o){return{stakeProtocolName:i.useMemo(()=>{if(o){if(o.includes("HASUI"))return"Haedal";if(o.includes("AFSUI"))return"Aftermath";if(o.includes("CERT"))return"Volo"}},[o])}}function cs(o,a,e,l,n,r,x,s,m,_,b,g){const{balanceInfo:p}=Qt(e),{balanceInfo:c}=Qt(l),{amountInputA:w,amountInputB:u,setAmountInputA:d,setAmountInputB:R,setCalculateResult:L,calculateResult:B}=Be(),{getTokenAmountValueByPyth:M}=Et(),{getTokenAmountValue:D}=it(),{volatileVaultsSdk:$,haedalFarmSdk:ae}=bt(),S=Ut("vaults"),{vaultsSlippage:J}=nt(),{updateCurrentVaultById:P}=Nt(),{fetchAccountBalance:pe}=na(),[se,Q]=i.useState(!1),{currentAccount:I}=Le(),{pythPriceMap:H}=ea(),{mevProtect:Y,transactionMode:le,maxCapForGas:ie,customGasPrice:Z}=nt(),{getVaultsFarmingStaked:be}=Xt(),{vaultsFarmObj:ue,autoClaimStakeFarming:he}=Ae(),N=i.useMemo(()=>ue[o],[ue,o]),[re,xe]=i.useState(0),ve=i.useRef(0);i.useEffect(()=>{ve.current=re},[re]);const q=i.useMemo(()=>a=="cetus"?D(e==null?void 0:e.coin_type,w):x&&se&&r==(e==null?void 0:e.coin_type)?C(m||"0").mul(re).div(100).toString():M(e==null?void 0:e.coin_type,w),[e==null?void 0:e.coin_type,w,H,a,x,se,re]),Se=i.useMemo(()=>a=="cetus"?D(l==null?void 0:l.coin_type,u):x&&se&&r==(l==null?void 0:l.coin_type)?C(m||"0").mul(re).div(100).toString():M(l==null?void 0:l.coin_type,u),[e==null?void 0:e.coin_type,u,H,a,x,se,re]),A=i.useMemo(()=>n?l:e,[n,e,l]),W=i.useMemo(()=>n?e:l,[n,e,l]),[we,de]=i.useState(""),K=i.useRef("");i.useEffect(()=>{console.log("🚀🚀🚀 ~ useVaultsAdd.ts:122 ~ useVaultsAdd ~ uuid:",we),K.current=we},[we]);const[fe,Ve]=i.useState(!1),De=i.useRef(!1);i.useEffect(()=>{De.current=fe},[fe]);const[Me,Xe]=i.useState(!1),[qe,ze]=i.useState(!1),[ke,oe]=i.useState(!1),ce=i.useRef(""),ne=i.useRef("");i.useEffect(()=>{ce.current=w},[w]),i.useEffect(()=>{ne.current=u},[u]);const G=i.useMemo(()=>x?r=="both"?"FlexibleBoth":r==(A==null?void 0:A.coin_type)?"OnlyCoinA":"OnlyCoinB":(a=="cetus-dlmm","FixedOneSide"),[x,r,A,a]),We=(h,f,z=!1)=>{if(console.log("🚀🚀🚀 ~ useVaultsAdd.ts:141 ~ wrapRes ~ res:",h),h)if(a=="haedal"||a=="cetus-dlmm"){const O=C(h.deposit_amount_a).div(10**A.decimals).toString();console.log("🚀🚀🚀 ~ useVaultsAdd.ts:162 ~ wrapRes ~ amountA:",O);const k=C(h.deposit_amount_b).div(10**W.decimals).toString();z?((r=="both"||r==(e==null?void 0:e.coin_type))&&d(n?k:O),(r=="both"||r==(l==null?void 0:l.coin_type))&&R(n?O:k)):f?R(n?O:k):d(n?k:O)}else{const O=C(h.amount_a).div(10**A.decimals).toString(),k=C(h.amount_b).div(10**W.decimals).toString();f?R(n?O:k):d(n?k:O)}},Pe=async(h,f,z)=>{try{oe(!0);const O=(n?!f:f)?A:W,k=(n?!f:f)?W:A,F=Oe(h,O.decimals),ge=Oe(z||0,k.decimals),V=n?!f:f;Xe(V),a=="haedal"?rt(F,f,ge,V):a=="cetus-dlmm"?rt(F,f,ge,V,!0):Qe(F,f,V)}catch{}},[Ce,je]=i.useState(void 0),rt=async(h,f,z,O,k=!1)=>{const F=Ye();de(F),K.current=F;let ge={uuid:F,mode:"FixedOneSide",fixed_amount:"0",fixed_coin_a:O,pool_id:o};x?(G==="OnlyCoinA"&&(ge={uuid:F,mode:G,pool_id:o,coin_amount_a:h}),G==="OnlyCoinB"&&(ge={uuid:F,mode:G,pool_id:o,coin_amount_b:h}),G=="FlexibleBoth"&&(ge={uuid:F,mode:G,pool_id:o,coin_amount_a:O?h:z,coin_amount_b:O?z:h})):ge={uuid:F,mode:"FixedOneSide",fixed_amount:h,fixed_coin_a:O,pool_id:o};let V;if(console.log("🚀🚀🚀 ~ useVaultsAdd.ts:273 ~ haedalPreCalculate ~ isDlmm:",k),k)try{je(void 0),V=await $.VaultsV2.preCalculateDepositAmount(ge,{onSuccess:te=>{console.log("🚀🚀🚀 ~ useVaultsAdd.ts:274 ~ haedalPreCalculate ~ receive_lp_amount:",te,G,F,K.current),F==K.current&&(G=="FixedOneSide"||G=="OnlyCoinA"||G=="OnlyCoinB"?ce.current||ne.current:ce.current&&ne.current)?(te=="0"?L(void 0):L({amount_a:n?V.deposit_amount_b:V.deposit_amount_a,amount_b:n?V.deposit_amount_a:V.deposit_amount_b,ft_amount:te}),setTimeout(()=>{oe(!1)},500)):(oe(!1),L(void 0))},onError:(te,ye)=>{oe(!1)}})}catch(te){L(void 0),je(void 0),console.log("🚀🚀🚀 ~ useVaultsAdd.ts:302 ~ haedalPreCalculate ~ error:",te),String(te).includes("is less than 1")&&je("amountTooSmall")}else V=await $.Vaults.preCalculateDepositAmount(ge,{onSuccess:te=>{console.log("🚀🚀🚀 ~ useVaultsAdd.ts:301 ~ haedalPreCalculate ~ receive_lp_amount:",te),F==K.current&&(G=="FixedOneSide"||G=="OnlyCoinA"||G=="OnlyCoinB"?ce.current||ne.current:ce.current&&ne.current)?(L({amount_a:n?V.deposit_amount_b:V.deposit_amount_a,amount_b:n?V.deposit_amount_a:V.deposit_amount_b,ft_amount:te}),oe(!1)):(oe(!1),L(void 0))},onError:(te,ye)=>{console.log("🚀🚀🚀 ~ useVaultsAdd.ts:321 ~ haedalPreCalculate ~ error:",te),oe(!1)}});console.log("🚀🚀🚀 ~ useVaultsAdd.ts:279 ~ res:",V,G),console.log("🚀🚀🚀 ~ useVaultsAdd.ts:327 ~ haedalPreCalculate ~ uuidRef.current:",K==null?void 0:K.current,F,G),K.current===F&&(G=="FixedOneSide"&&F==K.current&&We(V,f),(G=="FixedOneSide"||G=="OnlyCoinA"||G=="OnlyCoinB"?ce.current||ne.current:ce.current&&ne.current)&&T(V))},Qe=async(h,f,z)=>{if(A&&W&&o){const O=Ye();de(O),K.current=O;try{oe(!0);const k={vault_id:o,fix_amount_a:z,input_amount:h,slippage:Number(J),request_id:O,side:r==="both"?pt.Both:pt.OneSide},F=await S.Vaults.calculateDepositAmount(k,!0,!0);console.log("🚀🚀🚀 ~ useVaultsAdd.ts:204 ~ lstPreCalculate ~ res:",F),K.current===O&&(x||We(F,f),L(F),oe(!1))}catch{L(void 0)}finally{oe(!1)}}},Ne=mt(Pe,500),ct=async(h,f,z)=>{if(f?d(h):R(h),m=="0"&&(a=="haedal"||a=="cetus-dlmm"))return;if(Ve(f),!h&&!z){Ee();return}if(r=="both"&&x&&(!+h||!+z)){oe(!1),L(void 0),xe(0);return}const O=a=="haedal"?M(f?e.coin_type:l.coin_type,h):D(f?e.coin_type:l.coin_type,h),k=a=="haedal"?M(f?l.coin_type:e.coin_type,z):D(f?l.coin_type:e.coin_type,z),F=C(O).add(C(k));if(x&&(F.gt(1e4)||F.gt(0)&&F.lt(1e-4))){xe(0);return}console.log("🚀🚀🚀 ~ useVaultsAdd.ts:436 ~ handleAmountInputChange ~ +amount:",+h),+h?Ne(h,f,z):!x&&(!h||+h==0)&&Dt(h)?Ee():(f?R(""):d(""),L(void 0))},Ee=()=>{d(""),R(""),xe(0),de(""),L(void 0),oe(!1)},Ue=i.useMemo(()=>C(q||"0").add(Se||"0").toString(),[q,Se]),gt=i.useMemo(()=>x?C(Ue).gt(C(1e4)):!1,[Ue,x]),St=i.useMemo(()=>x?C(Ue).gt(0)&&C(Ue).lt(C(1e-4)):!1,[Ue,x]),{stakeProtocolName:_t}=ca(Me?W==null?void 0:W.coin_type:A==null?void 0:A.coin_type),Ct=i.useMemo(()=>{if(a!="haedal"&&r!=="both"&&A&&W&&(+w||+u)){const h=Me?w:u,f=Me?A:W,z=Me?W:A;if(B&&B.swap_result){const O=Ge(B.swap_result.swap_in_amount,f.decimals),k=Ge(C(B.swap_result.swap_out_amount).mul(1-Number(J)).toString(),z.decimals);return Rt.isSuiCoin(f.coin_type)?`By depositing ${Ze(Ie(h,9).toString(),9)} SUI, ${Ze(Ie(O,9).toString(),9)} SUI will be converted to ${z==null?void 0:z.symbol} via ${_t} liquid staking and added to the pool together.`:`By depositing ${Ze(Ie(h,9).toString(),9)} ${f==null?void 0:f.symbol}, ${Ze(Ie(O,9).toString(),9)} ${f==null?void 0:f.symbol} will be traded for ${Ze(Ie(k,9).toString(),9)} ${z==null?void 0:z.symbol} and then added to the pool together.`}else if(!Rt.isSuiCoin(r)){const O=D(r,h);if(C(O).gt(1e4))return"Single-asset deposit can't be higher than $10,000 at a time."}}},[r,B,w,u,a]);i.useEffect(()=>{a!=="cetus-dlmm"&&je(void 0)},[a]);const{signAndExecuteTransaction:et,transactionConfirmation:wt,transactionRejected:jt}=Tt(),Je=()=>{if(console.log("🚀🚀🚀 ~ useVaultsAdd.ts:492 ~ reCalculateResult ~ availableCapacityUSD:",m,a),m=="0"&&a=="haedal"){d(""),R(""),xe(0),oe(!1),L(void 0);return}if(!(r=="both"&&(!+w||!+u)))if(se)E(ve.current,_,s,we);else{const h=De.current?ce.current:ne.current,f=fe?ne.current:ce.current;+h?Ne(h,fe,f):je(void 0)}};i.useEffect(()=>{B&&je(void 0)},[B]);const E=mt(async(h,f,z,O)=>{var F;console.log("🚀🚀🚀 ~ useVaultsAdd.ts:520 ~ preCalculateDepositValue ~ coin:",z);const k=(F=H[tt((z==null?void 0:z.coin_type)||(z==null?void 0:z.coinType),!1)])==null?void 0:F.price;if(A&&W&&o){const ge=C(f).mul(h).div(100).mul(k).toString();if(ge=="0"){L(void 0),d(""),R(""),xe(0),oe(!1);return}C(f).mul(h).div(100).toString(),oe(!0);const V={mode:G==="FixedOneSide"?"FlexibleBoth":G,pool_id:o,amount_usd:ge,uuid:O};console.log("🚀🚀🚀 ~ useVaultsAdd.ts:472 ~ preCalculateDepositValue ~ params:",JSON.stringify(V));let te;if(a=="cetus-dlmm"?te=await $.VaultsV2.preCalculateDepositValue(V,{onSuccess:(ye,$e)=>{$e==K.current&&(G=="FixedOneSide"||G=="OnlyCoinA"||G=="OnlyCoinB"?ce.current||ne.current:ce.current&&ne.current)?(L({amount_a:n?te.deposit_amount_b:te.deposit_amount_a,amount_b:n?te.deposit_amount_a:te.deposit_amount_b,ft_amount:ye}),oe(!1)):(oe(!1),L(void 0))},onError:(ye,$e)=>{console.log("🚀 ~ preCalculate ~ error:",ye)}}):te=await $.Vaults.preCalculateDepositValue(V,{onSuccess:(ye,$e)=>{$e==K.current&&(G=="FixedOneSide"||G=="OnlyCoinA"||G=="OnlyCoinB"?ce.current||ne.current:ce.current&&ne.current)?(L({amount_a:n?te.deposit_amount_b:te.deposit_amount_a,amount_b:n?te.deposit_amount_a:te.deposit_amount_b,ft_amount:ye}),oe(!1)):(oe(!1),L(void 0))},onError:(ye,$e)=>{console.log("🚀 ~ preCalculate ~ error:",ye)}}),O!==K.current)return;console.log("🚀🚀🚀 ~ useVaultsAdd.ts:492 ~ preCalculateDepositValue ~ res:",te),We(te,!0,!0)}},500),v=(h,f,z,O)=>{if(console.log("🚀🚀🚀 ~ useVaultsAdd.ts:536 ~ handlePercentInputChange ~ percent:",h),C(h).lte(0)){L(void 0),je(void 0),d(""),R(""),oe(!1);return}E(h,f,z,O)},T=async h=>{if(console.log("🚀🚀🚀 ~ useVaultsAdd.ts:503 ~ calculateDepositRatioWithAvailableCapacity ~ wrapRes:",h),A&&W){const f=at(h.deposit_amount_a,A==null?void 0:A.decimals),z=at(h.deposit_amount_b,W==null?void 0:W.decimals),O=M(A==null?void 0:A.coin_type,String(f)),k=M(W==null?void 0:W.coin_type,String(z)),F=C(O).add(C(k)).toString(),ge=C(F).div(C(m)).mul(100);if(console.log("🚀🚀🚀 ~ useVaultsAdd.ts:624 ~ calculateDepositRatioWithAvailableCapacity ~ availableCapacityUSD:",m),m=="0"){xe(0),d(""),R(""),L(void 0),oe(!1);return}if(ge.gt(100)){const V=Ye();de(V),K.current=V,xe(100),E(100,_,s,V)}else if(ce.current||ne.current){const V=Ie(ge.toString(),2);xe(Number(V))}}},j=async()=>{var h;if(o){let f;a=="haedal"||a=="cetus-dlmm"?f={pool_id:o,amount_a:String(n?Oe(u||0,String(A==null?void 0:A.decimals)):Oe(w||0,String(A==null?void 0:A.decimals))),amount_b:String(n?Oe(w||0,String(W==null?void 0:W.decimals)):Oe(u||0,String(W==null?void 0:W.decimals)))}:f={vault_id:o,slippage:Number(J),deposit_result:B},console.log("🚀🚀🚀 ~ useVaultsAdd.ts:261 ~ doAddAction ~ depositParams:",B);const z={getShowInfo:(O,k,F)=>{console.log("🚀🚀🚀 ~ useVaultsAdd.ts:306 ~ doAddAction ~ res:",F);const ge="Deposit "+[Re(w,n?W==null?void 0:W.symbol:A==null?void 0:A.symbol),Re(u,n?A==null?void 0:A.symbol:W==null?void 0:W.symbol)].filter(Boolean).join(" and "),V={modalDescriptionText:ge,toastTitleText:ge};if(O==="success"){let te=w,ye=u;F&&F.events.forEach(ut=>{(ut.type.indexOf("::pool::DepositEvent")>-1||ut.type.indexOf("::vault::DepositEvent")>-1)&&A&&W&&(te=String(at(ut.parsedJson.amount_a,A.decimals)),ye=String(at(ut.parsedJson.amount_b,W.decimals)))});const $e="Deposit "+[Re(n?ye:te,n?W==null?void 0:W.symbol:A==null?void 0:A.symbol),Re(n?te:ye,n?A==null?void 0:A.symbol:W==null?void 0:W.symbol)].filter(Boolean).join(" and ");V.toastDescriptionContent=$e,V.modalDescriptionText=$e,V.toastTitleText="Deposit successful"}return V}};wt(z),console.log("🚀🚀🚀 ~ useVaultsAdd.ts:662 ~ doAddAction ~ vaultsFarmingStaked:",{vaultsFarmingStaked:g,currentVaultsFarmsReward:b}),N!=null&&N.isVaultsFarming&&he&&(f.return_lp_coin=!0);try{const O=new st;if(O.setSender(I.address),a=="haedal"){const F=await $.Vaults.buildDepositPayload(f,O);N!=null&&N.isVaultsFarming&&he&&await ae.Farms.buildStakePayload({poolId:N==null?void 0:N.poolId,stakeCoinType:N==null?void 0:N.stakeCoinType,stakeObjectId:g==null?void 0:g.stakeObjectId,lpCoin:F,decimals:(h=N==null?void 0:N.coinDetail)==null?void 0:h.decimals},O)}else if(a=="cetus-dlmm"){const F=await $.VaultsV2.buildDepositPayload(f,O)}else console.log("🚀🚀🚀 ~ useVaultsAdd.ts:447 ~ doAddAction ~ vaultsSdk:",S,f),await S.Vaults.deposit(f,O);console.log("🚀 ~ doAddAction ~ depositParams11111:",f),await et(O,z,{useMev:Y,txAction:"signTransactionBlock",useFastMode:le==="Fast Mode",maxCapForGas:ie,customGasPrice:Z,msafeParams:{action:ot.AddVaultsPosition,txbParams:f}})?(Ee(),setTimeout(()=>{pe(),P(o)},2e3),N!=null&&N.isVaultsFarming&&(be({stakeCoinType:g.stakeCoinType,poolId:g.poolId},o),console.log("🚀🚀🚀 ~ useVaultsAdd.ts:714 ~ doAddAction ~ vaultsFarmingStaked:",g))):Je()}catch(O){console.log("🚀🚀🚀 ~ useVaultsAdd.ts:418 ~ doAddAction ~ error:",O),jt(z)}}},U=i.useMemo(()=>r==(s==null?void 0:s.coin_type)||r=="both",[r,s]);return i.useEffect(()=>()=>{K.current=""},[]),{balanceInfoA:p,balanceInfoB:c,amountValueA:q,amountValueB:Se,handleAmountInputChange:ct,amountInputA:w,amountInputB:u,setAmountInputA:d,setAmountInputB:R,resetInputAmount:Ee,preCalculateLoading:qe,isFixedDisplayTokenA:fe,zapNumGtError:gt,zapNumLtError:St,calculateLpLoading:ke,inputTotalValue:Ue,showOnlySideTips:Ct,doAddAction:j,reCalculateResult:Je,percentage:re,setPercentage:xe,isSlider:se,setIsSlider:Q,handlePercentInputChange:v,isQuoteCoin:U,setUuid:de,uuidRef:K,preCalcError:Ce}}function ua(o,a,e,l,n,r,x,s,m,_,b,g){const{currentAccount:p}=Le(),{calculateResult:c}=Be(),w=i.useMemo(()=>{const u={text:void 0,disabled:!1};if(!(p!=null&&p.address))return u.text="Connect Wallet",u.disabled=!1,u;if(!n||!r)return u.disabled=!0,u;if(x==="both"){if(!+o&&!+a||g&&(!+o||!+a))return u.text="Enter an amount",u.disabled=!0,u}else{if(x==(n==null?void 0:n.coin_type)&&!+o||x==(r==null?void 0:r.coin_type)&&!+a)return u.text="Enter an amount",u.disabled=!0,u;if(b=="cetus"&&s){const d=Rt.isSuiCoin(x);if(d&&x===(n==null?void 0:n.coin_type)&&C(o).lt(3)||d&&x===(r==null?void 0:r.coin_type)&&C(a).lt(3))return u.text="Minimum deposit 3 SUI",u.disabled=!0,u}}if(x=="both"){if(C(o||"0").gt(e||"0"))return u.disabled=!0,u.text=s?`Insufficient ${n==null?void 0:n.symbol} Balance`:"Invalid Amount",u;if(C(a||"0").gt(l||"0"))return u.disabled=!0,u.text=s?`Insufficient ${r==null?void 0:r.symbol} Balance`:"Invalid Amount",u}if(x!=="both"){if(C(o||"0").gt(e||"0"))return u.disabled=!0,u.text=s?`Insufficient ${n==null?void 0:n.symbol} Balance`:"Invalid Amount",u;if(C(a||"0").gt(l||"0"))return u.disabled=!0,u.text=s?`Insufficient ${r==null?void 0:r.symbol} Balance`:"Invalid Amount",u}return s&&m||s&&_?(u.text="Enter an amount",u.disabled=!0,u):((c&&c.ft_amount=="0"||c&&c.burn_ft_amount=="0"||!c)&&(u.disabled=!0,u.text="Enter an amount"),u)},[o,a,e,l,n,r,x,m,_,b,p==null?void 0:p.address,c]);return{btnText:w.text,btnDisabled:w.disabled}}const us=(o,a)=>({isCheckedAcceptWalletObj:{},setIsCheckedAcceptWalletObj:e=>o(()=>({isCheckedAcceptWalletObj:{...a().isCheckedAcceptWalletObj,...e}})),isCheckedDontRemindWalletObj:{},setIsCheckedDontRemindWalletObj:e=>o(()=>({isCheckedDontRemindWalletObj:{...a().isCheckedDontRemindWalletObj,...e}}))}),da=ta(Ua(us,{name:"useVaultsRiskStore",partialize:o=>{const{isCheckedAcceptWalletObj:a,isCheckedDontRemindWalletObj:e}=o;return{isCheckedAcceptWalletObj:a,isCheckedDontRemindWalletObj:e}}})),ds={customDeposit:"Through Zap-In, you can deposit your liquidity in single token or with customized token ratio. Tokens will be auto converted to match the required ratio. ",deposit:"Through Zap-In, you can deposit your liquidity in single token. Tokens will be auto converted to match the required ratio.",withdraw:"Through Zap-Out, you can withdraw your liquidity in one token. The liquidity will be auto converted to one token you selected."};function ms(o){const{isCheckedZAP:a,zapText:e,tooltipType:l,zapSwitchChange:n}=o,{isApp:r}=$t();return t.jsx(Ke,{bg:"none",border:"none",padding:"6px 0px",borderRadius:"8px",width:"unset",children:t.jsxs(ba,{isLazy:!0,trigger:r?"click":"hover",placement:"top",autoFocus:!1,returnFocusOnClose:!1,children:[t.jsx(ha,{children:t.jsxs(me,{h:"14px",cursor:"pointer",as:"button",children:[t.jsx(ee,{fontSize:"14px",color:a?"primary":"",fontWeight:"500",children:e}),t.jsx(It,{isChecked:a,onChange:()=>n(!a)})]})}),t.jsx(ga,{minW:"fit-content",w:"fit-content",children:t.jsx(Sa,{p:"12px",lineHeight:"20px",fontSize:"12px",maxWidth:"320px",children:ds[l]})})]})})}const ps="You can also choose to deposit in only one asset type. In that case, the vault will convert your asset to the required propositions using Cetus. Please note that trading fees & slippage will be applied. When slippage is involved, a certain amount of post-swap dust (no loss of funds) will be returned to you.",fs=(o,a)=>`When you deposit in only SUI tokens, a part of your SUI amount will be converted to ${a} via ${o} liquid staking services to match required liquidity compositions of the liquidity pool on Cetus. A certain amount of dust (no loss of funds) will be returned to you if slippage is involved.`,He={Deposit:"Deposit"};function ma(o){const{displayTokenA:a,displayTokenB:e,onSelectAssetTab:l,label:n="Deposit Amounts",isCheckedZAP:r,setIsCheckedZAP:x,assetAction:s,setAssetAction:m,category:_,currentActionTab:b}=o,{stakeProtocolName:g}=ca(a==null?void 0:a.coin_type),p=i.useMemo(()=>_==="haedal"||_==="cetus-dlmm",[_]),c=()=>{if(!a||!e)return[];const R=[{label:`${a.symbol} only`,action:a.coin_type,afterIcon:r&&b===He.Deposit&&!p?{xlinkHref:"#icon-icon_tips"}:void 0,tooltip:p?b===He.Deposit?`You can add liquidity in this pool with only ${a.symbol}.`:"":ps},{label:`${e.symbol} only`,action:e.coin_type,afterIcon:r&&b===He.Deposit&&!p?{xlinkHref:"#icon-icon_tips"}:void 0,tooltip:p?b===He.Deposit?`You can add liquidity in this pool with only ${e.symbol}.`:"":fs(g,a==null?void 0:a.symbol)}];return p&&b===He.Deposit&&R.splice(1,0,{label:`${a.symbol}+${e.symbol}`,action:"both",tooltip:"You can add any value you want from both assets."}),R},w=i.useMemo(c,[a,e,r,g,p,b]),u=i.useMemo(()=>{var R,L,B;if(w.length!==0)return s===(a==null?void 0:a.coin_type)?w[0].label:s===(e==null?void 0:e.coin_type)?p&&b===He.Deposit?(R=w[2])==null?void 0:R.label:(L=w[1])==null?void 0:L.label:(B=w[1])==null?void 0:B.label},[s,w,p,b,a==null?void 0:a.coin_type,e==null?void 0:e.coin_type]),d=i.useMemo(()=>b===He.Deposit?p?"customDeposit":"deposit":"withdraw",[b,p]);return t.jsxs(X,{w:"100%",gap:"16px",children:[t.jsxs(me,{w:"100%",justifyContent:"space-between",children:[t.jsx(ee,{fontWeight:"500",children:n}),t.jsx(ms,{isCheckedZAP:r,zapText:b===He.Deposit?"Zap In":"Zap Out",tooltipType:d,zapSwitchChange:R=>{x(!r),m(R?(a==null?void 0:a.coin_type)??"":"both")}})]}),r&&w.length>0&&t.jsx(ht,{wrapStyle:{w:"100%",h:"48px",borderRadius:"12px",p:"3px"},itemStyle:{w:"50%",fontSize:"14px",borderRadius:"8px",fontWeight:"500"},type:"outlineTab",currentTab:u,tabList:w,handleChangeTab:R=>{m(R.action),l(R.action)}})]})}const dt=({children:o})=>t.jsx(ee,{lineHeight:"20px",color:"text_caption",fontSize:"12px",position:"relative",pl:"10px",_before:{content:'""',display:"inline-block",w:"4px",h:"4px",borderRadius:"50%",bg:"primary",position:"absolute",left:"0",top:"8px"},children:o});function xs(o){const{isOpen:a,setIsOpen:e,continueFunc:l}=o,[n,r]=i.useState(!1),[x,s]=i.useState(!1),{setIsCheckedAcceptWalletObj:m,setIsCheckedDontRemindWalletObj:_}=da(),{currentAccount:b}=Le(),g=()=>{const c={[b==null?void 0:b.address]:n};m(c);const w={[b==null?void 0:b.address]:x};_(w),l()},{isApp:p}=$t();return t.jsxs(Ot,{isCentered:!0,isOpen:a,onClose:()=>{e(!1)},children:[t.jsx(At,{}),t.jsxs(Lt,{width:{base:"100%",lg:"480px"},children:[t.jsx(Mt,{children:t.jsx(ee,{fontSize:p?"14px":"16px",fontWeight:"500",color:"caption",lineHeight:p?"20px":"40px",children:"Risk Acknowledgement"})}),t.jsx(zt,{m:p?"":"12px 2px 0 0"}),t.jsxs(Wt,{p:"0 16px",children:[t.jsxs(X,{bg:"menu_item_bg",borderRadius:"8px",border:"1px solid",borderColor:"border",p:"16px 12px",gap:p?"12px":"16px",children:[t.jsx(ee,{w:"100%",textAlign:"left",fontSize:"12px",children:"Before you provide liquidity via this vault:"}),t.jsxs(X,{gap:p?"12px":"16px",children:[t.jsx(dt,{children:"You acknowledge that this vault strategy is provided by a third party. Cetus integrates it at the UI level for user convenience but does not operate this product or take responsibility for third-party risks."}),t.jsx(dt,{children:"You acknowledge that the displayed APR and APY are based on historical data and not a guaranteed return."}),t.jsx(dt,{children:"You understand that APR and APY figures reflect past trading fees and rewards only, excluding impermanent loss and price volatility."}),t.jsx(dt,{children:"You recognize the risks associated with automated liquidity strategies, including market fluctuations and third-party operational risks."}),t.jsx(ee,{fontSize:"12px",color:"text_paragraph",lineHeight:"20px",children:"Please assess these risks carefully and proceed only if you fully understand and accept them."})]})]}),t.jsxs(X,{bg:"menu_item_bg",borderRadius:"8px",border:"1px solid",borderColor:"border",p:p?"12px 16px":"16px",justifyContent:"flex-start",alignItems:"flex-start",m:"16px 0",userSelect:"none",gap:p?"8px":"12px",children:[t.jsxs(me,{children:[t.jsx(Jt,{checked:n,onClick:()=>r(!n)}),t.jsx(ee,{fontWeight:"500",color:"text_caption",children:"I acknowledge and accept all the risks."})]}),t.jsxs(me,{children:[t.jsx(Jt,{checked:x,onClick:()=>s(!x)}),t.jsx(ee,{fontSize:"12px",color:"text_paragraph",children:"Don't remind me again."})]})]}),t.jsx(Fe,{w:"calc(100% + 32px)",h:"52px",bg:"primary",borderRadius:"12px",fontWeight:"600",ml:"-16px",isDisabled:!n,onClick:g,children:"Continue"})]})]})]})}function bs({percentage:o,onChange:a,quoteCoin:e,availableCapacityWithQuoteCoin:l,availableCapacityUSD:n}){const r=i.useMemo(()=>!n,[n]),x={fontSize:"sm",position:"absolute",ml:"-5px",top:"50%",transform:"translateY(-50%)",zIndex:"100",borderRadius:"50%"},s=[0,25,50,75,100];return t.jsx(t.Fragment,{children:r?t.jsxs(X,{width:"100%",maxHeight:"164px",justifyContent:"space-between",children:[t.jsx(yt,{width:"100%"}),t.jsx(yt,{width:"100%"}),t.jsx(yt,{width:"100%"})]}):t.jsxs(X,{width:"100%",alignItems:"start",gap:"0px",children:[t.jsx(ee,{textAlign:"left",children:"Available Capacity"}),t.jsxs(me,{w:"100%",alignItems:"center",justifyContent:"space-between",mt:"12px",children:[t.jsx(Fa,{tooltip:t.jsxs(me,{children:[t.jsx(Zt,{src:e==null?void 0:e.logo_url,w:"20px",h:"20px"},e==null?void 0:e.coin_type),t.jsx(ee,{color:"text_caption",children:Ie(l,2)}),t.jsx(ee,{color:"text_caption",children:e==null?void 0:e.symbol})]}),children:t.jsx(me,{w:"100%",alignItems:"center",justifyContent:"space-between",children:t.jsx(ee,{color:"text_caption",height:"14px",textAlign:"left",fontSize:"16px",textDecoration:"underline dotted",children:lt(n,"$")})})}),t.jsxs(_a,{"aria-label":"slider-ex-6",min:0,max:100,focusThumbOnChange:!1,value:o=="--"?0:Number(o),onChange:m=>a(m),w:{base:"165px",lg:"210px"},isDisabled:Number(n)<=0,children:[s.filter(m=>m!==Number(o)).map((m,_)=>t.jsx(Yt,{...x,value:m,w:"8px",h:"8px",bg:Number(o)>=m?"primary":"#384651",onClick:()=>a(m)},_)),t.jsx(Yt,{value:Number(o),textAlign:"center",bg:"primary_opacity.10",p:"2px 4px",borderRadius:"4px",fontSize:"12px",color:"primary",mt:"-28px",ml:"-15px",children:Ba(o,2)}),t.jsx(Ca,{bg:"#384651",height:"2px",borderRadius:"4px",children:t.jsx(wa,{height:"2px",bg:"primary",borderRadius:"2px"})}),t.jsx(ja,{p:"1px",w:"10px",h:"10px",border:"1px solid primary",position:"relative",zIndex:"100",borderRadius:"50%",_before:{content:'""',w:"6px",h:"6px",borderRadius:"50%",border:"1px solid #2b2e32"}})]})]}),!r&&n==0?t.jsx(X,{w:"100%",alignItems:"start",mt:"16px",children:t.jsx(ee,{color:"primary_yellow",fontSize:"12px",textAlign:"left",w:"100%",bg:"primary_yellow_opacity.10",p:"12px",borderRadius:"8px",lineHeight:"20px",children:"The vault has reached its current capacity. New deposits are not accepted at this time."})}):null]})})}function hs(o){const{currentAccount:a,onWalletModal:e}=Le(),{assetAction:l,setAssetAction:n,isCheckedZAP:r,setIsCheckedZAP:x}=Be(),{category:s,isReverse:m,vaultId:_,currentActionTab:b,totalSupply:g,lpTokenInfo:p,feeTier:c,isModal:w,isAutoRefresh:u,currentVaultsFarm:d,vaultsFarmingStaked:R,binStep:L}=o,{fromToken:B,toToken:M,calculateResult:D}=Be(),{vaultsPoolObj:$}=kt(),ae=i.useMemo(()=>$[_],[$,_]);console.log("🚀🚀🚀 ~ VaultsAdd.tsx:63 ~ VaultsAdd ~ currentVaultPool:",ae);const S=is(ae);console.log("🚀🚀🚀 ~ VaultsAdd.tsx:65 ~ VaultsAdd ~ avaiableCapacityInfo:",S);const{balanceInfoA:J,balanceInfoB:P,amountValueA:pe,amountValueB:se,handleAmountInputChange:Q,amountInputA:I,amountInputB:H,resetInputAmount:Y,preCalculateLoading:le,zapNumGtError:ie,zapNumLtError:Z,calculateLpLoading:be,inputTotalValue:ue,showOnlySideTips:he,doAddAction:N,reCalculateResult:re,percentage:xe,setPercentage:ve,setIsSlider:q,preCalcError:Se,handlePercentInputChange:A,isQuoteCoin:W,setUuid:we,uuidRef:de}=cs(_,s,B,M,m,l,r,S==null?void 0:S.quoteCoin,S==null?void 0:S.availableCapacityUSD,S==null?void 0:S.availableCapacityWithQuoteCoin,d,R);i.useEffect(()=>{Y()},[r,l,_]);const[K,fe]=i.useState(!1),{isApp:Ve}=$t(),{btnText:De,btnDisabled:Me}=ua(I,H,(J==null?void 0:J.balanceFormat)||"",(P==null?void 0:P.balanceFormat)||"",B,M,l,!0,ie,Z,s,r),{vaultsSlippage:Xe}=nt(),{lpRate:qe}=rs(D==null?void 0:D.ft_amount,g),{amountLimit:ze}=ra(Number(Xe),D==null?void 0:D.ft_amount,!1),ke=()=>(console.log("🚀🚀🚀 ~ VaultsAdd.tsx:140 ~ getSecondModelData ~ currentVaultPool:",L),{feeTier:c||"",displayTokenA:B,displayTokenB:M,displayAmountA:I,displayAmountB:H,totalAmountValue:ue,sharePool:qe,lpAmountLimit:ze||"0",lpDecimals:p==null?void 0:p.decimals,category:s,binStep:L}),{pythPriceMap:oe}=ea(),ce=i.useRef(!1);i.useEffect(()=>{ce.current=!0},[]),i.useEffect(()=>{ce.current&&re(),ce.current=!0},[oe]),i.useEffect(()=>{ce.current&&re()},[u]);const{isCheckedDontRemindWalletObj:ne}=da(),[G,We]=i.useState(!1),Pe=i.useMemo(()=>!ne[a==null?void 0:a.address],[ne,a==null?void 0:a.address]);return i.useEffect(()=>()=>{de.current=""},[]),t.jsxs(X,{gap:w?"8px":"12px",w:"100%",align:"flex-start",children:[t.jsxs(Ke,{bg:w?"transparent":"none",border:"none",borderRadius:"12px",p:{base:"0px 0px 8px",lg:w?"0":"0px"},w:"100%",children:[t.jsx(ma,{displayTokenA:B,displayTokenB:M,onSelectAssetTab:Ce=>{n(Ce)},setIsCheckedZAP:()=>x(!r),setAssetAction:n,assetAction:l,isCheckedZAP:r,category:s,currentActionTab:b,handleRefreshClick:()=>{console.log("🚀🚀🚀 ~ vaultsAdd.tsx:174 ~ VaultsAdd ~ handleRefreshClick:"),re()}}),t.jsx(X,{mt:w?"8px":"12px",position:"relative",children:t.jsx(Ht,{from:{wrapStyle:{h:"unset",p:{base:"20px 8px",lg:"20px 16px"}},hideSelf:l!=="both"&&l!==(B==null?void 0:B.coin_type),balance:(J==null?void 0:J.balanceFormat)||"",value:I,amountValue:I&&pe,loading:!1,onChange:Ce=>{s=="haedal"&&q(!1),Q(Ce,!0,H)},selectable:!1,placeholder:"0.0",token:B},to:{wrapStyle:{h:"unset",p:{base:"20px 8px",lg:"20px 16px"}},hideSelf:l!=="both"&&l!==(M==null?void 0:M.coin_type),balance:(P==null?void 0:P.balanceFormat)||"",value:H,amountValue:H&&se,loading:!1,onChange:Ce=>{s=="haedal"&&q(!1),Q(Ce,!1,I)},selectable:!1,placeholder:"0.0",token:M},iconParams:{xlinkHref:"#icon-icon_add",svgFill:"text_caption",iconCursor:"default"},iconHover:!1})})]}),s=="haedal"||s=="cetus-dlmm"&&Ft(oe)&&t.jsx(Ke,{bg:"primary_opacity.10",border:"none",borderRadius:"16px",p:"16px",children:t.jsx(bs,{depositRatio:S.depositRatio||"",percentage:xe,hardCapUSD:S.hardCapUSD||"",vaultTvl:S.vaultTvl||"",availableCapacityUSD:S.availableCapacityUSD||"",quoteCoin:S.quoteCoin,maxCapNum:S.hardCap||"",availableCapacityWithQuoteCoin:S.availableCapacityWithQuoteCoin||"",onChange:Ce=>{q(!0),ve(Ce);const je=Ye();we(je),A(Ce,W?S==null?void 0:S.availableCapacityWithQuoteCoin:S==null?void 0:S.availableCapacityWithBaseCoin,W?S.quoteCoin:S.baseCoin,je)}})},_),t.jsxs(X,{w:"100%",gap:"16px",children:[t.jsx(Fe,{m:"-1px",isLoading:be||K,w:"100%",borderRadius:"12px",h:"52px",fontSize:"18px",fontWeight:"500",isDisabled:Me||K||be,onClick:()=>{a?Pe&&s=="haedal"?We(!0):fe(!0):e(!0)},children:De||(r?"Zap In":"Deposit")}),Se&&!le&&s=="cetus-dlmm"&&t.jsx(Ja,{tips:"Amount too small to allocate across bins. Please increase the amount.",type:"warning"}),ie&&(I||H)&&t.jsx(X,{w:"100%",alignItems:"start",gap:"20px",children:t.jsx(ee,{color:"primary_yellow",fontSize:"12px",textAlign:"left",w:"100%",bg:"primary_yellow_opacity.10",p:"12px",borderRadius:"8px",lineHeight:"20px",children:"Single-asset deposit can't be higher than $10,000 at a time."})}),Z&&(I||H)&&t.jsx(X,{w:"100%",alignItems:"start",children:t.jsx(ee,{color:"primary_red",fontSize:"12px",textAlign:"left",w:"100%",bg:"primary_red_opacity.10",p:"12px",borderRadius:"8px",lineHeight:"20px",children:"The input is too small. Zap mode is not available."})}),(D||he)&&(I||H)&&t.jsxs(X,{w:"100%",alignItems:"start",gap:"0",mb:w?"12px":"0px",children:[l!=="both"&&he&&t.jsx(ee,{color:"text_paragraph",fontSize:"12px",lineHeight:"1.8",pb:D?"20px":"0",children:he}),D&&t.jsx(ia,{amountLimit:ze,inputTotalValue:ue,preCalculateLoading:le,calculateLpLoading:be,lpRate:qe,lpDecimals:p==null?void 0:p.decimals,poolName:`${B==null?void 0:B.symbol} - ${M==null?void 0:M.symbol}`,labelColor:"primary_gray"})]})]}),G&&t.jsx(xs,{isOpen:G,setIsOpen:We,continueFunc:()=>{We(!1),fe(!0)}}),K&&t.jsx(ls,{data:ke(),isOpen:K,calculateLpLoading:be,onClose:()=>{fe(!1)},onSubmitClick:()=>{fe(!1),N()}})]})}function gs(o,a,e,l,n,r,x,s,m){const{autoClaimFarmingReward:_}=Ae(),{currentVaultsFarm:b}=ft(o),{amountInputA:g,amountInputB:p,calculateResult:c,setAmountInputA:w,setAmountInputB:u,setCalculateResult:d}=Be(),{findBestRouters:R}=Ka(),{vaultsSlippage:L,mevProtect:B,maxCapForGas:M,transactionMode:D,customGasPrice:$}=nt(),{getTokenAmountValue:ae}=it(),{volatileVaultsSdk:S,haedalFarmSdk:J}=bt(),P=Ut("vaults"),{getTokenAmountValueByPyth:pe}=Et(),[se,Q]=i.useState(!1),[I,H]=i.useState(!1),{fetchAccountBalance:Y}=na(),{updateCurrentVaultById:le}=Nt(),{providers:ie}=$a(),Z=i.useRef(I);i.useEffect(()=>{Z.current=I},[I]);const[be,ue]=i.useState(!1),[he,N]=i.useState(""),re=i.useRef(he);i.useEffect(()=>{re.current=he},[he]);const xe=i.useRef(g),ve=i.useRef(p);i.useEffect(()=>{xe.current=g},[g]),i.useEffect(()=>{ve.current=p},[p]);const q=i.useMemo(()=>n?l:e,[n,e,l]),Se=i.useMemo(()=>n?e:l,[n,e,l]),A=a=="haedal"?pe(e==null?void 0:e.coin_type,g||"0"):ae(e==null?void 0:e.coin_type,g||"0"),W=a=="haedal"?pe(l==null?void 0:l.coin_type,p||"0"):ae(l==null?void 0:l.coin_type,p||"0"),[we,de]=i.useState(n?s==null?void 0:s.amountB:s==null?void 0:s.amountA),[K,fe]=i.useState(n?s==null?void 0:s.amountA:s==null?void 0:s.amountB),[Ve,De]=i.useState(!1),Me=async()=>{const{amountA:y,amountB:E}=s;if(De(!1),r==="both"){de(n?E:y),fe(n?y:E);return}const v=r===(q==null?void 0:q.coin_type),T=v?E:y,j=v?y:E;a=="haedal"||a==="cetus-dlmm"?Xe(T,j,v):qe(T,j,v)},Xe=async(y,E,v)=>{if(C(y).gt(0)){De(!0);const T={pool_id:o,mode:Ee,burn_lp_amount:s==null?void 0:s.balance,available_lp_amount:s==null?void 0:s.balance};try{const j=a==="cetus-dlmm"?await S.VaultsV2.preCalculateWithdrawAmount(T):await S.Vaults.preCalculateWithdrawAmount(T);if(console.log("🚀🚀🚀 ~ useVaultsRemove.ts:127 ~ haedalCalculateAvailableAmount ~ res:",j),Ee=="OnlyCoinA"){const U=Ge(j.receive_amount_a,q==null?void 0:q.decimals);n?fe(U):de(U)}else{const U=Ge(j.receive_amount_b,Se==null?void 0:Se.decimals);n?de(U):fe(U)}De(!1)}catch(j){console.log("🚀🚀🚀 ~ useVaultsRemove.ts:145 ~ calculateAvailableAmount ~ error:",j)}}else v?de(E):fe(E);De(!1)},qe=async(y,E,v)=>{if(C(y).gt(0)){De(!0);const T=v?Se:q;R({fromToken:T,toToken:v?q:Se,amount:Oe(y,T.decimals).toString(),providersKeys:ie,by_amount_in:!0,uuid:Ye()}).then(U=>{U.toAmountUi&&(E=C(E).add(U.toAmountUi).toString()),v?de(E):fe(E)}).finally(()=>{De(!1)})}else v?de(E):fe(E)},ze=i.useMemo(()=>C(A||"0").add(W||"0").toString(),[A,W]),ke=i.useMemo(()=>x?C(ze).gt(C(1e4)):!1,[ze,x]),oe=i.useMemo(()=>x?C(ze).gt(0)&&C(ze).lt(C(1e-4)):!1,[ze,x]),[ce,ne]=i.useState(0),G=()=>{w(""),u(""),ne(0),Q(!1),d(void 0),N("")},We=(y,E,v,T)=>{var j;if(console.log("🚀🚀🚀 ~ useVaultsRemove.ts:96 ~ wrapRes ~ res:",y,v,T),y){const U=C(a=="haedal"||a=="cetus-dlmm"?y.receive_amount_a:y.amount_a).div(10**q.decimals).toString(),h=C(a=="haedal"||a=="cetus-dlmm"?y.receive_amount_b:y.amount_b).div(10**Se.decimals).toString(),f=C(((j=y.swap_result)==null?void 0:j.swap_out_amount)||"0").div(10**(E?e.decimals:l.decimals)).toString();if(console.log("🚀🚀🚀 ~ useVaultsRemove.ts:239 ~ wrapRes ~ swapOutAmount:",f,U,h),v)if(r=="both")w(n?h:U),u(n?U:h);else if(r==(e==null?void 0:e.coin_type)){const z=C(we).mul(T).div(100).toString();console.log("🚀🚀🚀 ~ useVaultsRemove.ts:264 ~ wrapRes ~ amount:",z),w(z)}else{const z=C(K).mul(T).div(100).toString();u(z)}else{if(r!=="both")return;E?u(n?U:h):w(n?h:U)}}},Pe=async(y,E,v,T,j)=>{if(q&&Se&&o){if(!j){if(v){if(C(y).gt(we)){N(""),u(""),ne(0),d(void 0),Q(!1);return}}else if(C(y).gt(K)){N(""),w(""),d(void 0),Q(!1),ne(0);return}}(+xe.current||+ve.current||j)&&Q(!0);const U=(n?!v:v)?q:Se,h=Oe(y,U.decimals),f=v?Oe(we,U.decimals):Oe(K,U.decimals),z=n?!v:v,O=C(h).div(C(f)),k=vt(O.mul(s==null?void 0:s.balance).toString(),0,!0),F=Number(vt(O.mul(100).toString(),2));console.log("🚀🚀🚀 ~ useVaultsRemove.ts:324 ~ preCalculate ~ fixedCoinA:",z),H(z),a==="haedal"?Ce(k,v,T,F,!1):a=="cetus-dlmm"?Ce(k,v,T,F,!1,!0):je(k,v,z,T,F,!1)}},Ce=async(y,E,v,T,j,U=!1)=>{let h;if(r=="both")h={pool_id:o,mode:"FixedOneSide",burn_lp_amount:String(y)};else{const f=r==(q==null?void 0:q.coin_type)?"OnlyCoinA":"OnlyCoinB";h={pool_id:o,mode:f,burn_lp_amount:String(y)}}try{let f;if(U?f=await S.VaultsV2.preCalculateWithdrawAmount(h):f=await S.Vaults.preCalculateWithdrawAmount(h),console.log("🚀🚀🚀 ~ useVaultsRemove.ts:386 ~ haedalPreCalculate ~ res:",f,v,re.current),f.burn_lp_amount=="0"){Q(!1),d(void 0);return}if(re.current!==v)return;We(f,E,j,T),d({...f,burn_ft_amount:f.burn_lp_amount}),ne(T)}catch(f){console.log("🚀🚀🚀 ~ useVaultsRemove.ts:388 ~ haedalPreCalculate ~ error:",f),d(void 0)}finally{Q(!1)}},je=async(y,E,v,T,j,U)=>{const h={vault_id:o,fix_amount_a:v,input_amount:y,slippage:Number(L),request_id:T,side:r==="both"?pt.Both:pt.OneSide,is_ft_input:!0,max_ft_amount:s==null?void 0:s.balance};console.log("🚀🚀🚀 ~ useVaultsRemove.ts:275 ~ lstPreCalculate ~ params:",h);try{const f=await P.Vaults.calculateWithdrawAmount(h);if(console.log("🚀🚀🚀 ~ useVaultsRemove.ts:386 ~ res:",f,j),console.log("🚀🚀🚀 ~ useVaultsRemove.ts:215 ~ haedalPreCalculate ~ uuidRef.current:",re.current,T),f.burn_ft_amount=="0"){Q(!1),d(void 0);return}if(re.current!==T)return;We(f,E,U,j),d(f),ne(j)}catch{d(void 0)}finally{Q(!1)}},rt=mt(Pe,500),Qe=mt(a=="cetus"?je:Ce,500),Ne=(y,E)=>{if(y==0){G();return}console.log("🚀🚀🚀 ~ useVaultsRemove.ts:218 ~ handlePercentInputChange ~ value:",y,a),ue(!0),Q(!0),ne(y);const v=Ye();console.log("🚀🚀🚀 ~ useVaultsRemove.ts:225 ~ handlePercentInputChange ~ uuid:",v),N(v);const T=vt(C(s==null?void 0:s.balance).mul(y/100).toString(),0,!0);console.log("🚀🚀🚀 ~ useVaultsRemove.ts:459 ~ handlePercentInputChange ~ removeLpAmount:",T,s==null?void 0:s.balance);const j=n?!E:E;H(j),a==="haedal"?Qe(T,E,v,y,!0):a=="cetus-dlmm"?Qe(T,E,v,y,!0,!0):Qe(T,E,j,v,y,!0)},ct=(y,E,v,T)=>{if((T||v)&&r!=="both"&&(E?w(y):u(y)),v){Ne(100,E);return}if(T){Ne(50,E);return}if(ue(!1),E?w(y):u(y),+y){const j=Ye();N(j),console.log("🚀🚀🚀 ~ useVaultsRemove.ts:515 ~ handleAmountInputChange ~ amount:",y),rt(y,!1,E,j)}else console.log("🚀🚀🚀 ~ useVaultsRemove.ts:516 ~ handleAmountInputChange ~ amount:",y,!y&&Dt(y)),!y&&Dt(y)?G():(console.log("🚀🚀🚀 ~ useVaultsRemove.ts:522 ~ handleAmountInputChange ~ isFixedDisplayTokenA:",E),E?u(""):w(""),ne(0),d(void 0),N(""))},Ee=i.useMemo(()=>x?r=="both"?"FixedOneSide":r==(q==null?void 0:q.coin_type)?"OnlyCoinA":"OnlyCoinB":"FixedOneSide",[x,r,q]),Ue=()=>{const y=n?!Z.current:Z.current;if(be)Ne(ce,y);else{const E=Z.current?n?ve.current:xe.current:n?xe.current:ve.current;ct(E,y)}},{signAndExecuteTransaction:gt,transactionConfirmation:St,transactionRejected:_t}=Tt(),[Ct,et]=i.useState(!1),wt=async()=>{var y,E;if(o&&c&&(s!=null&&s.balance)){et(!0);let v;if(a=="haedal"||a==="cetus-dlmm")v={pool_id:o,burn_lp_amount:ce==100?s==null?void 0:s.balance:c.burn_ft_amount,mode:Ee,slippage:Number(L)};else if(r==="both")v={vault_id:o,ft_amount:c==null?void 0:c.burn_ft_amount,slippage:Number(L)};else{const j=r===(q==null?void 0:q.coin_type);if(ce===100)v={vault_id:o,is_ft_input:!0,input_amount:s==null?void 0:s.balance,slippage:Number(L),max_ft_amount:s==null?void 0:s.balance,fix_amount_a:j};else{const U=Oe(I?g:p,9);v={vault_id:o,is_ft_input:!1,input_amount:U.toString(),slippage:Number(L),max_ft_amount:s==null?void 0:s.balance,fix_amount_a:j}}}console.log("🚀 ~ doRemoveAction ~ params:",v);const T={getShowInfo:(j,U)=>{const h="Withdraw "+[Re(g,e.symbol),Re(p,l.symbol)].filter(Boolean).join(" and "),f={modalDescriptionText:h,toastDescriptionContent:h};if(j==="success"){let z=g||"0",O=p||"0";console.log("🚀🚀🚀 ~ useVaultsRemove.ts:582 ~ doRemoveAction ~ balanceChanges:",U,g,p),U&&(z=C(g||"0").gt(0)?qt(U,e)||g:"",O=C(p||"0").gt(0)?qt(U,l)||p:"");const k=[Re(z,e.symbol),Re(O,l.symbol)].filter(Boolean),F=(k&&k.length>1?"Removed ":"Withdraw ")+[Re(z,e==null?void 0:e.symbol),Re(O,l==null?void 0:l.symbol)].filter(Boolean).join(" and ");f.toastDescriptionContent=F,f.modalDescriptionText=F}return f}};St(T);try{let j=new st,U;if(a=="haedal")C(c.burn_ft_amount).gt(s==null?void 0:s.vaultBalance)?(U=await J.Farms.buildRawWithdrawPayload({poolId:b.poolId,stakeCoinType:b.stakeCoinType,stakeObjectId:m.stakeObjectId,amount:C(c.burn_ft_amount).sub(s==null?void 0:s.vaultBalance).toString(),claimReward:_,rewardConfigs:_?b.rewardConfigs:void 0},j),console.log("🚀🚀🚀 ~ useVaultsRemove.ts:672 ~ doRemoveAction ~ lpCoin:",U)):b!=null&&b.poolId&&_&&C((m==null?void 0:m.stakedBalance)||"0").gt(0)&&await J.Farms.buildHarvestPayload({poolId:b.poolId,stakeCoinType:b.stakeCoinType,stakeObjectId:m.stakeObjectId,rewardCoinType:(y=m.rewardConfigs[0])==null?void 0:y.rewardCoinType,rewardBank:(E=m.rewardConfigs[0])==null?void 0:E.bank},j),await S.Vaults.buildWithdrawPayload({...v,burn_lp_amount:C(c.burn_ft_amount).gt(s==null?void 0:s.vaultBalance)?s==null?void 0:s.vaultBalance:c.burn_ft_amount,extra_burn:U?{lp_burn_coin:U,burn_lp_amount:C(c.burn_ft_amount).sub(s==null?void 0:s.vaultBalance).toString()}:void 0},j);else if(a=="cetus-dlmm"){console.log("🚀🚀🚀 ~ useVaultsRemove.ts:726 ~ doRemoveAction ~ param:",v);const f={...v,pool_id:o,burn_lp_amount:C(c.burn_ft_amount).gt(s==null?void 0:s.vaultBalance)?s==null?void 0:s.vaultBalance:c.burn_ft_amount,mode:Ee};console.log("🚀🚀🚀 ~ useVaultsRemove.ts:733 ~ doRemoveAction ~ result:",f),await S.VaultsV2.buildWithdrawPayload({...v,pool_id:o,burn_lp_amount:C(c.burn_ft_amount).gt(s==null?void 0:s.vaultBalance)?s==null?void 0:s.vaultBalance:c.burn_ft_amount,mode:Ee},j)}else await P.Vaults.withdraw(v,j);await gt(j,T,{useMev:B,txAction:"signTransactionBlock",useFastMode:D==="Fast Mode",maxCapForGas:M,customGasPrice:$,msafeParams:{action:ot.AddVaultsPosition,txbParams:v}})?(G(),setTimeout(()=>{Y(),le(o)},2e3)):Ue(),et(!1)}catch(j){console.log("🚀🚀🚀 ~ useVaultsRemove.ts:675 ~ doRemoveAction ~ error:",j),et(!1),_t(T)}}},jt=i.useMemo(()=>{if(c&&(c.swap_result||c.swap)&&r!=="both"&&q&&Se){let y=a=="cetus"?c.swap_result.swap_in_amount:c.swap.swap_amount_in,E=a=="cetus"?c.swap_result.swap_out_amount:c.swap.swap_amount_out;const v=a=="cetus"?I:n?!I:I,T=v?g:p,j=v?e:l,U=v?l:e,h=Ge(y,U.decimals),f=Ge(C(E).mul(1-Number(L)).toString(),j.decimals);return`To withdraw ${Ie(T,j==null?void 0:j.decimals)} ${j==null?void 0:j.symbol}, ${Ie(h,U==null?void 0:U.decimals)} ${U==null?void 0:U.symbol} in the pool will be traded for ${Ie(f,j==null?void 0:j.decimals)} ${j==null?void 0:j.symbol}`}},[r,c,g,p,I,a]);i.useEffect(()=>{Ue()},[we,K]);const{currentAccount:Je}=Le();return i.useEffect(()=>{G(),setTimeout(()=>{s!=null&&s.amountA&&(s!=null&&s.amountB)&&Me()},200)},[x,r,Je==null?void 0:Je.address]),i.useEffect(()=>{Me()},[s==null?void 0:s.amountA,s==null?void 0:s.amountB]),{calculateAvailableLoading:Ve,availableAmountA:we,availableAmountB:K,amountInputA:g,amountInputB:p,amountValueA:A,amountValueB:W,zapNumGtError:ke,zapNumLtError:oe,handleAmountInputChange:ct,handlePercentInputChange:Ne,debouncedPercentInputChange:Qe,removePercent:ce,showOnlySideTips:jt,preCalculateLoading:se,doRemoveAction:wt,inputTotalValue:ze,calculateResult:c,setIsSlider:ue,resetInputAmount:G,calculateAvailableAmount:Me,submitLoading:Ct,isSlider:be,fixAmountA:I,reCalculateResult:Ue}}function Ss(o){const{currentAccount:a,onWalletModal:e}=Le(),{fromToken:l,toToken:n,calculateResult:r}=Be(),{currentVaultPosition:x}=xt(),{assetAction:s,setAssetAction:m,isCheckedZAP:_,setIsCheckedZAP:b}=Be(),{category:g,isReverse:p,vaultId:c,currentActionTab:w,lpTokenInfo:u,isModal:d,isAutoRefresh:R}=o,{vaultsFarmingStaked:L}=Ae(),B=i.useMemo(()=>L[c],[L,c]),M=i.useMemo(()=>x,[x]),{amountInputA:D,amountInputB:$,amountValueA:ae,amountValueB:S,calculateAvailableLoading:J,availableAmountA:P,availableAmountB:pe,zapNumGtError:se,zapNumLtError:Q,handleAmountInputChange:I,removePercent:H,handlePercentInputChange:Y,doRemoveAction:le,showOnlySideTips:ie,preCalculateLoading:Z,inputTotalValue:be,setIsSlider:ue,resetInputAmount:he,isSlider:N,fixAmountA:re}=gs(c,g,l,n,p,s,_,M,B),{btnText:xe,btnDisabled:ve}=ua(D,$,P||"",pe||"",l,n,s,!1,se,Q,g,_),{amountLimit:q}=ra(0,r==null?void 0:r.burn_ft_amount,!1),Se=i.useMemo(()=>Ie(Ge(q||"0",u==null?void 0:u.decimals),u==null?void 0:u.decimals),[q,u]);i.useEffect(()=>{he()},[_,s]);const A=i.useMemo(()=>Z?N?!0:p?re:!re:!1,[Z,N]),W=i.useMemo(()=>Z?N?!0:p?!re:re:!1,[Z,N]),we=i.useRef(!1);return i.useEffect(()=>{we.current=!0},[]),t.jsxs(X,{gap:d?"8px":"12px",w:"100%",align:"flex-start",children:[t.jsxs(Ke,{bg:d?"transparent":"none",border:"none",borderRadius:"12px",p:{base:"16px 8px 8px",lg:d?"0":"0px"},w:"100%",children:[t.jsx(ma,{label:"Remove Amounts",displayTokenA:l,displayTokenB:n,onSelectAssetTab:de=>{m(de)},isCheckedZAP:_,setIsCheckedZAP:b,assetAction:s,setAssetAction:m,currentActionTab:w,category:g}),t.jsx(Kt,{w:"100%",position:"relative",mt:d?"8px":"12px",children:t.jsx(Ht,{borderRadius:"12px",from:{wrapStyle:{borderRadius:"12px",h:"unset",p:{base:"20px 8px",lg:"20px 16px"}},calculateAvailableLoading:J,hideSelf:s!=="both"&&s!==(l==null?void 0:l.coin_type),balance:P||"",value:D,amountValue:ae&&!A?ae:"",loading:A,onChange:(de,K,fe)=>{a!=null&&a.address&&!J&&(ue(!1),I(de,!0,K,fe))},needRemainBalance:!1,selectable:!1,placeholder:"0.0",token:l,balanceLabel:"Available"},to:{wrapStyle:{borderRadius:"12px",h:"unset",p:{base:"20px 8px",lg:"20px 16px"}},balanceLabel:"Available",calculateAvailableLoading:J,needRemainBalance:!1,hideSelf:s!=="both"&&s!==(n==null?void 0:n.coin_type),balance:pe||"",value:$,amountValue:S&&!W?S:"",loading:W,onChange:(de,K,fe)=>{a!=null&&a.address&&!J&&(ue(!1),I(de,!1,K,fe))},selectable:!1,placeholder:"0.0",token:n},iconParams:{xlinkHref:"#icon-icon_add",svgFill:"text_caption",iconCursor:"default"},iconHover:!1})})]}),!d&&t.jsx(Ke,{bg:"none",border:"none",borderRadius:"12px",p:{base:"16px 8px",lg:"0px"},children:t.jsx(Za,{textFontSize:"20px",sliderTrackHeight:"8px",sliderBg:"bg_secondary",percentage:H,onChange:de=>{J||(console.log("🚀🚀🚀 ~ VaultsRemove.tsx:213 ~ VaultsRemove ~ assetAction:",s),console.log("🚀🚀🚀 ~ VaultsRemove.tsx:214 ~ VaultsRemove ~ fromToken.address:",l.address),Y(Number(de.toString().replace("%","")),s=="both"?!0:s==l.coin_type))}})}),t.jsxs(X,{w:"100%",gap:"12px",children:[t.jsx(Fe,{m:"-1px",isLoading:Z,w:"100%",borderRadius:"12px",h:"52px",fontSize:"18px",fontWeight:"500",isDisabled:ve||Z,onClick:()=>{a?le():e(!0)},children:xe||(_?"Zap Out":"Withdraw")}),se&&t.jsx(X,{w:"100%",alignItems:"start",children:t.jsx(ee,{color:"primary_yellow",fontSize:"12px",textAlign:"left",w:"100%",bg:"primary_yellow_opacity.10",p:"12px",borderRadius:"8px",lineHeight:"20px",children:"Single-asset withdraw can't be higher than $10,000 at a time."})}),r&&!se&&(D||$)&&t.jsxs(X,{w:"100%",gap:"0px",mt:s!=="both"&&ie?"0px":"6px",children:[s!=="both"&&ie&&t.jsx(ee,{color:"text_paragraph",width:"100%",fontSize:"12px",lineHeight:"1.8",pb:"20px",children:ie}),t.jsxs(X,{w:"100%",gap:"20px",children:[t.jsx(Te,{label:"Total Withdraw",labelStyle:{fontSize:"14px"},value:Ha(be,2),valueStyle:{fontSize:"14px"},skeletonStyle:{valueH:"14px"},isLoading:Z}),t.jsx(Te,{label:"LP Burn Amount",value:`${Se} ${`${l==null?void 0:l.symbol} - ${n==null?void 0:n.symbol}`}`,labelStyle:{fontSize:"14px"},valueStyle:{fontSize:"14px"},skeletonStyle:{valueH:"14px"},isLoading:Z})]})]})]})]})}const _s=[{label:"Deposit",value:"Deposit"},{label:"Withdraw",value:"Withdraw"}];function Js({vaultId:o,autoRefresh:a,isRefresh:e,isModal:l,setIsOpenFarmingModal:n,setIsOpenPre:r,setFarmingModalAction:x}){const{setAmountInputA:s,setAmountInputB:m,currTab:_,setCurrTab:b,setIsCheckedZAP:g,setAssetAction:p}=Be(),{vaultListObj:c,lpTokenInfoObj:w}=Pt(),{vaultsPoolObj:u}=kt(),d=i.useMemo(()=>c[o],[c,o]),R=i.useMemo(()=>u[o],[u]),L=i.useMemo(()=>w[d==null?void 0:d.lpTokenType],[w,d==null?void 0:d.lpTokenType]),[B,M]=i.useState(!1),D=()=>{a(),M(H=>!H)},{autoClaimStakeFarming:$,setAutoClaimStakeFarming:ae}=Ae(),{currentVaultsFarm:S,isVaultsFarming:J}=ft(d==null?void 0:d.vaultId),{vaultsFarmingStaked:P,autoClaimFarmingReward:pe,setAutoCliamFarmingReward:se}=Ae(),{currentAccount:Q}=Le(),I=i.useMemo(()=>P[d==null?void 0:d.vaultId],[P,d==null?void 0:d.vaultId]);return i.useEffect(()=>()=>{b("Deposit"),g(!1),p("both")},[]),t.jsxs(X,{w:{base:"100%",lg:"100%"},justifyContent:"start",gap:l?"8px":"12px",children:[t.jsxs(me,{w:"100%",children:[t.jsx(ht,{type:"borderTab",wrapStyle:{w:"100%",h:l?"54px":"60px",border:"none",bg:"transparent"},itemStyle:{fontSize:l?"14px":"16px",mr:"28px"},tabList:_s,currentTab:_,handleChangeTab:H=>{s(""),m(""),b(H==null?void 0:H.value),p("both"),g(!1),H.value=="Withdraw",se(!0)}}),t.jsxs(me,{children:[(_!=="Deposit"||(d==null?void 0:d.category)==="cetus")&&t.jsx(sa,{slippageType:"vaults",compact:!0}),l&&t.jsx(oa,{handleRefresh:()=>D(),isAutoRefresh:!0,refreshInterval:20,innerStyle:{bg:"bg_secondary"},w:"28px",h:"28px",borderRadius:"8px",bg:"bg_secondary"})]})]}),_==="Deposit"&&t.jsx(hs,{category:d==null?void 0:d.category,isReverse:d==null?void 0:d.isReverse,vaultId:d==null?void 0:d.vaultId,currentActionTab:"Deposit",totalSupply:R==null?void 0:R.totalSupply,lpTokenInfo:L,feeTier:d==null?void 0:d.feeDisplay,isModal:l,binStep:d==null?void 0:d.binStep,isAutoRefresh:l?B:e,currentVaultsFarm:S,vaultsFarmingStaked:I}),_==="Withdraw"&&d&&t.jsx(Ss,{category:d==null?void 0:d.category,isReverse:d==null?void 0:d.isReverse,vaultId:d==null?void 0:d.vaultId,currentActionTab:"Withdraw",lpTokenInfo:L,isModal:l}),_==="Deposit"&&J&&t.jsxs(me,{p:"8px 12px",bg:"primary_opacity.10",borderRadius:"8px",children:[t.jsx(ee,{w:"100%",fontSize:"12px",lineHeight:"16px",color:"primary",children:"Automatically stake your LP token into the 3rd party farm to enjoy higher yield."}),t.jsx(It,{isChecked:$,onChange:()=>ae(!$)})]}),_==="Withdraw"&&J&&(I==null?void 0:I.stakedBalance)>0&&t.jsxs(me,{w:"100%",p:"8px 12px",bg:"primary_opacity.10",borderRadius:"8px",fontSize:"12px",color:"primary",justifyContent:"space-between",children:[t.jsx(ee,{fontSize:"12px",children:" Automatically claim pending farming rewards."}),t.jsx(It,{isChecked:pe,onChange:()=>se(!pe)})]}),l&&J&&(Q==null?void 0:Q.address)&&t.jsx(ns,{apiVaultInfo:d,setIsOpenFarmingModal:n,setIsOpenPre:r,setFarmingModalAction:x})]})}export{Qs as F,os as R,Js as V,Be as a,ss as b,is as c,Nt as u};
//# sourceMappingURL=VaultsAction-DL-ibFN1.js.map
