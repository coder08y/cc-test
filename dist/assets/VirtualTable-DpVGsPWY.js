import{r as i,j as s,V as _,B as x,F as M,i as J,T as O}from"./vendor-CBmAETR3.js";import{u as Q}from"./index-CLgd2W9i.js";import{T as U}from"./Table-CbnPAf5M.js";function A({columns:l,data:n,rowHeight:h=66,overscan:b=10,stickyHeaderTop:a="0px",gridTemplateColumns:g,columnGap:u="12px",px:p="0 16px",bg:f="bg_primary",isApp:o=!1,isLoading:v=!1,scrollWidth:S="830px",justify:R="",onRowClick:y=()=>{},rowKey:r="coinType",rowStyle:d={},scrollContainerSelector:P=".scroll-container"}){const[I,$]=i.useState(new Set),V=i.useRef(null),z=i.useRef(!1),C=i.useRef(),L=i.useCallback((e,t)=>{const c=new Set(I);let k=!1;const B=z.current?50:20,X=Math.max(0,e-B),D=Math.min((n==null?void 0:n.length)-1,t+B);for(let m=X;m<=D;m++){const E=n[m],T=typeof r=="function"?r(E):(E==null?void 0:E[r])??m.toString();c.has(T)||(c.add(T),k=!0)}k&&$(c)},[n,r,I]),j=Q({count:(n==null?void 0:n.length)||0,getScrollElement:()=>{const e=document.querySelector(P);return V.current=e,e},estimateSize:()=>h,overscan:b,onChange:e=>{const t=e.getVirtualItems();(t==null?void 0:t.length)>0&&L(t[0].index,t[(t==null?void 0:t.length)-1].index)}});i.useEffect(()=>{(n==null?void 0:n.length)>0&&L(0,Math.min(50,(n==null?void 0:n.length)-1))},[n,L]),i.useEffect(()=>{const e=V.current;if(!e)return;const t=()=>{z.current=!0,clearTimeout(C.current)},c=()=>{C.current=setTimeout(()=>{z.current=!1},100)};return e.addEventListener("scroll",t,{passive:!0}),e.addEventListener("scrollend",c,{passive:!0}),()=>{e.removeEventListener("scroll",t),e.removeEventListener("scrollend",c),clearTimeout(C.current)}},[]),i.useEffect(()=>{j.measure()},[n,j]);const w=i.useRef(null),[F,N]=i.useState(!1);i.useEffect(()=>{const e=V.current;if(!e)return;const t=()=>{if(w.current){const{top:c}=w.current.getBoundingClientRect();N(c<=Number(a==null?void 0:a.split("px")[0]))}};return e.addEventListener("scroll",t),t(),()=>e.removeEventListener("scroll",t)},[]);const q=()=>s.jsx(x,{display:"grid",w:{base:"100%",lg:"1160px"},margin:"auto",gridTemplateColumns:g,h:"36px",columnGap:o?"0px":u,p:o?0:p,children:l.map((e,t)=>s.jsx(M,{align:"center",justify:t===0?"flex-start":t===(l==null?void 0:l.length)-1?"flex-end":R||"flex-start",position:o&&e.sticky?"sticky":"static",left:"0",right:"0",bg:o&&e.sticky?f:"inherit",zIndex:o&&e.sticky?2:1,pl:o&&!e.sticky?"12px":"0px",children:e.title},String(e.key)))}),G=()=>s.jsx(x,{w:{base:"100%",lg:"1160px"},margin:"auto",h:`${j.getTotalSize()}px`,pos:"relative",minHeight:"500px",children:j.getVirtualItems().map(e=>{const t=n[e.index],c=typeof r=="function"?r(t):(t==null?void 0:t[r])??e.index,k=I.has(c);return s.jsx(Y,{item:t,columns:l,virtualRow:e,gridTemplateColumns:g,onRowClick:y,isApp:o,justify:R,bg:f,rowHeight:h,px:p,columnGap:u,style:d,isPreloaded:k},c)})}),W=()=>{if(v)return s.jsx(x,{w:{base:"100%",lg:"1160px"},margin:"atuo",children:s.jsx(U,{rowKey:r,columns:l,dataSource:n,skeletonLength:10,loading:!0,rowStyle:{height:`${h}px`,...d}})});const e=s.jsxs(s.Fragment,{children:[s.jsx(x,{ref:w,bg:F?f:"none",transition:{backgroundColor:"0.3s"},w:{base:"100%",lg:"calc(100% + 40px)"},position:o?"unset":"sticky",top:a,zIndex:"10",children:q()}),G()]});return o?s.jsx(x,{w:"100%",overflowX:"auto",bg:f,children:s.jsx(x,{w:S,children:e})}):s.jsx(_,{gap:"0",w:"100%",children:e})};return s.jsx(_,{w:"100%",gap:"0",children:W()})}function Y({item:l,columns:n,virtualRow:h,onRowClick:b,bg:a,justify:g,isApp:u=!1,gridTemplateColumns:p,rowHeight:f,px:o,columnGap:v,style:S,isPreloaded:R}){const y=J.useMemo(()=>n.map((r,d)=>s.jsx(M,{align:"center",justify:d===0?"flex-start":d===(n==null?void 0:n.length)-1?"flex-end":g||"flex-start",position:u&&r.sticky?"sticky":"static",right:0,left:0,bg:u?a:"unset",zIndex:u&&r.sticky?2:1,h:"100%",pl:u&&!r.sticky?"12px":"0px",children:r.render?r.render(l):s.jsx(O,{fontSize:"14px",fontWeight:"500",color:"text_caption",children:l==null?void 0:l[r.key]})},String(r.key))),[n,l,u,a,g]);return s.jsx(x,{pos:"absolute",top:`${h.start}px`,left:0,w:"100%",...S,height:`${f}px`,display:"grid",cursor:"pointer",columnGap:u?"0px":v,gridTemplateColumns:p,borderRadius:"12px",p:{base:"0",lg:o},_hover:{bg:u?"auto":"primary_opacity.10",...S._hover||{}},onClick:()=>b(l),children:y})}export{A as V};
