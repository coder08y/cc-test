import{bg as W,bD as R,bK as D,f as E,a as O,M as N,d as u,aV as T}from"./index-ihcskjKt.js";import{M as L}from"./msafe-BzcjPV-e.js";import{T as $}from"./cross-CbhIs7DK.js";var V=/\s/;function j(e){for(var a=e.length;a--&&V.test(e.charAt(a)););return a}var G=/^\s+/;function H(e){return e&&e.slice(0,j(e)+1).replace(G,"")}var M=NaN,K=/^[-+]0x[0-9a-f]+$/i,U=/^0b[01]+$/i,X=/^0o[0-7]+$/i,z=parseInt;function F(e){if(typeof e=="number")return e;if(W(e))return M;if(R(e)){var a=typeof e.valueOf=="function"?e.valueOf():e;e=R(a)?a+"":a}if(typeof e!="string")return e===0?e:+e;e=H(e);var s=U.test(e);return s||X.test(e)?z(e.slice(2),s?2:8):K.test(e)?M:+e}var B=function(){return D.Date.now()},J="Expected a function",Q=Math.max,Y=Math.min;function oe(e,a,s){var y,g,P,b,n,o,l=0,m=!1,f=!1,_=!0;if(typeof e!="function")throw new TypeError(J);a=F(a)||0,R(s)&&(m=!!s.leading,f="maxWait"in s,P=f?Q(F(s.maxWait)||0,a):P,_="trailing"in s?!!s.trailing:_);function p(t){var r=y,i=g;return y=g=void 0,l=t,b=e.apply(i,r),b}function I(t){return l=t,n=setTimeout(A,a),m?p(t):b}function w(t){var r=t-o,i=t-l,d=a-r;return f?Y(d,P-i):d}function v(t){var r=t-o,i=t-l;return o===void 0||r>=a||r<0||f&&i>=P}function A(){var t=B();if(v(t))return k(t);n=setTimeout(A,w(t))}function k(t){return n=void 0,_&&y?p(t):(y=g=void 0,b)}function S(){n!==void 0&&clearTimeout(n),l=0,y=o=g=n=void 0}function C(){return n===void 0?b:k(B())}function x(){var t=B(),r=v(t);if(y=arguments,g=this,o=t,r){if(n===void 0)return I(o);if(f)return clearTimeout(n),n=setTimeout(A,a),p(o)}return n===void 0&&(n=setTimeout(A,a)),b}return x.cancel=S,x.flush=C,x}function ne(){const e=E("clmm"),a=E("farms"),{slippage:s}=O(),{currentAccount:y}=N(),g=async(n,o,l)=>{console.log("ðŸš€ ~ getRemoveTsPayload ~ isRemoveAll:",o),console.log("ðŸš€ ~ getRemoveTsPayload ~ params:",n);const{posId:m,poolAddress:f,coinTypeA:_,coinTypeB:p,amountA:I,amountB:w,liquidity:v,lowerTick:A,upperTick:k,posType:S,rewarderCoinTypes:C,farmsPoolId:x,farmsPosId:t,isAutoClaim:r}=n,i=u(I).mul(u(1).sub(u(s))),d=u(w.toString()).mul(u(1).sub(u(s)));if(console.log("ðŸš€ ~ getRemoveTsPayload ~ minAmountA:",i,d),S==="clmm"){const c={coin_type_a:_,coin_type_b:p,pool_id:f,pos_id:m,delta_liquidity:v,min_amount_a:T(i.toString(),0)||"",min_amount_b:T(d.toString(),0)||"",collect_fee:r||o,rewarder_coin_types:r||o?C:[]};console.log("ðŸš€ ~ getRemoveTsPayload ~ parameter:",c);const q=await e.Position.removeLiquidityPayload(c,l),h={action:L.DecreaseLiquidity,txbParams:c};return console.log("ðŸš€ ~ getRemoveTsPayload ~ msafeParams:",q,h),{tx:q,msafeParams:h}}else{const c={pool_id:x||"",coin_type_a:_,coin_type_b:p,position_nft_id:t||"",clmm_pool_id:f,min_amount_a:T(i.toString(),0)||"",min_amount_b:T(d.toString(),0)||"",collect_rewarder:!!o,clmm_rewarder_types:r||o?C:[],delta_liquidity:v,unstake:!!o,close_position:!1};console.log("ðŸš€ ~ getRemoveTsPayload ~ parameter:",c);const q=await a.Farms.removeLiquidityPayload(c,l),h={action:"FarmingDecreaseLiquidity",txbParams:c};return console.log("ðŸš€ ~ getRemoveTsPayload ~ msafeParams:",h,q),{tx:q,msafeParams:h}}},P=async(n,o)=>{const{posId:l,poolAddress:m,coinTypeA:f,coinTypeB:_,amountA:p,amountB:I,liquidity:w,lowerTick:v,upperTick:A,posType:k,rewarderCoinTypes:S,farmsPoolId:C,farmsPosId:x}=n,t=u(p).mul(u(1).sub(u(s))),r=u(I.toString()).mul(u(1).sub(u(s)));if(console.log("ðŸš€ ~ getCloseTsPayload ~ minAmountA:",n,t.toString(),r.toString()),console.log("ðŸš€ ~ getCloseTsPayload ~ parameter.rewarderCoinTypes:",S),k==="clmm"){const i={coin_type_a:f,coin_type_b:_,pool_id:m,pos_id:l||"",min_amount_a:T(t.toString(),0)||"",min_amount_b:T(r.toString(),0)||"",rewarder_coin_types:S,collect_fee:!1};console.log("ðŸš€ ~ getCloseTsPayload ~ parameter:",i);const d=await e.Position.closePositionPayload(i,o),c={action:L.RemoveLiquidity,txbParams:i};return console.log("ðŸš€ ~ getCloseTsPayload ~ msafeParams:",d,c),{tx:d,msafeParams:c}}else{const i={pool_id:C||"",coin_type_a:f,coin_type_b:_,position_nft_id:x||"",clmm_pool_id:m,min_amount_a:T(t.toString(),0)||"",min_amount_b:T(r.toString(),0)||"",collect_fee:!0,collect_rewarder:!0,clmm_rewarder_types:S,delta_liquidity:w,unstake:!0,close_position:!0,clmm_position_id:l};console.log("ðŸš€ ~ getCloseTsPayload ~ parameter:",i);const d=await a.Farms.removeLiquidityPayload(i,o),c={action:L.FarmingRemoveLiquidity,txbParams:i};return console.log("ðŸš€ ~ getCloseTsPayload ~ msafeParams:",c,d),{tx:d,msafeParams:c}}};return{getRemoveTsPayload:g,getCloseTsPayload:P,getCloseTsPayloadAll:async n=>{console.log("ðŸš€ ~ getCloseTsPayloadAll ~ paramsList:",n);const o=new $;o.setSender(y==null?void 0:y.address);const l=await Promise.all(n.map(m=>m!=null&&m.isVestingPos?g(m,!0,o):P(m,o)));return console.log("ðŸš€ ~ getCloseTsPayloadAll ~ results:",l),l[0]}}}export{oe as d,ne as u};
//# sourceMappingURL=usePosRemove-CKs7-Z6Q.js.map
