import{b as C}from"./dlmm-B3MPeVqN.js";import{f as B,z as m,n as x,bi as F,p as w,i as I,d as S}from"./index-ihcskjKt.js";import{b as T}from"./usePosClaimFeeAndReward-R-HkZji1.js";import{a as q}from"./useWrapPoolData-CzWcfmSl.js";import"./vendor-CBmAETR3.js";import"./cross-CbhIs7DK.js";function O(){const e=B("dlmm"),{collectRewardAndFeePayload:b}=T();return{dlmmPreRemove:async y=>{const{bins:l,activeId:c,fixAmountA:d,coinAmount:P,isOnlyA:n,tokenA:t,tokenB:i,isReverse:r}=y,D={bins:l,active_id:c,coin_amount:P,...n!==void 0?{is_only_a:n}:{fix_amount_a:d}};console.log("ðŸš€ðŸš€ðŸš€ ~ useDlmmPosRemove.ts:11 ~ dlmmPreRemove ~ dlmmPosRemoveLiquidityParams:",D);const a=e==null?void 0:e.Position.calculateRemoveLiquidityInfo(D);console.log("ðŸš€ðŸš€ðŸš€ ~ useDlmmPosRemove.ts:18 ~ preRemove ~ binInfos:",a);const u=m(a==null?void 0:a.amount_a).div(10**(t==null?void 0:t.decimals)).toString(),p=m(a==null?void 0:a.amount_b).div(10**(i==null?void 0:i.decimals)).toString();return{displayCoinAmountA:r?p:u,displayCoinAmountB:r?u:p,coinAmountA:u,coinAmountB:p,binInfos:a}},getDlmmPosRemoveLiquidityPayload:(y,l)=>{const{dlmmPool:c,binInfos:d,coinTypeA:P,coinTypeB:n,positionId:t,slippage:i,rewardCoins:r,activeId:D,binStep:a,slideValue:u}=y,{bins:p}=d,v=[];if(console.log(p,"getDlmmPosRemoveLiquidityPayload bins"),p.length>1e3){const _=Math.ceil(p.length/1e3);for(let A=0;A<_;A++){const E=C(p,A,1e3),g={pool_id:c,position_id:t,bin_infos:E,coin_type_a:P,coin_type_b:n,slippage:i,reward_coins:[],active_id:D,collect_fee:!1,bin_step:a,remove_percent:u},h=e.Position.removeLiquidityPayload(g);v.push(h),A===_-1&&l&&b([{dlmmPool:g.pool_id,positionId:g.position_id,rewardCoins:r,coinTypeA:g.coin_type_a,coinTypeB:g.coin_type_b}],h),console.log(`ðŸš€ðŸš€ðŸš€ ~ useDlmmPosRemove.ts ~ getDlmmPosRemoveLiquidityPayload ~ batch ${A+1}/${_} ~ parameter:`,g)}}else{const R={pool_id:c,position_id:t,bin_infos:d,coin_type_a:P,coin_type_b:n,slippage:i,reward_coins:l?r:[],active_id:D,collect_fee:l,bin_step:a,remove_percent:u};console.log("ðŸš€ðŸš€ðŸš€ ~ useDlmmPosRemove.ts ~ getDlmmPosRemoveLiquidityPayload ~ single batch ~ parameter:",R);const _=e.Position.removeLiquidityPayload(R);v.push(_)}return v},getDlmmPosClosePositionPayload:(y,l)=>{const{dlmmPool:c,positionId:d,rewardCoins:P,coinTypeA:n,coinTypeB:t}=y,i={pool_id:c,position_id:d,reward_coins:P,coin_type_a:n,coin_type_b:t},r=e.Position.closePositionPayload(i,l);return console.log("ðŸš€ðŸš€ðŸš€ ~ useDlmmPosRemove.ts:72 ~ getDlmmPosClosePositionPayload ~ payload:",r),r}}}function V(){const{fetchByApi:e}=x();return{getDlmmPositionDailyEarning:async(o,f)=>{try{const s=await e(F,"GET",{position_id:o});if(console.log(s,"getDlmmPositionDailyEarning"),s!=null&&s.FeeA){const{FeeA:y,FeeB:l,Mining:c}=s,{dailyExpansionFactorUSD:d}=y,{dailyExpansionFactorUSD:P}=l;let n=m(0);c.forEach(i=>{n=m(i.dailyExpansionFactorUSD).add(n)});const t=m(d).add(m(P)).add(n).toString();if(f!==void 0&&m(f).gt(0)){const i=m(t).div(m(f)).mul(365).toString(),r=q(i,!0),D=w(t,2);return{apr:i,aprDisplay:r,totalDailyExpansionFactorUSD:t,dailyEarnUSDDisplay:D,originResult:s}}}}catch(s){throw console.log("ðŸš€ðŸš€ðŸš€ ~ getDlmmPositionDailyEarning.ts:35 ~ getDlmmPositionDailyEarning ~ error:",s),s}}}}const L=(e,b)=>({preCalcError:void 0,setPreCalcError:o=>{e(()=>({preCalcError:o}))},binInfos:{},setBinInfos:o=>{e(()=>({binInfos:o}))},currentPosDetailTab:"increase",setCurrentPosDetailTab:o=>{e(()=>({currentPosDetailTab:o}))},tokenAmountAfterA:"",tokenAmountAfterB:"",setTokenAmountAfterA:o=>{e(()=>({tokenAmountAfterA:S(o).lte(0)&&o!==""?"0":o}))},setTokenAmountAfterB:o=>{e(()=>({tokenAmountAfterB:S(o).lte(0)&&o!==""?"0":o}))},minPriceData:{},maxPriceData:{},setMinPriceData:o=>{e(()=>({minPriceData:o}))},setMaxPriceData:o=>{e(()=>({maxPriceData:o}))},dlmmPosDetailDirect:!0,setDlmmPosDetailDirect:o=>{e(()=>({dlmmPosDetailDirect:o}))},showPositionSelectRange:!0,setShowPositionSelectRange:o=>{e(()=>({showPositionSelectRange:o}))},isAutoClaim:!0,setIsAutoClaim:o=>{e(()=>({isAutoClaim:o}))},resetDlmmPosDetail:()=>{e(()=>({binInfos:{},currentPosDetailTab:"increase",tokenAmountAfterA:"",tokenAmountAfterB:"",minPriceData:{},maxPriceData:{},dlmmPosDetailDirect:!0,showPositionSelectRange:!0,isAutoClaim:!0,preCalcError:void 0}))}}),j=I(L);export{j as a,V as b,O as u};
//# sourceMappingURL=detail-BQ6q8Dje.js.map
